(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const a of document.querySelectorAll('link[rel="modulepreload"]'))i(a);new MutationObserver(a=>{for(const l of a)if(l.type==="childList")for(const u of l.addedNodes)u.tagName==="LINK"&&u.rel==="modulepreload"&&i(u)}).observe(document,{childList:!0,subtree:!0});function n(a){const l={};return a.integrity&&(l.integrity=a.integrity),a.referrerPolicy&&(l.referrerPolicy=a.referrerPolicy),a.crossOrigin==="use-credentials"?l.credentials="include":a.crossOrigin==="anonymous"?l.credentials="omit":l.credentials="same-origin",l}function i(a){if(a.ep)return;a.ep=!0;const l=n(a);fetch(a.href,l)}})();var gp={exports:{}},Oc={};var cb;function WA(){if(cb)return Oc;cb=1;var t=Symbol.for("react.transitional.element"),e=Symbol.for("react.fragment");function n(i,a,l){var u=null;if(l!==void 0&&(u=""+l),a.key!==void 0&&(u=""+a.key),"key"in a){l={};for(var h in a)h!=="key"&&(l[h]=a[h])}else l=a;return a=l.ref,{$$typeof:t,type:i,key:u,ref:a!==void 0?a:null,props:l}}return Oc.Fragment=e,Oc.jsx=n,Oc.jsxs=n,Oc}var ub;function YA(){return ub||(ub=1,gp.exports=WA()),gp.exports}var d=YA(),yp={exports:{}},Be={};var db;function XA(){if(db)return Be;db=1;var t=Symbol.for("react.transitional.element"),e=Symbol.for("react.portal"),n=Symbol.for("react.fragment"),i=Symbol.for("react.strict_mode"),a=Symbol.for("react.profiler"),l=Symbol.for("react.consumer"),u=Symbol.for("react.context"),h=Symbol.for("react.forward_ref"),m=Symbol.for("react.suspense"),g=Symbol.for("react.memo"),_=Symbol.for("react.lazy"),v=Symbol.for("react.activity"),b=Symbol.iterator;function w(P){return P===null||typeof P!="object"?null:(P=b&&P[b]||P["@@iterator"],typeof P=="function"?P:null)}var C={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},R=Object.assign,N={};function B(P,W,Y){this.props=P,this.context=W,this.refs=N,this.updater=Y||C}B.prototype.isReactComponent={},B.prototype.setState=function(P,W){if(typeof P!="object"&&typeof P!="function"&&P!=null)throw Error("takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,P,W,"setState")},B.prototype.forceUpdate=function(P){this.updater.enqueueForceUpdate(this,P,"forceUpdate")};function H(){}H.prototype=B.prototype;function F(P,W,Y){this.props=P,this.context=W,this.refs=N,this.updater=Y||C}var ae=F.prototype=new H;ae.constructor=F,R(ae,B.prototype),ae.isPureReactComponent=!0;var te=Array.isArray;function he(){}var L={H:null,A:null,T:null,S:null},I=Object.prototype.hasOwnProperty;function D(P,W,Y){var Q=Y.ref;return{$$typeof:t,type:P,key:W,ref:Q!==void 0?Q:null,props:Y}}function k(P,W){return D(P.type,W,P.props)}function O(P){return typeof P=="object"&&P!==null&&P.$$typeof===t}function j(P){var W={"=":"=0",":":"=2"};return"$"+P.replace(/[=:]/g,function(Y){return W[Y]})}var T=/\/+/g;function Z(P,W){return typeof P=="object"&&P!==null&&P.key!=null?j(""+P.key):W.toString(36)}function U(P){switch(P.status){case"fulfilled":return P.value;case"rejected":throw P.reason;default:switch(typeof P.status=="string"?P.then(he,he):(P.status="pending",P.then(function(W){P.status==="pending"&&(P.status="fulfilled",P.value=W)},function(W){P.status==="pending"&&(P.status="rejected",P.reason=W)})),P.status){case"fulfilled":return P.value;case"rejected":throw P.reason}}throw P}function z(P,W,Y,Q,fe){var ce=typeof P;(ce==="undefined"||ce==="boolean")&&(P=null);var me=!1;if(P===null)me=!0;else switch(ce){case"bigint":case"string":case"number":me=!0;break;case"object":switch(P.$$typeof){case t:case e:me=!0;break;case _:return me=P._init,z(me(P._payload),W,Y,Q,fe)}}if(me)return fe=fe(P),me=Q===""?"."+Z(P,0):Q,te(fe)?(Y="",me!=null&&(Y=me.replace(T,"$&/")+"/"),z(fe,W,Y,"",function(re){return re})):fe!=null&&(O(fe)&&(fe=k(fe,Y+(fe.key==null||P&&P.key===fe.key?"":(""+fe.key).replace(T,"$&/")+"/")+me)),W.push(fe)),1;me=0;var ge=Q===""?".":Q+":";if(te(P))for(var Ee=0;Ee<P.length;Ee++)Q=P[Ee],ce=ge+Z(Q,Ee),me+=z(Q,W,Y,ce,fe);else if(Ee=w(P),typeof Ee=="function")for(P=Ee.call(P),Ee=0;!(Q=P.next()).done;)Q=Q.value,ce=ge+Z(Q,Ee++),me+=z(Q,W,Y,ce,fe);else if(ce==="object"){if(typeof P.then=="function")return z(U(P),W,Y,Q,fe);throw W=String(P),Error("Objects are not valid as a React child (found: "+(W==="[object Object]"?"object with keys {"+Object.keys(P).join(", ")+"}":W)+"). If you meant to render a collection of children, use an array instead.")}return me}function q(P,W,Y){if(P==null)return P;var Q=[],fe=0;return z(P,Q,"","",function(ce){return W.call(Y,ce,fe++)}),Q}function K(P){if(P._status===-1){var W=P._result;W=W(),W.then(function(Y){(P._status===0||P._status===-1)&&(P._status=1,P._result=Y)},function(Y){(P._status===0||P._status===-1)&&(P._status=2,P._result=Y)}),P._status===-1&&(P._status=0,P._result=W)}if(P._status===1)return P._result.default;throw P._result}var ee=typeof reportError=="function"?reportError:function(P){if(typeof window=="object"&&typeof window.ErrorEvent=="function"){var W=new window.ErrorEvent("error",{bubbles:!0,cancelable:!0,message:typeof P=="object"&&P!==null&&typeof P.message=="string"?String(P.message):String(P),error:P});if(!window.dispatchEvent(W))return}else if(typeof process=="object"&&typeof process.emit=="function"){process.emit("uncaughtException",P);return}console.error(P)},X={map:q,forEach:function(P,W,Y){q(P,function(){W.apply(this,arguments)},Y)},count:function(P){var W=0;return q(P,function(){W++}),W},toArray:function(P){return q(P,function(W){return W})||[]},only:function(P){if(!O(P))throw Error("React.Children.only expected to receive a single React element child.");return P}};return Be.Activity=v,Be.Children=X,Be.Component=B,Be.Fragment=n,Be.Profiler=a,Be.PureComponent=F,Be.StrictMode=i,Be.Suspense=m,Be.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE=L,Be.__COMPILER_RUNTIME={__proto__:null,c:function(P){return L.H.useMemoCache(P)}},Be.cache=function(P){return function(){return P.apply(null,arguments)}},Be.cacheSignal=function(){return null},Be.cloneElement=function(P,W,Y){if(P==null)throw Error("The argument must be a React element, but you passed "+P+".");var Q=R({},P.props),fe=P.key;if(W!=null)for(ce in W.key!==void 0&&(fe=""+W.key),W)!I.call(W,ce)||ce==="key"||ce==="__self"||ce==="__source"||ce==="ref"&&W.ref===void 0||(Q[ce]=W[ce]);var ce=arguments.length-2;if(ce===1)Q.children=Y;else if(1<ce){for(var me=Array(ce),ge=0;ge<ce;ge++)me[ge]=arguments[ge+2];Q.children=me}return D(P.type,fe,Q)},Be.createContext=function(P){return P={$$typeof:u,_currentValue:P,_currentValue2:P,_threadCount:0,Provider:null,Consumer:null},P.Provider=P,P.Consumer={$$typeof:l,_context:P},P},Be.createElement=function(P,W,Y){var Q,fe={},ce=null;if(W!=null)for(Q in W.key!==void 0&&(ce=""+W.key),W)I.call(W,Q)&&Q!=="key"&&Q!=="__self"&&Q!=="__source"&&(fe[Q]=W[Q]);var me=arguments.length-2;if(me===1)fe.children=Y;else if(1<me){for(var ge=Array(me),Ee=0;Ee<me;Ee++)ge[Ee]=arguments[Ee+2];fe.children=ge}if(P&&P.defaultProps)for(Q in me=P.defaultProps,me)fe[Q]===void 0&&(fe[Q]=me[Q]);return D(P,ce,fe)},Be.createRef=function(){return{current:null}},Be.forwardRef=function(P){return{$$typeof:h,render:P}},Be.isValidElement=O,Be.lazy=function(P){return{$$typeof:_,_payload:{_status:-1,_result:P},_init:K}},Be.memo=function(P,W){return{$$typeof:g,type:P,compare:W===void 0?null:W}},Be.startTransition=function(P){var W=L.T,Y={};L.T=Y;try{var Q=P(),fe=L.S;fe!==null&&fe(Y,Q),typeof Q=="object"&&Q!==null&&typeof Q.then=="function"&&Q.then(he,ee)}catch(ce){ee(ce)}finally{W!==null&&Y.types!==null&&(W.types=Y.types),L.T=W}},Be.unstable_useCacheRefresh=function(){return L.H.useCacheRefresh()},Be.use=function(P){return L.H.use(P)},Be.useActionState=function(P,W,Y){return L.H.useActionState(P,W,Y)},Be.useCallback=function(P,W){return L.H.useCallback(P,W)},Be.useContext=function(P){return L.H.useContext(P)},Be.useDebugValue=function(){},Be.useDeferredValue=function(P,W){return L.H.useDeferredValue(P,W)},Be.useEffect=function(P,W){return L.H.useEffect(P,W)},Be.useEffectEvent=function(P){return L.H.useEffectEvent(P)},Be.useId=function(){return L.H.useId()},Be.useImperativeHandle=function(P,W,Y){return L.H.useImperativeHandle(P,W,Y)},Be.useInsertionEffect=function(P,W){return L.H.useInsertionEffect(P,W)},Be.useLayoutEffect=function(P,W){return L.H.useLayoutEffect(P,W)},Be.useMemo=function(P,W){return L.H.useMemo(P,W)},Be.useOptimistic=function(P,W){return L.H.useOptimistic(P,W)},Be.useReducer=function(P,W,Y){return L.H.useReducer(P,W,Y)},Be.useRef=function(P){return L.H.useRef(P)},Be.useState=function(P){return L.H.useState(P)},Be.useSyncExternalStore=function(P,W,Y){return L.H.useSyncExternalStore(P,W,Y)},Be.useTransition=function(){return L.H.useTransition()},Be.version="19.2.3",Be}var hb;function Ag(){return hb||(hb=1,yp.exports=XA()),yp.exports}var A=Ag(),_p={exports:{}},Mc={},vp={exports:{}},bp={};var fb;function JA(){return fb||(fb=1,(function(t){function e(z,q){var K=z.length;z.push(q);e:for(;0<K;){var ee=K-1>>>1,X=z[ee];if(0<a(X,q))z[ee]=q,z[K]=X,K=ee;else break e}}function n(z){return z.length===0?null:z[0]}function i(z){if(z.length===0)return null;var q=z[0],K=z.pop();if(K!==q){z[0]=K;e:for(var ee=0,X=z.length,P=X>>>1;ee<P;){var W=2*(ee+1)-1,Y=z[W],Q=W+1,fe=z[Q];if(0>a(Y,K))Q<X&&0>a(fe,Y)?(z[ee]=fe,z[Q]=K,ee=Q):(z[ee]=Y,z[W]=K,ee=W);else if(Q<X&&0>a(fe,K))z[ee]=fe,z[Q]=K,ee=Q;else break e}}return q}function a(z,q){var K=z.sortIndex-q.sortIndex;return K!==0?K:z.id-q.id}if(t.unstable_now=void 0,typeof performance=="object"&&typeof performance.now=="function"){var l=performance;t.unstable_now=function(){return l.now()}}else{var u=Date,h=u.now();t.unstable_now=function(){return u.now()-h}}var m=[],g=[],_=1,v=null,b=3,w=!1,C=!1,R=!1,N=!1,B=typeof setTimeout=="function"?setTimeout:null,H=typeof clearTimeout=="function"?clearTimeout:null,F=typeof setImmediate<"u"?setImmediate:null;function ae(z){for(var q=n(g);q!==null;){if(q.callback===null)i(g);else if(q.startTime<=z)i(g),q.sortIndex=q.expirationTime,e(m,q);else break;q=n(g)}}function te(z){if(R=!1,ae(z),!C)if(n(m)!==null)C=!0,he||(he=!0,j());else{var q=n(g);q!==null&&U(te,q.startTime-z)}}var he=!1,L=-1,I=5,D=-1;function k(){return N?!0:!(t.unstable_now()-D<I)}function O(){if(N=!1,he){var z=t.unstable_now();D=z;var q=!0;try{e:{C=!1,R&&(R=!1,H(L),L=-1),w=!0;var K=b;try{t:{for(ae(z),v=n(m);v!==null&&!(v.expirationTime>z&&k());){var ee=v.callback;if(typeof ee=="function"){v.callback=null,b=v.priorityLevel;var X=ee(v.expirationTime<=z);if(z=t.unstable_now(),typeof X=="function"){v.callback=X,ae(z),q=!0;break t}v===n(m)&&i(m),ae(z)}else i(m);v=n(m)}if(v!==null)q=!0;else{var P=n(g);P!==null&&U(te,P.startTime-z),q=!1}}break e}finally{v=null,b=K,w=!1}q=void 0}}finally{q?j():he=!1}}}var j;if(typeof F=="function")j=function(){F(O)};else if(typeof MessageChannel<"u"){var T=new MessageChannel,Z=T.port2;T.port1.onmessage=O,j=function(){Z.postMessage(null)}}else j=function(){B(O,0)};function U(z,q){L=B(function(){z(t.unstable_now())},q)}t.unstable_IdlePriority=5,t.unstable_ImmediatePriority=1,t.unstable_LowPriority=4,t.unstable_NormalPriority=3,t.unstable_Profiling=null,t.unstable_UserBlockingPriority=2,t.unstable_cancelCallback=function(z){z.callback=null},t.unstable_forceFrameRate=function(z){0>z||125<z?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):I=0<z?Math.floor(1e3/z):5},t.unstable_getCurrentPriorityLevel=function(){return b},t.unstable_next=function(z){switch(b){case 1:case 2:case 3:var q=3;break;default:q=b}var K=b;b=q;try{return z()}finally{b=K}},t.unstable_requestPaint=function(){N=!0},t.unstable_runWithPriority=function(z,q){switch(z){case 1:case 2:case 3:case 4:case 5:break;default:z=3}var K=b;b=z;try{return q()}finally{b=K}},t.unstable_scheduleCallback=function(z,q,K){var ee=t.unstable_now();switch(typeof K=="object"&&K!==null?(K=K.delay,K=typeof K=="number"&&0<K?ee+K:ee):K=ee,z){case 1:var X=-1;break;case 2:X=250;break;case 5:X=1073741823;break;case 4:X=1e4;break;default:X=5e3}return X=K+X,z={id:_++,callback:q,priorityLevel:z,startTime:K,expirationTime:X,sortIndex:-1},K>ee?(z.sortIndex=K,e(g,z),n(m)===null&&z===n(g)&&(R?(H(L),L=-1):R=!0,U(te,K-ee))):(z.sortIndex=X,e(m,z),C||w||(C=!0,he||(he=!0,j()))),z},t.unstable_shouldYield=k,t.unstable_wrapCallback=function(z){var q=b;return function(){var K=b;b=q;try{return z.apply(this,arguments)}finally{b=K}}}})(bp)),bp}var mb;function ZA(){return mb||(mb=1,vp.exports=JA()),vp.exports}var xp={exports:{}},An={};var pb;function eC(){if(pb)return An;pb=1;var t=Ag();function e(m){var g="https://react.dev/errors/"+m;if(1<arguments.length){g+="?args[]="+encodeURIComponent(arguments[1]);for(var _=2;_<arguments.length;_++)g+="&args[]="+encodeURIComponent(arguments[_])}return"Minified React error #"+m+"; visit "+g+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}function n(){}var i={d:{f:n,r:function(){throw Error(e(522))},D:n,C:n,L:n,m:n,X:n,S:n,M:n},p:0,findDOMNode:null},a=Symbol.for("react.portal");function l(m,g,_){var v=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:a,key:v==null?null:""+v,children:m,containerInfo:g,implementation:_}}var u=t.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE;function h(m,g){if(m==="font")return"";if(typeof g=="string")return g==="use-credentials"?g:""}return An.__DOM_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE=i,An.createPortal=function(m,g){var _=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!g||g.nodeType!==1&&g.nodeType!==9&&g.nodeType!==11)throw Error(e(299));return l(m,g,null,_)},An.flushSync=function(m){var g=u.T,_=i.p;try{if(u.T=null,i.p=2,m)return m()}finally{u.T=g,i.p=_,i.d.f()}},An.preconnect=function(m,g){typeof m=="string"&&(g?(g=g.crossOrigin,g=typeof g=="string"?g==="use-credentials"?g:"":void 0):g=null,i.d.C(m,g))},An.prefetchDNS=function(m){typeof m=="string"&&i.d.D(m)},An.preinit=function(m,g){if(typeof m=="string"&&g&&typeof g.as=="string"){var _=g.as,v=h(_,g.crossOrigin),b=typeof g.integrity=="string"?g.integrity:void 0,w=typeof g.fetchPriority=="string"?g.fetchPriority:void 0;_==="style"?i.d.S(m,typeof g.precedence=="string"?g.precedence:void 0,{crossOrigin:v,integrity:b,fetchPriority:w}):_==="script"&&i.d.X(m,{crossOrigin:v,integrity:b,fetchPriority:w,nonce:typeof g.nonce=="string"?g.nonce:void 0})}},An.preinitModule=function(m,g){if(typeof m=="string")if(typeof g=="object"&&g!==null){if(g.as==null||g.as==="script"){var _=h(g.as,g.crossOrigin);i.d.M(m,{crossOrigin:_,integrity:typeof g.integrity=="string"?g.integrity:void 0,nonce:typeof g.nonce=="string"?g.nonce:void 0})}}else g==null&&i.d.M(m)},An.preload=function(m,g){if(typeof m=="string"&&typeof g=="object"&&g!==null&&typeof g.as=="string"){var _=g.as,v=h(_,g.crossOrigin);i.d.L(m,_,{crossOrigin:v,integrity:typeof g.integrity=="string"?g.integrity:void 0,nonce:typeof g.nonce=="string"?g.nonce:void 0,type:typeof g.type=="string"?g.type:void 0,fetchPriority:typeof g.fetchPriority=="string"?g.fetchPriority:void 0,referrerPolicy:typeof g.referrerPolicy=="string"?g.referrerPolicy:void 0,imageSrcSet:typeof g.imageSrcSet=="string"?g.imageSrcSet:void 0,imageSizes:typeof g.imageSizes=="string"?g.imageSizes:void 0,media:typeof g.media=="string"?g.media:void 0})}},An.preloadModule=function(m,g){if(typeof m=="string")if(g){var _=h(g.as,g.crossOrigin);i.d.m(m,{as:typeof g.as=="string"&&g.as!=="script"?g.as:void 0,crossOrigin:_,integrity:typeof g.integrity=="string"?g.integrity:void 0})}else i.d.m(m)},An.requestFormReset=function(m){i.d.r(m)},An.unstable_batchedUpdates=function(m,g){return m(g)},An.useFormState=function(m,g,_){return u.H.useFormState(m,g,_)},An.useFormStatus=function(){return u.H.useHostTransitionStatus()},An.version="19.2.3",An}var gb;function tC(){if(gb)return xp.exports;gb=1;function t(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(t)}catch(e){console.error(e)}}return t(),xp.exports=eC(),xp.exports}var yb;function nC(){if(yb)return Mc;yb=1;var t=ZA(),e=Ag(),n=tC();function i(r){var s="https://react.dev/errors/"+r;if(1<arguments.length){s+="?args[]="+encodeURIComponent(arguments[1]);for(var o=2;o<arguments.length;o++)s+="&args[]="+encodeURIComponent(arguments[o])}return"Minified React error #"+r+"; visit "+s+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}function a(r){return!(!r||r.nodeType!==1&&r.nodeType!==9&&r.nodeType!==11)}function l(r){var s=r,o=r;if(r.alternate)for(;s.return;)s=s.return;else{r=s;do s=r,(s.flags&4098)!==0&&(o=s.return),r=s.return;while(r)}return s.tag===3?o:null}function u(r){if(r.tag===13){var s=r.memoizedState;if(s===null&&(r=r.alternate,r!==null&&(s=r.memoizedState)),s!==null)return s.dehydrated}return null}function h(r){if(r.tag===31){var s=r.memoizedState;if(s===null&&(r=r.alternate,r!==null&&(s=r.memoizedState)),s!==null)return s.dehydrated}return null}function m(r){if(l(r)!==r)throw Error(i(188))}function g(r){var s=r.alternate;if(!s){if(s=l(r),s===null)throw Error(i(188));return s!==r?null:r}for(var o=r,c=s;;){var p=o.return;if(p===null)break;var y=p.alternate;if(y===null){if(c=p.return,c!==null){o=c;continue}break}if(p.child===y.child){for(y=p.child;y;){if(y===o)return m(p),r;if(y===c)return m(p),s;y=y.sibling}throw Error(i(188))}if(o.return!==c.return)o=p,c=y;else{for(var E=!1,M=p.child;M;){if(M===o){E=!0,o=p,c=y;break}if(M===c){E=!0,c=p,o=y;break}M=M.sibling}if(!E){for(M=y.child;M;){if(M===o){E=!0,o=y,c=p;break}if(M===c){E=!0,c=y,o=p;break}M=M.sibling}if(!E)throw Error(i(189))}}if(o.alternate!==c)throw Error(i(190))}if(o.tag!==3)throw Error(i(188));return o.stateNode.current===o?r:s}function _(r){var s=r.tag;if(s===5||s===26||s===27||s===6)return r;for(r=r.child;r!==null;){if(s=_(r),s!==null)return s;r=r.sibling}return null}var v=Object.assign,b=Symbol.for("react.element"),w=Symbol.for("react.transitional.element"),C=Symbol.for("react.portal"),R=Symbol.for("react.fragment"),N=Symbol.for("react.strict_mode"),B=Symbol.for("react.profiler"),H=Symbol.for("react.consumer"),F=Symbol.for("react.context"),ae=Symbol.for("react.forward_ref"),te=Symbol.for("react.suspense"),he=Symbol.for("react.suspense_list"),L=Symbol.for("react.memo"),I=Symbol.for("react.lazy"),D=Symbol.for("react.activity"),k=Symbol.for("react.memo_cache_sentinel"),O=Symbol.iterator;function j(r){return r===null||typeof r!="object"?null:(r=O&&r[O]||r["@@iterator"],typeof r=="function"?r:null)}var T=Symbol.for("react.client.reference");function Z(r){if(r==null)return null;if(typeof r=="function")return r.$$typeof===T?null:r.displayName||r.name||null;if(typeof r=="string")return r;switch(r){case R:return"Fragment";case B:return"Profiler";case N:return"StrictMode";case te:return"Suspense";case he:return"SuspenseList";case D:return"Activity"}if(typeof r=="object")switch(r.$$typeof){case C:return"Portal";case F:return r.displayName||"Context";case H:return(r._context.displayName||"Context")+".Consumer";case ae:var s=r.render;return r=r.displayName,r||(r=s.displayName||s.name||"",r=r!==""?"ForwardRef("+r+")":"ForwardRef"),r;case L:return s=r.displayName||null,s!==null?s:Z(r.type)||"Memo";case I:s=r._payload,r=r._init;try{return Z(r(s))}catch{}}return null}var U=Array.isArray,z=e.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE,q=n.__DOM_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE,K={pending:!1,data:null,method:null,action:null},ee=[],X=-1;function P(r){return{current:r}}function W(r){0>X||(r.current=ee[X],ee[X]=null,X--)}function Y(r,s){X++,ee[X]=r.current,r.current=s}var Q=P(null),fe=P(null),ce=P(null),me=P(null);function ge(r,s){switch(Y(ce,s),Y(fe,r),Y(Q,null),s.nodeType){case 9:case 11:r=(r=s.documentElement)&&(r=r.namespaceURI)?Ov(r):0;break;default:if(r=s.tagName,s=s.namespaceURI)s=Ov(s),r=Mv(s,r);else switch(r){case"svg":r=1;break;case"math":r=2;break;default:r=0}}W(Q),Y(Q,r)}function Ee(){W(Q),W(fe),W(ce)}function re(r){r.memoizedState!==null&&Y(me,r);var s=Q.current,o=Mv(s,r.type);s!==o&&(Y(fe,r),Y(Q,o))}function ke(r){fe.current===r&&(W(Q),W(fe)),me.current===r&&(W(me),Rc._currentValue=K)}var Ve,jt;function Ot(r){if(Ve===void 0)try{throw Error()}catch(o){var s=o.stack.trim().match(/\n( *(at )?)/);Ve=s&&s[1]||"",jt=-1<o.stack.indexOf(`
    at`)?" (<anonymous>)":-1<o.stack.indexOf("@")?"@unknown:0:0":""}return`
`+Ve+r+jt}var Mt=!1;function sr(r,s){if(!r||Mt)return"";Mt=!0;var o=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{var c={DetermineComponentFrameRoot:function(){try{if(s){var _e=function(){throw Error()};if(Object.defineProperty(_e.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(_e,[])}catch(ue){var oe=ue}Reflect.construct(r,[],_e)}else{try{_e.call()}catch(ue){oe=ue}r.call(_e.prototype)}}else{try{throw Error()}catch(ue){oe=ue}(_e=r())&&typeof _e.catch=="function"&&_e.catch(function(){})}}catch(ue){if(ue&&oe&&typeof ue.stack=="string")return[ue.stack,oe.stack]}return[null,null]}};c.DetermineComponentFrameRoot.displayName="DetermineComponentFrameRoot";var p=Object.getOwnPropertyDescriptor(c.DetermineComponentFrameRoot,"name");p&&p.configurable&&Object.defineProperty(c.DetermineComponentFrameRoot,"name",{value:"DetermineComponentFrameRoot"});var y=c.DetermineComponentFrameRoot(),E=y[0],M=y[1];if(E&&M){var G=E.split(`
`),se=M.split(`
`);for(p=c=0;c<G.length&&!G[c].includes("DetermineComponentFrameRoot");)c++;for(;p<se.length&&!se[p].includes("DetermineComponentFrameRoot");)p++;if(c===G.length||p===se.length)for(c=G.length-1,p=se.length-1;1<=c&&0<=p&&G[c]!==se[p];)p--;for(;1<=c&&0<=p;c--,p--)if(G[c]!==se[p]){if(c!==1||p!==1)do if(c--,p--,0>p||G[c]!==se[p]){var pe=`
`+G[c].replace(" at new "," at ");return r.displayName&&pe.includes("<anonymous>")&&(pe=pe.replace("<anonymous>",r.displayName)),pe}while(1<=c&&0<=p);break}}}finally{Mt=!1,Error.prepareStackTrace=o}return(o=r?r.displayName||r.name:"")?Ot(o):""}function ar(r,s){switch(r.tag){case 26:case 27:case 5:return Ot(r.type);case 16:return Ot("Lazy");case 13:return r.child!==s&&s!==null?Ot("Suspense Fallback"):Ot("Suspense");case 19:return Ot("SuspenseList");case 0:case 15:return sr(r.type,!1);case 11:return sr(r.type.render,!1);case 1:return sr(r.type,!0);case 31:return Ot("Activity");default:return""}}function qr(r){try{var s="",o=null;do s+=ar(r,o),o=r,r=r.return;while(r);return s}catch(c){return`
Error generating stack: `+c.message+`
`+c.stack}}var ut=Object.prototype.hasOwnProperty,dt=t.unstable_scheduleCallback,we=t.unstable_cancelCallback,Le=t.unstable_shouldYield,He=t.unstable_requestPaint,$e=t.unstable_now,at=t.unstable_getCurrentPriorityLevel,rt=t.unstable_ImmediatePriority,qt=t.unstable_UserBlockingPriority,pn=t.unstable_NormalPriority,Xa=t.unstable_LowPriority,or=t.unstable_IdlePriority,ts=t.log,Tu=t.unstable_setDisableYieldValue,Tr=null,gn=null;function lr(r){if(typeof ts=="function"&&Tu(r),gn&&typeof gn.setStrictMode=="function")try{gn.setStrictMode(Tr,r)}catch{}}var Lt=Math.clz32?Math.clz32:Cu,Au=Math.log,Ja=Math.LN2;function Cu(r){return r>>>=0,r===0?32:31-(Au(r)/Ja|0)|0}var Gr=256,sa=262144,Gt=4194304;function Hr(r){var s=r&42;if(s!==0)return s;switch(r&-r){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:return 64;case 128:return 128;case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:return r&261888;case 262144:case 524288:case 1048576:case 2097152:return r&3932160;case 4194304:case 8388608:case 16777216:case 33554432:return r&62914560;case 67108864:return 67108864;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 0;default:return r}}function Qr(r,s,o){var c=r.pendingLanes;if(c===0)return 0;var p=0,y=r.suspendedLanes,E=r.pingedLanes;r=r.warmLanes;var M=c&134217727;return M!==0?(c=M&~y,c!==0?p=Hr(c):(E&=M,E!==0?p=Hr(E):o||(o=M&~r,o!==0&&(p=Hr(o))))):(M=c&~y,M!==0?p=Hr(M):E!==0?p=Hr(E):o||(o=c&~r,o!==0&&(p=Hr(o)))),p===0?0:s!==0&&s!==p&&(s&y)===0&&(y=p&-p,o=s&-s,y>=o||y===32&&(o&4194048)!==0)?s:p}function Ar(r,s){return(r.pendingLanes&~(r.suspendedLanes&~r.pingedLanes)&s)===0}function bf(r,s){switch(r){case 1:case 2:case 4:case 8:case 64:return s+250;case 16:case 32:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return s+5e3;case 4194304:case 8388608:case 16777216:case 33554432:return-1;case 67108864:case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function Ru(){var r=Gt;return Gt<<=1,(Gt&62914560)===0&&(Gt=4194304),r}function $r(r){for(var s=[],o=0;31>o;o++)s.push(r);return s}function aa(r,s){r.pendingLanes|=s,s!==268435456&&(r.suspendedLanes=0,r.pingedLanes=0,r.warmLanes=0)}function xf(r,s,o,c,p,y){var E=r.pendingLanes;r.pendingLanes=o,r.suspendedLanes=0,r.pingedLanes=0,r.warmLanes=0,r.expiredLanes&=o,r.entangledLanes&=o,r.errorRecoveryDisabledLanes&=o,r.shellSuspendCounter=0;var M=r.entanglements,G=r.expirationTimes,se=r.hiddenUpdates;for(o=E&~o;0<o;){var pe=31-Lt(o),_e=1<<pe;M[pe]=0,G[pe]=-1;var oe=se[pe];if(oe!==null)for(se[pe]=null,pe=0;pe<oe.length;pe++){var ue=oe[pe];ue!==null&&(ue.lane&=-536870913)}o&=~_e}c!==0&&oa(r,c,0),y!==0&&p===0&&r.tag!==0&&(r.suspendedLanes|=y&~(E&~s))}function oa(r,s,o){r.pendingLanes|=s,r.suspendedLanes&=~s;var c=31-Lt(s);r.entangledLanes|=s,r.entanglements[c]=r.entanglements[c]|1073741824|o&261930}function Ml(r,s){var o=r.entangledLanes|=s;for(r=r.entanglements;o;){var c=31-Lt(o),p=1<<c;p&s|r[c]&s&&(r[c]|=s),o&=~p}}function kl(r,s){var o=s&-s;return o=(o&42)!==0?1:la(o),(o&(r.suspendedLanes|s))!==0?0:o}function la(r){switch(r){case 2:r=1;break;case 8:r=4;break;case 32:r=16;break;case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:r=128;break;case 268435456:r=134217728;break;default:r=0}return r}function Ei(r){return r&=-r,2<r?8<r?(r&134217727)!==0?32:268435456:8:2}function Du(){var r=q.p;return r!==0?r:(r=window.event,r===void 0?32:nb(r.type))}function Cr(r,s){var o=q.p;try{return q.p=r,s()}finally{q.p=o}}var Rr=Math.random().toString(36).slice(2),Ht="__reactFiber$"+Rr,cn="__reactProps$"+Rr,Kr="__reactContainer$"+Rr,Za="__reactEvents$"+Rr,Ef="__reactListeners$"+Rr,Iu="__reactHandles$"+Rr,ju="__reactResources$"+Rr,Wr="__reactMarker$"+Rr;function eo(r){delete r[Ht],delete r[cn],delete r[Za],delete r[Ef],delete r[Iu]}function Yr(r){var s=r[Ht];if(s)return s;for(var o=r.parentNode;o;){if(s=o[Kr]||o[Ht]){if(o=s.alternate,s.child!==null||o!==null&&o.child!==null)for(r=Uv(r);r!==null;){if(o=r[Ht])return o;r=Uv(r)}return s}r=o,o=r.parentNode}return null}function cr(r){if(r=r[Ht]||r[Kr]){var s=r.tag;if(s===5||s===6||s===13||s===31||s===26||s===27||s===3)return r}return null}function Qn(r){var s=r.tag;if(s===5||s===26||s===27||s===6)return r.stateNode;throw Error(i(33))}function Xr(r){var s=r[ju];return s||(s=r[ju]={hoistableStyles:new Map,hoistableScripts:new Map}),s}function Qt(r){r[Wr]=!0}var Nl=new Set,Pl={};function Jr(r,s){Zr(r,s),Zr(r+"Capture",s)}function Zr(r,s){for(Pl[r]=s,r=0;r<s.length;r++)Nl.add(s[r])}var Ll=RegExp("^[:A-Z_a-z\\u00C0-\\u00D6\\u00D8-\\u00F6\\u00F8-\\u02FF\\u0370-\\u037D\\u037F-\\u1FFF\\u200C-\\u200D\\u2070-\\u218F\\u2C00-\\u2FEF\\u3001-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFFD][:A-Z_a-z\\u00C0-\\u00D6\\u00D8-\\u00F6\\u00F8-\\u02FF\\u0370-\\u037D\\u037F-\\u1FFF\\u200C-\\u200D\\u2070-\\u218F\\u2C00-\\u2FEF\\u3001-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFFD\\-.0-9\\u00B7\\u0300-\\u036F\\u203F-\\u2040]*$"),Vl={},zl={};function Ou(r){return ut.call(zl,r)?!0:ut.call(Vl,r)?!1:Ll.test(r)?zl[r]=!0:(Vl[r]=!0,!1)}function to(r,s,o){if(Ou(s))if(o===null)r.removeAttribute(s);else{switch(typeof o){case"undefined":case"function":case"symbol":r.removeAttribute(s);return;case"boolean":var c=s.toLowerCase().slice(0,5);if(c!=="data-"&&c!=="aria-"){r.removeAttribute(s);return}}r.setAttribute(s,""+o)}}function $n(r,s,o){if(o===null)r.removeAttribute(s);else{switch(typeof o){case"undefined":case"function":case"symbol":case"boolean":r.removeAttribute(s);return}r.setAttribute(s,""+o)}}function $t(r,s,o,c){if(c===null)r.removeAttribute(o);else{switch(typeof c){case"undefined":case"function":case"symbol":case"boolean":r.removeAttribute(o);return}r.setAttributeNS(s,o,""+c)}}function un(r){switch(typeof r){case"bigint":case"boolean":case"number":case"string":case"undefined":return r;case"object":return r;default:return""}}function ns(r){var s=r.type;return(r=r.nodeName)&&r.toLowerCase()==="input"&&(s==="checkbox"||s==="radio")}function Ul(r,s,o){var c=Object.getOwnPropertyDescriptor(r.constructor.prototype,s);if(!r.hasOwnProperty(s)&&typeof c<"u"&&typeof c.get=="function"&&typeof c.set=="function"){var p=c.get,y=c.set;return Object.defineProperty(r,s,{configurable:!0,get:function(){return p.call(this)},set:function(E){o=""+E,y.call(this,E)}}),Object.defineProperty(r,s,{enumerable:c.enumerable}),{getValue:function(){return o},setValue:function(E){o=""+E},stopTracking:function(){r._valueTracker=null,delete r[s]}}}}function ht(r){if(!r._valueTracker){var s=ns(r)?"checked":"value";r._valueTracker=Ul(r,s,""+r[s])}}function ca(r){if(!r)return!1;var s=r._valueTracker;if(!s)return!0;var o=s.getValue(),c="";return r&&(c=ns(r)?r.checked?"true":"false":r.value),r=c,r!==o?(s.setValue(r),!0):!1}function ei(r){if(r=r||(typeof document<"u"?document:void 0),typeof r>"u")return null;try{return r.activeElement||r.body}catch{return r.body}}var ua=/[\n"\\]/g;function Nn(r){return r.replace(ua,function(s){return"\\"+s.charCodeAt(0).toString(16)+" "})}function no(r,s,o,c,p,y,E,M){r.name="",E!=null&&typeof E!="function"&&typeof E!="symbol"&&typeof E!="boolean"?r.type=E:r.removeAttribute("type"),s!=null?E==="number"?(s===0&&r.value===""||r.value!=s)&&(r.value=""+un(s)):r.value!==""+un(s)&&(r.value=""+un(s)):E!=="submit"&&E!=="reset"||r.removeAttribute("value"),s!=null?Bl(r,E,un(s)):o!=null?Bl(r,E,un(o)):c!=null&&r.removeAttribute("value"),p==null&&y!=null&&(r.defaultChecked=!!y),p!=null&&(r.checked=p&&typeof p!="function"&&typeof p!="symbol"),M!=null&&typeof M!="function"&&typeof M!="symbol"&&typeof M!="boolean"?r.name=""+un(M):r.removeAttribute("name")}function Mu(r,s,o,c,p,y,E,M){if(y!=null&&typeof y!="function"&&typeof y!="symbol"&&typeof y!="boolean"&&(r.type=y),s!=null||o!=null){if(!(y!=="submit"&&y!=="reset"||s!=null)){ht(r);return}o=o!=null?""+un(o):"",s=s!=null?""+un(s):o,M||s===r.value||(r.value=s),r.defaultValue=s}c=c??p,c=typeof c!="function"&&typeof c!="symbol"&&!!c,r.checked=M?r.checked:!!c,r.defaultChecked=!!c,E!=null&&typeof E!="function"&&typeof E!="symbol"&&typeof E!="boolean"&&(r.name=E),ht(r)}function Bl(r,s,o){s==="number"&&ei(r.ownerDocument)===r||r.defaultValue===""+o||(r.defaultValue=""+o)}function rs(r,s,o,c){if(r=r.options,s){s={};for(var p=0;p<o.length;p++)s["$"+o[p]]=!0;for(o=0;o<r.length;o++)p=s.hasOwnProperty("$"+r[o].value),r[o].selected!==p&&(r[o].selected=p),p&&c&&(r[o].defaultSelected=!0)}else{for(o=""+un(o),s=null,p=0;p<r.length;p++){if(r[p].value===o){r[p].selected=!0,c&&(r[p].defaultSelected=!0);return}s!==null||r[p].disabled||(s=r[p])}s!==null&&(s.selected=!0)}}function ku(r,s,o){if(s!=null&&(s=""+un(s),s!==r.value&&(r.value=s),o==null)){r.defaultValue!==s&&(r.defaultValue=s);return}r.defaultValue=o!=null?""+un(o):""}function is(r,s,o,c){if(s==null){if(c!=null){if(o!=null)throw Error(i(92));if(U(c)){if(1<c.length)throw Error(i(93));c=c[0]}o=c}o==null&&(o=""),s=o}o=un(s),r.defaultValue=o,c=r.textContent,c===o&&c!==""&&c!==null&&(r.value=c),ht(r)}function Pn(r,s){if(s){var o=r.firstChild;if(o&&o===r.lastChild&&o.nodeType===3){o.nodeValue=s;return}}r.textContent=s}var Nu=new Set("animationIterationCount aspectRatio borderImageOutset borderImageSlice borderImageWidth boxFlex boxFlexGroup boxOrdinalGroup columnCount columns flex flexGrow flexPositive flexShrink flexNegative flexOrder gridArea gridRow gridRowEnd gridRowSpan gridRowStart gridColumn gridColumnEnd gridColumnSpan gridColumnStart fontWeight lineClamp lineHeight opacity order orphans scale tabSize widows zIndex zoom fillOpacity floodOpacity stopOpacity strokeDasharray strokeDashoffset strokeMiterlimit strokeOpacity strokeWidth MozAnimationIterationCount MozBoxFlex MozBoxFlexGroup MozLineClamp msAnimationIterationCount msFlex msZoom msFlexGrow msFlexNegative msFlexOrder msFlexPositive msFlexShrink msGridColumn msGridColumnSpan msGridRow msGridRowSpan WebkitAnimationIterationCount WebkitBoxFlex WebKitBoxFlexGroup WebkitBoxOrdinalGroup WebkitColumnCount WebkitColumns WebkitFlex WebkitFlexGrow WebkitFlexPositive WebkitFlexShrink WebkitLineClamp".split(" "));function Fl(r,s,o){var c=s.indexOf("--")===0;o==null||typeof o=="boolean"||o===""?c?r.setProperty(s,""):s==="float"?r.cssFloat="":r[s]="":c?r.setProperty(s,o):typeof o!="number"||o===0||Nu.has(s)?s==="float"?r.cssFloat=o:r[s]=(""+o).trim():r[s]=o+"px"}function ql(r,s,o){if(s!=null&&typeof s!="object")throw Error(i(62));if(r=r.style,o!=null){for(var c in o)!o.hasOwnProperty(c)||s!=null&&s.hasOwnProperty(c)||(c.indexOf("--")===0?r.setProperty(c,""):c==="float"?r.cssFloat="":r[c]="");for(var p in s)c=s[p],s.hasOwnProperty(p)&&o[p]!==c&&Fl(r,p,c)}else for(var y in s)s.hasOwnProperty(y)&&Fl(r,y,s[y])}function ro(r){if(r.indexOf("-")===-1)return!1;switch(r){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var Pu=new Map([["acceptCharset","accept-charset"],["htmlFor","for"],["httpEquiv","http-equiv"],["crossOrigin","crossorigin"],["accentHeight","accent-height"],["alignmentBaseline","alignment-baseline"],["arabicForm","arabic-form"],["baselineShift","baseline-shift"],["capHeight","cap-height"],["clipPath","clip-path"],["clipRule","clip-rule"],["colorInterpolation","color-interpolation"],["colorInterpolationFilters","color-interpolation-filters"],["colorProfile","color-profile"],["colorRendering","color-rendering"],["dominantBaseline","dominant-baseline"],["enableBackground","enable-background"],["fillOpacity","fill-opacity"],["fillRule","fill-rule"],["floodColor","flood-color"],["floodOpacity","flood-opacity"],["fontFamily","font-family"],["fontSize","font-size"],["fontSizeAdjust","font-size-adjust"],["fontStretch","font-stretch"],["fontStyle","font-style"],["fontVariant","font-variant"],["fontWeight","font-weight"],["glyphName","glyph-name"],["glyphOrientationHorizontal","glyph-orientation-horizontal"],["glyphOrientationVertical","glyph-orientation-vertical"],["horizAdvX","horiz-adv-x"],["horizOriginX","horiz-origin-x"],["imageRendering","image-rendering"],["letterSpacing","letter-spacing"],["lightingColor","lighting-color"],["markerEnd","marker-end"],["markerMid","marker-mid"],["markerStart","marker-start"],["overlinePosition","overline-position"],["overlineThickness","overline-thickness"],["paintOrder","paint-order"],["panose-1","panose-1"],["pointerEvents","pointer-events"],["renderingIntent","rendering-intent"],["shapeRendering","shape-rendering"],["stopColor","stop-color"],["stopOpacity","stop-opacity"],["strikethroughPosition","strikethrough-position"],["strikethroughThickness","strikethrough-thickness"],["strokeDasharray","stroke-dasharray"],["strokeDashoffset","stroke-dashoffset"],["strokeLinecap","stroke-linecap"],["strokeLinejoin","stroke-linejoin"],["strokeMiterlimit","stroke-miterlimit"],["strokeOpacity","stroke-opacity"],["strokeWidth","stroke-width"],["textAnchor","text-anchor"],["textDecoration","text-decoration"],["textRendering","text-rendering"],["transformOrigin","transform-origin"],["underlinePosition","underline-position"],["underlineThickness","underline-thickness"],["unicodeBidi","unicode-bidi"],["unicodeRange","unicode-range"],["unitsPerEm","units-per-em"],["vAlphabetic","v-alphabetic"],["vHanging","v-hanging"],["vIdeographic","v-ideographic"],["vMathematical","v-mathematical"],["vectorEffect","vector-effect"],["vertAdvY","vert-adv-y"],["vertOriginX","vert-origin-x"],["vertOriginY","vert-origin-y"],["wordSpacing","word-spacing"],["writingMode","writing-mode"],["xmlnsXlink","xmlns:xlink"],["xHeight","x-height"]]),ss=/^[\u0000-\u001F ]*j[\r\n\t]*a[\r\n\t]*v[\r\n\t]*a[\r\n\t]*s[\r\n\t]*c[\r\n\t]*r[\r\n\t]*i[\r\n\t]*p[\r\n\t]*t[\r\n\t]*:/i;function io(r){return ss.test(""+r)?"javascript:throw new Error('React has blocked a javascript: URL as a security precaution.')":r}function Dr(){}var Gl=null;function ur(r){return r=r.target||r.srcElement||window,r.correspondingUseElement&&(r=r.correspondingUseElement),r.nodeType===3?r.parentNode:r}var as=null,ti=null;function da(r){var s=cr(r);if(s&&(r=s.stateNode)){var o=r[cn]||null;e:switch(r=s.stateNode,s.type){case"input":if(no(r,o.value,o.defaultValue,o.defaultValue,o.checked,o.defaultChecked,o.type,o.name),s=o.name,o.type==="radio"&&s!=null){for(o=r;o.parentNode;)o=o.parentNode;for(o=o.querySelectorAll('input[name="'+Nn(""+s)+'"][type="radio"]'),s=0;s<o.length;s++){var c=o[s];if(c!==r&&c.form===r.form){var p=c[cn]||null;if(!p)throw Error(i(90));no(c,p.value,p.defaultValue,p.defaultValue,p.checked,p.defaultChecked,p.type,p.name)}}for(s=0;s<o.length;s++)c=o[s],c.form===r.form&&ca(c)}break e;case"textarea":ku(r,o.value,o.defaultValue);break e;case"select":s=o.value,s!=null&&rs(r,!!o.multiple,s,!1)}}}var so=!1;function os(r,s,o){if(so)return r(s,o);so=!0;try{var c=r(s);return c}finally{if(so=!1,(as!==null||ti!==null)&&(Dd(),as&&(s=as,r=ti,ti=as=null,da(s),r)))for(s=0;s<r.length;s++)da(r[s])}}function Ir(r,s){var o=r.stateNode;if(o===null)return null;var c=o[cn]||null;if(c===null)return null;o=c[s];e:switch(s){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(c=!c.disabled)||(r=r.type,c=!(r==="button"||r==="input"||r==="select"||r==="textarea")),r=!c;break e;default:r=!1}if(r)return null;if(o&&typeof o!="function")throw Error(i(231,s,typeof o));return o}var dr=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),ha=!1;if(dr)try{var pt={};Object.defineProperty(pt,"passive",{get:function(){ha=!0}}),window.addEventListener("test",pt,pt),window.removeEventListener("test",pt,pt)}catch{ha=!1}var ni=null,Hl=null,fa=null;function Ql(){if(fa)return fa;var r,s=Hl,o=s.length,c,p="value"in ni?ni.value:ni.textContent,y=p.length;for(r=0;r<o&&s[r]===p[r];r++);var E=o-r;for(c=1;c<=E&&s[o-c]===p[y-c];c++);return fa=p.slice(r,1<c?1-c:void 0)}function ma(r){var s=r.keyCode;return"charCode"in r?(r=r.charCode,r===0&&s===13&&(r=13)):r=s,r===10&&(r=13),32<=r||r===13?r:0}function Si(){return!0}function jr(){return!1}function yn(r){function s(o,c,p,y,E){this._reactName=o,this._targetInst=p,this.type=c,this.nativeEvent=y,this.target=E,this.currentTarget=null;for(var M in r)r.hasOwnProperty(M)&&(o=r[M],this[M]=o?o(y):y[M]);return this.isDefaultPrevented=(y.defaultPrevented!=null?y.defaultPrevented:y.returnValue===!1)?Si:jr,this.isPropagationStopped=jr,this}return v(s.prototype,{preventDefault:function(){this.defaultPrevented=!0;var o=this.nativeEvent;o&&(o.preventDefault?o.preventDefault():typeof o.returnValue!="unknown"&&(o.returnValue=!1),this.isDefaultPrevented=Si)},stopPropagation:function(){var o=this.nativeEvent;o&&(o.stopPropagation?o.stopPropagation():typeof o.cancelBubble!="unknown"&&(o.cancelBubble=!0),this.isPropagationStopped=Si)},persist:function(){},isPersistent:Si}),s}var wi={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(r){return r.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},ri=yn(wi),ls=v({},wi,{view:0,detail:0}),$l=yn(ls),cs,ao,ii,oo=v({},ls,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:us,button:0,buttons:0,relatedTarget:function(r){return r.relatedTarget===void 0?r.fromElement===r.srcElement?r.toElement:r.fromElement:r.relatedTarget},movementX:function(r){return"movementX"in r?r.movementX:(r!==ii&&(ii&&r.type==="mousemove"?(cs=r.screenX-ii.screenX,ao=r.screenY-ii.screenY):ao=cs=0,ii=r),cs)},movementY:function(r){return"movementY"in r?r.movementY:ao}}),Kl=yn(oo),pa=v({},oo,{dataTransfer:0}),Lu=yn(pa),Vu=v({},ls,{relatedTarget:0}),ga=yn(Vu),Wl=v({},wi,{animationName:0,elapsedTime:0,pseudoElement:0}),zu=yn(Wl),lo=v({},wi,{clipboardData:function(r){return"clipboardData"in r?r.clipboardData:window.clipboardData}}),Uu=yn(lo),Bu=v({},wi,{data:0}),si=yn(Bu),Fu={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},qu={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},Gu={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function Hu(r){var s=this.nativeEvent;return s.getModifierState?s.getModifierState(r):(r=Gu[r])?!!s[r]:!1}function us(){return Hu}var jn=v({},ls,{key:function(r){if(r.key){var s=Fu[r.key]||r.key;if(s!=="Unidentified")return s}return r.type==="keypress"?(r=ma(r),r===13?"Enter":String.fromCharCode(r)):r.type==="keydown"||r.type==="keyup"?qu[r.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:us,charCode:function(r){return r.type==="keypress"?ma(r):0},keyCode:function(r){return r.type==="keydown"||r.type==="keyup"?r.keyCode:0},which:function(r){return r.type==="keypress"?ma(r):r.type==="keydown"||r.type==="keyup"?r.keyCode:0}}),Qu=yn(jn),$u=v({},oo,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),Ti=yn($u),f=v({},ls,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:us}),x=yn(f),S=v({},wi,{propertyName:0,elapsedTime:0,pseudoElement:0}),V=yn(S),ne=v({},oo,{deltaX:function(r){return"deltaX"in r?r.deltaX:"wheelDeltaX"in r?-r.wheelDeltaX:0},deltaY:function(r){return"deltaY"in r?r.deltaY:"wheelDeltaY"in r?-r.wheelDeltaY:"wheelDelta"in r?-r.wheelDelta:0},deltaZ:0,deltaMode:0}),le=yn(ne),Se=v({},wi,{newState:0,oldState:0}),qe=yn(Se),Vt=[9,13,27,32],ot=dr&&"CompositionEvent"in window,At=null;dr&&"documentMode"in document&&(At=document.documentMode);var hr=dr&&"TextEvent"in window&&!At,ai=dr&&(!ot||At&&8<At&&11>=At),Or=" ",Mr=!1;function ya(r,s){switch(r){case"keyup":return Vt.indexOf(s.keyCode)!==-1;case"keydown":return s.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function co(r){return r=r.detail,typeof r=="object"&&"data"in r?r.data:null}var uo=!1;function vT(r,s){switch(r){case"compositionend":return co(s);case"keypress":return s.which!==32?null:(Mr=!0,Or);case"textInput":return r=s.data,r===Or&&Mr?null:r;default:return null}}function bT(r,s){if(uo)return r==="compositionend"||!ot&&ya(r,s)?(r=Ql(),fa=Hl=ni=null,uo=!1,r):null;switch(r){case"paste":return null;case"keypress":if(!(s.ctrlKey||s.altKey||s.metaKey)||s.ctrlKey&&s.altKey){if(s.char&&1<s.char.length)return s.char;if(s.which)return String.fromCharCode(s.which)}return null;case"compositionend":return ai&&s.locale!=="ko"?null:s.data;default:return null}}var xT={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function qy(r){var s=r&&r.nodeName&&r.nodeName.toLowerCase();return s==="input"?!!xT[r.type]:s==="textarea"}function Gy(r,s,o,c){as?ti?ti.push(c):ti=[c]:as=c,s=Pd(s,"onChange"),0<s.length&&(o=new ri("onChange","change",null,o,c),r.push({event:o,listeners:s}))}var Yl=null,Xl=null;function ET(r){Av(r,0)}function Ku(r){var s=Qn(r);if(ca(s))return r}function Hy(r,s){if(r==="change")return s}var Qy=!1;if(dr){var Sf;if(dr){var wf="oninput"in document;if(!wf){var $y=document.createElement("div");$y.setAttribute("oninput","return;"),wf=typeof $y.oninput=="function"}Sf=wf}else Sf=!1;Qy=Sf&&(!document.documentMode||9<document.documentMode)}function Ky(){Yl&&(Yl.detachEvent("onpropertychange",Wy),Xl=Yl=null)}function Wy(r){if(r.propertyName==="value"&&Ku(Xl)){var s=[];Gy(s,Xl,r,ur(r)),os(ET,s)}}function ST(r,s,o){r==="focusin"?(Ky(),Yl=s,Xl=o,Yl.attachEvent("onpropertychange",Wy)):r==="focusout"&&Ky()}function wT(r){if(r==="selectionchange"||r==="keyup"||r==="keydown")return Ku(Xl)}function TT(r,s){if(r==="click")return Ku(s)}function AT(r,s){if(r==="input"||r==="change")return Ku(s)}function CT(r,s){return r===s&&(r!==0||1/r===1/s)||r!==r&&s!==s}var Kn=typeof Object.is=="function"?Object.is:CT;function Jl(r,s){if(Kn(r,s))return!0;if(typeof r!="object"||r===null||typeof s!="object"||s===null)return!1;var o=Object.keys(r),c=Object.keys(s);if(o.length!==c.length)return!1;for(c=0;c<o.length;c++){var p=o[c];if(!ut.call(s,p)||!Kn(r[p],s[p]))return!1}return!0}function Yy(r){for(;r&&r.firstChild;)r=r.firstChild;return r}function Xy(r,s){var o=Yy(r);r=0;for(var c;o;){if(o.nodeType===3){if(c=r+o.textContent.length,r<=s&&c>=s)return{node:o,offset:s-r};r=c}e:{for(;o;){if(o.nextSibling){o=o.nextSibling;break e}o=o.parentNode}o=void 0}o=Yy(o)}}function Jy(r,s){return r&&s?r===s?!0:r&&r.nodeType===3?!1:s&&s.nodeType===3?Jy(r,s.parentNode):"contains"in r?r.contains(s):r.compareDocumentPosition?!!(r.compareDocumentPosition(s)&16):!1:!1}function Zy(r){r=r!=null&&r.ownerDocument!=null&&r.ownerDocument.defaultView!=null?r.ownerDocument.defaultView:window;for(var s=ei(r.document);s instanceof r.HTMLIFrameElement;){try{var o=typeof s.contentWindow.location.href=="string"}catch{o=!1}if(o)r=s.contentWindow;else break;s=ei(r.document)}return s}function Tf(r){var s=r&&r.nodeName&&r.nodeName.toLowerCase();return s&&(s==="input"&&(r.type==="text"||r.type==="search"||r.type==="tel"||r.type==="url"||r.type==="password")||s==="textarea"||r.contentEditable==="true")}var RT=dr&&"documentMode"in document&&11>=document.documentMode,ho=null,Af=null,Zl=null,Cf=!1;function e_(r,s,o){var c=o.window===o?o.document:o.nodeType===9?o:o.ownerDocument;Cf||ho==null||ho!==ei(c)||(c=ho,"selectionStart"in c&&Tf(c)?c={start:c.selectionStart,end:c.selectionEnd}:(c=(c.ownerDocument&&c.ownerDocument.defaultView||window).getSelection(),c={anchorNode:c.anchorNode,anchorOffset:c.anchorOffset,focusNode:c.focusNode,focusOffset:c.focusOffset}),Zl&&Jl(Zl,c)||(Zl=c,c=Pd(Af,"onSelect"),0<c.length&&(s=new ri("onSelect","select",null,s,o),r.push({event:s,listeners:c}),s.target=ho)))}function _a(r,s){var o={};return o[r.toLowerCase()]=s.toLowerCase(),o["Webkit"+r]="webkit"+s,o["Moz"+r]="moz"+s,o}var fo={animationend:_a("Animation","AnimationEnd"),animationiteration:_a("Animation","AnimationIteration"),animationstart:_a("Animation","AnimationStart"),transitionrun:_a("Transition","TransitionRun"),transitionstart:_a("Transition","TransitionStart"),transitioncancel:_a("Transition","TransitionCancel"),transitionend:_a("Transition","TransitionEnd")},Rf={},t_={};dr&&(t_=document.createElement("div").style,"AnimationEvent"in window||(delete fo.animationend.animation,delete fo.animationiteration.animation,delete fo.animationstart.animation),"TransitionEvent"in window||delete fo.transitionend.transition);function va(r){if(Rf[r])return Rf[r];if(!fo[r])return r;var s=fo[r],o;for(o in s)if(s.hasOwnProperty(o)&&o in t_)return Rf[r]=s[o];return r}var n_=va("animationend"),r_=va("animationiteration"),i_=va("animationstart"),DT=va("transitionrun"),IT=va("transitionstart"),jT=va("transitioncancel"),s_=va("transitionend"),a_=new Map,Df="abort auxClick beforeToggle cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");Df.push("scrollEnd");function kr(r,s){a_.set(r,s),Jr(s,[r])}var Wu=typeof reportError=="function"?reportError:function(r){if(typeof window=="object"&&typeof window.ErrorEvent=="function"){var s=new window.ErrorEvent("error",{bubbles:!0,cancelable:!0,message:typeof r=="object"&&r!==null&&typeof r.message=="string"?String(r.message):String(r),error:r});if(!window.dispatchEvent(s))return}else if(typeof process=="object"&&typeof process.emit=="function"){process.emit("uncaughtException",r);return}console.error(r)},fr=[],mo=0,If=0;function Yu(){for(var r=mo,s=If=mo=0;s<r;){var o=fr[s];fr[s++]=null;var c=fr[s];fr[s++]=null;var p=fr[s];fr[s++]=null;var y=fr[s];if(fr[s++]=null,c!==null&&p!==null){var E=c.pending;E===null?p.next=p:(p.next=E.next,E.next=p),c.pending=p}y!==0&&o_(o,p,y)}}function Xu(r,s,o,c){fr[mo++]=r,fr[mo++]=s,fr[mo++]=o,fr[mo++]=c,If|=c,r.lanes|=c,r=r.alternate,r!==null&&(r.lanes|=c)}function jf(r,s,o,c){return Xu(r,s,o,c),Ju(r)}function ba(r,s){return Xu(r,null,null,s),Ju(r)}function o_(r,s,o){r.lanes|=o;var c=r.alternate;c!==null&&(c.lanes|=o);for(var p=!1,y=r.return;y!==null;)y.childLanes|=o,c=y.alternate,c!==null&&(c.childLanes|=o),y.tag===22&&(r=y.stateNode,r===null||r._visibility&1||(p=!0)),r=y,y=y.return;return r.tag===3?(y=r.stateNode,p&&s!==null&&(p=31-Lt(o),r=y.hiddenUpdates,c=r[p],c===null?r[p]=[s]:c.push(s),s.lane=o|536870912),y):null}function Ju(r){if(50<xc)throw xc=0,Um=null,Error(i(185));for(var s=r.return;s!==null;)r=s,s=r.return;return r.tag===3?r.stateNode:null}var po={};function OT(r,s,o,c){this.tag=r,this.key=o,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.refCleanup=this.ref=null,this.pendingProps=s,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=c,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function Wn(r,s,o,c){return new OT(r,s,o,c)}function Of(r){return r=r.prototype,!(!r||!r.isReactComponent)}function Ai(r,s){var o=r.alternate;return o===null?(o=Wn(r.tag,s,r.key,r.mode),o.elementType=r.elementType,o.type=r.type,o.stateNode=r.stateNode,o.alternate=r,r.alternate=o):(o.pendingProps=s,o.type=r.type,o.flags=0,o.subtreeFlags=0,o.deletions=null),o.flags=r.flags&65011712,o.childLanes=r.childLanes,o.lanes=r.lanes,o.child=r.child,o.memoizedProps=r.memoizedProps,o.memoizedState=r.memoizedState,o.updateQueue=r.updateQueue,s=r.dependencies,o.dependencies=s===null?null:{lanes:s.lanes,firstContext:s.firstContext},o.sibling=r.sibling,o.index=r.index,o.ref=r.ref,o.refCleanup=r.refCleanup,o}function l_(r,s){r.flags&=65011714;var o=r.alternate;return o===null?(r.childLanes=0,r.lanes=s,r.child=null,r.subtreeFlags=0,r.memoizedProps=null,r.memoizedState=null,r.updateQueue=null,r.dependencies=null,r.stateNode=null):(r.childLanes=o.childLanes,r.lanes=o.lanes,r.child=o.child,r.subtreeFlags=0,r.deletions=null,r.memoizedProps=o.memoizedProps,r.memoizedState=o.memoizedState,r.updateQueue=o.updateQueue,r.type=o.type,s=o.dependencies,r.dependencies=s===null?null:{lanes:s.lanes,firstContext:s.firstContext}),r}function Zu(r,s,o,c,p,y){var E=0;if(c=r,typeof r=="function")Of(r)&&(E=1);else if(typeof r=="string")E=LA(r,o,Q.current)?26:r==="html"||r==="head"||r==="body"?27:5;else e:switch(r){case D:return r=Wn(31,o,s,p),r.elementType=D,r.lanes=y,r;case R:return xa(o.children,p,y,s);case N:E=8,p|=24;break;case B:return r=Wn(12,o,s,p|2),r.elementType=B,r.lanes=y,r;case te:return r=Wn(13,o,s,p),r.elementType=te,r.lanes=y,r;case he:return r=Wn(19,o,s,p),r.elementType=he,r.lanes=y,r;default:if(typeof r=="object"&&r!==null)switch(r.$$typeof){case F:E=10;break e;case H:E=9;break e;case ae:E=11;break e;case L:E=14;break e;case I:E=16,c=null;break e}E=29,o=Error(i(130,r===null?"null":typeof r,"")),c=null}return s=Wn(E,o,s,p),s.elementType=r,s.type=c,s.lanes=y,s}function xa(r,s,o,c){return r=Wn(7,r,c,s),r.lanes=o,r}function Mf(r,s,o){return r=Wn(6,r,null,s),r.lanes=o,r}function c_(r){var s=Wn(18,null,null,0);return s.stateNode=r,s}function kf(r,s,o){return s=Wn(4,r.children!==null?r.children:[],r.key,s),s.lanes=o,s.stateNode={containerInfo:r.containerInfo,pendingChildren:null,implementation:r.implementation},s}var u_=new WeakMap;function mr(r,s){if(typeof r=="object"&&r!==null){var o=u_.get(r);return o!==void 0?o:(s={value:r,source:s,stack:qr(s)},u_.set(r,s),s)}return{value:r,source:s,stack:qr(s)}}var go=[],yo=0,ed=null,ec=0,pr=[],gr=0,ds=null,oi=1,li="";function Ci(r,s){go[yo++]=ec,go[yo++]=ed,ed=r,ec=s}function d_(r,s,o){pr[gr++]=oi,pr[gr++]=li,pr[gr++]=ds,ds=r;var c=oi;r=li;var p=32-Lt(c)-1;c&=~(1<<p),o+=1;var y=32-Lt(s)+p;if(30<y){var E=p-p%5;y=(c&(1<<E)-1).toString(32),c>>=E,p-=E,oi=1<<32-Lt(s)+p|o<<p|c,li=y+r}else oi=1<<y|o<<p|c,li=r}function Nf(r){r.return!==null&&(Ci(r,1),d_(r,1,0))}function Pf(r){for(;r===ed;)ed=go[--yo],go[yo]=null,ec=go[--yo],go[yo]=null;for(;r===ds;)ds=pr[--gr],pr[gr]=null,li=pr[--gr],pr[gr]=null,oi=pr[--gr],pr[gr]=null}function h_(r,s){pr[gr++]=oi,pr[gr++]=li,pr[gr++]=ds,oi=s.id,li=s.overflow,ds=r}var _n=null,St=null,tt=!1,hs=null,yr=!1,Lf=Error(i(519));function fs(r){var s=Error(i(418,1<arguments.length&&arguments[1]!==void 0&&arguments[1]?"text":"HTML",""));throw tc(mr(s,r)),Lf}function f_(r){var s=r.stateNode,o=r.type,c=r.memoizedProps;switch(s[Ht]=r,s[cn]=c,o){case"dialog":We("cancel",s),We("close",s);break;case"iframe":case"object":case"embed":We("load",s);break;case"video":case"audio":for(o=0;o<Sc.length;o++)We(Sc[o],s);break;case"source":We("error",s);break;case"img":case"image":case"link":We("error",s),We("load",s);break;case"details":We("toggle",s);break;case"input":We("invalid",s),Mu(s,c.value,c.defaultValue,c.checked,c.defaultChecked,c.type,c.name,!0);break;case"select":We("invalid",s);break;case"textarea":We("invalid",s),is(s,c.value,c.defaultValue,c.children)}o=c.children,typeof o!="string"&&typeof o!="number"&&typeof o!="bigint"||s.textContent===""+o||c.suppressHydrationWarning===!0||Iv(s.textContent,o)?(c.popover!=null&&(We("beforetoggle",s),We("toggle",s)),c.onScroll!=null&&We("scroll",s),c.onScrollEnd!=null&&We("scrollend",s),c.onClick!=null&&(s.onclick=Dr),s=!0):s=!1,s||fs(r,!0)}function m_(r){for(_n=r.return;_n;)switch(_n.tag){case 5:case 31:case 13:yr=!1;return;case 27:case 3:yr=!0;return;default:_n=_n.return}}function _o(r){if(r!==_n)return!1;if(!tt)return m_(r),tt=!0,!1;var s=r.tag,o;if((o=s!==3&&s!==27)&&((o=s===5)&&(o=r.type,o=!(o!=="form"&&o!=="button")||tp(r.type,r.memoizedProps)),o=!o),o&&St&&fs(r),m_(r),s===13){if(r=r.memoizedState,r=r!==null?r.dehydrated:null,!r)throw Error(i(317));St=zv(r)}else if(s===31){if(r=r.memoizedState,r=r!==null?r.dehydrated:null,!r)throw Error(i(317));St=zv(r)}else s===27?(s=St,Cs(r.type)?(r=ap,ap=null,St=r):St=s):St=_n?vr(r.stateNode.nextSibling):null;return!0}function Ea(){St=_n=null,tt=!1}function Vf(){var r=hs;return r!==null&&(Un===null?Un=r:Un.push.apply(Un,r),hs=null),r}function tc(r){hs===null?hs=[r]:hs.push(r)}var zf=P(null),Sa=null,Ri=null;function ms(r,s,o){Y(zf,s._currentValue),s._currentValue=o}function Di(r){r._currentValue=zf.current,W(zf)}function Uf(r,s,o){for(;r!==null;){var c=r.alternate;if((r.childLanes&s)!==s?(r.childLanes|=s,c!==null&&(c.childLanes|=s)):c!==null&&(c.childLanes&s)!==s&&(c.childLanes|=s),r===o)break;r=r.return}}function Bf(r,s,o,c){var p=r.child;for(p!==null&&(p.return=r);p!==null;){var y=p.dependencies;if(y!==null){var E=p.child;y=y.firstContext;e:for(;y!==null;){var M=y;y=p;for(var G=0;G<s.length;G++)if(M.context===s[G]){y.lanes|=o,M=y.alternate,M!==null&&(M.lanes|=o),Uf(y.return,o,r),c||(E=null);break e}y=M.next}}else if(p.tag===18){if(E=p.return,E===null)throw Error(i(341));E.lanes|=o,y=E.alternate,y!==null&&(y.lanes|=o),Uf(E,o,r),E=null}else E=p.child;if(E!==null)E.return=p;else for(E=p;E!==null;){if(E===r){E=null;break}if(p=E.sibling,p!==null){p.return=E.return,E=p;break}E=E.return}p=E}}function vo(r,s,o,c){r=null;for(var p=s,y=!1;p!==null;){if(!y){if((p.flags&524288)!==0)y=!0;else if((p.flags&262144)!==0)break}if(p.tag===10){var E=p.alternate;if(E===null)throw Error(i(387));if(E=E.memoizedProps,E!==null){var M=p.type;Kn(p.pendingProps.value,E.value)||(r!==null?r.push(M):r=[M])}}else if(p===me.current){if(E=p.alternate,E===null)throw Error(i(387));E.memoizedState.memoizedState!==p.memoizedState.memoizedState&&(r!==null?r.push(Rc):r=[Rc])}p=p.return}r!==null&&Bf(s,r,o,c),s.flags|=262144}function td(r){for(r=r.firstContext;r!==null;){if(!Kn(r.context._currentValue,r.memoizedValue))return!0;r=r.next}return!1}function wa(r){Sa=r,Ri=null,r=r.dependencies,r!==null&&(r.firstContext=null)}function vn(r){return p_(Sa,r)}function nd(r,s){return Sa===null&&wa(r),p_(r,s)}function p_(r,s){var o=s._currentValue;if(s={context:s,memoizedValue:o,next:null},Ri===null){if(r===null)throw Error(i(308));Ri=s,r.dependencies={lanes:0,firstContext:s},r.flags|=524288}else Ri=Ri.next=s;return o}var MT=typeof AbortController<"u"?AbortController:function(){var r=[],s=this.signal={aborted:!1,addEventListener:function(o,c){r.push(c)}};this.abort=function(){s.aborted=!0,r.forEach(function(o){return o()})}},kT=t.unstable_scheduleCallback,NT=t.unstable_NormalPriority,Kt={$$typeof:F,Consumer:null,Provider:null,_currentValue:null,_currentValue2:null,_threadCount:0};function Ff(){return{controller:new MT,data:new Map,refCount:0}}function nc(r){r.refCount--,r.refCount===0&&kT(NT,function(){r.controller.abort()})}var rc=null,qf=0,bo=0,xo=null;function PT(r,s){if(rc===null){var o=rc=[];qf=0,bo=Qm(),xo={status:"pending",value:void 0,then:function(c){o.push(c)}}}return qf++,s.then(g_,g_),s}function g_(){if(--qf===0&&rc!==null){xo!==null&&(xo.status="fulfilled");var r=rc;rc=null,bo=0,xo=null;for(var s=0;s<r.length;s++)(0,r[s])()}}function LT(r,s){var o=[],c={status:"pending",value:null,reason:null,then:function(p){o.push(p)}};return r.then(function(){c.status="fulfilled",c.value=s;for(var p=0;p<o.length;p++)(0,o[p])(s)},function(p){for(c.status="rejected",c.reason=p,p=0;p<o.length;p++)(0,o[p])(void 0)}),c}var y_=z.S;z.S=function(r,s){ev=$e(),typeof s=="object"&&s!==null&&typeof s.then=="function"&&PT(r,s),y_!==null&&y_(r,s)};var Ta=P(null);function Gf(){var r=Ta.current;return r!==null?r:bt.pooledCache}function rd(r,s){s===null?Y(Ta,Ta.current):Y(Ta,s.pool)}function __(){var r=Gf();return r===null?null:{parent:Kt._currentValue,pool:r}}var Eo=Error(i(460)),Hf=Error(i(474)),id=Error(i(542)),sd={then:function(){}};function v_(r){return r=r.status,r==="fulfilled"||r==="rejected"}function b_(r,s,o){switch(o=r[o],o===void 0?r.push(s):o!==s&&(s.then(Dr,Dr),s=o),s.status){case"fulfilled":return s.value;case"rejected":throw r=s.reason,E_(r),r;default:if(typeof s.status=="string")s.then(Dr,Dr);else{if(r=bt,r!==null&&100<r.shellSuspendCounter)throw Error(i(482));r=s,r.status="pending",r.then(function(c){if(s.status==="pending"){var p=s;p.status="fulfilled",p.value=c}},function(c){if(s.status==="pending"){var p=s;p.status="rejected",p.reason=c}})}switch(s.status){case"fulfilled":return s.value;case"rejected":throw r=s.reason,E_(r),r}throw Ca=s,Eo}}function Aa(r){try{var s=r._init;return s(r._payload)}catch(o){throw o!==null&&typeof o=="object"&&typeof o.then=="function"?(Ca=o,Eo):o}}var Ca=null;function x_(){if(Ca===null)throw Error(i(459));var r=Ca;return Ca=null,r}function E_(r){if(r===Eo||r===id)throw Error(i(483))}var So=null,ic=0;function ad(r){var s=ic;return ic+=1,So===null&&(So=[]),b_(So,r,s)}function sc(r,s){s=s.props.ref,r.ref=s!==void 0?s:null}function od(r,s){throw s.$$typeof===b?Error(i(525)):(r=Object.prototype.toString.call(s),Error(i(31,r==="[object Object]"?"object with keys {"+Object.keys(s).join(", ")+"}":r)))}function S_(r){function s(J,$){if(r){var ie=J.deletions;ie===null?(J.deletions=[$],J.flags|=16):ie.push($)}}function o(J,$){if(!r)return null;for(;$!==null;)s(J,$),$=$.sibling;return null}function c(J){for(var $=new Map;J!==null;)J.key!==null?$.set(J.key,J):$.set(J.index,J),J=J.sibling;return $}function p(J,$){return J=Ai(J,$),J.index=0,J.sibling=null,J}function y(J,$,ie){return J.index=ie,r?(ie=J.alternate,ie!==null?(ie=ie.index,ie<$?(J.flags|=67108866,$):ie):(J.flags|=67108866,$)):(J.flags|=1048576,$)}function E(J){return r&&J.alternate===null&&(J.flags|=67108866),J}function M(J,$,ie,ye){return $===null||$.tag!==6?($=Mf(ie,J.mode,ye),$.return=J,$):($=p($,ie),$.return=J,$)}function G(J,$,ie,ye){var Ie=ie.type;return Ie===R?pe(J,$,ie.props.children,ye,ie.key):$!==null&&($.elementType===Ie||typeof Ie=="object"&&Ie!==null&&Ie.$$typeof===I&&Aa(Ie)===$.type)?($=p($,ie.props),sc($,ie),$.return=J,$):($=Zu(ie.type,ie.key,ie.props,null,J.mode,ye),sc($,ie),$.return=J,$)}function se(J,$,ie,ye){return $===null||$.tag!==4||$.stateNode.containerInfo!==ie.containerInfo||$.stateNode.implementation!==ie.implementation?($=kf(ie,J.mode,ye),$.return=J,$):($=p($,ie.children||[]),$.return=J,$)}function pe(J,$,ie,ye,Ie){return $===null||$.tag!==7?($=xa(ie,J.mode,ye,Ie),$.return=J,$):($=p($,ie),$.return=J,$)}function _e(J,$,ie){if(typeof $=="string"&&$!==""||typeof $=="number"||typeof $=="bigint")return $=Mf(""+$,J.mode,ie),$.return=J,$;if(typeof $=="object"&&$!==null){switch($.$$typeof){case w:return ie=Zu($.type,$.key,$.props,null,J.mode,ie),sc(ie,$),ie.return=J,ie;case C:return $=kf($,J.mode,ie),$.return=J,$;case I:return $=Aa($),_e(J,$,ie)}if(U($)||j($))return $=xa($,J.mode,ie,null),$.return=J,$;if(typeof $.then=="function")return _e(J,ad($),ie);if($.$$typeof===F)return _e(J,nd(J,$),ie);od(J,$)}return null}function oe(J,$,ie,ye){var Ie=$!==null?$.key:null;if(typeof ie=="string"&&ie!==""||typeof ie=="number"||typeof ie=="bigint")return Ie!==null?null:M(J,$,""+ie,ye);if(typeof ie=="object"&&ie!==null){switch(ie.$$typeof){case w:return ie.key===Ie?G(J,$,ie,ye):null;case C:return ie.key===Ie?se(J,$,ie,ye):null;case I:return ie=Aa(ie),oe(J,$,ie,ye)}if(U(ie)||j(ie))return Ie!==null?null:pe(J,$,ie,ye,null);if(typeof ie.then=="function")return oe(J,$,ad(ie),ye);if(ie.$$typeof===F)return oe(J,$,nd(J,ie),ye);od(J,ie)}return null}function ue(J,$,ie,ye,Ie){if(typeof ye=="string"&&ye!==""||typeof ye=="number"||typeof ye=="bigint")return J=J.get(ie)||null,M($,J,""+ye,Ie);if(typeof ye=="object"&&ye!==null){switch(ye.$$typeof){case w:return J=J.get(ye.key===null?ie:ye.key)||null,G($,J,ye,Ie);case C:return J=J.get(ye.key===null?ie:ye.key)||null,se($,J,ye,Ie);case I:return ye=Aa(ye),ue(J,$,ie,ye,Ie)}if(U(ye)||j(ye))return J=J.get(ie)||null,pe($,J,ye,Ie,null);if(typeof ye.then=="function")return ue(J,$,ie,ad(ye),Ie);if(ye.$$typeof===F)return ue(J,$,ie,nd($,ye),Ie);od($,ye)}return null}function Ce(J,$,ie,ye){for(var Ie=null,it=null,De=$,Qe=$=0,Xe=null;De!==null&&Qe<ie.length;Qe++){De.index>Qe?(Xe=De,De=null):Xe=De.sibling;var st=oe(J,De,ie[Qe],ye);if(st===null){De===null&&(De=Xe);break}r&&De&&st.alternate===null&&s(J,De),$=y(st,$,Qe),it===null?Ie=st:it.sibling=st,it=st,De=Xe}if(Qe===ie.length)return o(J,De),tt&&Ci(J,Qe),Ie;if(De===null){for(;Qe<ie.length;Qe++)De=_e(J,ie[Qe],ye),De!==null&&($=y(De,$,Qe),it===null?Ie=De:it.sibling=De,it=De);return tt&&Ci(J,Qe),Ie}for(De=c(De);Qe<ie.length;Qe++)Xe=ue(De,J,Qe,ie[Qe],ye),Xe!==null&&(r&&Xe.alternate!==null&&De.delete(Xe.key===null?Qe:Xe.key),$=y(Xe,$,Qe),it===null?Ie=Xe:it.sibling=Xe,it=Xe);return r&&De.forEach(function(Os){return s(J,Os)}),tt&&Ci(J,Qe),Ie}function Me(J,$,ie,ye){if(ie==null)throw Error(i(151));for(var Ie=null,it=null,De=$,Qe=$=0,Xe=null,st=ie.next();De!==null&&!st.done;Qe++,st=ie.next()){De.index>Qe?(Xe=De,De=null):Xe=De.sibling;var Os=oe(J,De,st.value,ye);if(Os===null){De===null&&(De=Xe);break}r&&De&&Os.alternate===null&&s(J,De),$=y(Os,$,Qe),it===null?Ie=Os:it.sibling=Os,it=Os,De=Xe}if(st.done)return o(J,De),tt&&Ci(J,Qe),Ie;if(De===null){for(;!st.done;Qe++,st=ie.next())st=_e(J,st.value,ye),st!==null&&($=y(st,$,Qe),it===null?Ie=st:it.sibling=st,it=st);return tt&&Ci(J,Qe),Ie}for(De=c(De);!st.done;Qe++,st=ie.next())st=ue(De,J,Qe,st.value,ye),st!==null&&(r&&st.alternate!==null&&De.delete(st.key===null?Qe:st.key),$=y(st,$,Qe),it===null?Ie=st:it.sibling=st,it=st);return r&&De.forEach(function(KA){return s(J,KA)}),tt&&Ci(J,Qe),Ie}function _t(J,$,ie,ye){if(typeof ie=="object"&&ie!==null&&ie.type===R&&ie.key===null&&(ie=ie.props.children),typeof ie=="object"&&ie!==null){switch(ie.$$typeof){case w:e:{for(var Ie=ie.key;$!==null;){if($.key===Ie){if(Ie=ie.type,Ie===R){if($.tag===7){o(J,$.sibling),ye=p($,ie.props.children),ye.return=J,J=ye;break e}}else if($.elementType===Ie||typeof Ie=="object"&&Ie!==null&&Ie.$$typeof===I&&Aa(Ie)===$.type){o(J,$.sibling),ye=p($,ie.props),sc(ye,ie),ye.return=J,J=ye;break e}o(J,$);break}else s(J,$);$=$.sibling}ie.type===R?(ye=xa(ie.props.children,J.mode,ye,ie.key),ye.return=J,J=ye):(ye=Zu(ie.type,ie.key,ie.props,null,J.mode,ye),sc(ye,ie),ye.return=J,J=ye)}return E(J);case C:e:{for(Ie=ie.key;$!==null;){if($.key===Ie)if($.tag===4&&$.stateNode.containerInfo===ie.containerInfo&&$.stateNode.implementation===ie.implementation){o(J,$.sibling),ye=p($,ie.children||[]),ye.return=J,J=ye;break e}else{o(J,$);break}else s(J,$);$=$.sibling}ye=kf(ie,J.mode,ye),ye.return=J,J=ye}return E(J);case I:return ie=Aa(ie),_t(J,$,ie,ye)}if(U(ie))return Ce(J,$,ie,ye);if(j(ie)){if(Ie=j(ie),typeof Ie!="function")throw Error(i(150));return ie=Ie.call(ie),Me(J,$,ie,ye)}if(typeof ie.then=="function")return _t(J,$,ad(ie),ye);if(ie.$$typeof===F)return _t(J,$,nd(J,ie),ye);od(J,ie)}return typeof ie=="string"&&ie!==""||typeof ie=="number"||typeof ie=="bigint"?(ie=""+ie,$!==null&&$.tag===6?(o(J,$.sibling),ye=p($,ie),ye.return=J,J=ye):(o(J,$),ye=Mf(ie,J.mode,ye),ye.return=J,J=ye),E(J)):o(J,$)}return function(J,$,ie,ye){try{ic=0;var Ie=_t(J,$,ie,ye);return So=null,Ie}catch(De){if(De===Eo||De===id)throw De;var it=Wn(29,De,null,J.mode);return it.lanes=ye,it.return=J,it}}}var Ra=S_(!0),w_=S_(!1),ps=!1;function Qf(r){r.updateQueue={baseState:r.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,lanes:0,hiddenCallbacks:null},callbacks:null}}function $f(r,s){r=r.updateQueue,s.updateQueue===r&&(s.updateQueue={baseState:r.baseState,firstBaseUpdate:r.firstBaseUpdate,lastBaseUpdate:r.lastBaseUpdate,shared:r.shared,callbacks:null})}function gs(r){return{lane:r,tag:0,payload:null,callback:null,next:null}}function ys(r,s,o){var c=r.updateQueue;if(c===null)return null;if(c=c.shared,(lt&2)!==0){var p=c.pending;return p===null?s.next=s:(s.next=p.next,p.next=s),c.pending=s,s=Ju(r),o_(r,null,o),s}return Xu(r,c,s,o),Ju(r)}function ac(r,s,o){if(s=s.updateQueue,s!==null&&(s=s.shared,(o&4194048)!==0)){var c=s.lanes;c&=r.pendingLanes,o|=c,s.lanes=o,Ml(r,o)}}function Kf(r,s){var o=r.updateQueue,c=r.alternate;if(c!==null&&(c=c.updateQueue,o===c)){var p=null,y=null;if(o=o.firstBaseUpdate,o!==null){do{var E={lane:o.lane,tag:o.tag,payload:o.payload,callback:null,next:null};y===null?p=y=E:y=y.next=E,o=o.next}while(o!==null);y===null?p=y=s:y=y.next=s}else p=y=s;o={baseState:c.baseState,firstBaseUpdate:p,lastBaseUpdate:y,shared:c.shared,callbacks:c.callbacks},r.updateQueue=o;return}r=o.lastBaseUpdate,r===null?o.firstBaseUpdate=s:r.next=s,o.lastBaseUpdate=s}var Wf=!1;function oc(){if(Wf){var r=xo;if(r!==null)throw r}}function lc(r,s,o,c){Wf=!1;var p=r.updateQueue;ps=!1;var y=p.firstBaseUpdate,E=p.lastBaseUpdate,M=p.shared.pending;if(M!==null){p.shared.pending=null;var G=M,se=G.next;G.next=null,E===null?y=se:E.next=se,E=G;var pe=r.alternate;pe!==null&&(pe=pe.updateQueue,M=pe.lastBaseUpdate,M!==E&&(M===null?pe.firstBaseUpdate=se:M.next=se,pe.lastBaseUpdate=G))}if(y!==null){var _e=p.baseState;E=0,pe=se=G=null,M=y;do{var oe=M.lane&-536870913,ue=oe!==M.lane;if(ue?(Ye&oe)===oe:(c&oe)===oe){oe!==0&&oe===bo&&(Wf=!0),pe!==null&&(pe=pe.next={lane:0,tag:M.tag,payload:M.payload,callback:null,next:null});e:{var Ce=r,Me=M;oe=s;var _t=o;switch(Me.tag){case 1:if(Ce=Me.payload,typeof Ce=="function"){_e=Ce.call(_t,_e,oe);break e}_e=Ce;break e;case 3:Ce.flags=Ce.flags&-65537|128;case 0:if(Ce=Me.payload,oe=typeof Ce=="function"?Ce.call(_t,_e,oe):Ce,oe==null)break e;_e=v({},_e,oe);break e;case 2:ps=!0}}oe=M.callback,oe!==null&&(r.flags|=64,ue&&(r.flags|=8192),ue=p.callbacks,ue===null?p.callbacks=[oe]:ue.push(oe))}else ue={lane:oe,tag:M.tag,payload:M.payload,callback:M.callback,next:null},pe===null?(se=pe=ue,G=_e):pe=pe.next=ue,E|=oe;if(M=M.next,M===null){if(M=p.shared.pending,M===null)break;ue=M,M=ue.next,ue.next=null,p.lastBaseUpdate=ue,p.shared.pending=null}}while(!0);pe===null&&(G=_e),p.baseState=G,p.firstBaseUpdate=se,p.lastBaseUpdate=pe,y===null&&(p.shared.lanes=0),Es|=E,r.lanes=E,r.memoizedState=_e}}function T_(r,s){if(typeof r!="function")throw Error(i(191,r));r.call(s)}function A_(r,s){var o=r.callbacks;if(o!==null)for(r.callbacks=null,r=0;r<o.length;r++)T_(o[r],s)}var wo=P(null),ld=P(0);function C_(r,s){r=Vi,Y(ld,r),Y(wo,s),Vi=r|s.baseLanes}function Yf(){Y(ld,Vi),Y(wo,wo.current)}function Xf(){Vi=ld.current,W(wo),W(ld)}var Yn=P(null),_r=null;function _s(r){var s=r.alternate;Y(zt,zt.current&1),Y(Yn,r),_r===null&&(s===null||wo.current!==null||s.memoizedState!==null)&&(_r=r)}function Jf(r){Y(zt,zt.current),Y(Yn,r),_r===null&&(_r=r)}function R_(r){r.tag===22?(Y(zt,zt.current),Y(Yn,r),_r===null&&(_r=r)):vs()}function vs(){Y(zt,zt.current),Y(Yn,Yn.current)}function Xn(r){W(Yn),_r===r&&(_r=null),W(zt)}var zt=P(0);function cd(r){for(var s=r;s!==null;){if(s.tag===13){var o=s.memoizedState;if(o!==null&&(o=o.dehydrated,o===null||ip(o)||sp(o)))return s}else if(s.tag===19&&(s.memoizedProps.revealOrder==="forwards"||s.memoizedProps.revealOrder==="backwards"||s.memoizedProps.revealOrder==="unstable_legacy-backwards"||s.memoizedProps.revealOrder==="together")){if((s.flags&128)!==0)return s}else if(s.child!==null){s.child.return=s,s=s.child;continue}if(s===r)break;for(;s.sibling===null;){if(s.return===null||s.return===r)return null;s=s.return}s.sibling.return=s.return,s=s.sibling}return null}var Ii=0,Ge=null,gt=null,Wt=null,ud=!1,To=!1,Da=!1,dd=0,cc=0,Ao=null,VT=0;function kt(){throw Error(i(321))}function Zf(r,s){if(s===null)return!1;for(var o=0;o<s.length&&o<r.length;o++)if(!Kn(r[o],s[o]))return!1;return!0}function em(r,s,o,c,p,y){return Ii=y,Ge=s,s.memoizedState=null,s.updateQueue=null,s.lanes=0,z.H=r===null||r.memoizedState===null?d0:pm,Da=!1,y=o(c,p),Da=!1,To&&(y=I_(s,o,c,p)),D_(r),y}function D_(r){z.H=hc;var s=gt!==null&&gt.next!==null;if(Ii=0,Wt=gt=Ge=null,ud=!1,cc=0,Ao=null,s)throw Error(i(300));r===null||Yt||(r=r.dependencies,r!==null&&td(r)&&(Yt=!0))}function I_(r,s,o,c){Ge=r;var p=0;do{if(To&&(Ao=null),cc=0,To=!1,25<=p)throw Error(i(301));if(p+=1,Wt=gt=null,r.updateQueue!=null){var y=r.updateQueue;y.lastEffect=null,y.events=null,y.stores=null,y.memoCache!=null&&(y.memoCache.index=0)}z.H=h0,y=s(o,c)}while(To);return y}function zT(){var r=z.H,s=r.useState()[0];return s=typeof s.then=="function"?uc(s):s,r=r.useState()[0],(gt!==null?gt.memoizedState:null)!==r&&(Ge.flags|=1024),s}function tm(){var r=dd!==0;return dd=0,r}function nm(r,s,o){s.updateQueue=r.updateQueue,s.flags&=-2053,r.lanes&=~o}function rm(r){if(ud){for(r=r.memoizedState;r!==null;){var s=r.queue;s!==null&&(s.pending=null),r=r.next}ud=!1}Ii=0,Wt=gt=Ge=null,To=!1,cc=dd=0,Ao=null}function On(){var r={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return Wt===null?Ge.memoizedState=Wt=r:Wt=Wt.next=r,Wt}function Ut(){if(gt===null){var r=Ge.alternate;r=r!==null?r.memoizedState:null}else r=gt.next;var s=Wt===null?Ge.memoizedState:Wt.next;if(s!==null)Wt=s,gt=r;else{if(r===null)throw Ge.alternate===null?Error(i(467)):Error(i(310));gt=r,r={memoizedState:gt.memoizedState,baseState:gt.baseState,baseQueue:gt.baseQueue,queue:gt.queue,next:null},Wt===null?Ge.memoizedState=Wt=r:Wt=Wt.next=r}return Wt}function hd(){return{lastEffect:null,events:null,stores:null,memoCache:null}}function uc(r){var s=cc;return cc+=1,Ao===null&&(Ao=[]),r=b_(Ao,r,s),s=Ge,(Wt===null?s.memoizedState:Wt.next)===null&&(s=s.alternate,z.H=s===null||s.memoizedState===null?d0:pm),r}function fd(r){if(r!==null&&typeof r=="object"){if(typeof r.then=="function")return uc(r);if(r.$$typeof===F)return vn(r)}throw Error(i(438,String(r)))}function im(r){var s=null,o=Ge.updateQueue;if(o!==null&&(s=o.memoCache),s==null){var c=Ge.alternate;c!==null&&(c=c.updateQueue,c!==null&&(c=c.memoCache,c!=null&&(s={data:c.data.map(function(p){return p.slice()}),index:0})))}if(s==null&&(s={data:[],index:0}),o===null&&(o=hd(),Ge.updateQueue=o),o.memoCache=s,o=s.data[s.index],o===void 0)for(o=s.data[s.index]=Array(r),c=0;c<r;c++)o[c]=k;return s.index++,o}function ji(r,s){return typeof s=="function"?s(r):s}function md(r){var s=Ut();return sm(s,gt,r)}function sm(r,s,o){var c=r.queue;if(c===null)throw Error(i(311));c.lastRenderedReducer=o;var p=r.baseQueue,y=c.pending;if(y!==null){if(p!==null){var E=p.next;p.next=y.next,y.next=E}s.baseQueue=p=y,c.pending=null}if(y=r.baseState,p===null)r.memoizedState=y;else{s=p.next;var M=E=null,G=null,se=s,pe=!1;do{var _e=se.lane&-536870913;if(_e!==se.lane?(Ye&_e)===_e:(Ii&_e)===_e){var oe=se.revertLane;if(oe===0)G!==null&&(G=G.next={lane:0,revertLane:0,gesture:null,action:se.action,hasEagerState:se.hasEagerState,eagerState:se.eagerState,next:null}),_e===bo&&(pe=!0);else if((Ii&oe)===oe){se=se.next,oe===bo&&(pe=!0);continue}else _e={lane:0,revertLane:se.revertLane,gesture:null,action:se.action,hasEagerState:se.hasEagerState,eagerState:se.eagerState,next:null},G===null?(M=G=_e,E=y):G=G.next=_e,Ge.lanes|=oe,Es|=oe;_e=se.action,Da&&o(y,_e),y=se.hasEagerState?se.eagerState:o(y,_e)}else oe={lane:_e,revertLane:se.revertLane,gesture:se.gesture,action:se.action,hasEagerState:se.hasEagerState,eagerState:se.eagerState,next:null},G===null?(M=G=oe,E=y):G=G.next=oe,Ge.lanes|=_e,Es|=_e;se=se.next}while(se!==null&&se!==s);if(G===null?E=y:G.next=M,!Kn(y,r.memoizedState)&&(Yt=!0,pe&&(o=xo,o!==null)))throw o;r.memoizedState=y,r.baseState=E,r.baseQueue=G,c.lastRenderedState=y}return p===null&&(c.lanes=0),[r.memoizedState,c.dispatch]}function am(r){var s=Ut(),o=s.queue;if(o===null)throw Error(i(311));o.lastRenderedReducer=r;var c=o.dispatch,p=o.pending,y=s.memoizedState;if(p!==null){o.pending=null;var E=p=p.next;do y=r(y,E.action),E=E.next;while(E!==p);Kn(y,s.memoizedState)||(Yt=!0),s.memoizedState=y,s.baseQueue===null&&(s.baseState=y),o.lastRenderedState=y}return[y,c]}function j_(r,s,o){var c=Ge,p=Ut(),y=tt;if(y){if(o===void 0)throw Error(i(407));o=o()}else o=s();var E=!Kn((gt||p).memoizedState,o);if(E&&(p.memoizedState=o,Yt=!0),p=p.queue,cm(k_.bind(null,c,p,r),[r]),p.getSnapshot!==s||E||Wt!==null&&Wt.memoizedState.tag&1){if(c.flags|=2048,Co(9,{destroy:void 0},M_.bind(null,c,p,o,s),null),bt===null)throw Error(i(349));y||(Ii&127)!==0||O_(c,s,o)}return o}function O_(r,s,o){r.flags|=16384,r={getSnapshot:s,value:o},s=Ge.updateQueue,s===null?(s=hd(),Ge.updateQueue=s,s.stores=[r]):(o=s.stores,o===null?s.stores=[r]:o.push(r))}function M_(r,s,o,c){s.value=o,s.getSnapshot=c,N_(s)&&P_(r)}function k_(r,s,o){return o(function(){N_(s)&&P_(r)})}function N_(r){var s=r.getSnapshot;r=r.value;try{var o=s();return!Kn(r,o)}catch{return!0}}function P_(r){var s=ba(r,2);s!==null&&Bn(s,r,2)}function om(r){var s=On();if(typeof r=="function"){var o=r;if(r=o(),Da){lr(!0);try{o()}finally{lr(!1)}}}return s.memoizedState=s.baseState=r,s.queue={pending:null,lanes:0,dispatch:null,lastRenderedReducer:ji,lastRenderedState:r},s}function L_(r,s,o,c){return r.baseState=o,sm(r,gt,typeof c=="function"?c:ji)}function UT(r,s,o,c,p){if(yd(r))throw Error(i(485));if(r=s.action,r!==null){var y={payload:p,action:r,next:null,isTransition:!0,status:"pending",value:null,reason:null,listeners:[],then:function(E){y.listeners.push(E)}};z.T!==null?o(!0):y.isTransition=!1,c(y),o=s.pending,o===null?(y.next=s.pending=y,V_(s,y)):(y.next=o.next,s.pending=o.next=y)}}function V_(r,s){var o=s.action,c=s.payload,p=r.state;if(s.isTransition){var y=z.T,E={};z.T=E;try{var M=o(p,c),G=z.S;G!==null&&G(E,M),z_(r,s,M)}catch(se){lm(r,s,se)}finally{y!==null&&E.types!==null&&(y.types=E.types),z.T=y}}else try{y=o(p,c),z_(r,s,y)}catch(se){lm(r,s,se)}}function z_(r,s,o){o!==null&&typeof o=="object"&&typeof o.then=="function"?o.then(function(c){U_(r,s,c)},function(c){return lm(r,s,c)}):U_(r,s,o)}function U_(r,s,o){s.status="fulfilled",s.value=o,B_(s),r.state=o,s=r.pending,s!==null&&(o=s.next,o===s?r.pending=null:(o=o.next,s.next=o,V_(r,o)))}function lm(r,s,o){var c=r.pending;if(r.pending=null,c!==null){c=c.next;do s.status="rejected",s.reason=o,B_(s),s=s.next;while(s!==c)}r.action=null}function B_(r){r=r.listeners;for(var s=0;s<r.length;s++)(0,r[s])()}function F_(r,s){return s}function q_(r,s){if(tt){var o=bt.formState;if(o!==null){e:{var c=Ge;if(tt){if(St){t:{for(var p=St,y=yr;p.nodeType!==8;){if(!y){p=null;break t}if(p=vr(p.nextSibling),p===null){p=null;break t}}y=p.data,p=y==="F!"||y==="F"?p:null}if(p){St=vr(p.nextSibling),c=p.data==="F!";break e}}fs(c)}c=!1}c&&(s=o[0])}}return o=On(),o.memoizedState=o.baseState=s,c={pending:null,lanes:0,dispatch:null,lastRenderedReducer:F_,lastRenderedState:s},o.queue=c,o=l0.bind(null,Ge,c),c.dispatch=o,c=om(!1),y=mm.bind(null,Ge,!1,c.queue),c=On(),p={state:s,dispatch:null,action:r,pending:null},c.queue=p,o=UT.bind(null,Ge,p,y,o),p.dispatch=o,c.memoizedState=r,[s,o,!1]}function G_(r){var s=Ut();return H_(s,gt,r)}function H_(r,s,o){if(s=sm(r,s,F_)[0],r=md(ji)[0],typeof s=="object"&&s!==null&&typeof s.then=="function")try{var c=uc(s)}catch(E){throw E===Eo?id:E}else c=s;s=Ut();var p=s.queue,y=p.dispatch;return o!==s.memoizedState&&(Ge.flags|=2048,Co(9,{destroy:void 0},BT.bind(null,p,o),null)),[c,y,r]}function BT(r,s){r.action=s}function Q_(r){var s=Ut(),o=gt;if(o!==null)return H_(s,o,r);Ut(),s=s.memoizedState,o=Ut();var c=o.queue.dispatch;return o.memoizedState=r,[s,c,!1]}function Co(r,s,o,c){return r={tag:r,create:o,deps:c,inst:s,next:null},s=Ge.updateQueue,s===null&&(s=hd(),Ge.updateQueue=s),o=s.lastEffect,o===null?s.lastEffect=r.next=r:(c=o.next,o.next=r,r.next=c,s.lastEffect=r),r}function $_(){return Ut().memoizedState}function pd(r,s,o,c){var p=On();Ge.flags|=r,p.memoizedState=Co(1|s,{destroy:void 0},o,c===void 0?null:c)}function gd(r,s,o,c){var p=Ut();c=c===void 0?null:c;var y=p.memoizedState.inst;gt!==null&&c!==null&&Zf(c,gt.memoizedState.deps)?p.memoizedState=Co(s,y,o,c):(Ge.flags|=r,p.memoizedState=Co(1|s,y,o,c))}function K_(r,s){pd(8390656,8,r,s)}function cm(r,s){gd(2048,8,r,s)}function FT(r){Ge.flags|=4;var s=Ge.updateQueue;if(s===null)s=hd(),Ge.updateQueue=s,s.events=[r];else{var o=s.events;o===null?s.events=[r]:o.push(r)}}function W_(r){var s=Ut().memoizedState;return FT({ref:s,nextImpl:r}),function(){if((lt&2)!==0)throw Error(i(440));return s.impl.apply(void 0,arguments)}}function Y_(r,s){return gd(4,2,r,s)}function X_(r,s){return gd(4,4,r,s)}function J_(r,s){if(typeof s=="function"){r=r();var o=s(r);return function(){typeof o=="function"?o():s(null)}}if(s!=null)return r=r(),s.current=r,function(){s.current=null}}function Z_(r,s,o){o=o!=null?o.concat([r]):null,gd(4,4,J_.bind(null,s,r),o)}function um(){}function e0(r,s){var o=Ut();s=s===void 0?null:s;var c=o.memoizedState;return s!==null&&Zf(s,c[1])?c[0]:(o.memoizedState=[r,s],r)}function t0(r,s){var o=Ut();s=s===void 0?null:s;var c=o.memoizedState;if(s!==null&&Zf(s,c[1]))return c[0];if(c=r(),Da){lr(!0);try{r()}finally{lr(!1)}}return o.memoizedState=[c,s],c}function dm(r,s,o){return o===void 0||(Ii&1073741824)!==0&&(Ye&261930)===0?r.memoizedState=s:(r.memoizedState=o,r=nv(),Ge.lanes|=r,Es|=r,o)}function n0(r,s,o,c){return Kn(o,s)?o:wo.current!==null?(r=dm(r,o,c),Kn(r,s)||(Yt=!0),r):(Ii&42)===0||(Ii&1073741824)!==0&&(Ye&261930)===0?(Yt=!0,r.memoizedState=o):(r=nv(),Ge.lanes|=r,Es|=r,s)}function r0(r,s,o,c,p){var y=q.p;q.p=y!==0&&8>y?y:8;var E=z.T,M={};z.T=M,mm(r,!1,s,o);try{var G=p(),se=z.S;if(se!==null&&se(M,G),G!==null&&typeof G=="object"&&typeof G.then=="function"){var pe=LT(G,c);dc(r,s,pe,er(r))}else dc(r,s,c,er(r))}catch(_e){dc(r,s,{then:function(){},status:"rejected",reason:_e},er())}finally{q.p=y,E!==null&&M.types!==null&&(E.types=M.types),z.T=E}}function qT(){}function hm(r,s,o,c){if(r.tag!==5)throw Error(i(476));var p=i0(r).queue;r0(r,p,s,K,o===null?qT:function(){return s0(r),o(c)})}function i0(r){var s=r.memoizedState;if(s!==null)return s;s={memoizedState:K,baseState:K,baseQueue:null,queue:{pending:null,lanes:0,dispatch:null,lastRenderedReducer:ji,lastRenderedState:K},next:null};var o={};return s.next={memoizedState:o,baseState:o,baseQueue:null,queue:{pending:null,lanes:0,dispatch:null,lastRenderedReducer:ji,lastRenderedState:o},next:null},r.memoizedState=s,r=r.alternate,r!==null&&(r.memoizedState=s),s}function s0(r){var s=i0(r);s.next===null&&(s=r.alternate.memoizedState),dc(r,s.next.queue,{},er())}function fm(){return vn(Rc)}function a0(){return Ut().memoizedState}function o0(){return Ut().memoizedState}function GT(r){for(var s=r.return;s!==null;){switch(s.tag){case 24:case 3:var o=er();r=gs(o);var c=ys(s,r,o);c!==null&&(Bn(c,s,o),ac(c,s,o)),s={cache:Ff()},r.payload=s;return}s=s.return}}function HT(r,s,o){var c=er();o={lane:c,revertLane:0,gesture:null,action:o,hasEagerState:!1,eagerState:null,next:null},yd(r)?c0(s,o):(o=jf(r,s,o,c),o!==null&&(Bn(o,r,c),u0(o,s,c)))}function l0(r,s,o){var c=er();dc(r,s,o,c)}function dc(r,s,o,c){var p={lane:c,revertLane:0,gesture:null,action:o,hasEagerState:!1,eagerState:null,next:null};if(yd(r))c0(s,p);else{var y=r.alternate;if(r.lanes===0&&(y===null||y.lanes===0)&&(y=s.lastRenderedReducer,y!==null))try{var E=s.lastRenderedState,M=y(E,o);if(p.hasEagerState=!0,p.eagerState=M,Kn(M,E))return Xu(r,s,p,0),bt===null&&Yu(),!1}catch{}if(o=jf(r,s,p,c),o!==null)return Bn(o,r,c),u0(o,s,c),!0}return!1}function mm(r,s,o,c){if(c={lane:2,revertLane:Qm(),gesture:null,action:c,hasEagerState:!1,eagerState:null,next:null},yd(r)){if(s)throw Error(i(479))}else s=jf(r,o,c,2),s!==null&&Bn(s,r,2)}function yd(r){var s=r.alternate;return r===Ge||s!==null&&s===Ge}function c0(r,s){To=ud=!0;var o=r.pending;o===null?s.next=s:(s.next=o.next,o.next=s),r.pending=s}function u0(r,s,o){if((o&4194048)!==0){var c=s.lanes;c&=r.pendingLanes,o|=c,s.lanes=o,Ml(r,o)}}var hc={readContext:vn,use:fd,useCallback:kt,useContext:kt,useEffect:kt,useImperativeHandle:kt,useLayoutEffect:kt,useInsertionEffect:kt,useMemo:kt,useReducer:kt,useRef:kt,useState:kt,useDebugValue:kt,useDeferredValue:kt,useTransition:kt,useSyncExternalStore:kt,useId:kt,useHostTransitionStatus:kt,useFormState:kt,useActionState:kt,useOptimistic:kt,useMemoCache:kt,useCacheRefresh:kt};hc.useEffectEvent=kt;var d0={readContext:vn,use:fd,useCallback:function(r,s){return On().memoizedState=[r,s===void 0?null:s],r},useContext:vn,useEffect:K_,useImperativeHandle:function(r,s,o){o=o!=null?o.concat([r]):null,pd(4194308,4,J_.bind(null,s,r),o)},useLayoutEffect:function(r,s){return pd(4194308,4,r,s)},useInsertionEffect:function(r,s){pd(4,2,r,s)},useMemo:function(r,s){var o=On();s=s===void 0?null:s;var c=r();if(Da){lr(!0);try{r()}finally{lr(!1)}}return o.memoizedState=[c,s],c},useReducer:function(r,s,o){var c=On();if(o!==void 0){var p=o(s);if(Da){lr(!0);try{o(s)}finally{lr(!1)}}}else p=s;return c.memoizedState=c.baseState=p,r={pending:null,lanes:0,dispatch:null,lastRenderedReducer:r,lastRenderedState:p},c.queue=r,r=r.dispatch=HT.bind(null,Ge,r),[c.memoizedState,r]},useRef:function(r){var s=On();return r={current:r},s.memoizedState=r},useState:function(r){r=om(r);var s=r.queue,o=l0.bind(null,Ge,s);return s.dispatch=o,[r.memoizedState,o]},useDebugValue:um,useDeferredValue:function(r,s){var o=On();return dm(o,r,s)},useTransition:function(){var r=om(!1);return r=r0.bind(null,Ge,r.queue,!0,!1),On().memoizedState=r,[!1,r]},useSyncExternalStore:function(r,s,o){var c=Ge,p=On();if(tt){if(o===void 0)throw Error(i(407));o=o()}else{if(o=s(),bt===null)throw Error(i(349));(Ye&127)!==0||O_(c,s,o)}p.memoizedState=o;var y={value:o,getSnapshot:s};return p.queue=y,K_(k_.bind(null,c,y,r),[r]),c.flags|=2048,Co(9,{destroy:void 0},M_.bind(null,c,y,o,s),null),o},useId:function(){var r=On(),s=bt.identifierPrefix;if(tt){var o=li,c=oi;o=(c&~(1<<32-Lt(c)-1)).toString(32)+o,s="_"+s+"R_"+o,o=dd++,0<o&&(s+="H"+o.toString(32)),s+="_"}else o=VT++,s="_"+s+"r_"+o.toString(32)+"_";return r.memoizedState=s},useHostTransitionStatus:fm,useFormState:q_,useActionState:q_,useOptimistic:function(r){var s=On();s.memoizedState=s.baseState=r;var o={pending:null,lanes:0,dispatch:null,lastRenderedReducer:null,lastRenderedState:null};return s.queue=o,s=mm.bind(null,Ge,!0,o),o.dispatch=s,[r,s]},useMemoCache:im,useCacheRefresh:function(){return On().memoizedState=GT.bind(null,Ge)},useEffectEvent:function(r){var s=On(),o={impl:r};return s.memoizedState=o,function(){if((lt&2)!==0)throw Error(i(440));return o.impl.apply(void 0,arguments)}}},pm={readContext:vn,use:fd,useCallback:e0,useContext:vn,useEffect:cm,useImperativeHandle:Z_,useInsertionEffect:Y_,useLayoutEffect:X_,useMemo:t0,useReducer:md,useRef:$_,useState:function(){return md(ji)},useDebugValue:um,useDeferredValue:function(r,s){var o=Ut();return n0(o,gt.memoizedState,r,s)},useTransition:function(){var r=md(ji)[0],s=Ut().memoizedState;return[typeof r=="boolean"?r:uc(r),s]},useSyncExternalStore:j_,useId:a0,useHostTransitionStatus:fm,useFormState:G_,useActionState:G_,useOptimistic:function(r,s){var o=Ut();return L_(o,gt,r,s)},useMemoCache:im,useCacheRefresh:o0};pm.useEffectEvent=W_;var h0={readContext:vn,use:fd,useCallback:e0,useContext:vn,useEffect:cm,useImperativeHandle:Z_,useInsertionEffect:Y_,useLayoutEffect:X_,useMemo:t0,useReducer:am,useRef:$_,useState:function(){return am(ji)},useDebugValue:um,useDeferredValue:function(r,s){var o=Ut();return gt===null?dm(o,r,s):n0(o,gt.memoizedState,r,s)},useTransition:function(){var r=am(ji)[0],s=Ut().memoizedState;return[typeof r=="boolean"?r:uc(r),s]},useSyncExternalStore:j_,useId:a0,useHostTransitionStatus:fm,useFormState:Q_,useActionState:Q_,useOptimistic:function(r,s){var o=Ut();return gt!==null?L_(o,gt,r,s):(o.baseState=r,[r,o.queue.dispatch])},useMemoCache:im,useCacheRefresh:o0};h0.useEffectEvent=W_;function gm(r,s,o,c){s=r.memoizedState,o=o(c,s),o=o==null?s:v({},s,o),r.memoizedState=o,r.lanes===0&&(r.updateQueue.baseState=o)}var ym={enqueueSetState:function(r,s,o){r=r._reactInternals;var c=er(),p=gs(c);p.payload=s,o!=null&&(p.callback=o),s=ys(r,p,c),s!==null&&(Bn(s,r,c),ac(s,r,c))},enqueueReplaceState:function(r,s,o){r=r._reactInternals;var c=er(),p=gs(c);p.tag=1,p.payload=s,o!=null&&(p.callback=o),s=ys(r,p,c),s!==null&&(Bn(s,r,c),ac(s,r,c))},enqueueForceUpdate:function(r,s){r=r._reactInternals;var o=er(),c=gs(o);c.tag=2,s!=null&&(c.callback=s),s=ys(r,c,o),s!==null&&(Bn(s,r,o),ac(s,r,o))}};function f0(r,s,o,c,p,y,E){return r=r.stateNode,typeof r.shouldComponentUpdate=="function"?r.shouldComponentUpdate(c,y,E):s.prototype&&s.prototype.isPureReactComponent?!Jl(o,c)||!Jl(p,y):!0}function m0(r,s,o,c){r=s.state,typeof s.componentWillReceiveProps=="function"&&s.componentWillReceiveProps(o,c),typeof s.UNSAFE_componentWillReceiveProps=="function"&&s.UNSAFE_componentWillReceiveProps(o,c),s.state!==r&&ym.enqueueReplaceState(s,s.state,null)}function Ia(r,s){var o=s;if("ref"in s){o={};for(var c in s)c!=="ref"&&(o[c]=s[c])}if(r=r.defaultProps){o===s&&(o=v({},o));for(var p in r)o[p]===void 0&&(o[p]=r[p])}return o}function p0(r){Wu(r)}function g0(r){console.error(r)}function y0(r){Wu(r)}function _d(r,s){try{var o=r.onUncaughtError;o(s.value,{componentStack:s.stack})}catch(c){setTimeout(function(){throw c})}}function _0(r,s,o){try{var c=r.onCaughtError;c(o.value,{componentStack:o.stack,errorBoundary:s.tag===1?s.stateNode:null})}catch(p){setTimeout(function(){throw p})}}function _m(r,s,o){return o=gs(o),o.tag=3,o.payload={element:null},o.callback=function(){_d(r,s)},o}function v0(r){return r=gs(r),r.tag=3,r}function b0(r,s,o,c){var p=o.type.getDerivedStateFromError;if(typeof p=="function"){var y=c.value;r.payload=function(){return p(y)},r.callback=function(){_0(s,o,c)}}var E=o.stateNode;E!==null&&typeof E.componentDidCatch=="function"&&(r.callback=function(){_0(s,o,c),typeof p!="function"&&(Ss===null?Ss=new Set([this]):Ss.add(this));var M=c.stack;this.componentDidCatch(c.value,{componentStack:M!==null?M:""})})}function QT(r,s,o,c,p){if(o.flags|=32768,c!==null&&typeof c=="object"&&typeof c.then=="function"){if(s=o.alternate,s!==null&&vo(s,o,p,!0),o=Yn.current,o!==null){switch(o.tag){case 31:case 13:return _r===null?Id():o.alternate===null&&Nt===0&&(Nt=3),o.flags&=-257,o.flags|=65536,o.lanes=p,c===sd?o.flags|=16384:(s=o.updateQueue,s===null?o.updateQueue=new Set([c]):s.add(c),qm(r,c,p)),!1;case 22:return o.flags|=65536,c===sd?o.flags|=16384:(s=o.updateQueue,s===null?(s={transitions:null,markerInstances:null,retryQueue:new Set([c])},o.updateQueue=s):(o=s.retryQueue,o===null?s.retryQueue=new Set([c]):o.add(c)),qm(r,c,p)),!1}throw Error(i(435,o.tag))}return qm(r,c,p),Id(),!1}if(tt)return s=Yn.current,s!==null?((s.flags&65536)===0&&(s.flags|=256),s.flags|=65536,s.lanes=p,c!==Lf&&(r=Error(i(422),{cause:c}),tc(mr(r,o)))):(c!==Lf&&(s=Error(i(423),{cause:c}),tc(mr(s,o))),r=r.current.alternate,r.flags|=65536,p&=-p,r.lanes|=p,c=mr(c,o),p=_m(r.stateNode,c,p),Kf(r,p),Nt!==4&&(Nt=2)),!1;var y=Error(i(520),{cause:c});if(y=mr(y,o),bc===null?bc=[y]:bc.push(y),Nt!==4&&(Nt=2),s===null)return!0;c=mr(c,o),o=s;do{switch(o.tag){case 3:return o.flags|=65536,r=p&-p,o.lanes|=r,r=_m(o.stateNode,c,r),Kf(o,r),!1;case 1:if(s=o.type,y=o.stateNode,(o.flags&128)===0&&(typeof s.getDerivedStateFromError=="function"||y!==null&&typeof y.componentDidCatch=="function"&&(Ss===null||!Ss.has(y))))return o.flags|=65536,p&=-p,o.lanes|=p,p=v0(p),b0(p,r,o,c),Kf(o,p),!1}o=o.return}while(o!==null);return!1}var vm=Error(i(461)),Yt=!1;function bn(r,s,o,c){s.child=r===null?w_(s,null,o,c):Ra(s,r.child,o,c)}function x0(r,s,o,c,p){o=o.render;var y=s.ref;if("ref"in c){var E={};for(var M in c)M!=="ref"&&(E[M]=c[M])}else E=c;return wa(s),c=em(r,s,o,E,y,p),M=tm(),r!==null&&!Yt?(nm(r,s,p),Oi(r,s,p)):(tt&&M&&Nf(s),s.flags|=1,bn(r,s,c,p),s.child)}function E0(r,s,o,c,p){if(r===null){var y=o.type;return typeof y=="function"&&!Of(y)&&y.defaultProps===void 0&&o.compare===null?(s.tag=15,s.type=y,S0(r,s,y,c,p)):(r=Zu(o.type,null,c,s,s.mode,p),r.ref=s.ref,r.return=s,s.child=r)}if(y=r.child,!Cm(r,p)){var E=y.memoizedProps;if(o=o.compare,o=o!==null?o:Jl,o(E,c)&&r.ref===s.ref)return Oi(r,s,p)}return s.flags|=1,r=Ai(y,c),r.ref=s.ref,r.return=s,s.child=r}function S0(r,s,o,c,p){if(r!==null){var y=r.memoizedProps;if(Jl(y,c)&&r.ref===s.ref)if(Yt=!1,s.pendingProps=c=y,Cm(r,p))(r.flags&131072)!==0&&(Yt=!0);else return s.lanes=r.lanes,Oi(r,s,p)}return bm(r,s,o,c,p)}function w0(r,s,o,c){var p=c.children,y=r!==null?r.memoizedState:null;if(r===null&&s.stateNode===null&&(s.stateNode={_visibility:1,_pendingMarkers:null,_retryCache:null,_transitions:null}),c.mode==="hidden"){if((s.flags&128)!==0){if(y=y!==null?y.baseLanes|o:o,r!==null){for(c=s.child=r.child,p=0;c!==null;)p=p|c.lanes|c.childLanes,c=c.sibling;c=p&~y}else c=0,s.child=null;return T0(r,s,y,o,c)}if((o&536870912)!==0)s.memoizedState={baseLanes:0,cachePool:null},r!==null&&rd(s,y!==null?y.cachePool:null),y!==null?C_(s,y):Yf(),R_(s);else return c=s.lanes=536870912,T0(r,s,y!==null?y.baseLanes|o:o,o,c)}else y!==null?(rd(s,y.cachePool),C_(s,y),vs(),s.memoizedState=null):(r!==null&&rd(s,null),Yf(),vs());return bn(r,s,p,o),s.child}function fc(r,s){return r!==null&&r.tag===22||s.stateNode!==null||(s.stateNode={_visibility:1,_pendingMarkers:null,_retryCache:null,_transitions:null}),s.sibling}function T0(r,s,o,c,p){var y=Gf();return y=y===null?null:{parent:Kt._currentValue,pool:y},s.memoizedState={baseLanes:o,cachePool:y},r!==null&&rd(s,null),Yf(),R_(s),r!==null&&vo(r,s,c,!0),s.childLanes=p,null}function vd(r,s){return s=xd({mode:s.mode,children:s.children},r.mode),s.ref=r.ref,r.child=s,s.return=r,s}function A0(r,s,o){return Ra(s,r.child,null,o),r=vd(s,s.pendingProps),r.flags|=2,Xn(s),s.memoizedState=null,r}function $T(r,s,o){var c=s.pendingProps,p=(s.flags&128)!==0;if(s.flags&=-129,r===null){if(tt){if(c.mode==="hidden")return r=vd(s,c),s.lanes=536870912,fc(null,r);if(Jf(s),(r=St)?(r=Vv(r,yr),r=r!==null&&r.data==="&"?r:null,r!==null&&(s.memoizedState={dehydrated:r,treeContext:ds!==null?{id:oi,overflow:li}:null,retryLane:536870912,hydrationErrors:null},o=c_(r),o.return=s,s.child=o,_n=s,St=null)):r=null,r===null)throw fs(s);return s.lanes=536870912,null}return vd(s,c)}var y=r.memoizedState;if(y!==null){var E=y.dehydrated;if(Jf(s),p)if(s.flags&256)s.flags&=-257,s=A0(r,s,o);else if(s.memoizedState!==null)s.child=r.child,s.flags|=128,s=null;else throw Error(i(558));else if(Yt||vo(r,s,o,!1),p=(o&r.childLanes)!==0,Yt||p){if(c=bt,c!==null&&(E=kl(c,o),E!==0&&E!==y.retryLane))throw y.retryLane=E,ba(r,E),Bn(c,r,E),vm;Id(),s=A0(r,s,o)}else r=y.treeContext,St=vr(E.nextSibling),_n=s,tt=!0,hs=null,yr=!1,r!==null&&h_(s,r),s=vd(s,c),s.flags|=4096;return s}return r=Ai(r.child,{mode:c.mode,children:c.children}),r.ref=s.ref,s.child=r,r.return=s,r}function bd(r,s){var o=s.ref;if(o===null)r!==null&&r.ref!==null&&(s.flags|=4194816);else{if(typeof o!="function"&&typeof o!="object")throw Error(i(284));(r===null||r.ref!==o)&&(s.flags|=4194816)}}function bm(r,s,o,c,p){return wa(s),o=em(r,s,o,c,void 0,p),c=tm(),r!==null&&!Yt?(nm(r,s,p),Oi(r,s,p)):(tt&&c&&Nf(s),s.flags|=1,bn(r,s,o,p),s.child)}function C0(r,s,o,c,p,y){return wa(s),s.updateQueue=null,o=I_(s,c,o,p),D_(r),c=tm(),r!==null&&!Yt?(nm(r,s,y),Oi(r,s,y)):(tt&&c&&Nf(s),s.flags|=1,bn(r,s,o,y),s.child)}function R0(r,s,o,c,p){if(wa(s),s.stateNode===null){var y=po,E=o.contextType;typeof E=="object"&&E!==null&&(y=vn(E)),y=new o(c,y),s.memoizedState=y.state!==null&&y.state!==void 0?y.state:null,y.updater=ym,s.stateNode=y,y._reactInternals=s,y=s.stateNode,y.props=c,y.state=s.memoizedState,y.refs={},Qf(s),E=o.contextType,y.context=typeof E=="object"&&E!==null?vn(E):po,y.state=s.memoizedState,E=o.getDerivedStateFromProps,typeof E=="function"&&(gm(s,o,E,c),y.state=s.memoizedState),typeof o.getDerivedStateFromProps=="function"||typeof y.getSnapshotBeforeUpdate=="function"||typeof y.UNSAFE_componentWillMount!="function"&&typeof y.componentWillMount!="function"||(E=y.state,typeof y.componentWillMount=="function"&&y.componentWillMount(),typeof y.UNSAFE_componentWillMount=="function"&&y.UNSAFE_componentWillMount(),E!==y.state&&ym.enqueueReplaceState(y,y.state,null),lc(s,c,y,p),oc(),y.state=s.memoizedState),typeof y.componentDidMount=="function"&&(s.flags|=4194308),c=!0}else if(r===null){y=s.stateNode;var M=s.memoizedProps,G=Ia(o,M);y.props=G;var se=y.context,pe=o.contextType;E=po,typeof pe=="object"&&pe!==null&&(E=vn(pe));var _e=o.getDerivedStateFromProps;pe=typeof _e=="function"||typeof y.getSnapshotBeforeUpdate=="function",M=s.pendingProps!==M,pe||typeof y.UNSAFE_componentWillReceiveProps!="function"&&typeof y.componentWillReceiveProps!="function"||(M||se!==E)&&m0(s,y,c,E),ps=!1;var oe=s.memoizedState;y.state=oe,lc(s,c,y,p),oc(),se=s.memoizedState,M||oe!==se||ps?(typeof _e=="function"&&(gm(s,o,_e,c),se=s.memoizedState),(G=ps||f0(s,o,G,c,oe,se,E))?(pe||typeof y.UNSAFE_componentWillMount!="function"&&typeof y.componentWillMount!="function"||(typeof y.componentWillMount=="function"&&y.componentWillMount(),typeof y.UNSAFE_componentWillMount=="function"&&y.UNSAFE_componentWillMount()),typeof y.componentDidMount=="function"&&(s.flags|=4194308)):(typeof y.componentDidMount=="function"&&(s.flags|=4194308),s.memoizedProps=c,s.memoizedState=se),y.props=c,y.state=se,y.context=E,c=G):(typeof y.componentDidMount=="function"&&(s.flags|=4194308),c=!1)}else{y=s.stateNode,$f(r,s),E=s.memoizedProps,pe=Ia(o,E),y.props=pe,_e=s.pendingProps,oe=y.context,se=o.contextType,G=po,typeof se=="object"&&se!==null&&(G=vn(se)),M=o.getDerivedStateFromProps,(se=typeof M=="function"||typeof y.getSnapshotBeforeUpdate=="function")||typeof y.UNSAFE_componentWillReceiveProps!="function"&&typeof y.componentWillReceiveProps!="function"||(E!==_e||oe!==G)&&m0(s,y,c,G),ps=!1,oe=s.memoizedState,y.state=oe,lc(s,c,y,p),oc();var ue=s.memoizedState;E!==_e||oe!==ue||ps||r!==null&&r.dependencies!==null&&td(r.dependencies)?(typeof M=="function"&&(gm(s,o,M,c),ue=s.memoizedState),(pe=ps||f0(s,o,pe,c,oe,ue,G)||r!==null&&r.dependencies!==null&&td(r.dependencies))?(se||typeof y.UNSAFE_componentWillUpdate!="function"&&typeof y.componentWillUpdate!="function"||(typeof y.componentWillUpdate=="function"&&y.componentWillUpdate(c,ue,G),typeof y.UNSAFE_componentWillUpdate=="function"&&y.UNSAFE_componentWillUpdate(c,ue,G)),typeof y.componentDidUpdate=="function"&&(s.flags|=4),typeof y.getSnapshotBeforeUpdate=="function"&&(s.flags|=1024)):(typeof y.componentDidUpdate!="function"||E===r.memoizedProps&&oe===r.memoizedState||(s.flags|=4),typeof y.getSnapshotBeforeUpdate!="function"||E===r.memoizedProps&&oe===r.memoizedState||(s.flags|=1024),s.memoizedProps=c,s.memoizedState=ue),y.props=c,y.state=ue,y.context=G,c=pe):(typeof y.componentDidUpdate!="function"||E===r.memoizedProps&&oe===r.memoizedState||(s.flags|=4),typeof y.getSnapshotBeforeUpdate!="function"||E===r.memoizedProps&&oe===r.memoizedState||(s.flags|=1024),c=!1)}return y=c,bd(r,s),c=(s.flags&128)!==0,y||c?(y=s.stateNode,o=c&&typeof o.getDerivedStateFromError!="function"?null:y.render(),s.flags|=1,r!==null&&c?(s.child=Ra(s,r.child,null,p),s.child=Ra(s,null,o,p)):bn(r,s,o,p),s.memoizedState=y.state,r=s.child):r=Oi(r,s,p),r}function D0(r,s,o,c){return Ea(),s.flags|=256,bn(r,s,o,c),s.child}var xm={dehydrated:null,treeContext:null,retryLane:0,hydrationErrors:null};function Em(r){return{baseLanes:r,cachePool:__()}}function Sm(r,s,o){return r=r!==null?r.childLanes&~o:0,s&&(r|=Zn),r}function I0(r,s,o){var c=s.pendingProps,p=!1,y=(s.flags&128)!==0,E;if((E=y)||(E=r!==null&&r.memoizedState===null?!1:(zt.current&2)!==0),E&&(p=!0,s.flags&=-129),E=(s.flags&32)!==0,s.flags&=-33,r===null){if(tt){if(p?_s(s):vs(),(r=St)?(r=Vv(r,yr),r=r!==null&&r.data!=="&"?r:null,r!==null&&(s.memoizedState={dehydrated:r,treeContext:ds!==null?{id:oi,overflow:li}:null,retryLane:536870912,hydrationErrors:null},o=c_(r),o.return=s,s.child=o,_n=s,St=null)):r=null,r===null)throw fs(s);return sp(r)?s.lanes=32:s.lanes=536870912,null}var M=c.children;return c=c.fallback,p?(vs(),p=s.mode,M=xd({mode:"hidden",children:M},p),c=xa(c,p,o,null),M.return=s,c.return=s,M.sibling=c,s.child=M,c=s.child,c.memoizedState=Em(o),c.childLanes=Sm(r,E,o),s.memoizedState=xm,fc(null,c)):(_s(s),wm(s,M))}var G=r.memoizedState;if(G!==null&&(M=G.dehydrated,M!==null)){if(y)s.flags&256?(_s(s),s.flags&=-257,s=Tm(r,s,o)):s.memoizedState!==null?(vs(),s.child=r.child,s.flags|=128,s=null):(vs(),M=c.fallback,p=s.mode,c=xd({mode:"visible",children:c.children},p),M=xa(M,p,o,null),M.flags|=2,c.return=s,M.return=s,c.sibling=M,s.child=c,Ra(s,r.child,null,o),c=s.child,c.memoizedState=Em(o),c.childLanes=Sm(r,E,o),s.memoizedState=xm,s=fc(null,c));else if(_s(s),sp(M)){if(E=M.nextSibling&&M.nextSibling.dataset,E)var se=E.dgst;E=se,c=Error(i(419)),c.stack="",c.digest=E,tc({value:c,source:null,stack:null}),s=Tm(r,s,o)}else if(Yt||vo(r,s,o,!1),E=(o&r.childLanes)!==0,Yt||E){if(E=bt,E!==null&&(c=kl(E,o),c!==0&&c!==G.retryLane))throw G.retryLane=c,ba(r,c),Bn(E,r,c),vm;ip(M)||Id(),s=Tm(r,s,o)}else ip(M)?(s.flags|=192,s.child=r.child,s=null):(r=G.treeContext,St=vr(M.nextSibling),_n=s,tt=!0,hs=null,yr=!1,r!==null&&h_(s,r),s=wm(s,c.children),s.flags|=4096);return s}return p?(vs(),M=c.fallback,p=s.mode,G=r.child,se=G.sibling,c=Ai(G,{mode:"hidden",children:c.children}),c.subtreeFlags=G.subtreeFlags&65011712,se!==null?M=Ai(se,M):(M=xa(M,p,o,null),M.flags|=2),M.return=s,c.return=s,c.sibling=M,s.child=c,fc(null,c),c=s.child,M=r.child.memoizedState,M===null?M=Em(o):(p=M.cachePool,p!==null?(G=Kt._currentValue,p=p.parent!==G?{parent:G,pool:G}:p):p=__(),M={baseLanes:M.baseLanes|o,cachePool:p}),c.memoizedState=M,c.childLanes=Sm(r,E,o),s.memoizedState=xm,fc(r.child,c)):(_s(s),o=r.child,r=o.sibling,o=Ai(o,{mode:"visible",children:c.children}),o.return=s,o.sibling=null,r!==null&&(E=s.deletions,E===null?(s.deletions=[r],s.flags|=16):E.push(r)),s.child=o,s.memoizedState=null,o)}function wm(r,s){return s=xd({mode:"visible",children:s},r.mode),s.return=r,r.child=s}function xd(r,s){return r=Wn(22,r,null,s),r.lanes=0,r}function Tm(r,s,o){return Ra(s,r.child,null,o),r=wm(s,s.pendingProps.children),r.flags|=2,s.memoizedState=null,r}function j0(r,s,o){r.lanes|=s;var c=r.alternate;c!==null&&(c.lanes|=s),Uf(r.return,s,o)}function Am(r,s,o,c,p,y){var E=r.memoizedState;E===null?r.memoizedState={isBackwards:s,rendering:null,renderingStartTime:0,last:c,tail:o,tailMode:p,treeForkCount:y}:(E.isBackwards=s,E.rendering=null,E.renderingStartTime=0,E.last=c,E.tail=o,E.tailMode=p,E.treeForkCount=y)}function O0(r,s,o){var c=s.pendingProps,p=c.revealOrder,y=c.tail;c=c.children;var E=zt.current,M=(E&2)!==0;if(M?(E=E&1|2,s.flags|=128):E&=1,Y(zt,E),bn(r,s,c,o),c=tt?ec:0,!M&&r!==null&&(r.flags&128)!==0)e:for(r=s.child;r!==null;){if(r.tag===13)r.memoizedState!==null&&j0(r,o,s);else if(r.tag===19)j0(r,o,s);else if(r.child!==null){r.child.return=r,r=r.child;continue}if(r===s)break e;for(;r.sibling===null;){if(r.return===null||r.return===s)break e;r=r.return}r.sibling.return=r.return,r=r.sibling}switch(p){case"forwards":for(o=s.child,p=null;o!==null;)r=o.alternate,r!==null&&cd(r)===null&&(p=o),o=o.sibling;o=p,o===null?(p=s.child,s.child=null):(p=o.sibling,o.sibling=null),Am(s,!1,p,o,y,c);break;case"backwards":case"unstable_legacy-backwards":for(o=null,p=s.child,s.child=null;p!==null;){if(r=p.alternate,r!==null&&cd(r)===null){s.child=p;break}r=p.sibling,p.sibling=o,o=p,p=r}Am(s,!0,o,null,y,c);break;case"together":Am(s,!1,null,null,void 0,c);break;default:s.memoizedState=null}return s.child}function Oi(r,s,o){if(r!==null&&(s.dependencies=r.dependencies),Es|=s.lanes,(o&s.childLanes)===0)if(r!==null){if(vo(r,s,o,!1),(o&s.childLanes)===0)return null}else return null;if(r!==null&&s.child!==r.child)throw Error(i(153));if(s.child!==null){for(r=s.child,o=Ai(r,r.pendingProps),s.child=o,o.return=s;r.sibling!==null;)r=r.sibling,o=o.sibling=Ai(r,r.pendingProps),o.return=s;o.sibling=null}return s.child}function Cm(r,s){return(r.lanes&s)!==0?!0:(r=r.dependencies,!!(r!==null&&td(r)))}function KT(r,s,o){switch(s.tag){case 3:ge(s,s.stateNode.containerInfo),ms(s,Kt,r.memoizedState.cache),Ea();break;case 27:case 5:re(s);break;case 4:ge(s,s.stateNode.containerInfo);break;case 10:ms(s,s.type,s.memoizedProps.value);break;case 31:if(s.memoizedState!==null)return s.flags|=128,Jf(s),null;break;case 13:var c=s.memoizedState;if(c!==null)return c.dehydrated!==null?(_s(s),s.flags|=128,null):(o&s.child.childLanes)!==0?I0(r,s,o):(_s(s),r=Oi(r,s,o),r!==null?r.sibling:null);_s(s);break;case 19:var p=(r.flags&128)!==0;if(c=(o&s.childLanes)!==0,c||(vo(r,s,o,!1),c=(o&s.childLanes)!==0),p){if(c)return O0(r,s,o);s.flags|=128}if(p=s.memoizedState,p!==null&&(p.rendering=null,p.tail=null,p.lastEffect=null),Y(zt,zt.current),c)break;return null;case 22:return s.lanes=0,w0(r,s,o,s.pendingProps);case 24:ms(s,Kt,r.memoizedState.cache)}return Oi(r,s,o)}function M0(r,s,o){if(r!==null)if(r.memoizedProps!==s.pendingProps)Yt=!0;else{if(!Cm(r,o)&&(s.flags&128)===0)return Yt=!1,KT(r,s,o);Yt=(r.flags&131072)!==0}else Yt=!1,tt&&(s.flags&1048576)!==0&&d_(s,ec,s.index);switch(s.lanes=0,s.tag){case 16:e:{var c=s.pendingProps;if(r=Aa(s.elementType),s.type=r,typeof r=="function")Of(r)?(c=Ia(r,c),s.tag=1,s=R0(null,s,r,c,o)):(s.tag=0,s=bm(null,s,r,c,o));else{if(r!=null){var p=r.$$typeof;if(p===ae){s.tag=11,s=x0(null,s,r,c,o);break e}else if(p===L){s.tag=14,s=E0(null,s,r,c,o);break e}}throw s=Z(r)||r,Error(i(306,s,""))}}return s;case 0:return bm(r,s,s.type,s.pendingProps,o);case 1:return c=s.type,p=Ia(c,s.pendingProps),R0(r,s,c,p,o);case 3:e:{if(ge(s,s.stateNode.containerInfo),r===null)throw Error(i(387));c=s.pendingProps;var y=s.memoizedState;p=y.element,$f(r,s),lc(s,c,null,o);var E=s.memoizedState;if(c=E.cache,ms(s,Kt,c),c!==y.cache&&Bf(s,[Kt],o,!0),oc(),c=E.element,y.isDehydrated)if(y={element:c,isDehydrated:!1,cache:E.cache},s.updateQueue.baseState=y,s.memoizedState=y,s.flags&256){s=D0(r,s,c,o);break e}else if(c!==p){p=mr(Error(i(424)),s),tc(p),s=D0(r,s,c,o);break e}else for(r=s.stateNode.containerInfo,r.nodeType===9?r=r.body:r=r.nodeName==="HTML"?r.ownerDocument.body:r,St=vr(r.firstChild),_n=s,tt=!0,hs=null,yr=!0,o=w_(s,null,c,o),s.child=o;o;)o.flags=o.flags&-3|4096,o=o.sibling;else{if(Ea(),c===p){s=Oi(r,s,o);break e}bn(r,s,c,o)}s=s.child}return s;case 26:return bd(r,s),r===null?(o=Gv(s.type,null,s.pendingProps,null))?s.memoizedState=o:tt||(o=s.type,r=s.pendingProps,c=Ld(ce.current).createElement(o),c[Ht]=s,c[cn]=r,xn(c,o,r),Qt(c),s.stateNode=c):s.memoizedState=Gv(s.type,r.memoizedProps,s.pendingProps,r.memoizedState),null;case 27:return re(s),r===null&&tt&&(c=s.stateNode=Bv(s.type,s.pendingProps,ce.current),_n=s,yr=!0,p=St,Cs(s.type)?(ap=p,St=vr(c.firstChild)):St=p),bn(r,s,s.pendingProps.children,o),bd(r,s),r===null&&(s.flags|=4194304),s.child;case 5:return r===null&&tt&&((p=c=St)&&(c=wA(c,s.type,s.pendingProps,yr),c!==null?(s.stateNode=c,_n=s,St=vr(c.firstChild),yr=!1,p=!0):p=!1),p||fs(s)),re(s),p=s.type,y=s.pendingProps,E=r!==null?r.memoizedProps:null,c=y.children,tp(p,y)?c=null:E!==null&&tp(p,E)&&(s.flags|=32),s.memoizedState!==null&&(p=em(r,s,zT,null,null,o),Rc._currentValue=p),bd(r,s),bn(r,s,c,o),s.child;case 6:return r===null&&tt&&((r=o=St)&&(o=TA(o,s.pendingProps,yr),o!==null?(s.stateNode=o,_n=s,St=null,r=!0):r=!1),r||fs(s)),null;case 13:return I0(r,s,o);case 4:return ge(s,s.stateNode.containerInfo),c=s.pendingProps,r===null?s.child=Ra(s,null,c,o):bn(r,s,c,o),s.child;case 11:return x0(r,s,s.type,s.pendingProps,o);case 7:return bn(r,s,s.pendingProps,o),s.child;case 8:return bn(r,s,s.pendingProps.children,o),s.child;case 12:return bn(r,s,s.pendingProps.children,o),s.child;case 10:return c=s.pendingProps,ms(s,s.type,c.value),bn(r,s,c.children,o),s.child;case 9:return p=s.type._context,c=s.pendingProps.children,wa(s),p=vn(p),c=c(p),s.flags|=1,bn(r,s,c,o),s.child;case 14:return E0(r,s,s.type,s.pendingProps,o);case 15:return S0(r,s,s.type,s.pendingProps,o);case 19:return O0(r,s,o);case 31:return $T(r,s,o);case 22:return w0(r,s,o,s.pendingProps);case 24:return wa(s),c=vn(Kt),r===null?(p=Gf(),p===null&&(p=bt,y=Ff(),p.pooledCache=y,y.refCount++,y!==null&&(p.pooledCacheLanes|=o),p=y),s.memoizedState={parent:c,cache:p},Qf(s),ms(s,Kt,p)):((r.lanes&o)!==0&&($f(r,s),lc(s,null,null,o),oc()),p=r.memoizedState,y=s.memoizedState,p.parent!==c?(p={parent:c,cache:c},s.memoizedState=p,s.lanes===0&&(s.memoizedState=s.updateQueue.baseState=p),ms(s,Kt,c)):(c=y.cache,ms(s,Kt,c),c!==p.cache&&Bf(s,[Kt],o,!0))),bn(r,s,s.pendingProps.children,o),s.child;case 29:throw s.pendingProps}throw Error(i(156,s.tag))}function Mi(r){r.flags|=4}function Rm(r,s,o,c,p){if((s=(r.mode&32)!==0)&&(s=!1),s){if(r.flags|=16777216,(p&335544128)===p)if(r.stateNode.complete)r.flags|=8192;else if(av())r.flags|=8192;else throw Ca=sd,Hf}else r.flags&=-16777217}function k0(r,s){if(s.type!=="stylesheet"||(s.state.loading&4)!==0)r.flags&=-16777217;else if(r.flags|=16777216,!Wv(s))if(av())r.flags|=8192;else throw Ca=sd,Hf}function Ed(r,s){s!==null&&(r.flags|=4),r.flags&16384&&(s=r.tag!==22?Ru():536870912,r.lanes|=s,jo|=s)}function mc(r,s){if(!tt)switch(r.tailMode){case"hidden":s=r.tail;for(var o=null;s!==null;)s.alternate!==null&&(o=s),s=s.sibling;o===null?r.tail=null:o.sibling=null;break;case"collapsed":o=r.tail;for(var c=null;o!==null;)o.alternate!==null&&(c=o),o=o.sibling;c===null?s||r.tail===null?r.tail=null:r.tail.sibling=null:c.sibling=null}}function wt(r){var s=r.alternate!==null&&r.alternate.child===r.child,o=0,c=0;if(s)for(var p=r.child;p!==null;)o|=p.lanes|p.childLanes,c|=p.subtreeFlags&65011712,c|=p.flags&65011712,p.return=r,p=p.sibling;else for(p=r.child;p!==null;)o|=p.lanes|p.childLanes,c|=p.subtreeFlags,c|=p.flags,p.return=r,p=p.sibling;return r.subtreeFlags|=c,r.childLanes=o,s}function WT(r,s,o){var c=s.pendingProps;switch(Pf(s),s.tag){case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return wt(s),null;case 1:return wt(s),null;case 3:return o=s.stateNode,c=null,r!==null&&(c=r.memoizedState.cache),s.memoizedState.cache!==c&&(s.flags|=2048),Di(Kt),Ee(),o.pendingContext&&(o.context=o.pendingContext,o.pendingContext=null),(r===null||r.child===null)&&(_o(s)?Mi(s):r===null||r.memoizedState.isDehydrated&&(s.flags&256)===0||(s.flags|=1024,Vf())),wt(s),null;case 26:var p=s.type,y=s.memoizedState;return r===null?(Mi(s),y!==null?(wt(s),k0(s,y)):(wt(s),Rm(s,p,null,c,o))):y?y!==r.memoizedState?(Mi(s),wt(s),k0(s,y)):(wt(s),s.flags&=-16777217):(r=r.memoizedProps,r!==c&&Mi(s),wt(s),Rm(s,p,r,c,o)),null;case 27:if(ke(s),o=ce.current,p=s.type,r!==null&&s.stateNode!=null)r.memoizedProps!==c&&Mi(s);else{if(!c){if(s.stateNode===null)throw Error(i(166));return wt(s),null}r=Q.current,_o(s)?f_(s):(r=Bv(p,c,o),s.stateNode=r,Mi(s))}return wt(s),null;case 5:if(ke(s),p=s.type,r!==null&&s.stateNode!=null)r.memoizedProps!==c&&Mi(s);else{if(!c){if(s.stateNode===null)throw Error(i(166));return wt(s),null}if(y=Q.current,_o(s))f_(s);else{var E=Ld(ce.current);switch(y){case 1:y=E.createElementNS("http://www.w3.org/2000/svg",p);break;case 2:y=E.createElementNS("http://www.w3.org/1998/Math/MathML",p);break;default:switch(p){case"svg":y=E.createElementNS("http://www.w3.org/2000/svg",p);break;case"math":y=E.createElementNS("http://www.w3.org/1998/Math/MathML",p);break;case"script":y=E.createElement("div"),y.innerHTML="<script><\/script>",y=y.removeChild(y.firstChild);break;case"select":y=typeof c.is=="string"?E.createElement("select",{is:c.is}):E.createElement("select"),c.multiple?y.multiple=!0:c.size&&(y.size=c.size);break;default:y=typeof c.is=="string"?E.createElement(p,{is:c.is}):E.createElement(p)}}y[Ht]=s,y[cn]=c;e:for(E=s.child;E!==null;){if(E.tag===5||E.tag===6)y.appendChild(E.stateNode);else if(E.tag!==4&&E.tag!==27&&E.child!==null){E.child.return=E,E=E.child;continue}if(E===s)break e;for(;E.sibling===null;){if(E.return===null||E.return===s)break e;E=E.return}E.sibling.return=E.return,E=E.sibling}s.stateNode=y;e:switch(xn(y,p,c),p){case"button":case"input":case"select":case"textarea":c=!!c.autoFocus;break e;case"img":c=!0;break e;default:c=!1}c&&Mi(s)}}return wt(s),Rm(s,s.type,r===null?null:r.memoizedProps,s.pendingProps,o),null;case 6:if(r&&s.stateNode!=null)r.memoizedProps!==c&&Mi(s);else{if(typeof c!="string"&&s.stateNode===null)throw Error(i(166));if(r=ce.current,_o(s)){if(r=s.stateNode,o=s.memoizedProps,c=null,p=_n,p!==null)switch(p.tag){case 27:case 5:c=p.memoizedProps}r[Ht]=s,r=!!(r.nodeValue===o||c!==null&&c.suppressHydrationWarning===!0||Iv(r.nodeValue,o)),r||fs(s,!0)}else r=Ld(r).createTextNode(c),r[Ht]=s,s.stateNode=r}return wt(s),null;case 31:if(o=s.memoizedState,r===null||r.memoizedState!==null){if(c=_o(s),o!==null){if(r===null){if(!c)throw Error(i(318));if(r=s.memoizedState,r=r!==null?r.dehydrated:null,!r)throw Error(i(557));r[Ht]=s}else Ea(),(s.flags&128)===0&&(s.memoizedState=null),s.flags|=4;wt(s),r=!1}else o=Vf(),r!==null&&r.memoizedState!==null&&(r.memoizedState.hydrationErrors=o),r=!0;if(!r)return s.flags&256?(Xn(s),s):(Xn(s),null);if((s.flags&128)!==0)throw Error(i(558))}return wt(s),null;case 13:if(c=s.memoizedState,r===null||r.memoizedState!==null&&r.memoizedState.dehydrated!==null){if(p=_o(s),c!==null&&c.dehydrated!==null){if(r===null){if(!p)throw Error(i(318));if(p=s.memoizedState,p=p!==null?p.dehydrated:null,!p)throw Error(i(317));p[Ht]=s}else Ea(),(s.flags&128)===0&&(s.memoizedState=null),s.flags|=4;wt(s),p=!1}else p=Vf(),r!==null&&r.memoizedState!==null&&(r.memoizedState.hydrationErrors=p),p=!0;if(!p)return s.flags&256?(Xn(s),s):(Xn(s),null)}return Xn(s),(s.flags&128)!==0?(s.lanes=o,s):(o=c!==null,r=r!==null&&r.memoizedState!==null,o&&(c=s.child,p=null,c.alternate!==null&&c.alternate.memoizedState!==null&&c.alternate.memoizedState.cachePool!==null&&(p=c.alternate.memoizedState.cachePool.pool),y=null,c.memoizedState!==null&&c.memoizedState.cachePool!==null&&(y=c.memoizedState.cachePool.pool),y!==p&&(c.flags|=2048)),o!==r&&o&&(s.child.flags|=8192),Ed(s,s.updateQueue),wt(s),null);case 4:return Ee(),r===null&&Ym(s.stateNode.containerInfo),wt(s),null;case 10:return Di(s.type),wt(s),null;case 19:if(W(zt),c=s.memoizedState,c===null)return wt(s),null;if(p=(s.flags&128)!==0,y=c.rendering,y===null)if(p)mc(c,!1);else{if(Nt!==0||r!==null&&(r.flags&128)!==0)for(r=s.child;r!==null;){if(y=cd(r),y!==null){for(s.flags|=128,mc(c,!1),r=y.updateQueue,s.updateQueue=r,Ed(s,r),s.subtreeFlags=0,r=o,o=s.child;o!==null;)l_(o,r),o=o.sibling;return Y(zt,zt.current&1|2),tt&&Ci(s,c.treeForkCount),s.child}r=r.sibling}c.tail!==null&&$e()>Cd&&(s.flags|=128,p=!0,mc(c,!1),s.lanes=4194304)}else{if(!p)if(r=cd(y),r!==null){if(s.flags|=128,p=!0,r=r.updateQueue,s.updateQueue=r,Ed(s,r),mc(c,!0),c.tail===null&&c.tailMode==="hidden"&&!y.alternate&&!tt)return wt(s),null}else 2*$e()-c.renderingStartTime>Cd&&o!==536870912&&(s.flags|=128,p=!0,mc(c,!1),s.lanes=4194304);c.isBackwards?(y.sibling=s.child,s.child=y):(r=c.last,r!==null?r.sibling=y:s.child=y,c.last=y)}return c.tail!==null?(r=c.tail,c.rendering=r,c.tail=r.sibling,c.renderingStartTime=$e(),r.sibling=null,o=zt.current,Y(zt,p?o&1|2:o&1),tt&&Ci(s,c.treeForkCount),r):(wt(s),null);case 22:case 23:return Xn(s),Xf(),c=s.memoizedState!==null,r!==null?r.memoizedState!==null!==c&&(s.flags|=8192):c&&(s.flags|=8192),c?(o&536870912)!==0&&(s.flags&128)===0&&(wt(s),s.subtreeFlags&6&&(s.flags|=8192)):wt(s),o=s.updateQueue,o!==null&&Ed(s,o.retryQueue),o=null,r!==null&&r.memoizedState!==null&&r.memoizedState.cachePool!==null&&(o=r.memoizedState.cachePool.pool),c=null,s.memoizedState!==null&&s.memoizedState.cachePool!==null&&(c=s.memoizedState.cachePool.pool),c!==o&&(s.flags|=2048),r!==null&&W(Ta),null;case 24:return o=null,r!==null&&(o=r.memoizedState.cache),s.memoizedState.cache!==o&&(s.flags|=2048),Di(Kt),wt(s),null;case 25:return null;case 30:return null}throw Error(i(156,s.tag))}function YT(r,s){switch(Pf(s),s.tag){case 1:return r=s.flags,r&65536?(s.flags=r&-65537|128,s):null;case 3:return Di(Kt),Ee(),r=s.flags,(r&65536)!==0&&(r&128)===0?(s.flags=r&-65537|128,s):null;case 26:case 27:case 5:return ke(s),null;case 31:if(s.memoizedState!==null){if(Xn(s),s.alternate===null)throw Error(i(340));Ea()}return r=s.flags,r&65536?(s.flags=r&-65537|128,s):null;case 13:if(Xn(s),r=s.memoizedState,r!==null&&r.dehydrated!==null){if(s.alternate===null)throw Error(i(340));Ea()}return r=s.flags,r&65536?(s.flags=r&-65537|128,s):null;case 19:return W(zt),null;case 4:return Ee(),null;case 10:return Di(s.type),null;case 22:case 23:return Xn(s),Xf(),r!==null&&W(Ta),r=s.flags,r&65536?(s.flags=r&-65537|128,s):null;case 24:return Di(Kt),null;case 25:return null;default:return null}}function N0(r,s){switch(Pf(s),s.tag){case 3:Di(Kt),Ee();break;case 26:case 27:case 5:ke(s);break;case 4:Ee();break;case 31:s.memoizedState!==null&&Xn(s);break;case 13:Xn(s);break;case 19:W(zt);break;case 10:Di(s.type);break;case 22:case 23:Xn(s),Xf(),r!==null&&W(Ta);break;case 24:Di(Kt)}}function pc(r,s){try{var o=s.updateQueue,c=o!==null?o.lastEffect:null;if(c!==null){var p=c.next;o=p;do{if((o.tag&r)===r){c=void 0;var y=o.create,E=o.inst;c=y(),E.destroy=c}o=o.next}while(o!==p)}}catch(M){mt(s,s.return,M)}}function bs(r,s,o){try{var c=s.updateQueue,p=c!==null?c.lastEffect:null;if(p!==null){var y=p.next;c=y;do{if((c.tag&r)===r){var E=c.inst,M=E.destroy;if(M!==void 0){E.destroy=void 0,p=s;var G=o,se=M;try{se()}catch(pe){mt(p,G,pe)}}}c=c.next}while(c!==y)}}catch(pe){mt(s,s.return,pe)}}function P0(r){var s=r.updateQueue;if(s!==null){var o=r.stateNode;try{A_(s,o)}catch(c){mt(r,r.return,c)}}}function L0(r,s,o){o.props=Ia(r.type,r.memoizedProps),o.state=r.memoizedState;try{o.componentWillUnmount()}catch(c){mt(r,s,c)}}function gc(r,s){try{var o=r.ref;if(o!==null){switch(r.tag){case 26:case 27:case 5:var c=r.stateNode;break;case 30:c=r.stateNode;break;default:c=r.stateNode}typeof o=="function"?r.refCleanup=o(c):o.current=c}}catch(p){mt(r,s,p)}}function ci(r,s){var o=r.ref,c=r.refCleanup;if(o!==null)if(typeof c=="function")try{c()}catch(p){mt(r,s,p)}finally{r.refCleanup=null,r=r.alternate,r!=null&&(r.refCleanup=null)}else if(typeof o=="function")try{o(null)}catch(p){mt(r,s,p)}else o.current=null}function V0(r){var s=r.type,o=r.memoizedProps,c=r.stateNode;try{e:switch(s){case"button":case"input":case"select":case"textarea":o.autoFocus&&c.focus();break e;case"img":o.src?c.src=o.src:o.srcSet&&(c.srcset=o.srcSet)}}catch(p){mt(r,r.return,p)}}function Dm(r,s,o){try{var c=r.stateNode;_A(c,r.type,o,s),c[cn]=s}catch(p){mt(r,r.return,p)}}function z0(r){return r.tag===5||r.tag===3||r.tag===26||r.tag===27&&Cs(r.type)||r.tag===4}function Im(r){e:for(;;){for(;r.sibling===null;){if(r.return===null||z0(r.return))return null;r=r.return}for(r.sibling.return=r.return,r=r.sibling;r.tag!==5&&r.tag!==6&&r.tag!==18;){if(r.tag===27&&Cs(r.type)||r.flags&2||r.child===null||r.tag===4)continue e;r.child.return=r,r=r.child}if(!(r.flags&2))return r.stateNode}}function jm(r,s,o){var c=r.tag;if(c===5||c===6)r=r.stateNode,s?(o.nodeType===9?o.body:o.nodeName==="HTML"?o.ownerDocument.body:o).insertBefore(r,s):(s=o.nodeType===9?o.body:o.nodeName==="HTML"?o.ownerDocument.body:o,s.appendChild(r),o=o._reactRootContainer,o!=null||s.onclick!==null||(s.onclick=Dr));else if(c!==4&&(c===27&&Cs(r.type)&&(o=r.stateNode,s=null),r=r.child,r!==null))for(jm(r,s,o),r=r.sibling;r!==null;)jm(r,s,o),r=r.sibling}function Sd(r,s,o){var c=r.tag;if(c===5||c===6)r=r.stateNode,s?o.insertBefore(r,s):o.appendChild(r);else if(c!==4&&(c===27&&Cs(r.type)&&(o=r.stateNode),r=r.child,r!==null))for(Sd(r,s,o),r=r.sibling;r!==null;)Sd(r,s,o),r=r.sibling}function U0(r){var s=r.stateNode,o=r.memoizedProps;try{for(var c=r.type,p=s.attributes;p.length;)s.removeAttributeNode(p[0]);xn(s,c,o),s[Ht]=r,s[cn]=o}catch(y){mt(r,r.return,y)}}var ki=!1,Xt=!1,Om=!1,B0=typeof WeakSet=="function"?WeakSet:Set,dn=null;function XT(r,s){if(r=r.containerInfo,Zm=Gd,r=Zy(r),Tf(r)){if("selectionStart"in r)var o={start:r.selectionStart,end:r.selectionEnd};else e:{o=(o=r.ownerDocument)&&o.defaultView||window;var c=o.getSelection&&o.getSelection();if(c&&c.rangeCount!==0){o=c.anchorNode;var p=c.anchorOffset,y=c.focusNode;c=c.focusOffset;try{o.nodeType,y.nodeType}catch{o=null;break e}var E=0,M=-1,G=-1,se=0,pe=0,_e=r,oe=null;t:for(;;){for(var ue;_e!==o||p!==0&&_e.nodeType!==3||(M=E+p),_e!==y||c!==0&&_e.nodeType!==3||(G=E+c),_e.nodeType===3&&(E+=_e.nodeValue.length),(ue=_e.firstChild)!==null;)oe=_e,_e=ue;for(;;){if(_e===r)break t;if(oe===o&&++se===p&&(M=E),oe===y&&++pe===c&&(G=E),(ue=_e.nextSibling)!==null)break;_e=oe,oe=_e.parentNode}_e=ue}o=M===-1||G===-1?null:{start:M,end:G}}else o=null}o=o||{start:0,end:0}}else o=null;for(ep={focusedElem:r,selectionRange:o},Gd=!1,dn=s;dn!==null;)if(s=dn,r=s.child,(s.subtreeFlags&1028)!==0&&r!==null)r.return=s,dn=r;else for(;dn!==null;){switch(s=dn,y=s.alternate,r=s.flags,s.tag){case 0:if((r&4)!==0&&(r=s.updateQueue,r=r!==null?r.events:null,r!==null))for(o=0;o<r.length;o++)p=r[o],p.ref.impl=p.nextImpl;break;case 11:case 15:break;case 1:if((r&1024)!==0&&y!==null){r=void 0,o=s,p=y.memoizedProps,y=y.memoizedState,c=o.stateNode;try{var Ce=Ia(o.type,p);r=c.getSnapshotBeforeUpdate(Ce,y),c.__reactInternalSnapshotBeforeUpdate=r}catch(Me){mt(o,o.return,Me)}}break;case 3:if((r&1024)!==0){if(r=s.stateNode.containerInfo,o=r.nodeType,o===9)rp(r);else if(o===1)switch(r.nodeName){case"HEAD":case"HTML":case"BODY":rp(r);break;default:r.textContent=""}}break;case 5:case 26:case 27:case 6:case 4:case 17:break;default:if((r&1024)!==0)throw Error(i(163))}if(r=s.sibling,r!==null){r.return=s.return,dn=r;break}dn=s.return}}function F0(r,s,o){var c=o.flags;switch(o.tag){case 0:case 11:case 15:Pi(r,o),c&4&&pc(5,o);break;case 1:if(Pi(r,o),c&4)if(r=o.stateNode,s===null)try{r.componentDidMount()}catch(E){mt(o,o.return,E)}else{var p=Ia(o.type,s.memoizedProps);s=s.memoizedState;try{r.componentDidUpdate(p,s,r.__reactInternalSnapshotBeforeUpdate)}catch(E){mt(o,o.return,E)}}c&64&&P0(o),c&512&&gc(o,o.return);break;case 3:if(Pi(r,o),c&64&&(r=o.updateQueue,r!==null)){if(s=null,o.child!==null)switch(o.child.tag){case 27:case 5:s=o.child.stateNode;break;case 1:s=o.child.stateNode}try{A_(r,s)}catch(E){mt(o,o.return,E)}}break;case 27:s===null&&c&4&&U0(o);case 26:case 5:Pi(r,o),s===null&&c&4&&V0(o),c&512&&gc(o,o.return);break;case 12:Pi(r,o);break;case 31:Pi(r,o),c&4&&H0(r,o);break;case 13:Pi(r,o),c&4&&Q0(r,o),c&64&&(r=o.memoizedState,r!==null&&(r=r.dehydrated,r!==null&&(o=aA.bind(null,o),AA(r,o))));break;case 22:if(c=o.memoizedState!==null||ki,!c){s=s!==null&&s.memoizedState!==null||Xt,p=ki;var y=Xt;ki=c,(Xt=s)&&!y?Li(r,o,(o.subtreeFlags&8772)!==0):Pi(r,o),ki=p,Xt=y}break;case 30:break;default:Pi(r,o)}}function q0(r){var s=r.alternate;s!==null&&(r.alternate=null,q0(s)),r.child=null,r.deletions=null,r.sibling=null,r.tag===5&&(s=r.stateNode,s!==null&&eo(s)),r.stateNode=null,r.return=null,r.dependencies=null,r.memoizedProps=null,r.memoizedState=null,r.pendingProps=null,r.stateNode=null,r.updateQueue=null}var Ct=null,Ln=!1;function Ni(r,s,o){for(o=o.child;o!==null;)G0(r,s,o),o=o.sibling}function G0(r,s,o){if(gn&&typeof gn.onCommitFiberUnmount=="function")try{gn.onCommitFiberUnmount(Tr,o)}catch{}switch(o.tag){case 26:Xt||ci(o,s),Ni(r,s,o),o.memoizedState?o.memoizedState.count--:o.stateNode&&(o=o.stateNode,o.parentNode.removeChild(o));break;case 27:Xt||ci(o,s);var c=Ct,p=Ln;Cs(o.type)&&(Ct=o.stateNode,Ln=!1),Ni(r,s,o),Tc(o.stateNode),Ct=c,Ln=p;break;case 5:Xt||ci(o,s);case 6:if(c=Ct,p=Ln,Ct=null,Ni(r,s,o),Ct=c,Ln=p,Ct!==null)if(Ln)try{(Ct.nodeType===9?Ct.body:Ct.nodeName==="HTML"?Ct.ownerDocument.body:Ct).removeChild(o.stateNode)}catch(y){mt(o,s,y)}else try{Ct.removeChild(o.stateNode)}catch(y){mt(o,s,y)}break;case 18:Ct!==null&&(Ln?(r=Ct,Pv(r.nodeType===9?r.body:r.nodeName==="HTML"?r.ownerDocument.body:r,o.stateNode),zo(r)):Pv(Ct,o.stateNode));break;case 4:c=Ct,p=Ln,Ct=o.stateNode.containerInfo,Ln=!0,Ni(r,s,o),Ct=c,Ln=p;break;case 0:case 11:case 14:case 15:bs(2,o,s),Xt||bs(4,o,s),Ni(r,s,o);break;case 1:Xt||(ci(o,s),c=o.stateNode,typeof c.componentWillUnmount=="function"&&L0(o,s,c)),Ni(r,s,o);break;case 21:Ni(r,s,o);break;case 22:Xt=(c=Xt)||o.memoizedState!==null,Ni(r,s,o),Xt=c;break;default:Ni(r,s,o)}}function H0(r,s){if(s.memoizedState===null&&(r=s.alternate,r!==null&&(r=r.memoizedState,r!==null))){r=r.dehydrated;try{zo(r)}catch(o){mt(s,s.return,o)}}}function Q0(r,s){if(s.memoizedState===null&&(r=s.alternate,r!==null&&(r=r.memoizedState,r!==null&&(r=r.dehydrated,r!==null))))try{zo(r)}catch(o){mt(s,s.return,o)}}function JT(r){switch(r.tag){case 31:case 13:case 19:var s=r.stateNode;return s===null&&(s=r.stateNode=new B0),s;case 22:return r=r.stateNode,s=r._retryCache,s===null&&(s=r._retryCache=new B0),s;default:throw Error(i(435,r.tag))}}function wd(r,s){var o=JT(r);s.forEach(function(c){if(!o.has(c)){o.add(c);var p=oA.bind(null,r,c);c.then(p,p)}})}function Vn(r,s){var o=s.deletions;if(o!==null)for(var c=0;c<o.length;c++){var p=o[c],y=r,E=s,M=E;e:for(;M!==null;){switch(M.tag){case 27:if(Cs(M.type)){Ct=M.stateNode,Ln=!1;break e}break;case 5:Ct=M.stateNode,Ln=!1;break e;case 3:case 4:Ct=M.stateNode.containerInfo,Ln=!0;break e}M=M.return}if(Ct===null)throw Error(i(160));G0(y,E,p),Ct=null,Ln=!1,y=p.alternate,y!==null&&(y.return=null),p.return=null}if(s.subtreeFlags&13886)for(s=s.child;s!==null;)$0(s,r),s=s.sibling}var Nr=null;function $0(r,s){var o=r.alternate,c=r.flags;switch(r.tag){case 0:case 11:case 14:case 15:Vn(s,r),zn(r),c&4&&(bs(3,r,r.return),pc(3,r),bs(5,r,r.return));break;case 1:Vn(s,r),zn(r),c&512&&(Xt||o===null||ci(o,o.return)),c&64&&ki&&(r=r.updateQueue,r!==null&&(c=r.callbacks,c!==null&&(o=r.shared.hiddenCallbacks,r.shared.hiddenCallbacks=o===null?c:o.concat(c))));break;case 26:var p=Nr;if(Vn(s,r),zn(r),c&512&&(Xt||o===null||ci(o,o.return)),c&4){var y=o!==null?o.memoizedState:null;if(c=r.memoizedState,o===null)if(c===null)if(r.stateNode===null){e:{c=r.type,o=r.memoizedProps,p=p.ownerDocument||p;t:switch(c){case"title":y=p.getElementsByTagName("title")[0],(!y||y[Wr]||y[Ht]||y.namespaceURI==="http://www.w3.org/2000/svg"||y.hasAttribute("itemprop"))&&(y=p.createElement(c),p.head.insertBefore(y,p.querySelector("head > title"))),xn(y,c,o),y[Ht]=r,Qt(y),c=y;break e;case"link":var E=$v("link","href",p).get(c+(o.href||""));if(E){for(var M=0;M<E.length;M++)if(y=E[M],y.getAttribute("href")===(o.href==null||o.href===""?null:o.href)&&y.getAttribute("rel")===(o.rel==null?null:o.rel)&&y.getAttribute("title")===(o.title==null?null:o.title)&&y.getAttribute("crossorigin")===(o.crossOrigin==null?null:o.crossOrigin)){E.splice(M,1);break t}}y=p.createElement(c),xn(y,c,o),p.head.appendChild(y);break;case"meta":if(E=$v("meta","content",p).get(c+(o.content||""))){for(M=0;M<E.length;M++)if(y=E[M],y.getAttribute("content")===(o.content==null?null:""+o.content)&&y.getAttribute("name")===(o.name==null?null:o.name)&&y.getAttribute("property")===(o.property==null?null:o.property)&&y.getAttribute("http-equiv")===(o.httpEquiv==null?null:o.httpEquiv)&&y.getAttribute("charset")===(o.charSet==null?null:o.charSet)){E.splice(M,1);break t}}y=p.createElement(c),xn(y,c,o),p.head.appendChild(y);break;default:throw Error(i(468,c))}y[Ht]=r,Qt(y),c=y}r.stateNode=c}else Kv(p,r.type,r.stateNode);else r.stateNode=Qv(p,c,r.memoizedProps);else y!==c?(y===null?o.stateNode!==null&&(o=o.stateNode,o.parentNode.removeChild(o)):y.count--,c===null?Kv(p,r.type,r.stateNode):Qv(p,c,r.memoizedProps)):c===null&&r.stateNode!==null&&Dm(r,r.memoizedProps,o.memoizedProps)}break;case 27:Vn(s,r),zn(r),c&512&&(Xt||o===null||ci(o,o.return)),o!==null&&c&4&&Dm(r,r.memoizedProps,o.memoizedProps);break;case 5:if(Vn(s,r),zn(r),c&512&&(Xt||o===null||ci(o,o.return)),r.flags&32){p=r.stateNode;try{Pn(p,"")}catch(Ce){mt(r,r.return,Ce)}}c&4&&r.stateNode!=null&&(p=r.memoizedProps,Dm(r,p,o!==null?o.memoizedProps:p)),c&1024&&(Om=!0);break;case 6:if(Vn(s,r),zn(r),c&4){if(r.stateNode===null)throw Error(i(162));c=r.memoizedProps,o=r.stateNode;try{o.nodeValue=c}catch(Ce){mt(r,r.return,Ce)}}break;case 3:if(Ud=null,p=Nr,Nr=Vd(s.containerInfo),Vn(s,r),Nr=p,zn(r),c&4&&o!==null&&o.memoizedState.isDehydrated)try{zo(s.containerInfo)}catch(Ce){mt(r,r.return,Ce)}Om&&(Om=!1,K0(r));break;case 4:c=Nr,Nr=Vd(r.stateNode.containerInfo),Vn(s,r),zn(r),Nr=c;break;case 12:Vn(s,r),zn(r);break;case 31:Vn(s,r),zn(r),c&4&&(c=r.updateQueue,c!==null&&(r.updateQueue=null,wd(r,c)));break;case 13:Vn(s,r),zn(r),r.child.flags&8192&&r.memoizedState!==null!=(o!==null&&o.memoizedState!==null)&&(Ad=$e()),c&4&&(c=r.updateQueue,c!==null&&(r.updateQueue=null,wd(r,c)));break;case 22:p=r.memoizedState!==null;var G=o!==null&&o.memoizedState!==null,se=ki,pe=Xt;if(ki=se||p,Xt=pe||G,Vn(s,r),Xt=pe,ki=se,zn(r),c&8192)e:for(s=r.stateNode,s._visibility=p?s._visibility&-2:s._visibility|1,p&&(o===null||G||ki||Xt||ja(r)),o=null,s=r;;){if(s.tag===5||s.tag===26){if(o===null){G=o=s;try{if(y=G.stateNode,p)E=y.style,typeof E.setProperty=="function"?E.setProperty("display","none","important"):E.display="none";else{M=G.stateNode;var _e=G.memoizedProps.style,oe=_e!=null&&_e.hasOwnProperty("display")?_e.display:null;M.style.display=oe==null||typeof oe=="boolean"?"":(""+oe).trim()}}catch(Ce){mt(G,G.return,Ce)}}}else if(s.tag===6){if(o===null){G=s;try{G.stateNode.nodeValue=p?"":G.memoizedProps}catch(Ce){mt(G,G.return,Ce)}}}else if(s.tag===18){if(o===null){G=s;try{var ue=G.stateNode;p?Lv(ue,!0):Lv(G.stateNode,!1)}catch(Ce){mt(G,G.return,Ce)}}}else if((s.tag!==22&&s.tag!==23||s.memoizedState===null||s===r)&&s.child!==null){s.child.return=s,s=s.child;continue}if(s===r)break e;for(;s.sibling===null;){if(s.return===null||s.return===r)break e;o===s&&(o=null),s=s.return}o===s&&(o=null),s.sibling.return=s.return,s=s.sibling}c&4&&(c=r.updateQueue,c!==null&&(o=c.retryQueue,o!==null&&(c.retryQueue=null,wd(r,o))));break;case 19:Vn(s,r),zn(r),c&4&&(c=r.updateQueue,c!==null&&(r.updateQueue=null,wd(r,c)));break;case 30:break;case 21:break;default:Vn(s,r),zn(r)}}function zn(r){var s=r.flags;if(s&2){try{for(var o,c=r.return;c!==null;){if(z0(c)){o=c;break}c=c.return}if(o==null)throw Error(i(160));switch(o.tag){case 27:var p=o.stateNode,y=Im(r);Sd(r,y,p);break;case 5:var E=o.stateNode;o.flags&32&&(Pn(E,""),o.flags&=-33);var M=Im(r);Sd(r,M,E);break;case 3:case 4:var G=o.stateNode.containerInfo,se=Im(r);jm(r,se,G);break;default:throw Error(i(161))}}catch(pe){mt(r,r.return,pe)}r.flags&=-3}s&4096&&(r.flags&=-4097)}function K0(r){if(r.subtreeFlags&1024)for(r=r.child;r!==null;){var s=r;K0(s),s.tag===5&&s.flags&1024&&s.stateNode.reset(),r=r.sibling}}function Pi(r,s){if(s.subtreeFlags&8772)for(s=s.child;s!==null;)F0(r,s.alternate,s),s=s.sibling}function ja(r){for(r=r.child;r!==null;){var s=r;switch(s.tag){case 0:case 11:case 14:case 15:bs(4,s,s.return),ja(s);break;case 1:ci(s,s.return);var o=s.stateNode;typeof o.componentWillUnmount=="function"&&L0(s,s.return,o),ja(s);break;case 27:Tc(s.stateNode);case 26:case 5:ci(s,s.return),ja(s);break;case 22:s.memoizedState===null&&ja(s);break;case 30:ja(s);break;default:ja(s)}r=r.sibling}}function Li(r,s,o){for(o=o&&(s.subtreeFlags&8772)!==0,s=s.child;s!==null;){var c=s.alternate,p=r,y=s,E=y.flags;switch(y.tag){case 0:case 11:case 15:Li(p,y,o),pc(4,y);break;case 1:if(Li(p,y,o),c=y,p=c.stateNode,typeof p.componentDidMount=="function")try{p.componentDidMount()}catch(se){mt(c,c.return,se)}if(c=y,p=c.updateQueue,p!==null){var M=c.stateNode;try{var G=p.shared.hiddenCallbacks;if(G!==null)for(p.shared.hiddenCallbacks=null,p=0;p<G.length;p++)T_(G[p],M)}catch(se){mt(c,c.return,se)}}o&&E&64&&P0(y),gc(y,y.return);break;case 27:U0(y);case 26:case 5:Li(p,y,o),o&&c===null&&E&4&&V0(y),gc(y,y.return);break;case 12:Li(p,y,o);break;case 31:Li(p,y,o),o&&E&4&&H0(p,y);break;case 13:Li(p,y,o),o&&E&4&&Q0(p,y);break;case 22:y.memoizedState===null&&Li(p,y,o),gc(y,y.return);break;case 30:break;default:Li(p,y,o)}s=s.sibling}}function Mm(r,s){var o=null;r!==null&&r.memoizedState!==null&&r.memoizedState.cachePool!==null&&(o=r.memoizedState.cachePool.pool),r=null,s.memoizedState!==null&&s.memoizedState.cachePool!==null&&(r=s.memoizedState.cachePool.pool),r!==o&&(r!=null&&r.refCount++,o!=null&&nc(o))}function km(r,s){r=null,s.alternate!==null&&(r=s.alternate.memoizedState.cache),s=s.memoizedState.cache,s!==r&&(s.refCount++,r!=null&&nc(r))}function Pr(r,s,o,c){if(s.subtreeFlags&10256)for(s=s.child;s!==null;)W0(r,s,o,c),s=s.sibling}function W0(r,s,o,c){var p=s.flags;switch(s.tag){case 0:case 11:case 15:Pr(r,s,o,c),p&2048&&pc(9,s);break;case 1:Pr(r,s,o,c);break;case 3:Pr(r,s,o,c),p&2048&&(r=null,s.alternate!==null&&(r=s.alternate.memoizedState.cache),s=s.memoizedState.cache,s!==r&&(s.refCount++,r!=null&&nc(r)));break;case 12:if(p&2048){Pr(r,s,o,c),r=s.stateNode;try{var y=s.memoizedProps,E=y.id,M=y.onPostCommit;typeof M=="function"&&M(E,s.alternate===null?"mount":"update",r.passiveEffectDuration,-0)}catch(G){mt(s,s.return,G)}}else Pr(r,s,o,c);break;case 31:Pr(r,s,o,c);break;case 13:Pr(r,s,o,c);break;case 23:break;case 22:y=s.stateNode,E=s.alternate,s.memoizedState!==null?y._visibility&2?Pr(r,s,o,c):yc(r,s):y._visibility&2?Pr(r,s,o,c):(y._visibility|=2,Ro(r,s,o,c,(s.subtreeFlags&10256)!==0||!1)),p&2048&&Mm(E,s);break;case 24:Pr(r,s,o,c),p&2048&&km(s.alternate,s);break;default:Pr(r,s,o,c)}}function Ro(r,s,o,c,p){for(p=p&&((s.subtreeFlags&10256)!==0||!1),s=s.child;s!==null;){var y=r,E=s,M=o,G=c,se=E.flags;switch(E.tag){case 0:case 11:case 15:Ro(y,E,M,G,p),pc(8,E);break;case 23:break;case 22:var pe=E.stateNode;E.memoizedState!==null?pe._visibility&2?Ro(y,E,M,G,p):yc(y,E):(pe._visibility|=2,Ro(y,E,M,G,p)),p&&se&2048&&Mm(E.alternate,E);break;case 24:Ro(y,E,M,G,p),p&&se&2048&&km(E.alternate,E);break;default:Ro(y,E,M,G,p)}s=s.sibling}}function yc(r,s){if(s.subtreeFlags&10256)for(s=s.child;s!==null;){var o=r,c=s,p=c.flags;switch(c.tag){case 22:yc(o,c),p&2048&&Mm(c.alternate,c);break;case 24:yc(o,c),p&2048&&km(c.alternate,c);break;default:yc(o,c)}s=s.sibling}}var _c=8192;function Do(r,s,o){if(r.subtreeFlags&_c)for(r=r.child;r!==null;)Y0(r,s,o),r=r.sibling}function Y0(r,s,o){switch(r.tag){case 26:Do(r,s,o),r.flags&_c&&r.memoizedState!==null&&VA(o,Nr,r.memoizedState,r.memoizedProps);break;case 5:Do(r,s,o);break;case 3:case 4:var c=Nr;Nr=Vd(r.stateNode.containerInfo),Do(r,s,o),Nr=c;break;case 22:r.memoizedState===null&&(c=r.alternate,c!==null&&c.memoizedState!==null?(c=_c,_c=16777216,Do(r,s,o),_c=c):Do(r,s,o));break;default:Do(r,s,o)}}function X0(r){var s=r.alternate;if(s!==null&&(r=s.child,r!==null)){s.child=null;do s=r.sibling,r.sibling=null,r=s;while(r!==null)}}function vc(r){var s=r.deletions;if((r.flags&16)!==0){if(s!==null)for(var o=0;o<s.length;o++){var c=s[o];dn=c,Z0(c,r)}X0(r)}if(r.subtreeFlags&10256)for(r=r.child;r!==null;)J0(r),r=r.sibling}function J0(r){switch(r.tag){case 0:case 11:case 15:vc(r),r.flags&2048&&bs(9,r,r.return);break;case 3:vc(r);break;case 12:vc(r);break;case 22:var s=r.stateNode;r.memoizedState!==null&&s._visibility&2&&(r.return===null||r.return.tag!==13)?(s._visibility&=-3,Td(r)):vc(r);break;default:vc(r)}}function Td(r){var s=r.deletions;if((r.flags&16)!==0){if(s!==null)for(var o=0;o<s.length;o++){var c=s[o];dn=c,Z0(c,r)}X0(r)}for(r=r.child;r!==null;){switch(s=r,s.tag){case 0:case 11:case 15:bs(8,s,s.return),Td(s);break;case 22:o=s.stateNode,o._visibility&2&&(o._visibility&=-3,Td(s));break;default:Td(s)}r=r.sibling}}function Z0(r,s){for(;dn!==null;){var o=dn;switch(o.tag){case 0:case 11:case 15:bs(8,o,s);break;case 23:case 22:if(o.memoizedState!==null&&o.memoizedState.cachePool!==null){var c=o.memoizedState.cachePool.pool;c!=null&&c.refCount++}break;case 24:nc(o.memoizedState.cache)}if(c=o.child,c!==null)c.return=o,dn=c;else e:for(o=r;dn!==null;){c=dn;var p=c.sibling,y=c.return;if(q0(c),c===o){dn=null;break e}if(p!==null){p.return=y,dn=p;break e}dn=y}}}var ZT={getCacheForType:function(r){var s=vn(Kt),o=s.data.get(r);return o===void 0&&(o=r(),s.data.set(r,o)),o},cacheSignal:function(){return vn(Kt).controller.signal}},eA=typeof WeakMap=="function"?WeakMap:Map,lt=0,bt=null,Ke=null,Ye=0,ft=0,Jn=null,xs=!1,Io=!1,Nm=!1,Vi=0,Nt=0,Es=0,Oa=0,Pm=0,Zn=0,jo=0,bc=null,Un=null,Lm=!1,Ad=0,ev=0,Cd=1/0,Rd=null,Ss=null,rn=0,ws=null,Oo=null,zi=0,Vm=0,zm=null,tv=null,xc=0,Um=null;function er(){return(lt&2)!==0&&Ye!==0?Ye&-Ye:z.T!==null?Qm():Du()}function nv(){if(Zn===0)if((Ye&536870912)===0||tt){var r=sa;sa<<=1,(sa&3932160)===0&&(sa=262144),Zn=r}else Zn=536870912;return r=Yn.current,r!==null&&(r.flags|=32),Zn}function Bn(r,s,o){(r===bt&&(ft===2||ft===9)||r.cancelPendingCommit!==null)&&(Mo(r,0),Ts(r,Ye,Zn,!1)),aa(r,o),((lt&2)===0||r!==bt)&&(r===bt&&((lt&2)===0&&(Oa|=o),Nt===4&&Ts(r,Ye,Zn,!1)),ui(r))}function rv(r,s,o){if((lt&6)!==0)throw Error(i(327));var c=!o&&(s&127)===0&&(s&r.expiredLanes)===0||Ar(r,s),p=c?rA(r,s):Fm(r,s,!0),y=c;do{if(p===0){Io&&!c&&Ts(r,s,0,!1);break}else{if(o=r.current.alternate,y&&!tA(o)){p=Fm(r,s,!1),y=!1;continue}if(p===2){if(y=s,r.errorRecoveryDisabledLanes&y)var E=0;else E=r.pendingLanes&-536870913,E=E!==0?E:E&536870912?536870912:0;if(E!==0){s=E;e:{var M=r;p=bc;var G=M.current.memoizedState.isDehydrated;if(G&&(Mo(M,E).flags|=256),E=Fm(M,E,!1),E!==2){if(Nm&&!G){M.errorRecoveryDisabledLanes|=y,Oa|=y,p=4;break e}y=Un,Un=p,y!==null&&(Un===null?Un=y:Un.push.apply(Un,y))}p=E}if(y=!1,p!==2)continue}}if(p===1){Mo(r,0),Ts(r,s,0,!0);break}e:{switch(c=r,y=p,y){case 0:case 1:throw Error(i(345));case 4:if((s&4194048)!==s)break;case 6:Ts(c,s,Zn,!xs);break e;case 2:Un=null;break;case 3:case 5:break;default:throw Error(i(329))}if((s&62914560)===s&&(p=Ad+300-$e(),10<p)){if(Ts(c,s,Zn,!xs),Qr(c,0,!0)!==0)break e;zi=s,c.timeoutHandle=kv(iv.bind(null,c,o,Un,Rd,Lm,s,Zn,Oa,jo,xs,y,"Throttled",-0,0),p);break e}iv(c,o,Un,Rd,Lm,s,Zn,Oa,jo,xs,y,null,-0,0)}}break}while(!0);ui(r)}function iv(r,s,o,c,p,y,E,M,G,se,pe,_e,oe,ue){if(r.timeoutHandle=-1,_e=s.subtreeFlags,_e&8192||(_e&16785408)===16785408){_e={stylesheets:null,count:0,imgCount:0,imgBytes:0,suspenseyImages:[],waitingForImages:!0,waitingForViewTransition:!1,unsuspend:Dr},Y0(s,y,_e);var Ce=(y&62914560)===y?Ad-$e():(y&4194048)===y?ev-$e():0;if(Ce=zA(_e,Ce),Ce!==null){zi=y,r.cancelPendingCommit=Ce(hv.bind(null,r,s,y,o,c,p,E,M,G,pe,_e,null,oe,ue)),Ts(r,y,E,!se);return}}hv(r,s,y,o,c,p,E,M,G)}function tA(r){for(var s=r;;){var o=s.tag;if((o===0||o===11||o===15)&&s.flags&16384&&(o=s.updateQueue,o!==null&&(o=o.stores,o!==null)))for(var c=0;c<o.length;c++){var p=o[c],y=p.getSnapshot;p=p.value;try{if(!Kn(y(),p))return!1}catch{return!1}}if(o=s.child,s.subtreeFlags&16384&&o!==null)o.return=s,s=o;else{if(s===r)break;for(;s.sibling===null;){if(s.return===null||s.return===r)return!0;s=s.return}s.sibling.return=s.return,s=s.sibling}}return!0}function Ts(r,s,o,c){s&=~Pm,s&=~Oa,r.suspendedLanes|=s,r.pingedLanes&=~s,c&&(r.warmLanes|=s),c=r.expirationTimes;for(var p=s;0<p;){var y=31-Lt(p),E=1<<y;c[y]=-1,p&=~E}o!==0&&oa(r,o,s)}function Dd(){return(lt&6)===0?(Ec(0),!1):!0}function Bm(){if(Ke!==null){if(ft===0)var r=Ke.return;else r=Ke,Ri=Sa=null,rm(r),So=null,ic=0,r=Ke;for(;r!==null;)N0(r.alternate,r),r=r.return;Ke=null}}function Mo(r,s){var o=r.timeoutHandle;o!==-1&&(r.timeoutHandle=-1,xA(o)),o=r.cancelPendingCommit,o!==null&&(r.cancelPendingCommit=null,o()),zi=0,Bm(),bt=r,Ke=o=Ai(r.current,null),Ye=s,ft=0,Jn=null,xs=!1,Io=Ar(r,s),Nm=!1,jo=Zn=Pm=Oa=Es=Nt=0,Un=bc=null,Lm=!1,(s&8)!==0&&(s|=s&32);var c=r.entangledLanes;if(c!==0)for(r=r.entanglements,c&=s;0<c;){var p=31-Lt(c),y=1<<p;s|=r[p],c&=~y}return Vi=s,Yu(),o}function sv(r,s){Ge=null,z.H=hc,s===Eo||s===id?(s=x_(),ft=3):s===Hf?(s=x_(),ft=4):ft=s===vm?8:s!==null&&typeof s=="object"&&typeof s.then=="function"?6:1,Jn=s,Ke===null&&(Nt=1,_d(r,mr(s,r.current)))}function av(){var r=Yn.current;return r===null?!0:(Ye&4194048)===Ye?_r===null:(Ye&62914560)===Ye||(Ye&536870912)!==0?r===_r:!1}function ov(){var r=z.H;return z.H=hc,r===null?hc:r}function lv(){var r=z.A;return z.A=ZT,r}function Id(){Nt=4,xs||(Ye&4194048)!==Ye&&Yn.current!==null||(Io=!0),(Es&134217727)===0&&(Oa&134217727)===0||bt===null||Ts(bt,Ye,Zn,!1)}function Fm(r,s,o){var c=lt;lt|=2;var p=ov(),y=lv();(bt!==r||Ye!==s)&&(Rd=null,Mo(r,s)),s=!1;var E=Nt;e:do try{if(ft!==0&&Ke!==null){var M=Ke,G=Jn;switch(ft){case 8:Bm(),E=6;break e;case 3:case 2:case 9:case 6:Yn.current===null&&(s=!0);var se=ft;if(ft=0,Jn=null,ko(r,M,G,se),o&&Io){E=0;break e}break;default:se=ft,ft=0,Jn=null,ko(r,M,G,se)}}nA(),E=Nt;break}catch(pe){sv(r,pe)}while(!0);return s&&r.shellSuspendCounter++,Ri=Sa=null,lt=c,z.H=p,z.A=y,Ke===null&&(bt=null,Ye=0,Yu()),E}function nA(){for(;Ke!==null;)cv(Ke)}function rA(r,s){var o=lt;lt|=2;var c=ov(),p=lv();bt!==r||Ye!==s?(Rd=null,Cd=$e()+500,Mo(r,s)):Io=Ar(r,s);e:do try{if(ft!==0&&Ke!==null){s=Ke;var y=Jn;t:switch(ft){case 1:ft=0,Jn=null,ko(r,s,y,1);break;case 2:case 9:if(v_(y)){ft=0,Jn=null,uv(s);break}s=function(){ft!==2&&ft!==9||bt!==r||(ft=7),ui(r)},y.then(s,s);break e;case 3:ft=7;break e;case 4:ft=5;break e;case 7:v_(y)?(ft=0,Jn=null,uv(s)):(ft=0,Jn=null,ko(r,s,y,7));break;case 5:var E=null;switch(Ke.tag){case 26:E=Ke.memoizedState;case 5:case 27:var M=Ke;if(E?Wv(E):M.stateNode.complete){ft=0,Jn=null;var G=M.sibling;if(G!==null)Ke=G;else{var se=M.return;se!==null?(Ke=se,jd(se)):Ke=null}break t}}ft=0,Jn=null,ko(r,s,y,5);break;case 6:ft=0,Jn=null,ko(r,s,y,6);break;case 8:Bm(),Nt=6;break e;default:throw Error(i(462))}}iA();break}catch(pe){sv(r,pe)}while(!0);return Ri=Sa=null,z.H=c,z.A=p,lt=o,Ke!==null?0:(bt=null,Ye=0,Yu(),Nt)}function iA(){for(;Ke!==null&&!Le();)cv(Ke)}function cv(r){var s=M0(r.alternate,r,Vi);r.memoizedProps=r.pendingProps,s===null?jd(r):Ke=s}function uv(r){var s=r,o=s.alternate;switch(s.tag){case 15:case 0:s=C0(o,s,s.pendingProps,s.type,void 0,Ye);break;case 11:s=C0(o,s,s.pendingProps,s.type.render,s.ref,Ye);break;case 5:rm(s);default:N0(o,s),s=Ke=l_(s,Vi),s=M0(o,s,Vi)}r.memoizedProps=r.pendingProps,s===null?jd(r):Ke=s}function ko(r,s,o,c){Ri=Sa=null,rm(s),So=null,ic=0;var p=s.return;try{if(QT(r,p,s,o,Ye)){Nt=1,_d(r,mr(o,r.current)),Ke=null;return}}catch(y){if(p!==null)throw Ke=p,y;Nt=1,_d(r,mr(o,r.current)),Ke=null;return}s.flags&32768?(tt||c===1?r=!0:Io||(Ye&536870912)!==0?r=!1:(xs=r=!0,(c===2||c===9||c===3||c===6)&&(c=Yn.current,c!==null&&c.tag===13&&(c.flags|=16384))),dv(s,r)):jd(s)}function jd(r){var s=r;do{if((s.flags&32768)!==0){dv(s,xs);return}r=s.return;var o=WT(s.alternate,s,Vi);if(o!==null){Ke=o;return}if(s=s.sibling,s!==null){Ke=s;return}Ke=s=r}while(s!==null);Nt===0&&(Nt=5)}function dv(r,s){do{var o=YT(r.alternate,r);if(o!==null){o.flags&=32767,Ke=o;return}if(o=r.return,o!==null&&(o.flags|=32768,o.subtreeFlags=0,o.deletions=null),!s&&(r=r.sibling,r!==null)){Ke=r;return}Ke=r=o}while(r!==null);Nt=6,Ke=null}function hv(r,s,o,c,p,y,E,M,G){r.cancelPendingCommit=null;do Od();while(rn!==0);if((lt&6)!==0)throw Error(i(327));if(s!==null){if(s===r.current)throw Error(i(177));if(y=s.lanes|s.childLanes,y|=If,xf(r,o,y,E,M,G),r===bt&&(Ke=bt=null,Ye=0),Oo=s,ws=r,zi=o,Vm=y,zm=p,tv=c,(s.subtreeFlags&10256)!==0||(s.flags&10256)!==0?(r.callbackNode=null,r.callbackPriority=0,lA(pn,function(){return yv(),null})):(r.callbackNode=null,r.callbackPriority=0),c=(s.flags&13878)!==0,(s.subtreeFlags&13878)!==0||c){c=z.T,z.T=null,p=q.p,q.p=2,E=lt,lt|=4;try{XT(r,s,o)}finally{lt=E,q.p=p,z.T=c}}rn=1,fv(),mv(),pv()}}function fv(){if(rn===1){rn=0;var r=ws,s=Oo,o=(s.flags&13878)!==0;if((s.subtreeFlags&13878)!==0||o){o=z.T,z.T=null;var c=q.p;q.p=2;var p=lt;lt|=4;try{$0(s,r);var y=ep,E=Zy(r.containerInfo),M=y.focusedElem,G=y.selectionRange;if(E!==M&&M&&M.ownerDocument&&Jy(M.ownerDocument.documentElement,M)){if(G!==null&&Tf(M)){var se=G.start,pe=G.end;if(pe===void 0&&(pe=se),"selectionStart"in M)M.selectionStart=se,M.selectionEnd=Math.min(pe,M.value.length);else{var _e=M.ownerDocument||document,oe=_e&&_e.defaultView||window;if(oe.getSelection){var ue=oe.getSelection(),Ce=M.textContent.length,Me=Math.min(G.start,Ce),_t=G.end===void 0?Me:Math.min(G.end,Ce);!ue.extend&&Me>_t&&(E=_t,_t=Me,Me=E);var J=Xy(M,Me),$=Xy(M,_t);if(J&&$&&(ue.rangeCount!==1||ue.anchorNode!==J.node||ue.anchorOffset!==J.offset||ue.focusNode!==$.node||ue.focusOffset!==$.offset)){var ie=_e.createRange();ie.setStart(J.node,J.offset),ue.removeAllRanges(),Me>_t?(ue.addRange(ie),ue.extend($.node,$.offset)):(ie.setEnd($.node,$.offset),ue.addRange(ie))}}}}for(_e=[],ue=M;ue=ue.parentNode;)ue.nodeType===1&&_e.push({element:ue,left:ue.scrollLeft,top:ue.scrollTop});for(typeof M.focus=="function"&&M.focus(),M=0;M<_e.length;M++){var ye=_e[M];ye.element.scrollLeft=ye.left,ye.element.scrollTop=ye.top}}Gd=!!Zm,ep=Zm=null}finally{lt=p,q.p=c,z.T=o}}r.current=s,rn=2}}function mv(){if(rn===2){rn=0;var r=ws,s=Oo,o=(s.flags&8772)!==0;if((s.subtreeFlags&8772)!==0||o){o=z.T,z.T=null;var c=q.p;q.p=2;var p=lt;lt|=4;try{F0(r,s.alternate,s)}finally{lt=p,q.p=c,z.T=o}}rn=3}}function pv(){if(rn===4||rn===3){rn=0,He();var r=ws,s=Oo,o=zi,c=tv;(s.subtreeFlags&10256)!==0||(s.flags&10256)!==0?rn=5:(rn=0,Oo=ws=null,gv(r,r.pendingLanes));var p=r.pendingLanes;if(p===0&&(Ss=null),Ei(o),s=s.stateNode,gn&&typeof gn.onCommitFiberRoot=="function")try{gn.onCommitFiberRoot(Tr,s,void 0,(s.current.flags&128)===128)}catch{}if(c!==null){s=z.T,p=q.p,q.p=2,z.T=null;try{for(var y=r.onRecoverableError,E=0;E<c.length;E++){var M=c[E];y(M.value,{componentStack:M.stack})}}finally{z.T=s,q.p=p}}(zi&3)!==0&&Od(),ui(r),p=r.pendingLanes,(o&261930)!==0&&(p&42)!==0?r===Um?xc++:(xc=0,Um=r):xc=0,Ec(0)}}function gv(r,s){(r.pooledCacheLanes&=s)===0&&(s=r.pooledCache,s!=null&&(r.pooledCache=null,nc(s)))}function Od(){return fv(),mv(),pv(),yv()}function yv(){if(rn!==5)return!1;var r=ws,s=Vm;Vm=0;var o=Ei(zi),c=z.T,p=q.p;try{q.p=32>o?32:o,z.T=null,o=zm,zm=null;var y=ws,E=zi;if(rn=0,Oo=ws=null,zi=0,(lt&6)!==0)throw Error(i(331));var M=lt;if(lt|=4,J0(y.current),W0(y,y.current,E,o),lt=M,Ec(0,!1),gn&&typeof gn.onPostCommitFiberRoot=="function")try{gn.onPostCommitFiberRoot(Tr,y)}catch{}return!0}finally{q.p=p,z.T=c,gv(r,s)}}function _v(r,s,o){s=mr(o,s),s=_m(r.stateNode,s,2),r=ys(r,s,2),r!==null&&(aa(r,2),ui(r))}function mt(r,s,o){if(r.tag===3)_v(r,r,o);else for(;s!==null;){if(s.tag===3){_v(s,r,o);break}else if(s.tag===1){var c=s.stateNode;if(typeof s.type.getDerivedStateFromError=="function"||typeof c.componentDidCatch=="function"&&(Ss===null||!Ss.has(c))){r=mr(o,r),o=v0(2),c=ys(s,o,2),c!==null&&(b0(o,c,s,r),aa(c,2),ui(c));break}}s=s.return}}function qm(r,s,o){var c=r.pingCache;if(c===null){c=r.pingCache=new eA;var p=new Set;c.set(s,p)}else p=c.get(s),p===void 0&&(p=new Set,c.set(s,p));p.has(o)||(Nm=!0,p.add(o),r=sA.bind(null,r,s,o),s.then(r,r))}function sA(r,s,o){var c=r.pingCache;c!==null&&c.delete(s),r.pingedLanes|=r.suspendedLanes&o,r.warmLanes&=~o,bt===r&&(Ye&o)===o&&(Nt===4||Nt===3&&(Ye&62914560)===Ye&&300>$e()-Ad?(lt&2)===0&&Mo(r,0):Pm|=o,jo===Ye&&(jo=0)),ui(r)}function vv(r,s){s===0&&(s=Ru()),r=ba(r,s),r!==null&&(aa(r,s),ui(r))}function aA(r){var s=r.memoizedState,o=0;s!==null&&(o=s.retryLane),vv(r,o)}function oA(r,s){var o=0;switch(r.tag){case 31:case 13:var c=r.stateNode,p=r.memoizedState;p!==null&&(o=p.retryLane);break;case 19:c=r.stateNode;break;case 22:c=r.stateNode._retryCache;break;default:throw Error(i(314))}c!==null&&c.delete(s),vv(r,o)}function lA(r,s){return dt(r,s)}var Md=null,No=null,Gm=!1,kd=!1,Hm=!1,As=0;function ui(r){r!==No&&r.next===null&&(No===null?Md=No=r:No=No.next=r),kd=!0,Gm||(Gm=!0,uA())}function Ec(r,s){if(!Hm&&kd){Hm=!0;do for(var o=!1,c=Md;c!==null;){if(r!==0){var p=c.pendingLanes;if(p===0)var y=0;else{var E=c.suspendedLanes,M=c.pingedLanes;y=(1<<31-Lt(42|r)+1)-1,y&=p&~(E&~M),y=y&201326741?y&201326741|1:y?y|2:0}y!==0&&(o=!0,Sv(c,y))}else y=Ye,y=Qr(c,c===bt?y:0,c.cancelPendingCommit!==null||c.timeoutHandle!==-1),(y&3)===0||Ar(c,y)||(o=!0,Sv(c,y));c=c.next}while(o);Hm=!1}}function cA(){bv()}function bv(){kd=Gm=!1;var r=0;As!==0&&bA()&&(r=As);for(var s=$e(),o=null,c=Md;c!==null;){var p=c.next,y=xv(c,s);y===0?(c.next=null,o===null?Md=p:o.next=p,p===null&&(No=o)):(o=c,(r!==0||(y&3)!==0)&&(kd=!0)),c=p}rn!==0&&rn!==5||Ec(r),As!==0&&(As=0)}function xv(r,s){for(var o=r.suspendedLanes,c=r.pingedLanes,p=r.expirationTimes,y=r.pendingLanes&-62914561;0<y;){var E=31-Lt(y),M=1<<E,G=p[E];G===-1?((M&o)===0||(M&c)!==0)&&(p[E]=bf(M,s)):G<=s&&(r.expiredLanes|=M),y&=~M}if(s=bt,o=Ye,o=Qr(r,r===s?o:0,r.cancelPendingCommit!==null||r.timeoutHandle!==-1),c=r.callbackNode,o===0||r===s&&(ft===2||ft===9)||r.cancelPendingCommit!==null)return c!==null&&c!==null&&we(c),r.callbackNode=null,r.callbackPriority=0;if((o&3)===0||Ar(r,o)){if(s=o&-o,s===r.callbackPriority)return s;switch(c!==null&&we(c),Ei(o)){case 2:case 8:o=qt;break;case 32:o=pn;break;case 268435456:o=or;break;default:o=pn}return c=Ev.bind(null,r),o=dt(o,c),r.callbackPriority=s,r.callbackNode=o,s}return c!==null&&c!==null&&we(c),r.callbackPriority=2,r.callbackNode=null,2}function Ev(r,s){if(rn!==0&&rn!==5)return r.callbackNode=null,r.callbackPriority=0,null;var o=r.callbackNode;if(Od()&&r.callbackNode!==o)return null;var c=Ye;return c=Qr(r,r===bt?c:0,r.cancelPendingCommit!==null||r.timeoutHandle!==-1),c===0?null:(rv(r,c,s),xv(r,$e()),r.callbackNode!=null&&r.callbackNode===o?Ev.bind(null,r):null)}function Sv(r,s){if(Od())return null;rv(r,s,!0)}function uA(){EA(function(){(lt&6)!==0?dt(rt,cA):bv()})}function Qm(){if(As===0){var r=bo;r===0&&(r=Gr,Gr<<=1,(Gr&261888)===0&&(Gr=256)),As=r}return As}function wv(r){return r==null||typeof r=="symbol"||typeof r=="boolean"?null:typeof r=="function"?r:io(""+r)}function Tv(r,s){var o=s.ownerDocument.createElement("input");return o.name=s.name,o.value=s.value,r.id&&o.setAttribute("form",r.id),s.parentNode.insertBefore(o,s),r=new FormData(r),o.parentNode.removeChild(o),r}function dA(r,s,o,c,p){if(s==="submit"&&o&&o.stateNode===p){var y=wv((p[cn]||null).action),E=c.submitter;E&&(s=(s=E[cn]||null)?wv(s.formAction):E.getAttribute("formAction"),s!==null&&(y=s,E=null));var M=new ri("action","action",null,c,p);r.push({event:M,listeners:[{instance:null,listener:function(){if(c.defaultPrevented){if(As!==0){var G=E?Tv(p,E):new FormData(p);hm(o,{pending:!0,data:G,method:p.method,action:y},null,G)}}else typeof y=="function"&&(M.preventDefault(),G=E?Tv(p,E):new FormData(p),hm(o,{pending:!0,data:G,method:p.method,action:y},y,G))},currentTarget:p}]})}}for(var $m=0;$m<Df.length;$m++){var Km=Df[$m],hA=Km.toLowerCase(),fA=Km[0].toUpperCase()+Km.slice(1);kr(hA,"on"+fA)}kr(n_,"onAnimationEnd"),kr(r_,"onAnimationIteration"),kr(i_,"onAnimationStart"),kr("dblclick","onDoubleClick"),kr("focusin","onFocus"),kr("focusout","onBlur"),kr(DT,"onTransitionRun"),kr(IT,"onTransitionStart"),kr(jT,"onTransitionCancel"),kr(s_,"onTransitionEnd"),Zr("onMouseEnter",["mouseout","mouseover"]),Zr("onMouseLeave",["mouseout","mouseover"]),Zr("onPointerEnter",["pointerout","pointerover"]),Zr("onPointerLeave",["pointerout","pointerover"]),Jr("onChange","change click focusin focusout input keydown keyup selectionchange".split(" ")),Jr("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" ")),Jr("onBeforeInput",["compositionend","keypress","textInput","paste"]),Jr("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" ")),Jr("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" ")),Jr("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var Sc="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),mA=new Set("beforetoggle cancel close invalid load scroll scrollend toggle".split(" ").concat(Sc));function Av(r,s){s=(s&4)!==0;for(var o=0;o<r.length;o++){var c=r[o],p=c.event;c=c.listeners;e:{var y=void 0;if(s)for(var E=c.length-1;0<=E;E--){var M=c[E],G=M.instance,se=M.currentTarget;if(M=M.listener,G!==y&&p.isPropagationStopped())break e;y=M,p.currentTarget=se;try{y(p)}catch(pe){Wu(pe)}p.currentTarget=null,y=G}else for(E=0;E<c.length;E++){if(M=c[E],G=M.instance,se=M.currentTarget,M=M.listener,G!==y&&p.isPropagationStopped())break e;y=M,p.currentTarget=se;try{y(p)}catch(pe){Wu(pe)}p.currentTarget=null,y=G}}}}function We(r,s){var o=s[Za];o===void 0&&(o=s[Za]=new Set);var c=r+"__bubble";o.has(c)||(Cv(s,r,2,!1),o.add(c))}function Wm(r,s,o){var c=0;s&&(c|=4),Cv(o,r,c,s)}var Nd="_reactListening"+Math.random().toString(36).slice(2);function Ym(r){if(!r[Nd]){r[Nd]=!0,Nl.forEach(function(o){o!=="selectionchange"&&(mA.has(o)||Wm(o,!1,r),Wm(o,!0,r))});var s=r.nodeType===9?r:r.ownerDocument;s===null||s[Nd]||(s[Nd]=!0,Wm("selectionchange",!1,s))}}function Cv(r,s,o,c){switch(nb(s)){case 2:var p=FA;break;case 8:p=qA;break;default:p=dp}o=p.bind(null,s,o,r),p=void 0,!ha||s!=="touchstart"&&s!=="touchmove"&&s!=="wheel"||(p=!0),c?p!==void 0?r.addEventListener(s,o,{capture:!0,passive:p}):r.addEventListener(s,o,!0):p!==void 0?r.addEventListener(s,o,{passive:p}):r.addEventListener(s,o,!1)}function Xm(r,s,o,c,p){var y=c;if((s&1)===0&&(s&2)===0&&c!==null)e:for(;;){if(c===null)return;var E=c.tag;if(E===3||E===4){var M=c.stateNode.containerInfo;if(M===p)break;if(E===4)for(E=c.return;E!==null;){var G=E.tag;if((G===3||G===4)&&E.stateNode.containerInfo===p)return;E=E.return}for(;M!==null;){if(E=Yr(M),E===null)return;if(G=E.tag,G===5||G===6||G===26||G===27){c=y=E;continue e}M=M.parentNode}}c=c.return}os(function(){var se=y,pe=ur(o),_e=[];e:{var oe=a_.get(r);if(oe!==void 0){var ue=ri,Ce=r;switch(r){case"keypress":if(ma(o)===0)break e;case"keydown":case"keyup":ue=Qu;break;case"focusin":Ce="focus",ue=ga;break;case"focusout":Ce="blur",ue=ga;break;case"beforeblur":case"afterblur":ue=ga;break;case"click":if(o.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":ue=Kl;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":ue=Lu;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":ue=x;break;case n_:case r_:case i_:ue=zu;break;case s_:ue=V;break;case"scroll":case"scrollend":ue=$l;break;case"wheel":ue=le;break;case"copy":case"cut":case"paste":ue=Uu;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":ue=Ti;break;case"toggle":case"beforetoggle":ue=qe}var Me=(s&4)!==0,_t=!Me&&(r==="scroll"||r==="scrollend"),J=Me?oe!==null?oe+"Capture":null:oe;Me=[];for(var $=se,ie;$!==null;){var ye=$;if(ie=ye.stateNode,ye=ye.tag,ye!==5&&ye!==26&&ye!==27||ie===null||J===null||(ye=Ir($,J),ye!=null&&Me.push(wc($,ye,ie))),_t)break;$=$.return}0<Me.length&&(oe=new ue(oe,Ce,null,o,pe),_e.push({event:oe,listeners:Me}))}}if((s&7)===0){e:{if(oe=r==="mouseover"||r==="pointerover",ue=r==="mouseout"||r==="pointerout",oe&&o!==Gl&&(Ce=o.relatedTarget||o.fromElement)&&(Yr(Ce)||Ce[Kr]))break e;if((ue||oe)&&(oe=pe.window===pe?pe:(oe=pe.ownerDocument)?oe.defaultView||oe.parentWindow:window,ue?(Ce=o.relatedTarget||o.toElement,ue=se,Ce=Ce?Yr(Ce):null,Ce!==null&&(_t=l(Ce),Me=Ce.tag,Ce!==_t||Me!==5&&Me!==27&&Me!==6)&&(Ce=null)):(ue=null,Ce=se),ue!==Ce)){if(Me=Kl,ye="onMouseLeave",J="onMouseEnter",$="mouse",(r==="pointerout"||r==="pointerover")&&(Me=Ti,ye="onPointerLeave",J="onPointerEnter",$="pointer"),_t=ue==null?oe:Qn(ue),ie=Ce==null?oe:Qn(Ce),oe=new Me(ye,$+"leave",ue,o,pe),oe.target=_t,oe.relatedTarget=ie,ye=null,Yr(pe)===se&&(Me=new Me(J,$+"enter",Ce,o,pe),Me.target=ie,Me.relatedTarget=_t,ye=Me),_t=ye,ue&&Ce)t:{for(Me=pA,J=ue,$=Ce,ie=0,ye=J;ye;ye=Me(ye))ie++;ye=0;for(var Ie=$;Ie;Ie=Me(Ie))ye++;for(;0<ie-ye;)J=Me(J),ie--;for(;0<ye-ie;)$=Me($),ye--;for(;ie--;){if(J===$||$!==null&&J===$.alternate){Me=J;break t}J=Me(J),$=Me($)}Me=null}else Me=null;ue!==null&&Rv(_e,oe,ue,Me,!1),Ce!==null&&_t!==null&&Rv(_e,_t,Ce,Me,!0)}}e:{if(oe=se?Qn(se):window,ue=oe.nodeName&&oe.nodeName.toLowerCase(),ue==="select"||ue==="input"&&oe.type==="file")var it=Hy;else if(qy(oe))if(Qy)it=AT;else{it=wT;var De=ST}else ue=oe.nodeName,!ue||ue.toLowerCase()!=="input"||oe.type!=="checkbox"&&oe.type!=="radio"?se&&ro(se.elementType)&&(it=Hy):it=TT;if(it&&(it=it(r,se))){Gy(_e,it,o,pe);break e}De&&De(r,oe,se),r==="focusout"&&se&&oe.type==="number"&&se.memoizedProps.value!=null&&Bl(oe,"number",oe.value)}switch(De=se?Qn(se):window,r){case"focusin":(qy(De)||De.contentEditable==="true")&&(ho=De,Af=se,Zl=null);break;case"focusout":Zl=Af=ho=null;break;case"mousedown":Cf=!0;break;case"contextmenu":case"mouseup":case"dragend":Cf=!1,e_(_e,o,pe);break;case"selectionchange":if(RT)break;case"keydown":case"keyup":e_(_e,o,pe)}var Qe;if(ot)e:{switch(r){case"compositionstart":var Xe="onCompositionStart";break e;case"compositionend":Xe="onCompositionEnd";break e;case"compositionupdate":Xe="onCompositionUpdate";break e}Xe=void 0}else uo?ya(r,o)&&(Xe="onCompositionEnd"):r==="keydown"&&o.keyCode===229&&(Xe="onCompositionStart");Xe&&(ai&&o.locale!=="ko"&&(uo||Xe!=="onCompositionStart"?Xe==="onCompositionEnd"&&uo&&(Qe=Ql()):(ni=pe,Hl="value"in ni?ni.value:ni.textContent,uo=!0)),De=Pd(se,Xe),0<De.length&&(Xe=new si(Xe,r,null,o,pe),_e.push({event:Xe,listeners:De}),Qe?Xe.data=Qe:(Qe=co(o),Qe!==null&&(Xe.data=Qe)))),(Qe=hr?vT(r,o):bT(r,o))&&(Xe=Pd(se,"onBeforeInput"),0<Xe.length&&(De=new si("onBeforeInput","beforeinput",null,o,pe),_e.push({event:De,listeners:Xe}),De.data=Qe)),dA(_e,r,se,o,pe)}Av(_e,s)})}function wc(r,s,o){return{instance:r,listener:s,currentTarget:o}}function Pd(r,s){for(var o=s+"Capture",c=[];r!==null;){var p=r,y=p.stateNode;if(p=p.tag,p!==5&&p!==26&&p!==27||y===null||(p=Ir(r,o),p!=null&&c.unshift(wc(r,p,y)),p=Ir(r,s),p!=null&&c.push(wc(r,p,y))),r.tag===3)return c;r=r.return}return[]}function pA(r){if(r===null)return null;do r=r.return;while(r&&r.tag!==5&&r.tag!==27);return r||null}function Rv(r,s,o,c,p){for(var y=s._reactName,E=[];o!==null&&o!==c;){var M=o,G=M.alternate,se=M.stateNode;if(M=M.tag,G!==null&&G===c)break;M!==5&&M!==26&&M!==27||se===null||(G=se,p?(se=Ir(o,y),se!=null&&E.unshift(wc(o,se,G))):p||(se=Ir(o,y),se!=null&&E.push(wc(o,se,G)))),o=o.return}E.length!==0&&r.push({event:s,listeners:E})}var gA=/\r\n?/g,yA=/\u0000|\uFFFD/g;function Dv(r){return(typeof r=="string"?r:""+r).replace(gA,`
`).replace(yA,"")}function Iv(r,s){return s=Dv(s),Dv(r)===s}function yt(r,s,o,c,p,y){switch(o){case"children":typeof c=="string"?s==="body"||s==="textarea"&&c===""||Pn(r,c):(typeof c=="number"||typeof c=="bigint")&&s!=="body"&&Pn(r,""+c);break;case"className":$n(r,"class",c);break;case"tabIndex":$n(r,"tabindex",c);break;case"dir":case"role":case"viewBox":case"width":case"height":$n(r,o,c);break;case"style":ql(r,c,y);break;case"data":if(s!=="object"){$n(r,"data",c);break}case"src":case"href":if(c===""&&(s!=="a"||o!=="href")){r.removeAttribute(o);break}if(c==null||typeof c=="function"||typeof c=="symbol"||typeof c=="boolean"){r.removeAttribute(o);break}c=io(""+c),r.setAttribute(o,c);break;case"action":case"formAction":if(typeof c=="function"){r.setAttribute(o,"javascript:throw new Error('A React form was unexpectedly submitted. If you called form.submit() manually, consider using form.requestSubmit() instead. If you\\'re trying to use event.stopPropagation() in a submit event handler, consider also calling event.preventDefault().')");break}else typeof y=="function"&&(o==="formAction"?(s!=="input"&&yt(r,s,"name",p.name,p,null),yt(r,s,"formEncType",p.formEncType,p,null),yt(r,s,"formMethod",p.formMethod,p,null),yt(r,s,"formTarget",p.formTarget,p,null)):(yt(r,s,"encType",p.encType,p,null),yt(r,s,"method",p.method,p,null),yt(r,s,"target",p.target,p,null)));if(c==null||typeof c=="symbol"||typeof c=="boolean"){r.removeAttribute(o);break}c=io(""+c),r.setAttribute(o,c);break;case"onClick":c!=null&&(r.onclick=Dr);break;case"onScroll":c!=null&&We("scroll",r);break;case"onScrollEnd":c!=null&&We("scrollend",r);break;case"dangerouslySetInnerHTML":if(c!=null){if(typeof c!="object"||!("__html"in c))throw Error(i(61));if(o=c.__html,o!=null){if(p.children!=null)throw Error(i(60));r.innerHTML=o}}break;case"multiple":r.multiple=c&&typeof c!="function"&&typeof c!="symbol";break;case"muted":r.muted=c&&typeof c!="function"&&typeof c!="symbol";break;case"suppressContentEditableWarning":case"suppressHydrationWarning":case"defaultValue":case"defaultChecked":case"innerHTML":case"ref":break;case"autoFocus":break;case"xlinkHref":if(c==null||typeof c=="function"||typeof c=="boolean"||typeof c=="symbol"){r.removeAttribute("xlink:href");break}o=io(""+c),r.setAttributeNS("http://www.w3.org/1999/xlink","xlink:href",o);break;case"contentEditable":case"spellCheck":case"draggable":case"value":case"autoReverse":case"externalResourcesRequired":case"focusable":case"preserveAlpha":c!=null&&typeof c!="function"&&typeof c!="symbol"?r.setAttribute(o,""+c):r.removeAttribute(o);break;case"inert":case"allowFullScreen":case"async":case"autoPlay":case"controls":case"default":case"defer":case"disabled":case"disablePictureInPicture":case"disableRemotePlayback":case"formNoValidate":case"hidden":case"loop":case"noModule":case"noValidate":case"open":case"playsInline":case"readOnly":case"required":case"reversed":case"scoped":case"seamless":case"itemScope":c&&typeof c!="function"&&typeof c!="symbol"?r.setAttribute(o,""):r.removeAttribute(o);break;case"capture":case"download":c===!0?r.setAttribute(o,""):c!==!1&&c!=null&&typeof c!="function"&&typeof c!="symbol"?r.setAttribute(o,c):r.removeAttribute(o);break;case"cols":case"rows":case"size":case"span":c!=null&&typeof c!="function"&&typeof c!="symbol"&&!isNaN(c)&&1<=c?r.setAttribute(o,c):r.removeAttribute(o);break;case"rowSpan":case"start":c==null||typeof c=="function"||typeof c=="symbol"||isNaN(c)?r.removeAttribute(o):r.setAttribute(o,c);break;case"popover":We("beforetoggle",r),We("toggle",r),to(r,"popover",c);break;case"xlinkActuate":$t(r,"http://www.w3.org/1999/xlink","xlink:actuate",c);break;case"xlinkArcrole":$t(r,"http://www.w3.org/1999/xlink","xlink:arcrole",c);break;case"xlinkRole":$t(r,"http://www.w3.org/1999/xlink","xlink:role",c);break;case"xlinkShow":$t(r,"http://www.w3.org/1999/xlink","xlink:show",c);break;case"xlinkTitle":$t(r,"http://www.w3.org/1999/xlink","xlink:title",c);break;case"xlinkType":$t(r,"http://www.w3.org/1999/xlink","xlink:type",c);break;case"xmlBase":$t(r,"http://www.w3.org/XML/1998/namespace","xml:base",c);break;case"xmlLang":$t(r,"http://www.w3.org/XML/1998/namespace","xml:lang",c);break;case"xmlSpace":$t(r,"http://www.w3.org/XML/1998/namespace","xml:space",c);break;case"is":to(r,"is",c);break;case"innerText":case"textContent":break;default:(!(2<o.length)||o[0]!=="o"&&o[0]!=="O"||o[1]!=="n"&&o[1]!=="N")&&(o=Pu.get(o)||o,to(r,o,c))}}function Jm(r,s,o,c,p,y){switch(o){case"style":ql(r,c,y);break;case"dangerouslySetInnerHTML":if(c!=null){if(typeof c!="object"||!("__html"in c))throw Error(i(61));if(o=c.__html,o!=null){if(p.children!=null)throw Error(i(60));r.innerHTML=o}}break;case"children":typeof c=="string"?Pn(r,c):(typeof c=="number"||typeof c=="bigint")&&Pn(r,""+c);break;case"onScroll":c!=null&&We("scroll",r);break;case"onScrollEnd":c!=null&&We("scrollend",r);break;case"onClick":c!=null&&(r.onclick=Dr);break;case"suppressContentEditableWarning":case"suppressHydrationWarning":case"innerHTML":case"ref":break;case"innerText":case"textContent":break;default:if(!Pl.hasOwnProperty(o))e:{if(o[0]==="o"&&o[1]==="n"&&(p=o.endsWith("Capture"),s=o.slice(2,p?o.length-7:void 0),y=r[cn]||null,y=y!=null?y[o]:null,typeof y=="function"&&r.removeEventListener(s,y,p),typeof c=="function")){typeof y!="function"&&y!==null&&(o in r?r[o]=null:r.hasAttribute(o)&&r.removeAttribute(o)),r.addEventListener(s,c,p);break e}o in r?r[o]=c:c===!0?r.setAttribute(o,""):to(r,o,c)}}}function xn(r,s,o){switch(s){case"div":case"span":case"svg":case"path":case"a":case"g":case"p":case"li":break;case"img":We("error",r),We("load",r);var c=!1,p=!1,y;for(y in o)if(o.hasOwnProperty(y)){var E=o[y];if(E!=null)switch(y){case"src":c=!0;break;case"srcSet":p=!0;break;case"children":case"dangerouslySetInnerHTML":throw Error(i(137,s));default:yt(r,s,y,E,o,null)}}p&&yt(r,s,"srcSet",o.srcSet,o,null),c&&yt(r,s,"src",o.src,o,null);return;case"input":We("invalid",r);var M=y=E=p=null,G=null,se=null;for(c in o)if(o.hasOwnProperty(c)){var pe=o[c];if(pe!=null)switch(c){case"name":p=pe;break;case"type":E=pe;break;case"checked":G=pe;break;case"defaultChecked":se=pe;break;case"value":y=pe;break;case"defaultValue":M=pe;break;case"children":case"dangerouslySetInnerHTML":if(pe!=null)throw Error(i(137,s));break;default:yt(r,s,c,pe,o,null)}}Mu(r,y,M,G,se,E,p,!1);return;case"select":We("invalid",r),c=E=y=null;for(p in o)if(o.hasOwnProperty(p)&&(M=o[p],M!=null))switch(p){case"value":y=M;break;case"defaultValue":E=M;break;case"multiple":c=M;default:yt(r,s,p,M,o,null)}s=y,o=E,r.multiple=!!c,s!=null?rs(r,!!c,s,!1):o!=null&&rs(r,!!c,o,!0);return;case"textarea":We("invalid",r),y=p=c=null;for(E in o)if(o.hasOwnProperty(E)&&(M=o[E],M!=null))switch(E){case"value":c=M;break;case"defaultValue":p=M;break;case"children":y=M;break;case"dangerouslySetInnerHTML":if(M!=null)throw Error(i(91));break;default:yt(r,s,E,M,o,null)}is(r,c,p,y);return;case"option":for(G in o)o.hasOwnProperty(G)&&(c=o[G],c!=null)&&(G==="selected"?r.selected=c&&typeof c!="function"&&typeof c!="symbol":yt(r,s,G,c,o,null));return;case"dialog":We("beforetoggle",r),We("toggle",r),We("cancel",r),We("close",r);break;case"iframe":case"object":We("load",r);break;case"video":case"audio":for(c=0;c<Sc.length;c++)We(Sc[c],r);break;case"image":We("error",r),We("load",r);break;case"details":We("toggle",r);break;case"embed":case"source":case"link":We("error",r),We("load",r);case"area":case"base":case"br":case"col":case"hr":case"keygen":case"meta":case"param":case"track":case"wbr":case"menuitem":for(se in o)if(o.hasOwnProperty(se)&&(c=o[se],c!=null))switch(se){case"children":case"dangerouslySetInnerHTML":throw Error(i(137,s));default:yt(r,s,se,c,o,null)}return;default:if(ro(s)){for(pe in o)o.hasOwnProperty(pe)&&(c=o[pe],c!==void 0&&Jm(r,s,pe,c,o,void 0));return}}for(M in o)o.hasOwnProperty(M)&&(c=o[M],c!=null&&yt(r,s,M,c,o,null))}function _A(r,s,o,c){switch(s){case"div":case"span":case"svg":case"path":case"a":case"g":case"p":case"li":break;case"input":var p=null,y=null,E=null,M=null,G=null,se=null,pe=null;for(ue in o){var _e=o[ue];if(o.hasOwnProperty(ue)&&_e!=null)switch(ue){case"checked":break;case"value":break;case"defaultValue":G=_e;default:c.hasOwnProperty(ue)||yt(r,s,ue,null,c,_e)}}for(var oe in c){var ue=c[oe];if(_e=o[oe],c.hasOwnProperty(oe)&&(ue!=null||_e!=null))switch(oe){case"type":y=ue;break;case"name":p=ue;break;case"checked":se=ue;break;case"defaultChecked":pe=ue;break;case"value":E=ue;break;case"defaultValue":M=ue;break;case"children":case"dangerouslySetInnerHTML":if(ue!=null)throw Error(i(137,s));break;default:ue!==_e&&yt(r,s,oe,ue,c,_e)}}no(r,E,M,G,se,pe,y,p);return;case"select":ue=E=M=oe=null;for(y in o)if(G=o[y],o.hasOwnProperty(y)&&G!=null)switch(y){case"value":break;case"multiple":ue=G;default:c.hasOwnProperty(y)||yt(r,s,y,null,c,G)}for(p in c)if(y=c[p],G=o[p],c.hasOwnProperty(p)&&(y!=null||G!=null))switch(p){case"value":oe=y;break;case"defaultValue":M=y;break;case"multiple":E=y;default:y!==G&&yt(r,s,p,y,c,G)}s=M,o=E,c=ue,oe!=null?rs(r,!!o,oe,!1):!!c!=!!o&&(s!=null?rs(r,!!o,s,!0):rs(r,!!o,o?[]:"",!1));return;case"textarea":ue=oe=null;for(M in o)if(p=o[M],o.hasOwnProperty(M)&&p!=null&&!c.hasOwnProperty(M))switch(M){case"value":break;case"children":break;default:yt(r,s,M,null,c,p)}for(E in c)if(p=c[E],y=o[E],c.hasOwnProperty(E)&&(p!=null||y!=null))switch(E){case"value":oe=p;break;case"defaultValue":ue=p;break;case"children":break;case"dangerouslySetInnerHTML":if(p!=null)throw Error(i(91));break;default:p!==y&&yt(r,s,E,p,c,y)}ku(r,oe,ue);return;case"option":for(var Ce in o)oe=o[Ce],o.hasOwnProperty(Ce)&&oe!=null&&!c.hasOwnProperty(Ce)&&(Ce==="selected"?r.selected=!1:yt(r,s,Ce,null,c,oe));for(G in c)oe=c[G],ue=o[G],c.hasOwnProperty(G)&&oe!==ue&&(oe!=null||ue!=null)&&(G==="selected"?r.selected=oe&&typeof oe!="function"&&typeof oe!="symbol":yt(r,s,G,oe,c,ue));return;case"img":case"link":case"area":case"base":case"br":case"col":case"embed":case"hr":case"keygen":case"meta":case"param":case"source":case"track":case"wbr":case"menuitem":for(var Me in o)oe=o[Me],o.hasOwnProperty(Me)&&oe!=null&&!c.hasOwnProperty(Me)&&yt(r,s,Me,null,c,oe);for(se in c)if(oe=c[se],ue=o[se],c.hasOwnProperty(se)&&oe!==ue&&(oe!=null||ue!=null))switch(se){case"children":case"dangerouslySetInnerHTML":if(oe!=null)throw Error(i(137,s));break;default:yt(r,s,se,oe,c,ue)}return;default:if(ro(s)){for(var _t in o)oe=o[_t],o.hasOwnProperty(_t)&&oe!==void 0&&!c.hasOwnProperty(_t)&&Jm(r,s,_t,void 0,c,oe);for(pe in c)oe=c[pe],ue=o[pe],!c.hasOwnProperty(pe)||oe===ue||oe===void 0&&ue===void 0||Jm(r,s,pe,oe,c,ue);return}}for(var J in o)oe=o[J],o.hasOwnProperty(J)&&oe!=null&&!c.hasOwnProperty(J)&&yt(r,s,J,null,c,oe);for(_e in c)oe=c[_e],ue=o[_e],!c.hasOwnProperty(_e)||oe===ue||oe==null&&ue==null||yt(r,s,_e,oe,c,ue)}function jv(r){switch(r){case"css":case"script":case"font":case"img":case"image":case"input":case"link":return!0;default:return!1}}function vA(){if(typeof performance.getEntriesByType=="function"){for(var r=0,s=0,o=performance.getEntriesByType("resource"),c=0;c<o.length;c++){var p=o[c],y=p.transferSize,E=p.initiatorType,M=p.duration;if(y&&M&&jv(E)){for(E=0,M=p.responseEnd,c+=1;c<o.length;c++){var G=o[c],se=G.startTime;if(se>M)break;var pe=G.transferSize,_e=G.initiatorType;pe&&jv(_e)&&(G=G.responseEnd,E+=pe*(G<M?1:(M-se)/(G-se)))}if(--c,s+=8*(y+E)/(p.duration/1e3),r++,10<r)break}}if(0<r)return s/r/1e6}return navigator.connection&&(r=navigator.connection.downlink,typeof r=="number")?r:5}var Zm=null,ep=null;function Ld(r){return r.nodeType===9?r:r.ownerDocument}function Ov(r){switch(r){case"http://www.w3.org/2000/svg":return 1;case"http://www.w3.org/1998/Math/MathML":return 2;default:return 0}}function Mv(r,s){if(r===0)switch(s){case"svg":return 1;case"math":return 2;default:return 0}return r===1&&s==="foreignObject"?0:r}function tp(r,s){return r==="textarea"||r==="noscript"||typeof s.children=="string"||typeof s.children=="number"||typeof s.children=="bigint"||typeof s.dangerouslySetInnerHTML=="object"&&s.dangerouslySetInnerHTML!==null&&s.dangerouslySetInnerHTML.__html!=null}var np=null;function bA(){var r=window.event;return r&&r.type==="popstate"?r===np?!1:(np=r,!0):(np=null,!1)}var kv=typeof setTimeout=="function"?setTimeout:void 0,xA=typeof clearTimeout=="function"?clearTimeout:void 0,Nv=typeof Promise=="function"?Promise:void 0,EA=typeof queueMicrotask=="function"?queueMicrotask:typeof Nv<"u"?function(r){return Nv.resolve(null).then(r).catch(SA)}:kv;function SA(r){setTimeout(function(){throw r})}function Cs(r){return r==="head"}function Pv(r,s){var o=s,c=0;do{var p=o.nextSibling;if(r.removeChild(o),p&&p.nodeType===8)if(o=p.data,o==="/$"||o==="/&"){if(c===0){r.removeChild(p),zo(s);return}c--}else if(o==="$"||o==="$?"||o==="$~"||o==="$!"||o==="&")c++;else if(o==="html")Tc(r.ownerDocument.documentElement);else if(o==="head"){o=r.ownerDocument.head,Tc(o);for(var y=o.firstChild;y;){var E=y.nextSibling,M=y.nodeName;y[Wr]||M==="SCRIPT"||M==="STYLE"||M==="LINK"&&y.rel.toLowerCase()==="stylesheet"||o.removeChild(y),y=E}}else o==="body"&&Tc(r.ownerDocument.body);o=p}while(o);zo(s)}function Lv(r,s){var o=r;r=0;do{var c=o.nextSibling;if(o.nodeType===1?s?(o._stashedDisplay=o.style.display,o.style.display="none"):(o.style.display=o._stashedDisplay||"",o.getAttribute("style")===""&&o.removeAttribute("style")):o.nodeType===3&&(s?(o._stashedText=o.nodeValue,o.nodeValue=""):o.nodeValue=o._stashedText||""),c&&c.nodeType===8)if(o=c.data,o==="/$"){if(r===0)break;r--}else o!=="$"&&o!=="$?"&&o!=="$~"&&o!=="$!"||r++;o=c}while(o)}function rp(r){var s=r.firstChild;for(s&&s.nodeType===10&&(s=s.nextSibling);s;){var o=s;switch(s=s.nextSibling,o.nodeName){case"HTML":case"HEAD":case"BODY":rp(o),eo(o);continue;case"SCRIPT":case"STYLE":continue;case"LINK":if(o.rel.toLowerCase()==="stylesheet")continue}r.removeChild(o)}}function wA(r,s,o,c){for(;r.nodeType===1;){var p=o;if(r.nodeName.toLowerCase()!==s.toLowerCase()){if(!c&&(r.nodeName!=="INPUT"||r.type!=="hidden"))break}else if(c){if(!r[Wr])switch(s){case"meta":if(!r.hasAttribute("itemprop"))break;return r;case"link":if(y=r.getAttribute("rel"),y==="stylesheet"&&r.hasAttribute("data-precedence"))break;if(y!==p.rel||r.getAttribute("href")!==(p.href==null||p.href===""?null:p.href)||r.getAttribute("crossorigin")!==(p.crossOrigin==null?null:p.crossOrigin)||r.getAttribute("title")!==(p.title==null?null:p.title))break;return r;case"style":if(r.hasAttribute("data-precedence"))break;return r;case"script":if(y=r.getAttribute("src"),(y!==(p.src==null?null:p.src)||r.getAttribute("type")!==(p.type==null?null:p.type)||r.getAttribute("crossorigin")!==(p.crossOrigin==null?null:p.crossOrigin))&&y&&r.hasAttribute("async")&&!r.hasAttribute("itemprop"))break;return r;default:return r}}else if(s==="input"&&r.type==="hidden"){var y=p.name==null?null:""+p.name;if(p.type==="hidden"&&r.getAttribute("name")===y)return r}else return r;if(r=vr(r.nextSibling),r===null)break}return null}function TA(r,s,o){if(s==="")return null;for(;r.nodeType!==3;)if((r.nodeType!==1||r.nodeName!=="INPUT"||r.type!=="hidden")&&!o||(r=vr(r.nextSibling),r===null))return null;return r}function Vv(r,s){for(;r.nodeType!==8;)if((r.nodeType!==1||r.nodeName!=="INPUT"||r.type!=="hidden")&&!s||(r=vr(r.nextSibling),r===null))return null;return r}function ip(r){return r.data==="$?"||r.data==="$~"}function sp(r){return r.data==="$!"||r.data==="$?"&&r.ownerDocument.readyState!=="loading"}function AA(r,s){var o=r.ownerDocument;if(r.data==="$~")r._reactRetry=s;else if(r.data!=="$?"||o.readyState!=="loading")s();else{var c=function(){s(),o.removeEventListener("DOMContentLoaded",c)};o.addEventListener("DOMContentLoaded",c),r._reactRetry=c}}function vr(r){for(;r!=null;r=r.nextSibling){var s=r.nodeType;if(s===1||s===3)break;if(s===8){if(s=r.data,s==="$"||s==="$!"||s==="$?"||s==="$~"||s==="&"||s==="F!"||s==="F")break;if(s==="/$"||s==="/&")return null}}return r}var ap=null;function zv(r){r=r.nextSibling;for(var s=0;r;){if(r.nodeType===8){var o=r.data;if(o==="/$"||o==="/&"){if(s===0)return vr(r.nextSibling);s--}else o!=="$"&&o!=="$!"&&o!=="$?"&&o!=="$~"&&o!=="&"||s++}r=r.nextSibling}return null}function Uv(r){r=r.previousSibling;for(var s=0;r;){if(r.nodeType===8){var o=r.data;if(o==="$"||o==="$!"||o==="$?"||o==="$~"||o==="&"){if(s===0)return r;s--}else o!=="/$"&&o!=="/&"||s++}r=r.previousSibling}return null}function Bv(r,s,o){switch(s=Ld(o),r){case"html":if(r=s.documentElement,!r)throw Error(i(452));return r;case"head":if(r=s.head,!r)throw Error(i(453));return r;case"body":if(r=s.body,!r)throw Error(i(454));return r;default:throw Error(i(451))}}function Tc(r){for(var s=r.attributes;s.length;)r.removeAttributeNode(s[0]);eo(r)}var br=new Map,Fv=new Set;function Vd(r){return typeof r.getRootNode=="function"?r.getRootNode():r.nodeType===9?r:r.ownerDocument}var Ui=q.d;q.d={f:CA,r:RA,D:DA,C:IA,L:jA,m:OA,X:kA,S:MA,M:NA};function CA(){var r=Ui.f(),s=Dd();return r||s}function RA(r){var s=cr(r);s!==null&&s.tag===5&&s.type==="form"?s0(s):Ui.r(r)}var Po=typeof document>"u"?null:document;function qv(r,s,o){var c=Po;if(c&&typeof s=="string"&&s){var p=Nn(s);p='link[rel="'+r+'"][href="'+p+'"]',typeof o=="string"&&(p+='[crossorigin="'+o+'"]'),Fv.has(p)||(Fv.add(p),r={rel:r,crossOrigin:o,href:s},c.querySelector(p)===null&&(s=c.createElement("link"),xn(s,"link",r),Qt(s),c.head.appendChild(s)))}}function DA(r){Ui.D(r),qv("dns-prefetch",r,null)}function IA(r,s){Ui.C(r,s),qv("preconnect",r,s)}function jA(r,s,o){Ui.L(r,s,o);var c=Po;if(c&&r&&s){var p='link[rel="preload"][as="'+Nn(s)+'"]';s==="image"&&o&&o.imageSrcSet?(p+='[imagesrcset="'+Nn(o.imageSrcSet)+'"]',typeof o.imageSizes=="string"&&(p+='[imagesizes="'+Nn(o.imageSizes)+'"]')):p+='[href="'+Nn(r)+'"]';var y=p;switch(s){case"style":y=Lo(r);break;case"script":y=Vo(r)}br.has(y)||(r=v({rel:"preload",href:s==="image"&&o&&o.imageSrcSet?void 0:r,as:s},o),br.set(y,r),c.querySelector(p)!==null||s==="style"&&c.querySelector(Ac(y))||s==="script"&&c.querySelector(Cc(y))||(s=c.createElement("link"),xn(s,"link",r),Qt(s),c.head.appendChild(s)))}}function OA(r,s){Ui.m(r,s);var o=Po;if(o&&r){var c=s&&typeof s.as=="string"?s.as:"script",p='link[rel="modulepreload"][as="'+Nn(c)+'"][href="'+Nn(r)+'"]',y=p;switch(c){case"audioworklet":case"paintworklet":case"serviceworker":case"sharedworker":case"worker":case"script":y=Vo(r)}if(!br.has(y)&&(r=v({rel:"modulepreload",href:r},s),br.set(y,r),o.querySelector(p)===null)){switch(c){case"audioworklet":case"paintworklet":case"serviceworker":case"sharedworker":case"worker":case"script":if(o.querySelector(Cc(y)))return}c=o.createElement("link"),xn(c,"link",r),Qt(c),o.head.appendChild(c)}}}function MA(r,s,o){Ui.S(r,s,o);var c=Po;if(c&&r){var p=Xr(c).hoistableStyles,y=Lo(r);s=s||"default";var E=p.get(y);if(!E){var M={loading:0,preload:null};if(E=c.querySelector(Ac(y)))M.loading=5;else{r=v({rel:"stylesheet",href:r,"data-precedence":s},o),(o=br.get(y))&&op(r,o);var G=E=c.createElement("link");Qt(G),xn(G,"link",r),G._p=new Promise(function(se,pe){G.onload=se,G.onerror=pe}),G.addEventListener("load",function(){M.loading|=1}),G.addEventListener("error",function(){M.loading|=2}),M.loading|=4,zd(E,s,c)}E={type:"stylesheet",instance:E,count:1,state:M},p.set(y,E)}}}function kA(r,s){Ui.X(r,s);var o=Po;if(o&&r){var c=Xr(o).hoistableScripts,p=Vo(r),y=c.get(p);y||(y=o.querySelector(Cc(p)),y||(r=v({src:r,async:!0},s),(s=br.get(p))&&lp(r,s),y=o.createElement("script"),Qt(y),xn(y,"link",r),o.head.appendChild(y)),y={type:"script",instance:y,count:1,state:null},c.set(p,y))}}function NA(r,s){Ui.M(r,s);var o=Po;if(o&&r){var c=Xr(o).hoistableScripts,p=Vo(r),y=c.get(p);y||(y=o.querySelector(Cc(p)),y||(r=v({src:r,async:!0,type:"module"},s),(s=br.get(p))&&lp(r,s),y=o.createElement("script"),Qt(y),xn(y,"link",r),o.head.appendChild(y)),y={type:"script",instance:y,count:1,state:null},c.set(p,y))}}function Gv(r,s,o,c){var p=(p=ce.current)?Vd(p):null;if(!p)throw Error(i(446));switch(r){case"meta":case"title":return null;case"style":return typeof o.precedence=="string"&&typeof o.href=="string"?(s=Lo(o.href),o=Xr(p).hoistableStyles,c=o.get(s),c||(c={type:"style",instance:null,count:0,state:null},o.set(s,c)),c):{type:"void",instance:null,count:0,state:null};case"link":if(o.rel==="stylesheet"&&typeof o.href=="string"&&typeof o.precedence=="string"){r=Lo(o.href);var y=Xr(p).hoistableStyles,E=y.get(r);if(E||(p=p.ownerDocument||p,E={type:"stylesheet",instance:null,count:0,state:{loading:0,preload:null}},y.set(r,E),(y=p.querySelector(Ac(r)))&&!y._p&&(E.instance=y,E.state.loading=5),br.has(r)||(o={rel:"preload",as:"style",href:o.href,crossOrigin:o.crossOrigin,integrity:o.integrity,media:o.media,hrefLang:o.hrefLang,referrerPolicy:o.referrerPolicy},br.set(r,o),y||PA(p,r,o,E.state))),s&&c===null)throw Error(i(528,""));return E}if(s&&c!==null)throw Error(i(529,""));return null;case"script":return s=o.async,o=o.src,typeof o=="string"&&s&&typeof s!="function"&&typeof s!="symbol"?(s=Vo(o),o=Xr(p).hoistableScripts,c=o.get(s),c||(c={type:"script",instance:null,count:0,state:null},o.set(s,c)),c):{type:"void",instance:null,count:0,state:null};default:throw Error(i(444,r))}}function Lo(r){return'href="'+Nn(r)+'"'}function Ac(r){return'link[rel="stylesheet"]['+r+"]"}function Hv(r){return v({},r,{"data-precedence":r.precedence,precedence:null})}function PA(r,s,o,c){r.querySelector('link[rel="preload"][as="style"]['+s+"]")?c.loading=1:(s=r.createElement("link"),c.preload=s,s.addEventListener("load",function(){return c.loading|=1}),s.addEventListener("error",function(){return c.loading|=2}),xn(s,"link",o),Qt(s),r.head.appendChild(s))}function Vo(r){return'[src="'+Nn(r)+'"]'}function Cc(r){return"script[async]"+r}function Qv(r,s,o){if(s.count++,s.instance===null)switch(s.type){case"style":var c=r.querySelector('style[data-href~="'+Nn(o.href)+'"]');if(c)return s.instance=c,Qt(c),c;var p=v({},o,{"data-href":o.href,"data-precedence":o.precedence,href:null,precedence:null});return c=(r.ownerDocument||r).createElement("style"),Qt(c),xn(c,"style",p),zd(c,o.precedence,r),s.instance=c;case"stylesheet":p=Lo(o.href);var y=r.querySelector(Ac(p));if(y)return s.state.loading|=4,s.instance=y,Qt(y),y;c=Hv(o),(p=br.get(p))&&op(c,p),y=(r.ownerDocument||r).createElement("link"),Qt(y);var E=y;return E._p=new Promise(function(M,G){E.onload=M,E.onerror=G}),xn(y,"link",c),s.state.loading|=4,zd(y,o.precedence,r),s.instance=y;case"script":return y=Vo(o.src),(p=r.querySelector(Cc(y)))?(s.instance=p,Qt(p),p):(c=o,(p=br.get(y))&&(c=v({},o),lp(c,p)),r=r.ownerDocument||r,p=r.createElement("script"),Qt(p),xn(p,"link",c),r.head.appendChild(p),s.instance=p);case"void":return null;default:throw Error(i(443,s.type))}else s.type==="stylesheet"&&(s.state.loading&4)===0&&(c=s.instance,s.state.loading|=4,zd(c,o.precedence,r));return s.instance}function zd(r,s,o){for(var c=o.querySelectorAll('link[rel="stylesheet"][data-precedence],style[data-precedence]'),p=c.length?c[c.length-1]:null,y=p,E=0;E<c.length;E++){var M=c[E];if(M.dataset.precedence===s)y=M;else if(y!==p)break}y?y.parentNode.insertBefore(r,y.nextSibling):(s=o.nodeType===9?o.head:o,s.insertBefore(r,s.firstChild))}function op(r,s){r.crossOrigin==null&&(r.crossOrigin=s.crossOrigin),r.referrerPolicy==null&&(r.referrerPolicy=s.referrerPolicy),r.title==null&&(r.title=s.title)}function lp(r,s){r.crossOrigin==null&&(r.crossOrigin=s.crossOrigin),r.referrerPolicy==null&&(r.referrerPolicy=s.referrerPolicy),r.integrity==null&&(r.integrity=s.integrity)}var Ud=null;function $v(r,s,o){if(Ud===null){var c=new Map,p=Ud=new Map;p.set(o,c)}else p=Ud,c=p.get(o),c||(c=new Map,p.set(o,c));if(c.has(r))return c;for(c.set(r,null),o=o.getElementsByTagName(r),p=0;p<o.length;p++){var y=o[p];if(!(y[Wr]||y[Ht]||r==="link"&&y.getAttribute("rel")==="stylesheet")&&y.namespaceURI!=="http://www.w3.org/2000/svg"){var E=y.getAttribute(s)||"";E=r+E;var M=c.get(E);M?M.push(y):c.set(E,[y])}}return c}function Kv(r,s,o){r=r.ownerDocument||r,r.head.insertBefore(o,s==="title"?r.querySelector("head > title"):null)}function LA(r,s,o){if(o===1||s.itemProp!=null)return!1;switch(r){case"meta":case"title":return!0;case"style":if(typeof s.precedence!="string"||typeof s.href!="string"||s.href==="")break;return!0;case"link":if(typeof s.rel!="string"||typeof s.href!="string"||s.href===""||s.onLoad||s.onError)break;return s.rel==="stylesheet"?(r=s.disabled,typeof s.precedence=="string"&&r==null):!0;case"script":if(s.async&&typeof s.async!="function"&&typeof s.async!="symbol"&&!s.onLoad&&!s.onError&&s.src&&typeof s.src=="string")return!0}return!1}function Wv(r){return!(r.type==="stylesheet"&&(r.state.loading&3)===0)}function VA(r,s,o,c){if(o.type==="stylesheet"&&(typeof c.media!="string"||matchMedia(c.media).matches!==!1)&&(o.state.loading&4)===0){if(o.instance===null){var p=Lo(c.href),y=s.querySelector(Ac(p));if(y){s=y._p,s!==null&&typeof s=="object"&&typeof s.then=="function"&&(r.count++,r=Bd.bind(r),s.then(r,r)),o.state.loading|=4,o.instance=y,Qt(y);return}y=s.ownerDocument||s,c=Hv(c),(p=br.get(p))&&op(c,p),y=y.createElement("link"),Qt(y);var E=y;E._p=new Promise(function(M,G){E.onload=M,E.onerror=G}),xn(y,"link",c),o.instance=y}r.stylesheets===null&&(r.stylesheets=new Map),r.stylesheets.set(o,s),(s=o.state.preload)&&(o.state.loading&3)===0&&(r.count++,o=Bd.bind(r),s.addEventListener("load",o),s.addEventListener("error",o))}}var cp=0;function zA(r,s){return r.stylesheets&&r.count===0&&qd(r,r.stylesheets),0<r.count||0<r.imgCount?function(o){var c=setTimeout(function(){if(r.stylesheets&&qd(r,r.stylesheets),r.unsuspend){var y=r.unsuspend;r.unsuspend=null,y()}},6e4+s);0<r.imgBytes&&cp===0&&(cp=62500*vA());var p=setTimeout(function(){if(r.waitingForImages=!1,r.count===0&&(r.stylesheets&&qd(r,r.stylesheets),r.unsuspend)){var y=r.unsuspend;r.unsuspend=null,y()}},(r.imgBytes>cp?50:800)+s);return r.unsuspend=o,function(){r.unsuspend=null,clearTimeout(c),clearTimeout(p)}}:null}function Bd(){if(this.count--,this.count===0&&(this.imgCount===0||!this.waitingForImages)){if(this.stylesheets)qd(this,this.stylesheets);else if(this.unsuspend){var r=this.unsuspend;this.unsuspend=null,r()}}}var Fd=null;function qd(r,s){r.stylesheets=null,r.unsuspend!==null&&(r.count++,Fd=new Map,s.forEach(UA,r),Fd=null,Bd.call(r))}function UA(r,s){if(!(s.state.loading&4)){var o=Fd.get(r);if(o)var c=o.get(null);else{o=new Map,Fd.set(r,o);for(var p=r.querySelectorAll("link[data-precedence],style[data-precedence]"),y=0;y<p.length;y++){var E=p[y];(E.nodeName==="LINK"||E.getAttribute("media")!=="not all")&&(o.set(E.dataset.precedence,E),c=E)}c&&o.set(null,c)}p=s.instance,E=p.getAttribute("data-precedence"),y=o.get(E)||c,y===c&&o.set(null,p),o.set(E,p),this.count++,c=Bd.bind(this),p.addEventListener("load",c),p.addEventListener("error",c),y?y.parentNode.insertBefore(p,y.nextSibling):(r=r.nodeType===9?r.head:r,r.insertBefore(p,r.firstChild)),s.state.loading|=4}}var Rc={$$typeof:F,Provider:null,Consumer:null,_currentValue:K,_currentValue2:K,_threadCount:0};function BA(r,s,o,c,p,y,E,M,G){this.tag=1,this.containerInfo=r,this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.next=this.pendingContext=this.context=this.cancelPendingCommit=null,this.callbackPriority=0,this.expirationTimes=$r(-1),this.entangledLanes=this.shellSuspendCounter=this.errorRecoveryDisabledLanes=this.expiredLanes=this.warmLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=$r(0),this.hiddenUpdates=$r(null),this.identifierPrefix=c,this.onUncaughtError=p,this.onCaughtError=y,this.onRecoverableError=E,this.pooledCache=null,this.pooledCacheLanes=0,this.formState=G,this.incompleteTransitions=new Map}function Yv(r,s,o,c,p,y,E,M,G,se,pe,_e){return r=new BA(r,s,o,E,G,se,pe,_e,M),s=1,y===!0&&(s|=24),y=Wn(3,null,null,s),r.current=y,y.stateNode=r,s=Ff(),s.refCount++,r.pooledCache=s,s.refCount++,y.memoizedState={element:c,isDehydrated:o,cache:s},Qf(y),r}function Xv(r){return r?(r=po,r):po}function Jv(r,s,o,c,p,y){p=Xv(p),c.context===null?c.context=p:c.pendingContext=p,c=gs(s),c.payload={element:o},y=y===void 0?null:y,y!==null&&(c.callback=y),o=ys(r,c,s),o!==null&&(Bn(o,r,s),ac(o,r,s))}function Zv(r,s){if(r=r.memoizedState,r!==null&&r.dehydrated!==null){var o=r.retryLane;r.retryLane=o!==0&&o<s?o:s}}function up(r,s){Zv(r,s),(r=r.alternate)&&Zv(r,s)}function eb(r){if(r.tag===13||r.tag===31){var s=ba(r,67108864);s!==null&&Bn(s,r,67108864),up(r,67108864)}}function tb(r){if(r.tag===13||r.tag===31){var s=er();s=la(s);var o=ba(r,s);o!==null&&Bn(o,r,s),up(r,s)}}var Gd=!0;function FA(r,s,o,c){var p=z.T;z.T=null;var y=q.p;try{q.p=2,dp(r,s,o,c)}finally{q.p=y,z.T=p}}function qA(r,s,o,c){var p=z.T;z.T=null;var y=q.p;try{q.p=8,dp(r,s,o,c)}finally{q.p=y,z.T=p}}function dp(r,s,o,c){if(Gd){var p=hp(c);if(p===null)Xm(r,s,c,Hd,o),rb(r,c);else if(HA(p,r,s,o,c))c.stopPropagation();else if(rb(r,c),s&4&&-1<GA.indexOf(r)){for(;p!==null;){var y=cr(p);if(y!==null)switch(y.tag){case 3:if(y=y.stateNode,y.current.memoizedState.isDehydrated){var E=Hr(y.pendingLanes);if(E!==0){var M=y;for(M.pendingLanes|=2,M.entangledLanes|=2;E;){var G=1<<31-Lt(E);M.entanglements[1]|=G,E&=~G}ui(y),(lt&6)===0&&(Cd=$e()+500,Ec(0))}}break;case 31:case 13:M=ba(y,2),M!==null&&Bn(M,y,2),Dd(),up(y,2)}if(y=hp(c),y===null&&Xm(r,s,c,Hd,o),y===p)break;p=y}p!==null&&c.stopPropagation()}else Xm(r,s,c,null,o)}}function hp(r){return r=ur(r),fp(r)}var Hd=null;function fp(r){if(Hd=null,r=Yr(r),r!==null){var s=l(r);if(s===null)r=null;else{var o=s.tag;if(o===13){if(r=u(s),r!==null)return r;r=null}else if(o===31){if(r=h(s),r!==null)return r;r=null}else if(o===3){if(s.stateNode.current.memoizedState.isDehydrated)return s.tag===3?s.stateNode.containerInfo:null;r=null}else s!==r&&(r=null)}}return Hd=r,null}function nb(r){switch(r){case"beforetoggle":case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"toggle":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 2;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 8;case"message":switch(at()){case rt:return 2;case qt:return 8;case pn:case Xa:return 32;case or:return 268435456;default:return 32}default:return 32}}var mp=!1,Rs=null,Ds=null,Is=null,Dc=new Map,Ic=new Map,js=[],GA="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset".split(" ");function rb(r,s){switch(r){case"focusin":case"focusout":Rs=null;break;case"dragenter":case"dragleave":Ds=null;break;case"mouseover":case"mouseout":Is=null;break;case"pointerover":case"pointerout":Dc.delete(s.pointerId);break;case"gotpointercapture":case"lostpointercapture":Ic.delete(s.pointerId)}}function jc(r,s,o,c,p,y){return r===null||r.nativeEvent!==y?(r={blockedOn:s,domEventName:o,eventSystemFlags:c,nativeEvent:y,targetContainers:[p]},s!==null&&(s=cr(s),s!==null&&eb(s)),r):(r.eventSystemFlags|=c,s=r.targetContainers,p!==null&&s.indexOf(p)===-1&&s.push(p),r)}function HA(r,s,o,c,p){switch(s){case"focusin":return Rs=jc(Rs,r,s,o,c,p),!0;case"dragenter":return Ds=jc(Ds,r,s,o,c,p),!0;case"mouseover":return Is=jc(Is,r,s,o,c,p),!0;case"pointerover":var y=p.pointerId;return Dc.set(y,jc(Dc.get(y)||null,r,s,o,c,p)),!0;case"gotpointercapture":return y=p.pointerId,Ic.set(y,jc(Ic.get(y)||null,r,s,o,c,p)),!0}return!1}function ib(r){var s=Yr(r.target);if(s!==null){var o=l(s);if(o!==null){if(s=o.tag,s===13){if(s=u(o),s!==null){r.blockedOn=s,Cr(r.priority,function(){tb(o)});return}}else if(s===31){if(s=h(o),s!==null){r.blockedOn=s,Cr(r.priority,function(){tb(o)});return}}else if(s===3&&o.stateNode.current.memoizedState.isDehydrated){r.blockedOn=o.tag===3?o.stateNode.containerInfo:null;return}}}r.blockedOn=null}function Qd(r){if(r.blockedOn!==null)return!1;for(var s=r.targetContainers;0<s.length;){var o=hp(r.nativeEvent);if(o===null){o=r.nativeEvent;var c=new o.constructor(o.type,o);Gl=c,o.target.dispatchEvent(c),Gl=null}else return s=cr(o),s!==null&&eb(s),r.blockedOn=o,!1;s.shift()}return!0}function sb(r,s,o){Qd(r)&&o.delete(s)}function QA(){mp=!1,Rs!==null&&Qd(Rs)&&(Rs=null),Ds!==null&&Qd(Ds)&&(Ds=null),Is!==null&&Qd(Is)&&(Is=null),Dc.forEach(sb),Ic.forEach(sb)}function $d(r,s){r.blockedOn===s&&(r.blockedOn=null,mp||(mp=!0,t.unstable_scheduleCallback(t.unstable_NormalPriority,QA)))}var Kd=null;function ab(r){Kd!==r&&(Kd=r,t.unstable_scheduleCallback(t.unstable_NormalPriority,function(){Kd===r&&(Kd=null);for(var s=0;s<r.length;s+=3){var o=r[s],c=r[s+1],p=r[s+2];if(typeof c!="function"){if(fp(c||o)===null)continue;break}var y=cr(o);y!==null&&(r.splice(s,3),s-=3,hm(y,{pending:!0,data:p,method:o.method,action:c},c,p))}}))}function zo(r){function s(G){return $d(G,r)}Rs!==null&&$d(Rs,r),Ds!==null&&$d(Ds,r),Is!==null&&$d(Is,r),Dc.forEach(s),Ic.forEach(s);for(var o=0;o<js.length;o++){var c=js[o];c.blockedOn===r&&(c.blockedOn=null)}for(;0<js.length&&(o=js[0],o.blockedOn===null);)ib(o),o.blockedOn===null&&js.shift();if(o=(r.ownerDocument||r).$$reactFormReplay,o!=null)for(c=0;c<o.length;c+=3){var p=o[c],y=o[c+1],E=p[cn]||null;if(typeof y=="function")E||ab(o);else if(E){var M=null;if(y&&y.hasAttribute("formAction")){if(p=y,E=y[cn]||null)M=E.formAction;else if(fp(p)!==null)continue}else M=E.action;typeof M=="function"?o[c+1]=M:(o.splice(c,3),c-=3),ab(o)}}}function ob(){function r(y){y.canIntercept&&y.info==="react-transition"&&y.intercept({handler:function(){return new Promise(function(E){return p=E})},focusReset:"manual",scroll:"manual"})}function s(){p!==null&&(p(),p=null),c||setTimeout(o,20)}function o(){if(!c&&!navigation.transition){var y=navigation.currentEntry;y&&y.url!=null&&navigation.navigate(y.url,{state:y.getState(),info:"react-transition",history:"replace"})}}if(typeof navigation=="object"){var c=!1,p=null;return navigation.addEventListener("navigate",r),navigation.addEventListener("navigatesuccess",s),navigation.addEventListener("navigateerror",s),setTimeout(o,100),function(){c=!0,navigation.removeEventListener("navigate",r),navigation.removeEventListener("navigatesuccess",s),navigation.removeEventListener("navigateerror",s),p!==null&&(p(),p=null)}}}function pp(r){this._internalRoot=r}Wd.prototype.render=pp.prototype.render=function(r){var s=this._internalRoot;if(s===null)throw Error(i(409));var o=s.current,c=er();Jv(o,c,r,s,null,null)},Wd.prototype.unmount=pp.prototype.unmount=function(){var r=this._internalRoot;if(r!==null){this._internalRoot=null;var s=r.containerInfo;Jv(r.current,2,null,r,null,null),Dd(),s[Kr]=null}};function Wd(r){this._internalRoot=r}Wd.prototype.unstable_scheduleHydration=function(r){if(r){var s=Du();r={blockedOn:null,target:r,priority:s};for(var o=0;o<js.length&&s!==0&&s<js[o].priority;o++);js.splice(o,0,r),o===0&&ib(r)}};var lb=e.version;if(lb!=="19.2.3")throw Error(i(527,lb,"19.2.3"));q.findDOMNode=function(r){var s=r._reactInternals;if(s===void 0)throw typeof r.render=="function"?Error(i(188)):(r=Object.keys(r).join(","),Error(i(268,r)));return r=g(s),r=r!==null?_(r):null,r=r===null?null:r.stateNode,r};var $A={bundleType:0,version:"19.2.3",rendererPackageName:"react-dom",currentDispatcherRef:z,reconcilerVersion:"19.2.3"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var Yd=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!Yd.isDisabled&&Yd.supportsFiber)try{Tr=Yd.inject($A),gn=Yd}catch{}}return Mc.createRoot=function(r,s){if(!a(r))throw Error(i(299));var o=!1,c="",p=p0,y=g0,E=y0;return s!=null&&(s.unstable_strictMode===!0&&(o=!0),s.identifierPrefix!==void 0&&(c=s.identifierPrefix),s.onUncaughtError!==void 0&&(p=s.onUncaughtError),s.onCaughtError!==void 0&&(y=s.onCaughtError),s.onRecoverableError!==void 0&&(E=s.onRecoverableError)),s=Yv(r,1,!1,null,null,o,c,null,p,y,E,ob),r[Kr]=s.current,Ym(r),new pp(s)},Mc.hydrateRoot=function(r,s,o){if(!a(r))throw Error(i(299));var c=!1,p="",y=p0,E=g0,M=y0,G=null;return o!=null&&(o.unstable_strictMode===!0&&(c=!0),o.identifierPrefix!==void 0&&(p=o.identifierPrefix),o.onUncaughtError!==void 0&&(y=o.onUncaughtError),o.onCaughtError!==void 0&&(E=o.onCaughtError),o.onRecoverableError!==void 0&&(M=o.onRecoverableError),o.formState!==void 0&&(G=o.formState)),s=Yv(r,1,!0,s,o??null,c,p,G,y,E,M,ob),s.context=Xv(null),o=s.current,c=er(),c=la(c),p=gs(c),p.callback=null,ys(o,p,c),o=c,s.current.lanes=o,aa(s,o),ui(s),r[Kr]=s.current,Ym(r),new Wd(s)},Mc.version="19.2.3",Mc}var _b;function rC(){if(_b)return _p.exports;_b=1;function t(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(t)}catch(e){console.error(e)}}return t(),_p.exports=nC(),_p.exports}var iC=rC();var vb="popstate";function sC(t={}){function e(i,a){let{pathname:l,search:u,hash:h}=i.location;return zp("",{pathname:l,search:u,hash:h},a.state&&a.state.usr||null,a.state&&a.state.key||"default")}function n(i,a){return typeof a=="string"?a:Kc(a)}return oC(e,n,null,t)}function Rt(t,e){if(t===!1||t===null||typeof t>"u")throw new Error(e)}function nr(t,e){if(!t){typeof console<"u"&&console.warn(e);try{throw new Error(e)}catch{}}}function aC(){return Math.random().toString(36).substring(2,10)}function bb(t,e){return{usr:t.state,key:t.key,idx:e}}function zp(t,e,n=null,i){return{pathname:typeof t=="string"?t:t.pathname,search:"",hash:"",...typeof e=="string"?fl(e):e,state:n,key:e&&e.key||i||aC()}}function Kc({pathname:t="/",search:e="",hash:n=""}){return e&&e!=="?"&&(t+=e.charAt(0)==="?"?e:"?"+e),n&&n!=="#"&&(t+=n.charAt(0)==="#"?n:"#"+n),t}function fl(t){let e={};if(t){let n=t.indexOf("#");n>=0&&(e.hash=t.substring(n),t=t.substring(0,n));let i=t.indexOf("?");i>=0&&(e.search=t.substring(i),t=t.substring(0,i)),t&&(e.pathname=t)}return e}function oC(t,e,n,i={}){let{window:a=document.defaultView,v5Compat:l=!1}=i,u=a.history,h="POP",m=null,g=_();g==null&&(g=0,u.replaceState({...u.state,idx:g},""));function _(){return(u.state||{idx:null}).idx}function v(){h="POP";let N=_(),B=N==null?null:N-g;g=N,m&&m({action:h,location:R.location,delta:B})}function b(N,B){h="PUSH";let H=zp(R.location,N,B);g=_()+1;let F=bb(H,g),ae=R.createHref(H);try{u.pushState(F,"",ae)}catch(te){if(te instanceof DOMException&&te.name==="DataCloneError")throw te;a.location.assign(ae)}l&&m&&m({action:h,location:R.location,delta:1})}function w(N,B){h="REPLACE";let H=zp(R.location,N,B);g=_();let F=bb(H,g),ae=R.createHref(H);u.replaceState(F,"",ae),l&&m&&m({action:h,location:R.location,delta:0})}function C(N){return lC(N)}let R={get action(){return h},get location(){return t(a,u)},listen(N){if(m)throw new Error("A history only accepts one active listener");return a.addEventListener(vb,v),m=N,()=>{a.removeEventListener(vb,v),m=null}},createHref(N){return e(a,N)},createURL:C,encodeLocation(N){let B=C(N);return{pathname:B.pathname,search:B.search,hash:B.hash}},push:b,replace:w,go(N){return u.go(N)}};return R}function lC(t,e=!1){let n="http://localhost";typeof window<"u"&&(n=window.location.origin!=="null"?window.location.origin:window.location.href),Rt(n,"No window.location.(origin|href) available to create URL");let i=typeof t=="string"?t:Kc(t);return i=i.replace(/ $/,"%20"),!e&&i.startsWith("//")&&(i=n+i),new URL(i,n)}function GE(t,e,n="/"){return cC(t,e,n,!1)}function cC(t,e,n,i){let a=typeof e=="string"?fl(e):e,l=Qi(a.pathname||"/",n);if(l==null)return null;let u=HE(t);uC(u);let h=null;for(let m=0;h==null&&m<u.length;++m){let g=xC(l);h=vC(u[m],g,i)}return h}function HE(t,e=[],n=[],i="",a=!1){let l=(u,h,m=a,g)=>{let _={relativePath:g===void 0?u.path||"":g,caseSensitive:u.caseSensitive===!0,childrenIndex:h,route:u};if(_.relativePath.startsWith("/")){if(!_.relativePath.startsWith(i)&&m)return;Rt(_.relativePath.startsWith(i),`Absolute route path "${_.relativePath}" nested under path "${i}" is not valid. An absolute child route path must start with the combined path of all its parent routes.`),_.relativePath=_.relativePath.slice(i.length)}let v=Gi([i,_.relativePath]),b=n.concat(_);u.children&&u.children.length>0&&(Rt(u.index!==!0,`Index routes must not have child routes. Please remove all child routes from route path "${v}".`),HE(u.children,e,b,v,m)),!(u.path==null&&!u.index)&&e.push({path:v,score:yC(v,u.index),routesMeta:b})};return t.forEach((u,h)=>{if(u.path===""||!u.path?.includes("?"))l(u,h);else for(let m of QE(u.path))l(u,h,!0,m)}),e}function QE(t){let e=t.split("/");if(e.length===0)return[];let[n,...i]=e,a=n.endsWith("?"),l=n.replace(/\?$/,"");if(i.length===0)return a?[l,""]:[l];let u=QE(i.join("/")),h=[];return h.push(...u.map(m=>m===""?l:[l,m].join("/"))),a&&h.push(...u),h.map(m=>t.startsWith("/")&&m===""?"/":m)}function uC(t){t.sort((e,n)=>e.score!==n.score?n.score-e.score:_C(e.routesMeta.map(i=>i.childrenIndex),n.routesMeta.map(i=>i.childrenIndex)))}var dC=/^:[\w-]+$/,hC=3,fC=2,mC=1,pC=10,gC=-2,xb=t=>t==="*";function yC(t,e){let n=t.split("/"),i=n.length;return n.some(xb)&&(i+=gC),e&&(i+=fC),n.filter(a=>!xb(a)).reduce((a,l)=>a+(dC.test(l)?hC:l===""?mC:pC),i)}function _C(t,e){return t.length===e.length&&t.slice(0,-1).every((i,a)=>i===e[a])?t[t.length-1]-e[e.length-1]:0}function vC(t,e,n=!1){let{routesMeta:i}=t,a={},l="/",u=[];for(let h=0;h<i.length;++h){let m=i[h],g=h===i.length-1,_=l==="/"?e:e.slice(l.length)||"/",v=vh({path:m.relativePath,caseSensitive:m.caseSensitive,end:g},_),b=m.route;if(!v&&g&&n&&!i[i.length-1].route.index&&(v=vh({path:m.relativePath,caseSensitive:m.caseSensitive,end:!1},_)),!v)return null;Object.assign(a,v.params),u.push({params:a,pathname:Gi([l,v.pathname]),pathnameBase:TC(Gi([l,v.pathnameBase])),route:b}),v.pathnameBase!=="/"&&(l=Gi([l,v.pathnameBase]))}return u}function vh(t,e){typeof t=="string"&&(t={path:t,caseSensitive:!1,end:!0});let[n,i]=bC(t.path,t.caseSensitive,t.end),a=e.match(n);if(!a)return null;let l=a[0],u=l.replace(/(.)\/+$/,"$1"),h=a.slice(1);return{params:i.reduce((g,{paramName:_,isOptional:v},b)=>{if(_==="*"){let C=h[b]||"";u=l.slice(0,l.length-C.length).replace(/(.)\/+$/,"$1")}const w=h[b];return v&&!w?g[_]=void 0:g[_]=(w||"").replace(/%2F/g,"/"),g},{}),pathname:l,pathnameBase:u,pattern:t}}function bC(t,e=!1,n=!0){nr(t==="*"||!t.endsWith("*")||t.endsWith("/*"),`Route path "${t}" will be treated as if it were "${t.replace(/\*$/,"/*")}" because the \`*\` character must always follow a \`/\` in the pattern. To get rid of this warning, please change the route path to "${t.replace(/\*$/,"/*")}".`);let i=[],a="^"+t.replace(/\/*\*?$/,"").replace(/^\/*/,"/").replace(/[\\.*+^${}|()[\]]/g,"\\$&").replace(/\/:([\w-]+)(\?)?/g,(u,h,m)=>(i.push({paramName:h,isOptional:m!=null}),m?"/?([^\\/]+)?":"/([^\\/]+)")).replace(/\/([\w-]+)\?(\/|$)/g,"(/$1)?$2");return t.endsWith("*")?(i.push({paramName:"*"}),a+=t==="*"||t==="/*"?"(.*)$":"(?:\\/(.+)|\\/*)$"):n?a+="\\/*$":t!==""&&t!=="/"&&(a+="(?:(?=\\/|$))"),[new RegExp(a,e?void 0:"i"),i]}function xC(t){try{return t.split("/").map(e=>decodeURIComponent(e).replace(/\//g,"%2F")).join("/")}catch(e){return nr(!1,`The URL path "${t}" could not be decoded because it is a malformed URL segment. This is probably due to a bad percent encoding (${e}).`),t}}function Qi(t,e){if(e==="/")return t;if(!t.toLowerCase().startsWith(e.toLowerCase()))return null;let n=e.endsWith("/")?e.length-1:e.length,i=t.charAt(n);return i&&i!=="/"?null:t.slice(n)||"/"}var $E=/^(?:[a-z][a-z0-9+.-]*:|\/\/)/i,EC=t=>$E.test(t);function SC(t,e="/"){let{pathname:n,search:i="",hash:a=""}=typeof t=="string"?fl(t):t,l;if(n)if(EC(n))l=n;else{if(n.includes("//")){let u=n;n=n.replace(/\/\/+/g,"/"),nr(!1,`Pathnames cannot have embedded double slashes - normalizing ${u} -> ${n}`)}n.startsWith("/")?l=Eb(n.substring(1),"/"):l=Eb(n,e)}else l=e;return{pathname:l,search:AC(i),hash:CC(a)}}function Eb(t,e){let n=e.replace(/\/+$/,"").split("/");return t.split("/").forEach(a=>{a===".."?n.length>1&&n.pop():a!=="."&&n.push(a)}),n.length>1?n.join("/"):"/"}function Ep(t,e,n,i){return`Cannot include a '${t}' character in a manually specified \`to.${e}\` field [${JSON.stringify(i)}].  Please separate it out to the \`to.${n}\` field. Alternatively you may provide the full path as a string in <Link to="..."> and the router will parse it for you.`}function wC(t){return t.filter((e,n)=>n===0||e.route.path&&e.route.path.length>0)}function Cg(t){let e=wC(t);return e.map((n,i)=>i===e.length-1?n.pathname:n.pathnameBase)}function Rg(t,e,n,i=!1){let a;typeof t=="string"?a=fl(t):(a={...t},Rt(!a.pathname||!a.pathname.includes("?"),Ep("?","pathname","search",a)),Rt(!a.pathname||!a.pathname.includes("#"),Ep("#","pathname","hash",a)),Rt(!a.search||!a.search.includes("#"),Ep("#","search","hash",a)));let l=t===""||a.pathname==="",u=l?"/":a.pathname,h;if(u==null)h=n;else{let v=e.length-1;if(!i&&u.startsWith("..")){let b=u.split("/");for(;b[0]==="..";)b.shift(),v-=1;a.pathname=b.join("/")}h=v>=0?e[v]:"/"}let m=SC(a,h),g=u&&u!=="/"&&u.endsWith("/"),_=(l||u===".")&&n.endsWith("/");return!m.pathname.endsWith("/")&&(g||_)&&(m.pathname+="/"),m}var Gi=t=>t.join("/").replace(/\/\/+/g,"/"),TC=t=>t.replace(/\/+$/,"").replace(/^\/*/,"/"),AC=t=>!t||t==="?"?"":t.startsWith("?")?t:"?"+t,CC=t=>!t||t==="#"?"":t.startsWith("#")?t:"#"+t,RC=class{constructor(t,e,n,i=!1){this.status=t,this.statusText=e||"",this.internal=i,n instanceof Error?(this.data=n.toString(),this.error=n):this.data=n}};function DC(t){return t!=null&&typeof t.status=="number"&&typeof t.statusText=="string"&&typeof t.internal=="boolean"&&"data"in t}function IC(t){return t.map(e=>e.route.path).filter(Boolean).join("/").replace(/\/\/*/g,"/")||"/"}var KE=typeof window<"u"&&typeof window.document<"u"&&typeof window.document.createElement<"u";function WE(t,e){let n=t;if(typeof n!="string"||!$E.test(n))return{absoluteURL:void 0,isExternal:!1,to:n};let i=n,a=!1;if(KE)try{let l=new URL(window.location.href),u=n.startsWith("//")?new URL(l.protocol+n):new URL(n),h=Qi(u.pathname,e);u.origin===l.origin&&h!=null?n=h+u.search+u.hash:a=!0}catch{nr(!1,`<Link to="${n}"> contains an invalid URL which will probably break when clicked - please update to a valid URL path.`)}return{absoluteURL:i,isExternal:a,to:n}}Object.getOwnPropertyNames(Object.prototype).sort().join("\0");var YE=["POST","PUT","PATCH","DELETE"];new Set(YE);var jC=["GET",...YE];new Set(jC);var ml=A.createContext(null);ml.displayName="DataRouter";var Gh=A.createContext(null);Gh.displayName="DataRouterState";var OC=A.createContext(!1),XE=A.createContext({isTransitioning:!1});XE.displayName="ViewTransition";var MC=A.createContext(new Map);MC.displayName="Fetchers";var kC=A.createContext(null);kC.displayName="Await";var rr=A.createContext(null);rr.displayName="Navigation";var au=A.createContext(null);au.displayName="Location";var wr=A.createContext({outlet:null,matches:[],isDataRoute:!1});wr.displayName="Route";var Dg=A.createContext(null);Dg.displayName="RouteError";var JE="REACT_ROUTER_ERROR",NC="REDIRECT",PC="ROUTE_ERROR_RESPONSE";function LC(t){if(t.startsWith(`${JE}:${NC}:{`))try{let e=JSON.parse(t.slice(28));if(typeof e=="object"&&e&&typeof e.status=="number"&&typeof e.statusText=="string"&&typeof e.location=="string"&&typeof e.reloadDocument=="boolean"&&typeof e.replace=="boolean")return e}catch{}}function VC(t){if(t.startsWith(`${JE}:${PC}:{`))try{let e=JSON.parse(t.slice(40));if(typeof e=="object"&&e&&typeof e.status=="number"&&typeof e.statusText=="string")return new RC(e.status,e.statusText,e.data)}catch{}}function zC(t,{relative:e}={}){Rt(pl(),"useHref() may be used only in the context of a <Router> component.");let{basename:n,navigator:i}=A.useContext(rr),{hash:a,pathname:l,search:u}=lu(t,{relative:e}),h=l;return n!=="/"&&(h=l==="/"?n:Gi([n,l])),i.createHref({pathname:h,search:u,hash:a})}function pl(){return A.useContext(au)!=null}function kn(){return Rt(pl(),"useLocation() may be used only in the context of a <Router> component."),A.useContext(au).location}var ZE="You should call navigate() in a React.useEffect(), not when your component is first rendered.";function eS(t){A.useContext(rr).static||A.useLayoutEffect(t)}function ou(){let{isDataRoute:t}=A.useContext(wr);return t?tR():UC()}function UC(){Rt(pl(),"useNavigate() may be used only in the context of a <Router> component.");let t=A.useContext(ml),{basename:e,navigator:n}=A.useContext(rr),{matches:i}=A.useContext(wr),{pathname:a}=kn(),l=JSON.stringify(Cg(i)),u=A.useRef(!1);return eS(()=>{u.current=!0}),A.useCallback((m,g={})=>{if(nr(u.current,ZE),!u.current)return;if(typeof m=="number"){n.go(m);return}let _=Rg(m,JSON.parse(l),a,g.relative==="path");t==null&&e!=="/"&&(_.pathname=_.pathname==="/"?e:Gi([e,_.pathname])),(g.replace?n.replace:n.push)(_,g.state,g)},[e,n,l,a,t])}var BC=A.createContext(null);function FC(t){let e=A.useContext(wr).outlet;return A.useMemo(()=>e&&A.createElement(BC.Provider,{value:t},e),[e,t])}function qC(){let{matches:t}=A.useContext(wr),e=t[t.length-1];return e?e.params:{}}function lu(t,{relative:e}={}){let{matches:n}=A.useContext(wr),{pathname:i}=kn(),a=JSON.stringify(Cg(n));return A.useMemo(()=>Rg(t,JSON.parse(a),i,e==="path"),[t,a,i,e])}function GC(t,e){return tS(t,e)}function tS(t,e,n,i,a){Rt(pl(),"useRoutes() may be used only in the context of a <Router> component.");let{navigator:l}=A.useContext(rr),{matches:u}=A.useContext(wr),h=u[u.length-1],m=h?h.params:{},g=h?h.pathname:"/",_=h?h.pathnameBase:"/",v=h&&h.route;{let H=v&&v.path||"";rS(g,!v||H.endsWith("*")||H.endsWith("*?"),`You rendered descendant <Routes> (or called \`useRoutes()\`) at "${g}" (under <Route path="${H}">) but the parent route path has no trailing "*". This means if you navigate deeper, the parent won't match anymore and therefore the child routes will never render.

Please change the parent <Route path="${H}"> to <Route path="${H==="/"?"*":`${H}/*`}">.`)}let b=kn(),w;if(e){let H=typeof e=="string"?fl(e):e;Rt(_==="/"||H.pathname?.startsWith(_),`When overriding the location using \`<Routes location>\` or \`useRoutes(routes, location)\`, the location pathname must begin with the portion of the URL pathname that was matched by all parent routes. The current pathname base is "${_}" but pathname "${H.pathname}" was given in the \`location\` prop.`),w=H}else w=b;let C=w.pathname||"/",R=C;if(_!=="/"){let H=_.replace(/^\//,"").split("/");R="/"+C.replace(/^\//,"").split("/").slice(H.length).join("/")}let N=GE(t,{pathname:R});nr(v||N!=null,`No routes matched location "${w.pathname}${w.search}${w.hash}" `),nr(N==null||N[N.length-1].route.element!==void 0||N[N.length-1].route.Component!==void 0||N[N.length-1].route.lazy!==void 0,`Matched leaf route at location "${w.pathname}${w.search}${w.hash}" does not have an element or Component. This means it will render an <Outlet /> with a null value by default resulting in an "empty" page.`);let B=WC(N&&N.map(H=>Object.assign({},H,{params:Object.assign({},m,H.params),pathname:Gi([_,l.encodeLocation?l.encodeLocation(H.pathname.replace(/\?/g,"%3F").replace(/#/g,"%23")).pathname:H.pathname]),pathnameBase:H.pathnameBase==="/"?_:Gi([_,l.encodeLocation?l.encodeLocation(H.pathnameBase.replace(/\?/g,"%3F").replace(/#/g,"%23")).pathname:H.pathnameBase])})),u,n,i,a);return e&&B?A.createElement(au.Provider,{value:{location:{pathname:"/",search:"",hash:"",state:null,key:"default",...w},navigationType:"POP"}},B):B}function HC(){let t=eR(),e=DC(t)?`${t.status} ${t.statusText}`:t instanceof Error?t.message:JSON.stringify(t),n=t instanceof Error?t.stack:null,i="rgba(200,200,200, 0.5)",a={padding:"0.5rem",backgroundColor:i},l={padding:"2px 4px",backgroundColor:i},u=null;return console.error("Error handled by React Router default ErrorBoundary:",t),u=A.createElement(A.Fragment,null,A.createElement("p",null," Hey developer "),A.createElement("p",null,"You can provide a way better UX than this when your app throws errors by providing your own ",A.createElement("code",{style:l},"ErrorBoundary")," or"," ",A.createElement("code",{style:l},"errorElement")," prop on your route.")),A.createElement(A.Fragment,null,A.createElement("h2",null,"Unexpected Application Error!"),A.createElement("h3",{style:{fontStyle:"italic"}},e),n?A.createElement("pre",{style:a},n):null,u)}var QC=A.createElement(HC,null),nS=class extends A.Component{constructor(t){super(t),this.state={location:t.location,revalidation:t.revalidation,error:t.error}}static getDerivedStateFromError(t){return{error:t}}static getDerivedStateFromProps(t,e){return e.location!==t.location||e.revalidation!=="idle"&&t.revalidation==="idle"?{error:t.error,location:t.location,revalidation:t.revalidation}:{error:t.error!==void 0?t.error:e.error,location:e.location,revalidation:t.revalidation||e.revalidation}}componentDidCatch(t,e){this.props.onError?this.props.onError(t,e):console.error("React Router caught the following error during render",t)}render(){let t=this.state.error;if(this.context&&typeof t=="object"&&t&&"digest"in t&&typeof t.digest=="string"){const n=VC(t.digest);n&&(t=n)}let e=t!==void 0?A.createElement(wr.Provider,{value:this.props.routeContext},A.createElement(Dg.Provider,{value:t,children:this.props.component})):this.props.children;return this.context?A.createElement($C,{error:t},e):e}};nS.contextType=OC;var Sp=new WeakMap;function $C({children:t,error:e}){let{basename:n}=A.useContext(rr);if(typeof e=="object"&&e&&"digest"in e&&typeof e.digest=="string"){let i=LC(e.digest);if(i){let a=Sp.get(e);if(a)throw a;let l=WE(i.location,n);if(KE&&!Sp.get(e))if(l.isExternal||i.reloadDocument)window.location.href=l.absoluteURL||l.to;else{const u=Promise.resolve().then(()=>window.__reactRouterDataRouter.navigate(l.to,{replace:i.replace}));throw Sp.set(e,u),u}return A.createElement("meta",{httpEquiv:"refresh",content:`0;url=${l.absoluteURL||l.to}`})}}return t}function KC({routeContext:t,match:e,children:n}){let i=A.useContext(ml);return i&&i.static&&i.staticContext&&(e.route.errorElement||e.route.ErrorBoundary)&&(i.staticContext._deepestRenderedBoundaryId=e.route.id),A.createElement(wr.Provider,{value:t},n)}function WC(t,e=[],n=null,i=null,a=null){if(t==null){if(!n)return null;if(n.errors)t=n.matches;else if(e.length===0&&!n.initialized&&n.matches.length>0)t=n.matches;else return null}let l=t,u=n?.errors;if(u!=null){let _=l.findIndex(v=>v.route.id&&u?.[v.route.id]!==void 0);Rt(_>=0,`Could not find a matching route for errors on route IDs: ${Object.keys(u).join(",")}`),l=l.slice(0,Math.min(l.length,_+1))}let h=!1,m=-1;if(n)for(let _=0;_<l.length;_++){let v=l[_];if((v.route.HydrateFallback||v.route.hydrateFallbackElement)&&(m=_),v.route.id){let{loaderData:b,errors:w}=n,C=v.route.loader&&!b.hasOwnProperty(v.route.id)&&(!w||w[v.route.id]===void 0);if(v.route.lazy||C){h=!0,m>=0?l=l.slice(0,m+1):l=[l[0]];break}}}let g=n&&i?(_,v)=>{i(_,{location:n.location,params:n.matches?.[0]?.params??{},unstable_pattern:IC(n.matches),errorInfo:v})}:void 0;return l.reduceRight((_,v,b)=>{let w,C=!1,R=null,N=null;n&&(w=u&&v.route.id?u[v.route.id]:void 0,R=v.route.errorElement||QC,h&&(m<0&&b===0?(rS("route-fallback",!1,"No `HydrateFallback` element provided to render during initial hydration"),C=!0,N=null):m===b&&(C=!0,N=v.route.hydrateFallbackElement||null)));let B=e.concat(l.slice(0,b+1)),H=()=>{let F;return w?F=R:C?F=N:v.route.Component?F=A.createElement(v.route.Component,null):v.route.element?F=v.route.element:F=_,A.createElement(KC,{match:v,routeContext:{outlet:_,matches:B,isDataRoute:n!=null},children:F})};return n&&(v.route.ErrorBoundary||v.route.errorElement||b===0)?A.createElement(nS,{location:n.location,revalidation:n.revalidation,component:R,error:w,children:H(),routeContext:{outlet:null,matches:B,isDataRoute:!0},onError:g}):H()},null)}function Ig(t){return`${t} must be used within a data router.  See https://reactrouter.com/en/main/routers/picking-a-router.`}function YC(t){let e=A.useContext(ml);return Rt(e,Ig(t)),e}function XC(t){let e=A.useContext(Gh);return Rt(e,Ig(t)),e}function JC(t){let e=A.useContext(wr);return Rt(e,Ig(t)),e}function jg(t){let e=JC(t),n=e.matches[e.matches.length-1];return Rt(n.route.id,`${t} can only be used on routes that contain a unique "id"`),n.route.id}function ZC(){return jg("useRouteId")}function eR(){let t=A.useContext(Dg),e=XC("useRouteError"),n=jg("useRouteError");return t!==void 0?t:e.errors?.[n]}function tR(){let{router:t}=YC("useNavigate"),e=jg("useNavigate"),n=A.useRef(!1);return eS(()=>{n.current=!0}),A.useCallback(async(a,l={})=>{nr(n.current,ZE),n.current&&(typeof a=="number"?await t.navigate(a):await t.navigate(a,{fromRouteId:e,...l}))},[t,e])}var Sb={};function rS(t,e,n){!e&&!Sb[t]&&(Sb[t]=!0,nr(!1,n))}A.memo(nR);function nR({routes:t,future:e,state:n,onError:i}){return tS(t,void 0,n,i,e)}function Hh({to:t,replace:e,state:n,relative:i}){Rt(pl(),"<Navigate> may be used only in the context of a <Router> component.");let{static:a}=A.useContext(rr);nr(!a,"<Navigate> must not be used on the initial render in a <StaticRouter>. This is a no-op, but you should modify your code so the <Navigate> is only ever rendered in response to some user interaction or state change.");let{matches:l}=A.useContext(wr),{pathname:u}=kn(),h=ou(),m=Rg(t,Cg(l),u,i==="path"),g=JSON.stringify(m);return A.useEffect(()=>{h(JSON.parse(g),{replace:e,state:n,relative:i})},[h,g,i,e,n]),null}function Qh(t){return FC(t.context)}function Jt(t){Rt(!1,"A <Route> is only ever to be used as the child of <Routes> element, never rendered directly. Please wrap your <Route> in a <Routes>.")}function rR({basename:t="/",children:e=null,location:n,navigationType:i="POP",navigator:a,static:l=!1,unstable_useTransitions:u}){Rt(!pl(),"You cannot render a <Router> inside another <Router>. You should never have more than one in your app.");let h=t.replace(/^\/*/,"/"),m=A.useMemo(()=>({basename:h,navigator:a,static:l,unstable_useTransitions:u,future:{}}),[h,a,l,u]);typeof n=="string"&&(n=fl(n));let{pathname:g="/",search:_="",hash:v="",state:b=null,key:w="default"}=n,C=A.useMemo(()=>{let R=Qi(g,h);return R==null?null:{location:{pathname:R,search:_,hash:v,state:b,key:w},navigationType:i}},[h,g,_,v,b,w,i]);return nr(C!=null,`<Router basename="${h}"> is not able to match the URL "${g}${_}${v}" because it does not start with the basename, so the <Router> won't render anything.`),C==null?null:A.createElement(rr.Provider,{value:m},A.createElement(au.Provider,{children:e,value:C}))}function iR({children:t,location:e}){return GC(Up(t),e)}function Up(t,e=[]){let n=[];return A.Children.forEach(t,(i,a)=>{if(!A.isValidElement(i))return;let l=[...e,a];if(i.type===A.Fragment){n.push.apply(n,Up(i.props.children,l));return}Rt(i.type===Jt,`[${typeof i.type=="string"?i.type:i.type.name}] is not a <Route> component. All component children of <Routes> must be a <Route> or <React.Fragment>`),Rt(!i.props.index||!i.props.children,"An index route cannot have child routes.");let u={id:i.props.id||l.join("-"),caseSensitive:i.props.caseSensitive,element:i.props.element,Component:i.props.Component,index:i.props.index,path:i.props.path,middleware:i.props.middleware,loader:i.props.loader,action:i.props.action,hydrateFallbackElement:i.props.hydrateFallbackElement,HydrateFallback:i.props.HydrateFallback,errorElement:i.props.errorElement,ErrorBoundary:i.props.ErrorBoundary,hasErrorBoundary:i.props.hasErrorBoundary===!0||i.props.ErrorBoundary!=null||i.props.errorElement!=null,shouldRevalidate:i.props.shouldRevalidate,handle:i.props.handle,lazy:i.props.lazy};i.props.children&&(u.children=Up(i.props.children,l)),n.push(u)}),n}var sh="get",ah="application/x-www-form-urlencoded";function $h(t){return typeof HTMLElement<"u"&&t instanceof HTMLElement}function sR(t){return $h(t)&&t.tagName.toLowerCase()==="button"}function aR(t){return $h(t)&&t.tagName.toLowerCase()==="form"}function oR(t){return $h(t)&&t.tagName.toLowerCase()==="input"}function lR(t){return!!(t.metaKey||t.altKey||t.ctrlKey||t.shiftKey)}function cR(t,e){return t.button===0&&(!e||e==="_self")&&!lR(t)}function Bp(t=""){return new URLSearchParams(typeof t=="string"||Array.isArray(t)||t instanceof URLSearchParams?t:Object.keys(t).reduce((e,n)=>{let i=t[n];return e.concat(Array.isArray(i)?i.map(a=>[n,a]):[[n,i]])},[]))}function uR(t,e){let n=Bp(t);return e&&e.forEach((i,a)=>{n.has(a)||e.getAll(a).forEach(l=>{n.append(a,l)})}),n}var Xd=null;function dR(){if(Xd===null)try{new FormData(document.createElement("form"),0),Xd=!1}catch{Xd=!0}return Xd}var hR=new Set(["application/x-www-form-urlencoded","multipart/form-data","text/plain"]);function wp(t){return t!=null&&!hR.has(t)?(nr(!1,`"${t}" is not a valid \`encType\` for \`<Form>\`/\`<fetcher.Form>\` and will default to "${ah}"`),null):t}function fR(t,e){let n,i,a,l,u;if(aR(t)){let h=t.getAttribute("action");i=h?Qi(h,e):null,n=t.getAttribute("method")||sh,a=wp(t.getAttribute("enctype"))||ah,l=new FormData(t)}else if(sR(t)||oR(t)&&(t.type==="submit"||t.type==="image")){let h=t.form;if(h==null)throw new Error('Cannot submit a <button> or <input type="submit"> without a <form>');let m=t.getAttribute("formaction")||h.getAttribute("action");if(i=m?Qi(m,e):null,n=t.getAttribute("formmethod")||h.getAttribute("method")||sh,a=wp(t.getAttribute("formenctype"))||wp(h.getAttribute("enctype"))||ah,l=new FormData(h,t),!dR()){let{name:g,type:_,value:v}=t;if(_==="image"){let b=g?`${g}.`:"";l.append(`${b}x`,"0"),l.append(`${b}y`,"0")}else g&&l.append(g,v)}}else{if($h(t))throw new Error('Cannot submit element that is not <form>, <button>, or <input type="submit|image">');n=sh,i=null,a=ah,u=t}return l&&a==="text/plain"&&(u=l,l=void 0),{action:i,method:n.toLowerCase(),encType:a,formData:l,body:u}}Object.getOwnPropertyNames(Object.prototype).sort().join("\0");function Og(t,e){if(t===!1||t===null||typeof t>"u")throw new Error(e)}function mR(t,e,n){let i=typeof t=="string"?new URL(t,typeof window>"u"?"server://singlefetch/":window.location.origin):t;return i.pathname==="/"?i.pathname=`_root.${n}`:e&&Qi(i.pathname,e)==="/"?i.pathname=`${e.replace(/\/$/,"")}/_root.${n}`:i.pathname=`${i.pathname.replace(/\/$/,"")}.${n}`,i}async function pR(t,e){if(t.id in e)return e[t.id];try{let n=await import(t.module);return e[t.id]=n,n}catch(n){return console.error(`Error loading route module \`${t.module}\`, reloading page...`),console.error(n),window.__reactRouterContext&&window.__reactRouterContext.isSpaMode,window.location.reload(),new Promise(()=>{})}}function gR(t){return t==null?!1:t.href==null?t.rel==="preload"&&typeof t.imageSrcSet=="string"&&typeof t.imageSizes=="string":typeof t.rel=="string"&&typeof t.href=="string"}async function yR(t,e,n){let i=await Promise.all(t.map(async a=>{let l=e.routes[a.route.id];if(l){let u=await pR(l,n);return u.links?u.links():[]}return[]}));return xR(i.flat(1).filter(gR).filter(a=>a.rel==="stylesheet"||a.rel==="preload").map(a=>a.rel==="stylesheet"?{...a,rel:"prefetch",as:"style"}:{...a,rel:"prefetch"}))}function wb(t,e,n,i,a,l){let u=(m,g)=>n[g]?m.route.id!==n[g].route.id:!0,h=(m,g)=>n[g].pathname!==m.pathname||n[g].route.path?.endsWith("*")&&n[g].params["*"]!==m.params["*"];return l==="assets"?e.filter((m,g)=>u(m,g)||h(m,g)):l==="data"?e.filter((m,g)=>{let _=i.routes[m.route.id];if(!_||!_.hasLoader)return!1;if(u(m,g)||h(m,g))return!0;if(m.route.shouldRevalidate){let v=m.route.shouldRevalidate({currentUrl:new URL(a.pathname+a.search+a.hash,window.origin),currentParams:n[0]?.params||{},nextUrl:new URL(t,window.origin),nextParams:m.params,defaultShouldRevalidate:!0});if(typeof v=="boolean")return v}return!0}):[]}function _R(t,e,{includeHydrateFallback:n}={}){return vR(t.map(i=>{let a=e.routes[i.route.id];if(!a)return[];let l=[a.module];return a.clientActionModule&&(l=l.concat(a.clientActionModule)),a.clientLoaderModule&&(l=l.concat(a.clientLoaderModule)),n&&a.hydrateFallbackModule&&(l=l.concat(a.hydrateFallbackModule)),a.imports&&(l=l.concat(a.imports)),l}).flat(1))}function vR(t){return[...new Set(t)]}function bR(t){let e={},n=Object.keys(t).sort();for(let i of n)e[i]=t[i];return e}function xR(t,e){let n=new Set;return new Set(e),t.reduce((i,a)=>{let l=JSON.stringify(bR(a));return n.has(l)||(n.add(l),i.push({key:l,link:a})),i},[])}function iS(){let t=A.useContext(ml);return Og(t,"You must render this element inside a <DataRouterContext.Provider> element"),t}function ER(){let t=A.useContext(Gh);return Og(t,"You must render this element inside a <DataRouterStateContext.Provider> element"),t}var Mg=A.createContext(void 0);Mg.displayName="FrameworkContext";function sS(){let t=A.useContext(Mg);return Og(t,"You must render this element inside a <HydratedRouter> element"),t}function SR(t,e){let n=A.useContext(Mg),[i,a]=A.useState(!1),[l,u]=A.useState(!1),{onFocus:h,onBlur:m,onMouseEnter:g,onMouseLeave:_,onTouchStart:v}=e,b=A.useRef(null);A.useEffect(()=>{if(t==="render"&&u(!0),t==="viewport"){let R=B=>{B.forEach(H=>{u(H.isIntersecting)})},N=new IntersectionObserver(R,{threshold:.5});return b.current&&N.observe(b.current),()=>{N.disconnect()}}},[t]),A.useEffect(()=>{if(i){let R=setTimeout(()=>{u(!0)},100);return()=>{clearTimeout(R)}}},[i]);let w=()=>{a(!0)},C=()=>{a(!1),u(!1)};return n?t!=="intent"?[l,b,{}]:[l,b,{onFocus:kc(h,w),onBlur:kc(m,C),onMouseEnter:kc(g,w),onMouseLeave:kc(_,C),onTouchStart:kc(v,w)}]:[!1,b,{}]}function kc(t,e){return n=>{t&&t(n),n.defaultPrevented||e(n)}}function wR({page:t,...e}){let{router:n}=iS(),i=A.useMemo(()=>GE(n.routes,t,n.basename),[n.routes,t,n.basename]);return i?A.createElement(AR,{page:t,matches:i,...e}):null}function TR(t){let{manifest:e,routeModules:n}=sS(),[i,a]=A.useState([]);return A.useEffect(()=>{let l=!1;return yR(t,e,n).then(u=>{l||a(u)}),()=>{l=!0}},[t,e,n]),i}function AR({page:t,matches:e,...n}){let i=kn(),{manifest:a,routeModules:l}=sS(),{basename:u}=iS(),{loaderData:h,matches:m}=ER(),g=A.useMemo(()=>wb(t,e,m,a,i,"data"),[t,e,m,a,i]),_=A.useMemo(()=>wb(t,e,m,a,i,"assets"),[t,e,m,a,i]),v=A.useMemo(()=>{if(t===i.pathname+i.search+i.hash)return[];let C=new Set,R=!1;if(e.forEach(B=>{let H=a.routes[B.route.id];!H||!H.hasLoader||(!g.some(F=>F.route.id===B.route.id)&&B.route.id in h&&l[B.route.id]?.shouldRevalidate||H.hasClientLoader?R=!0:C.add(B.route.id))}),C.size===0)return[];let N=mR(t,u,"data");return R&&C.size>0&&N.searchParams.set("_routes",e.filter(B=>C.has(B.route.id)).map(B=>B.route.id).join(",")),[N.pathname+N.search]},[u,h,i,a,g,e,t,l]),b=A.useMemo(()=>_R(_,a),[_,a]),w=TR(_);return A.createElement(A.Fragment,null,v.map(C=>A.createElement("link",{key:C,rel:"prefetch",as:"fetch",href:C,...n})),b.map(C=>A.createElement("link",{key:C,rel:"modulepreload",href:C,...n})),w.map(({key:C,link:R})=>A.createElement("link",{key:C,nonce:n.nonce,...R})))}function CR(...t){return e=>{t.forEach(n=>{typeof n=="function"?n(e):n!=null&&(n.current=e)})}}var RR=typeof window<"u"&&typeof window.document<"u"&&typeof window.document.createElement<"u";try{RR&&(window.__reactRouterVersion="7.11.0")}catch{}function DR({basename:t,children:e,unstable_useTransitions:n,window:i}){let a=A.useRef();a.current==null&&(a.current=sC({window:i,v5Compat:!0}));let l=a.current,[u,h]=A.useState({action:l.action,location:l.location}),m=A.useCallback(g=>{n===!1?h(g):A.startTransition(()=>h(g))},[n]);return A.useLayoutEffect(()=>l.listen(m),[l,m]),A.createElement(rR,{basename:t,children:e,location:u.location,navigationType:u.action,navigator:l,unstable_useTransitions:n})}var aS=/^(?:[a-z][a-z0-9+.-]*:|\/\/)/i,Dt=A.forwardRef(function({onClick:e,discover:n="render",prefetch:i="none",relative:a,reloadDocument:l,replace:u,state:h,target:m,to:g,preventScrollReset:_,viewTransition:v,unstable_defaultShouldRevalidate:b,...w},C){let{basename:R,unstable_useTransitions:N}=A.useContext(rr),B=typeof g=="string"&&aS.test(g),H=WE(g,R);g=H.to;let F=zC(g,{relative:a}),[ae,te,he]=SR(i,w),L=MR(g,{replace:u,state:h,target:m,preventScrollReset:_,relative:a,viewTransition:v,unstable_defaultShouldRevalidate:b,unstable_useTransitions:N});function I(k){e&&e(k),k.defaultPrevented||L(k)}let D=A.createElement("a",{...w,...he,href:H.absoluteURL||F,onClick:H.isExternal||l?e:I,ref:CR(C,te),target:m,"data-discover":!B&&n==="render"?"true":void 0});return ae&&!B?A.createElement(A.Fragment,null,D,A.createElement(wR,{page:F})):D});Dt.displayName="Link";var IR=A.forwardRef(function({"aria-current":e="page",caseSensitive:n=!1,className:i="",end:a=!1,style:l,to:u,viewTransition:h,children:m,...g},_){let v=lu(u,{relative:g.relative}),b=kn(),w=A.useContext(Gh),{navigator:C,basename:R}=A.useContext(rr),N=w!=null&&zR(v)&&h===!0,B=C.encodeLocation?C.encodeLocation(v).pathname:v.pathname,H=b.pathname,F=w&&w.navigation&&w.navigation.location?w.navigation.location.pathname:null;n||(H=H.toLowerCase(),F=F?F.toLowerCase():null,B=B.toLowerCase()),F&&R&&(F=Qi(F,R)||F);const ae=B!=="/"&&B.endsWith("/")?B.length-1:B.length;let te=H===B||!a&&H.startsWith(B)&&H.charAt(ae)==="/",he=F!=null&&(F===B||!a&&F.startsWith(B)&&F.charAt(B.length)==="/"),L={isActive:te,isPending:he,isTransitioning:N},I=te?e:void 0,D;typeof i=="function"?D=i(L):D=[i,te?"active":null,he?"pending":null,N?"transitioning":null].filter(Boolean).join(" ");let k=typeof l=="function"?l(L):l;return A.createElement(Dt,{...g,"aria-current":I,className:D,ref:_,style:k,to:u,viewTransition:h},typeof m=="function"?m(L):m)});IR.displayName="NavLink";var jR=A.forwardRef(({discover:t="render",fetcherKey:e,navigate:n,reloadDocument:i,replace:a,state:l,method:u=sh,action:h,onSubmit:m,relative:g,preventScrollReset:_,viewTransition:v,unstable_defaultShouldRevalidate:b,...w},C)=>{let{unstable_useTransitions:R}=A.useContext(rr),N=LR(),B=VR(h,{relative:g}),H=u.toLowerCase()==="get"?"get":"post",F=typeof h=="string"&&aS.test(h),ae=te=>{if(m&&m(te),te.defaultPrevented)return;te.preventDefault();let he=te.nativeEvent.submitter,L=he?.getAttribute("formmethod")||u,I=()=>N(he||te.currentTarget,{fetcherKey:e,method:L,navigate:n,replace:a,state:l,relative:g,preventScrollReset:_,viewTransition:v,unstable_defaultShouldRevalidate:b});R&&n!==!1?A.startTransition(()=>I()):I()};return A.createElement("form",{ref:C,method:H,action:B,onSubmit:i?m:ae,...w,"data-discover":!F&&t==="render"?"true":void 0})});jR.displayName="Form";function OR(t){return`${t} must be used within a data router.  See https://reactrouter.com/en/main/routers/picking-a-router.`}function oS(t){let e=A.useContext(ml);return Rt(e,OR(t)),e}function MR(t,{target:e,replace:n,state:i,preventScrollReset:a,relative:l,viewTransition:u,unstable_defaultShouldRevalidate:h,unstable_useTransitions:m}={}){let g=ou(),_=kn(),v=lu(t,{relative:l});return A.useCallback(b=>{if(cR(b,e)){b.preventDefault();let w=n!==void 0?n:Kc(_)===Kc(v),C=()=>g(t,{replace:w,state:i,preventScrollReset:a,relative:l,viewTransition:u,unstable_defaultShouldRevalidate:h});m?A.startTransition(()=>C()):C()}},[_,g,v,n,i,e,t,a,l,u,h,m])}function kR(t){nr(typeof URLSearchParams<"u","You cannot use the `useSearchParams` hook in a browser that does not support the URLSearchParams API. If you need to support Internet Explorer 11, we recommend you load a polyfill such as https://github.com/ungap/url-search-params.");let e=A.useRef(Bp(t)),n=A.useRef(!1),i=kn(),a=A.useMemo(()=>uR(i.search,n.current?null:e.current),[i.search]),l=ou(),u=A.useCallback((h,m)=>{const g=Bp(typeof h=="function"?h(new URLSearchParams(a)):h);n.current=!0,l("?"+g,m)},[l,a]);return[a,u]}var NR=0,PR=()=>`__${String(++NR)}__`;function LR(){let{router:t}=oS("useSubmit"),{basename:e}=A.useContext(rr),n=ZC(),i=t.fetch,a=t.navigate;return A.useCallback(async(l,u={})=>{let{action:h,method:m,encType:g,formData:_,body:v}=fR(l,e);if(u.navigate===!1){let b=u.fetcherKey||PR();await i(b,n,u.action||h,{unstable_defaultShouldRevalidate:u.unstable_defaultShouldRevalidate,preventScrollReset:u.preventScrollReset,formData:_,body:v,formMethod:u.method||m,formEncType:u.encType||g,flushSync:u.flushSync})}else await a(u.action||h,{unstable_defaultShouldRevalidate:u.unstable_defaultShouldRevalidate,preventScrollReset:u.preventScrollReset,formData:_,body:v,formMethod:u.method||m,formEncType:u.encType||g,replace:u.replace,state:u.state,fromRouteId:n,flushSync:u.flushSync,viewTransition:u.viewTransition})},[i,a,e,n])}function VR(t,{relative:e}={}){let{basename:n}=A.useContext(rr),i=A.useContext(wr);Rt(i,"useFormAction must be used inside a RouteContext");let[a]=i.matches.slice(-1),l={...lu(t||".",{relative:e})},u=kn();if(t==null){l.search=u.search;let h=new URLSearchParams(l.search),m=h.getAll("index");if(m.some(_=>_==="")){h.delete("index"),m.filter(v=>v).forEach(v=>h.append("index",v));let _=h.toString();l.search=_?`?${_}`:""}}return(!t||t===".")&&a.route.index&&(l.search=l.search?l.search.replace(/^\?/,"?index&"):"?index"),n!=="/"&&(l.pathname=l.pathname==="/"?n:Gi([n,l.pathname])),Kc(l)}function zR(t,{relative:e}={}){let n=A.useContext(XE);Rt(n!=null,"`useViewTransitionState` must be used within `react-router-dom`'s `RouterProvider`.  Did you accidentally import `RouterProvider` from `react-router`?");let{basename:i}=oS("useViewTransitionState"),a=lu(t,{relative:e});if(!n.isTransitioning)return!1;let l=Qi(n.currentLocation.pathname,i)||n.currentLocation.pathname,u=Qi(n.nextLocation.pathname,i)||n.nextLocation.pathname;return vh(a.pathname,u)!=null||vh(a.pathname,l)!=null}const UR=function(){},BR={is_logged_in:!1,is_auth_checked:!1,username:"",set_user_context:UR},cu=A.createContext(BR);var gl=class{constructor(){this.listeners=new Set,this.subscribe=this.subscribe.bind(this)}subscribe(t){return this.listeners.add(t),this.onSubscribe(),()=>{this.listeners.delete(t),this.onUnsubscribe()}}hasListeners(){return this.listeners.size>0}onSubscribe(){}onUnsubscribe(){}},FR={setTimeout:(t,e)=>setTimeout(t,e),clearTimeout:t=>clearTimeout(t),setInterval:(t,e)=>setInterval(t,e),clearInterval:t=>clearInterval(t)},qR=class{#e=FR;#t=!1;setTimeoutProvider(t){this.#e=t}setTimeout(t,e){return this.#e.setTimeout(t,e)}clearTimeout(t){this.#e.clearTimeout(t)}setInterval(t,e){return this.#e.setInterval(t,e)}clearInterval(t){this.#e.clearInterval(t)}},Bi=new qR;function GR(t){setTimeout(t,0)}var La=typeof window>"u"||"Deno"in globalThis;function sn(){}function HR(t,e){return typeof t=="function"?t(e):t}function Fp(t){return typeof t=="number"&&t>=0&&t!==1/0}function lS(t,e){return Math.max(t+(e||0)-Date.now(),0)}function Bs(t,e){return typeof t=="function"?t(e):t}function xr(t,e){return typeof t=="function"?t(e):t}function Tb(t,e){const{type:n="all",exact:i,fetchStatus:a,predicate:l,queryKey:u,stale:h}=t;if(u){if(i){if(e.queryHash!==kg(u,e.options))return!1}else if(!Wc(e.queryKey,u))return!1}if(n!=="all"){const m=e.isActive();if(n==="active"&&!m||n==="inactive"&&m)return!1}return!(typeof h=="boolean"&&e.isStale()!==h||a&&a!==e.state.fetchStatus||l&&!l(e))}function Ab(t,e){const{exact:n,status:i,predicate:a,mutationKey:l}=t;if(l){if(!e.options.mutationKey)return!1;if(n){if(Va(e.options.mutationKey)!==Va(l))return!1}else if(!Wc(e.options.mutationKey,l))return!1}return!(i&&e.state.status!==i||a&&!a(e))}function kg(t,e){return(e?.queryKeyHashFn||Va)(t)}function Va(t){return JSON.stringify(t,(e,n)=>qp(n)?Object.keys(n).sort().reduce((i,a)=>(i[a]=n[a],i),{}):n)}function Wc(t,e){return t===e?!0:typeof t!=typeof e?!1:t&&e&&typeof t=="object"&&typeof e=="object"?Object.keys(e).every(n=>Wc(t[n],e[n])):!1}var QR=Object.prototype.hasOwnProperty;function cS(t,e){if(t===e)return t;const n=Cb(t)&&Cb(e);if(!n&&!(qp(t)&&qp(e)))return e;const a=(n?t:Object.keys(t)).length,l=n?e:Object.keys(e),u=l.length,h=n?new Array(u):{};let m=0;for(let g=0;g<u;g++){const _=n?g:l[g],v=t[_],b=e[_];if(v===b){h[_]=v,(n?g<a:QR.call(t,_))&&m++;continue}if(v===null||b===null||typeof v!="object"||typeof b!="object"){h[_]=b;continue}const w=cS(v,b);h[_]=w,w===v&&m++}return a===u&&m===a?t:h}function bh(t,e){if(!e||Object.keys(t).length!==Object.keys(e).length)return!1;for(const n in t)if(t[n]!==e[n])return!1;return!0}function Cb(t){return Array.isArray(t)&&t.length===Object.keys(t).length}function qp(t){if(!Rb(t))return!1;const e=t.constructor;if(e===void 0)return!0;const n=e.prototype;return!(!Rb(n)||!n.hasOwnProperty("isPrototypeOf")||Object.getPrototypeOf(t)!==Object.prototype)}function Rb(t){return Object.prototype.toString.call(t)==="[object Object]"}function $R(t){return new Promise(e=>{Bi.setTimeout(e,t)})}function Gp(t,e,n){return typeof n.structuralSharing=="function"?n.structuralSharing(t,e):n.structuralSharing!==!1?cS(t,e):e}function KR(t,e,n=0){const i=[...t,e];return n&&i.length>n?i.slice(1):i}function WR(t,e,n=0){const i=[e,...t];return n&&i.length>n?i.slice(0,-1):i}var Ng=Symbol();function uS(t,e){return!t.queryFn&&e?.initialPromise?()=>e.initialPromise:!t.queryFn||t.queryFn===Ng?()=>Promise.reject(new Error(`Missing queryFn: '${t.queryHash}'`)):t.queryFn}function dS(t,e){return typeof t=="function"?t(...e):!!t}var YR=class extends gl{#e;#t;#n;constructor(){super(),this.#n=t=>{if(!La&&window.addEventListener){const e=()=>t();return window.addEventListener("visibilitychange",e,!1),()=>{window.removeEventListener("visibilitychange",e)}}}}onSubscribe(){this.#t||this.setEventListener(this.#n)}onUnsubscribe(){this.hasListeners()||(this.#t?.(),this.#t=void 0)}setEventListener(t){this.#n=t,this.#t?.(),this.#t=t(e=>{typeof e=="boolean"?this.setFocused(e):this.onFocus()})}setFocused(t){this.#e!==t&&(this.#e=t,this.onFocus())}onFocus(){const t=this.isFocused();this.listeners.forEach(e=>{e(t)})}isFocused(){return typeof this.#e=="boolean"?this.#e:globalThis.document?.visibilityState!=="hidden"}},Pg=new YR;function Hp(){let t,e;const n=new Promise((a,l)=>{t=a,e=l});n.status="pending",n.catch(()=>{});function i(a){Object.assign(n,a),delete n.resolve,delete n.reject}return n.resolve=a=>{i({status:"fulfilled",value:a}),t(a)},n.reject=a=>{i({status:"rejected",reason:a}),e(a)},n}function XR(t){let e;if(t.then(n=>(e=n,n),sn)?.catch(sn),e!==void 0)return{data:e}}function hS(t){return t}function JR(t){return{mutationKey:t.options.mutationKey,state:t.state,...t.options.scope&&{scope:t.options.scope},...t.meta&&{meta:t.meta}}}function ZR(t,e,n){const i=()=>{const a=t.promise?.then(e).catch(l=>n(l)?Promise.reject(new Error("redacted")):Promise.reject(l));return a?.catch(sn),a};return{dehydratedAt:Date.now(),state:{...t.state,...t.state.data!==void 0&&{data:e(t.state.data)}},queryKey:t.queryKey,queryHash:t.queryHash,...t.state.status==="pending"&&{promise:i()},...t.meta&&{meta:t.meta}}}function eD(t){return t.state.isPaused}function tD(t){return t.state.status==="success"}function nD(t){return!0}function rD(t,e={}){const n=e.shouldDehydrateMutation??t.getDefaultOptions().dehydrate?.shouldDehydrateMutation??eD,i=t.getMutationCache().getAll().flatMap(m=>n(m)?[JR(m)]:[]),a=e.shouldDehydrateQuery??t.getDefaultOptions().dehydrate?.shouldDehydrateQuery??tD,l=e.shouldRedactErrors??t.getDefaultOptions().dehydrate?.shouldRedactErrors??nD,u=e.serializeData??t.getDefaultOptions().dehydrate?.serializeData??hS,h=t.getQueryCache().getAll().flatMap(m=>a(m)?[ZR(m,u,l)]:[]);return{mutations:i,queries:h}}function iD(t,e,n){if(typeof e!="object"||e===null)return;const i=t.getMutationCache(),a=t.getQueryCache(),l=n?.defaultOptions?.deserializeData??t.getDefaultOptions().hydrate?.deserializeData??hS,u=e.mutations||[],h=e.queries||[];u.forEach(({state:m,...g})=>{i.build(t,{...t.getDefaultOptions().hydrate?.mutations,...n?.defaultOptions?.mutations,...g},m)}),h.forEach(({queryKey:m,state:g,queryHash:_,meta:v,promise:b,dehydratedAt:w})=>{const C=b?XR(b):void 0,R=g.data===void 0?C?.data:g.data,N=R===void 0?R:l(R);let B=a.get(_);const H=B?.state.status==="pending",F=B?.state.fetchStatus==="fetching";if(B){const ae=C&&w!==void 0&&w>B.state.dataUpdatedAt;if(g.dataUpdatedAt>B.state.dataUpdatedAt||ae){const{fetchStatus:te,...he}=g;B.setState({...he,data:N})}}else B=a.build(t,{...t.getDefaultOptions().hydrate?.queries,...n?.defaultOptions?.queries,queryKey:m,queryHash:_,meta:v},{...g,data:N,fetchStatus:"idle",status:N!==void 0?"success":g.status});b&&!H&&!F&&(w===void 0||w>B.state.dataUpdatedAt)&&B.fetch(void 0,{initialPromise:Promise.resolve(b).then(l)}).catch(sn)})}var sD=GR;function aD(){let t=[],e=0,n=h=>{h()},i=h=>{h()},a=sD;const l=h=>{e?t.push(h):a(()=>{n(h)})},u=()=>{const h=t;t=[],h.length&&a(()=>{i(()=>{h.forEach(m=>{n(m)})})})};return{batch:h=>{let m;e++;try{m=h()}finally{e--,e||u()}return m},batchCalls:h=>(...m)=>{l(()=>{h(...m)})},schedule:l,setNotifyFunction:h=>{n=h},setBatchNotifyFunction:h=>{i=h},setScheduler:h=>{a=h}}}var an=aD(),oD=class extends gl{#e=!0;#t;#n;constructor(){super(),this.#n=t=>{if(!La&&window.addEventListener){const e=()=>t(!0),n=()=>t(!1);return window.addEventListener("online",e,!1),window.addEventListener("offline",n,!1),()=>{window.removeEventListener("online",e),window.removeEventListener("offline",n)}}}}onSubscribe(){this.#t||this.setEventListener(this.#n)}onUnsubscribe(){this.hasListeners()||(this.#t?.(),this.#t=void 0)}setEventListener(t){this.#n=t,this.#t?.(),this.#t=t(this.setOnline.bind(this))}setOnline(t){this.#e!==t&&(this.#e=t,this.listeners.forEach(n=>{n(t)}))}isOnline(){return this.#e}},xh=new oD;function lD(t){return Math.min(1e3*2**t,3e4)}function fS(t){return(t??"online")==="online"?xh.isOnline():!0}var Qp=class extends Error{constructor(t){super("CancelledError"),this.revert=t?.revert,this.silent=t?.silent}};function mS(t){let e=!1,n=0,i;const a=Hp(),l=()=>a.status!=="pending",u=R=>{if(!l()){const N=new Qp(R);b(N),t.onCancel?.(N)}},h=()=>{e=!0},m=()=>{e=!1},g=()=>Pg.isFocused()&&(t.networkMode==="always"||xh.isOnline())&&t.canRun(),_=()=>fS(t.networkMode)&&t.canRun(),v=R=>{l()||(i?.(),a.resolve(R))},b=R=>{l()||(i?.(),a.reject(R))},w=()=>new Promise(R=>{i=N=>{(l()||g())&&R(N)},t.onPause?.()}).then(()=>{i=void 0,l()||t.onContinue?.()}),C=()=>{if(l())return;let R;const N=n===0?t.initialPromise:void 0;try{R=N??t.fn()}catch(B){R=Promise.reject(B)}Promise.resolve(R).then(v).catch(B=>{if(l())return;const H=t.retry??(La?0:3),F=t.retryDelay??lD,ae=typeof F=="function"?F(n,B):F,te=H===!0||typeof H=="number"&&n<H||typeof H=="function"&&H(n,B);if(e||!te){b(B);return}n++,t.onFail?.(n,B),$R(ae).then(()=>g()?void 0:w()).then(()=>{e?b(B):C()})})};return{promise:a,status:()=>a.status,cancel:u,continue:()=>(i?.(),a),cancelRetry:h,continueRetry:m,canStart:_,start:()=>(_()?C():w().then(C),a)}}var pS=class{#e;destroy(){this.clearGcTimeout()}scheduleGc(){this.clearGcTimeout(),Fp(this.gcTime)&&(this.#e=Bi.setTimeout(()=>{this.optionalRemove()},this.gcTime))}updateGcTime(t){this.gcTime=Math.max(this.gcTime||0,t??(La?1/0:300*1e3))}clearGcTimeout(){this.#e&&(Bi.clearTimeout(this.#e),this.#e=void 0)}},cD=class extends pS{#e;#t;#n;#i;#r;#a;#o;constructor(e){super(),this.#o=!1,this.#a=e.defaultOptions,this.setOptions(e.options),this.observers=[],this.#i=e.client,this.#n=this.#i.getQueryCache(),this.queryKey=e.queryKey,this.queryHash=e.queryHash,this.#e=Ib(this.options),this.state=e.state??this.#e,this.scheduleGc()}get meta(){return this.options.meta}get promise(){return this.#r?.promise}setOptions(e){if(this.options={...this.#a,...e},this.updateGcTime(this.options.gcTime),this.state&&this.state.data===void 0){const n=Ib(this.options);n.data!==void 0&&(this.setState(Db(n.data,n.dataUpdatedAt)),this.#e=n)}}optionalRemove(){!this.observers.length&&this.state.fetchStatus==="idle"&&this.#n.remove(this)}setData(e,n){const i=Gp(this.state.data,e,this.options);return this.#s({data:i,type:"success",dataUpdatedAt:n?.updatedAt,manual:n?.manual}),i}setState(e,n){this.#s({type:"setState",state:e,setStateOptions:n})}cancel(e){const n=this.#r?.promise;return this.#r?.cancel(e),n?n.then(sn).catch(sn):Promise.resolve()}destroy(){super.destroy(),this.cancel({silent:!0})}reset(){this.destroy(),this.setState(this.#e)}isActive(){return this.observers.some(e=>xr(e.options.enabled,this)!==!1)}isDisabled(){return this.getObserversCount()>0?!this.isActive():this.options.queryFn===Ng||this.state.dataUpdateCount+this.state.errorUpdateCount===0}isStatic(){return this.getObserversCount()>0?this.observers.some(e=>Bs(e.options.staleTime,this)==="static"):!1}isStale(){return this.getObserversCount()>0?this.observers.some(e=>e.getCurrentResult().isStale):this.state.data===void 0||this.state.isInvalidated}isStaleByTime(e=0){return this.state.data===void 0?!0:e==="static"?!1:this.state.isInvalidated?!0:!lS(this.state.dataUpdatedAt,e)}onFocus(){this.observers.find(n=>n.shouldFetchOnWindowFocus())?.refetch({cancelRefetch:!1}),this.#r?.continue()}onOnline(){this.observers.find(n=>n.shouldFetchOnReconnect())?.refetch({cancelRefetch:!1}),this.#r?.continue()}addObserver(e){this.observers.includes(e)||(this.observers.push(e),this.clearGcTimeout(),this.#n.notify({type:"observerAdded",query:this,observer:e}))}removeObserver(e){this.observers.includes(e)&&(this.observers=this.observers.filter(n=>n!==e),this.observers.length||(this.#r&&(this.#o?this.#r.cancel({revert:!0}):this.#r.cancelRetry()),this.scheduleGc()),this.#n.notify({type:"observerRemoved",query:this,observer:e}))}getObserversCount(){return this.observers.length}invalidate(){this.state.isInvalidated||this.#s({type:"invalidate"})}async fetch(e,n){if(this.state.fetchStatus!=="idle"&&this.#r?.status()!=="rejected"){if(this.state.data!==void 0&&n?.cancelRefetch)this.cancel({silent:!0});else if(this.#r)return this.#r.continueRetry(),this.#r.promise}if(e&&this.setOptions(e),!this.options.queryFn){const m=this.observers.find(g=>g.options.queryFn);m&&this.setOptions(m.options)}const i=new AbortController,a=m=>{Object.defineProperty(m,"signal",{enumerable:!0,get:()=>(this.#o=!0,i.signal)})},l=()=>{const m=uS(this.options,n),_=(()=>{const v={client:this.#i,queryKey:this.queryKey,meta:this.meta};return a(v),v})();return this.#o=!1,this.options.persister?this.options.persister(m,_,this):m(_)},h=(()=>{const m={fetchOptions:n,options:this.options,queryKey:this.queryKey,client:this.#i,state:this.state,fetchFn:l};return a(m),m})();this.options.behavior?.onFetch(h,this),this.#t=this.state,(this.state.fetchStatus==="idle"||this.state.fetchMeta!==h.fetchOptions?.meta)&&this.#s({type:"fetch",meta:h.fetchOptions?.meta}),this.#r=mS({initialPromise:n?.initialPromise,fn:h.fetchFn,onCancel:m=>{m instanceof Qp&&m.revert&&this.setState({...this.#t,fetchStatus:"idle"}),i.abort()},onFail:(m,g)=>{this.#s({type:"failed",failureCount:m,error:g})},onPause:()=>{this.#s({type:"pause"})},onContinue:()=>{this.#s({type:"continue"})},retry:h.options.retry,retryDelay:h.options.retryDelay,networkMode:h.options.networkMode,canRun:()=>!0});try{const m=await this.#r.start();if(m===void 0)throw new Error(`${this.queryHash} data is undefined`);return this.setData(m),this.#n.config.onSuccess?.(m,this),this.#n.config.onSettled?.(m,this.state.error,this),m}catch(m){if(m instanceof Qp){if(m.silent)return this.#r.promise;if(m.revert){if(this.state.data===void 0)throw m;return this.state.data}}throw this.#s({type:"error",error:m}),this.#n.config.onError?.(m,this),this.#n.config.onSettled?.(this.state.data,m,this),m}finally{this.scheduleGc()}}#s(e){const n=i=>{switch(e.type){case"failed":return{...i,fetchFailureCount:e.failureCount,fetchFailureReason:e.error};case"pause":return{...i,fetchStatus:"paused"};case"continue":return{...i,fetchStatus:"fetching"};case"fetch":return{...i,...gS(i.data,this.options),fetchMeta:e.meta??null};case"success":const a={...i,...Db(e.data,e.dataUpdatedAt),dataUpdateCount:i.dataUpdateCount+1,...!e.manual&&{fetchStatus:"idle",fetchFailureCount:0,fetchFailureReason:null}};return this.#t=e.manual?a:void 0,a;case"error":const l=e.error;return{...i,error:l,errorUpdateCount:i.errorUpdateCount+1,errorUpdatedAt:Date.now(),fetchFailureCount:i.fetchFailureCount+1,fetchFailureReason:l,fetchStatus:"idle",status:"error"};case"invalidate":return{...i,isInvalidated:!0};case"setState":return{...i,...e.state}}};this.state=n(this.state),an.batch(()=>{this.observers.forEach(i=>{i.onQueryUpdate()}),this.#n.notify({query:this,type:"updated",action:e})})}};function gS(t,e){return{fetchFailureCount:0,fetchFailureReason:null,fetchStatus:fS(e.networkMode)?"fetching":"paused",...t===void 0&&{error:null,status:"pending"}}}function Db(t,e){return{data:t,dataUpdatedAt:e??Date.now(),error:null,isInvalidated:!1,status:"success"}}function Ib(t){const e=typeof t.initialData=="function"?t.initialData():t.initialData,n=e!==void 0,i=n?typeof t.initialDataUpdatedAt=="function"?t.initialDataUpdatedAt():t.initialDataUpdatedAt:0;return{data:e,dataUpdateCount:0,dataUpdatedAt:n?i??Date.now():0,error:null,errorUpdateCount:0,errorUpdatedAt:0,fetchFailureCount:0,fetchFailureReason:null,fetchMeta:null,isInvalidated:!1,status:n?"success":"pending",fetchStatus:"idle"}}var uD=class extends gl{constructor(t,e){super(),this.options=e,this.#e=t,this.#s=null,this.#o=Hp(),this.bindMethods(),this.setOptions(e)}#e;#t=void 0;#n=void 0;#i=void 0;#r;#a;#o;#s;#p;#h;#f;#c;#u;#l;#m=new Set;bindMethods(){this.refetch=this.refetch.bind(this)}onSubscribe(){this.listeners.size===1&&(this.#t.addObserver(this),jb(this.#t,this.options)?this.#d():this.updateResult(),this.#v())}onUnsubscribe(){this.hasListeners()||this.destroy()}shouldFetchOnReconnect(){return $p(this.#t,this.options,this.options.refetchOnReconnect)}shouldFetchOnWindowFocus(){return $p(this.#t,this.options,this.options.refetchOnWindowFocus)}destroy(){this.listeners=new Set,this.#b(),this.#x(),this.#t.removeObserver(this)}setOptions(t){const e=this.options,n=this.#t;if(this.options=this.#e.defaultQueryOptions(t),this.options.enabled!==void 0&&typeof this.options.enabled!="boolean"&&typeof this.options.enabled!="function"&&typeof xr(this.options.enabled,this.#t)!="boolean")throw new Error("Expected enabled to be a boolean or a callback that returns a boolean");this.#E(),this.#t.setOptions(this.options),e._defaulted&&!bh(this.options,e)&&this.#e.getQueryCache().notify({type:"observerOptionsUpdated",query:this.#t,observer:this});const i=this.hasListeners();i&&Ob(this.#t,n,this.options,e)&&this.#d(),this.updateResult(),i&&(this.#t!==n||xr(this.options.enabled,this.#t)!==xr(e.enabled,this.#t)||Bs(this.options.staleTime,this.#t)!==Bs(e.staleTime,this.#t))&&this.#g();const a=this.#y();i&&(this.#t!==n||xr(this.options.enabled,this.#t)!==xr(e.enabled,this.#t)||a!==this.#l)&&this.#_(a)}getOptimisticResult(t){const e=this.#e.getQueryCache().build(this.#e,t),n=this.createResult(e,t);return hD(this,n)&&(this.#i=n,this.#a=this.options,this.#r=this.#t.state),n}getCurrentResult(){return this.#i}trackResult(t,e){return new Proxy(t,{get:(n,i)=>(this.trackProp(i),e?.(i),i==="promise"&&(this.trackProp("data"),!this.options.experimental_prefetchInRender&&this.#o.status==="pending"&&this.#o.reject(new Error("experimental_prefetchInRender feature flag is not enabled"))),Reflect.get(n,i))})}trackProp(t){this.#m.add(t)}getCurrentQuery(){return this.#t}refetch({...t}={}){return this.fetch({...t})}fetchOptimistic(t){const e=this.#e.defaultQueryOptions(t),n=this.#e.getQueryCache().build(this.#e,e);return n.fetch().then(()=>this.createResult(n,e))}fetch(t){return this.#d({...t,cancelRefetch:t.cancelRefetch??!0}).then(()=>(this.updateResult(),this.#i))}#d(t){this.#E();let e=this.#t.fetch(this.options,t);return t?.throwOnError||(e=e.catch(sn)),e}#g(){this.#b();const t=Bs(this.options.staleTime,this.#t);if(La||this.#i.isStale||!Fp(t))return;const n=lS(this.#i.dataUpdatedAt,t)+1;this.#c=Bi.setTimeout(()=>{this.#i.isStale||this.updateResult()},n)}#y(){return(typeof this.options.refetchInterval=="function"?this.options.refetchInterval(this.#t):this.options.refetchInterval)??!1}#_(t){this.#x(),this.#l=t,!(La||xr(this.options.enabled,this.#t)===!1||!Fp(this.#l)||this.#l===0)&&(this.#u=Bi.setInterval(()=>{(this.options.refetchIntervalInBackground||Pg.isFocused())&&this.#d()},this.#l))}#v(){this.#g(),this.#_(this.#y())}#b(){this.#c&&(Bi.clearTimeout(this.#c),this.#c=void 0)}#x(){this.#u&&(Bi.clearInterval(this.#u),this.#u=void 0)}createResult(t,e){const n=this.#t,i=this.options,a=this.#i,l=this.#r,u=this.#a,m=t!==n?t.state:this.#n,{state:g}=t;let _={...g},v=!1,b;if(e._optimisticResults){const I=this.hasListeners(),D=!I&&jb(t,e),k=I&&Ob(t,n,e,i);(D||k)&&(_={..._,...gS(g.data,t.options)}),e._optimisticResults==="isRestoring"&&(_.fetchStatus="idle")}let{error:w,errorUpdatedAt:C,status:R}=_;b=_.data;let N=!1;if(e.placeholderData!==void 0&&b===void 0&&R==="pending"){let I;a?.isPlaceholderData&&e.placeholderData===u?.placeholderData?(I=a.data,N=!0):I=typeof e.placeholderData=="function"?e.placeholderData(this.#f?.state.data,this.#f):e.placeholderData,I!==void 0&&(R="success",b=Gp(a?.data,I,e),v=!0)}if(e.select&&b!==void 0&&!N)if(a&&b===l?.data&&e.select===this.#p)b=this.#h;else try{this.#p=e.select,b=e.select(b),b=Gp(a?.data,b,e),this.#h=b,this.#s=null}catch(I){this.#s=I}this.#s&&(w=this.#s,b=this.#h,C=Date.now(),R="error");const B=_.fetchStatus==="fetching",H=R==="pending",F=R==="error",ae=H&&B,te=b!==void 0,L={status:R,fetchStatus:_.fetchStatus,isPending:H,isSuccess:R==="success",isError:F,isInitialLoading:ae,isLoading:ae,data:b,dataUpdatedAt:_.dataUpdatedAt,error:w,errorUpdatedAt:C,failureCount:_.fetchFailureCount,failureReason:_.fetchFailureReason,errorUpdateCount:_.errorUpdateCount,isFetched:_.dataUpdateCount>0||_.errorUpdateCount>0,isFetchedAfterMount:_.dataUpdateCount>m.dataUpdateCount||_.errorUpdateCount>m.errorUpdateCount,isFetching:B,isRefetching:B&&!H,isLoadingError:F&&!te,isPaused:_.fetchStatus==="paused",isPlaceholderData:v,isRefetchError:F&&te,isStale:Lg(t,e),refetch:this.refetch,promise:this.#o,isEnabled:xr(e.enabled,t)!==!1};if(this.options.experimental_prefetchInRender){const I=O=>{L.status==="error"?O.reject(L.error):L.data!==void 0&&O.resolve(L.data)},D=()=>{const O=this.#o=L.promise=Hp();I(O)},k=this.#o;switch(k.status){case"pending":t.queryHash===n.queryHash&&I(k);break;case"fulfilled":(L.status==="error"||L.data!==k.value)&&D();break;case"rejected":(L.status!=="error"||L.error!==k.reason)&&D();break}}return L}updateResult(){const t=this.#i,e=this.createResult(this.#t,this.options);if(this.#r=this.#t.state,this.#a=this.options,this.#r.data!==void 0&&(this.#f=this.#t),bh(e,t))return;this.#i=e;const n=()=>{if(!t)return!0;const{notifyOnChangeProps:i}=this.options,a=typeof i=="function"?i():i;if(a==="all"||!a&&!this.#m.size)return!0;const l=new Set(a??this.#m);return this.options.throwOnError&&l.add("error"),Object.keys(this.#i).some(u=>{const h=u;return this.#i[h]!==t[h]&&l.has(h)})};this.#S({listeners:n()})}#E(){const t=this.#e.getQueryCache().build(this.#e,this.options);if(t===this.#t)return;const e=this.#t;this.#t=t,this.#n=t.state,this.hasListeners()&&(e?.removeObserver(this),t.addObserver(this))}onQueryUpdate(){this.updateResult(),this.hasListeners()&&this.#v()}#S(t){an.batch(()=>{t.listeners&&this.listeners.forEach(e=>{e(this.#i)}),this.#e.getQueryCache().notify({query:this.#t,type:"observerResultsUpdated"})})}};function dD(t,e){return xr(e.enabled,t)!==!1&&t.state.data===void 0&&!(t.state.status==="error"&&e.retryOnMount===!1)}function jb(t,e){return dD(t,e)||t.state.data!==void 0&&$p(t,e,e.refetchOnMount)}function $p(t,e,n){if(xr(e.enabled,t)!==!1&&Bs(e.staleTime,t)!=="static"){const i=typeof n=="function"?n(t):n;return i==="always"||i!==!1&&Lg(t,e)}return!1}function Ob(t,e,n,i){return(t!==e||xr(i.enabled,t)===!1)&&(!n.suspense||t.state.status!=="error")&&Lg(t,n)}function Lg(t,e){return xr(e.enabled,t)!==!1&&t.isStaleByTime(Bs(e.staleTime,t))}function hD(t,e){return!bh(t.getCurrentResult(),e)}function Mb(t){return{onFetch:(e,n)=>{const i=e.options,a=e.fetchOptions?.meta?.fetchMore?.direction,l=e.state.data?.pages||[],u=e.state.data?.pageParams||[];let h={pages:[],pageParams:[]},m=0;const g=async()=>{let _=!1;const v=C=>{Object.defineProperty(C,"signal",{enumerable:!0,get:()=>(e.signal.aborted?_=!0:e.signal.addEventListener("abort",()=>{_=!0}),e.signal)})},b=uS(e.options,e.fetchOptions),w=async(C,R,N)=>{if(_)return Promise.reject();if(R==null&&C.pages.length)return Promise.resolve(C);const H=(()=>{const he={client:e.client,queryKey:e.queryKey,pageParam:R,direction:N?"backward":"forward",meta:e.options.meta};return v(he),he})(),F=await b(H),{maxPages:ae}=e.options,te=N?WR:KR;return{pages:te(C.pages,F,ae),pageParams:te(C.pageParams,R,ae)}};if(a&&l.length){const C=a==="backward",R=C?fD:kb,N={pages:l,pageParams:u},B=R(i,N);h=await w(N,B,C)}else{const C=t??l.length;do{const R=m===0?u[0]??i.initialPageParam:kb(i,h);if(m>0&&R==null)break;h=await w(h,R),m++}while(m<C)}return h};e.options.persister?e.fetchFn=()=>e.options.persister?.(g,{client:e.client,queryKey:e.queryKey,meta:e.options.meta,signal:e.signal},n):e.fetchFn=g}}}function kb(t,{pages:e,pageParams:n}){const i=e.length-1;return e.length>0?t.getNextPageParam(e[i],e,n[i],n):void 0}function fD(t,{pages:e,pageParams:n}){return e.length>0?t.getPreviousPageParam?.(e[0],e,n[0],n):void 0}var mD=class extends pS{#e;#t;#n;#i;constructor(e){super(),this.#e=e.client,this.mutationId=e.mutationId,this.#n=e.mutationCache,this.#t=[],this.state=e.state||yS(),this.setOptions(e.options),this.scheduleGc()}setOptions(e){this.options=e,this.updateGcTime(this.options.gcTime)}get meta(){return this.options.meta}addObserver(e){this.#t.includes(e)||(this.#t.push(e),this.clearGcTimeout(),this.#n.notify({type:"observerAdded",mutation:this,observer:e}))}removeObserver(e){this.#t=this.#t.filter(n=>n!==e),this.scheduleGc(),this.#n.notify({type:"observerRemoved",mutation:this,observer:e})}optionalRemove(){this.#t.length||(this.state.status==="pending"?this.scheduleGc():this.#n.remove(this))}continue(){return this.#i?.continue()??this.execute(this.state.variables)}async execute(e){const n=()=>{this.#r({type:"continue"})},i={client:this.#e,meta:this.options.meta,mutationKey:this.options.mutationKey};this.#i=mS({fn:()=>this.options.mutationFn?this.options.mutationFn(e,i):Promise.reject(new Error("No mutationFn found")),onFail:(u,h)=>{this.#r({type:"failed",failureCount:u,error:h})},onPause:()=>{this.#r({type:"pause"})},onContinue:n,retry:this.options.retry??0,retryDelay:this.options.retryDelay,networkMode:this.options.networkMode,canRun:()=>this.#n.canRun(this)});const a=this.state.status==="pending",l=!this.#i.canStart();try{if(a)n();else{this.#r({type:"pending",variables:e,isPaused:l}),await this.#n.config.onMutate?.(e,this,i);const h=await this.options.onMutate?.(e,i);h!==this.state.context&&this.#r({type:"pending",context:h,variables:e,isPaused:l})}const u=await this.#i.start();return await this.#n.config.onSuccess?.(u,e,this.state.context,this,i),await this.options.onSuccess?.(u,e,this.state.context,i),await this.#n.config.onSettled?.(u,null,this.state.variables,this.state.context,this,i),await this.options.onSettled?.(u,null,e,this.state.context,i),this.#r({type:"success",data:u}),u}catch(u){try{throw await this.#n.config.onError?.(u,e,this.state.context,this,i),await this.options.onError?.(u,e,this.state.context,i),await this.#n.config.onSettled?.(void 0,u,this.state.variables,this.state.context,this,i),await this.options.onSettled?.(void 0,u,e,this.state.context,i),u}finally{this.#r({type:"error",error:u})}}finally{this.#n.runNext(this)}}#r(e){const n=i=>{switch(e.type){case"failed":return{...i,failureCount:e.failureCount,failureReason:e.error};case"pause":return{...i,isPaused:!0};case"continue":return{...i,isPaused:!1};case"pending":return{...i,context:e.context,data:void 0,failureCount:0,failureReason:null,error:null,isPaused:e.isPaused,status:"pending",variables:e.variables,submittedAt:Date.now()};case"success":return{...i,data:e.data,failureCount:0,failureReason:null,error:null,status:"success",isPaused:!1};case"error":return{...i,data:void 0,error:e.error,failureCount:i.failureCount+1,failureReason:e.error,isPaused:!1,status:"error"}}};this.state=n(this.state),an.batch(()=>{this.#t.forEach(i=>{i.onMutationUpdate(e)}),this.#n.notify({mutation:this,type:"updated",action:e})})}};function yS(){return{context:void 0,data:void 0,error:null,failureCount:0,failureReason:null,isPaused:!1,status:"idle",variables:void 0,submittedAt:0}}var pD=class extends gl{constructor(t={}){super(),this.config=t,this.#e=new Set,this.#t=new Map,this.#n=0}#e;#t;#n;build(t,e,n){const i=new mD({client:t,mutationCache:this,mutationId:++this.#n,options:t.defaultMutationOptions(e),state:n});return this.add(i),i}add(t){this.#e.add(t);const e=Jd(t);if(typeof e=="string"){const n=this.#t.get(e);n?n.push(t):this.#t.set(e,[t])}this.notify({type:"added",mutation:t})}remove(t){if(this.#e.delete(t)){const e=Jd(t);if(typeof e=="string"){const n=this.#t.get(e);if(n)if(n.length>1){const i=n.indexOf(t);i!==-1&&n.splice(i,1)}else n[0]===t&&this.#t.delete(e)}}this.notify({type:"removed",mutation:t})}canRun(t){const e=Jd(t);if(typeof e=="string"){const i=this.#t.get(e)?.find(a=>a.state.status==="pending");return!i||i===t}else return!0}runNext(t){const e=Jd(t);return typeof e=="string"?this.#t.get(e)?.find(i=>i!==t&&i.state.isPaused)?.continue()??Promise.resolve():Promise.resolve()}clear(){an.batch(()=>{this.#e.forEach(t=>{this.notify({type:"removed",mutation:t})}),this.#e.clear(),this.#t.clear()})}getAll(){return Array.from(this.#e)}find(t){const e={exact:!0,...t};return this.getAll().find(n=>Ab(e,n))}findAll(t={}){return this.getAll().filter(e=>Ab(t,e))}notify(t){an.batch(()=>{this.listeners.forEach(e=>{e(t)})})}resumePausedMutations(){const t=this.getAll().filter(e=>e.state.isPaused);return an.batch(()=>Promise.all(t.map(e=>e.continue().catch(sn))))}};function Jd(t){return t.options.scope?.id}var gD=class extends gl{#e;#t=void 0;#n;#i;constructor(e,n){super(),this.#e=e,this.setOptions(n),this.bindMethods(),this.#r()}bindMethods(){this.mutate=this.mutate.bind(this),this.reset=this.reset.bind(this)}setOptions(e){const n=this.options;this.options=this.#e.defaultMutationOptions(e),bh(this.options,n)||this.#e.getMutationCache().notify({type:"observerOptionsUpdated",mutation:this.#n,observer:this}),n?.mutationKey&&this.options.mutationKey&&Va(n.mutationKey)!==Va(this.options.mutationKey)?this.reset():this.#n?.state.status==="pending"&&this.#n.setOptions(this.options)}onUnsubscribe(){this.hasListeners()||this.#n?.removeObserver(this)}onMutationUpdate(e){this.#r(),this.#a(e)}getCurrentResult(){return this.#t}reset(){this.#n?.removeObserver(this),this.#n=void 0,this.#r(),this.#a()}mutate(e,n){return this.#i=n,this.#n?.removeObserver(this),this.#n=this.#e.getMutationCache().build(this.#e,this.options),this.#n.addObserver(this),this.#n.execute(e)}#r(){const e=this.#n?.state??yS();this.#t={...e,isPending:e.status==="pending",isSuccess:e.status==="success",isError:e.status==="error",isIdle:e.status==="idle",mutate:this.mutate,reset:this.reset}}#a(e){an.batch(()=>{if(this.#i&&this.hasListeners()){const n=this.#t.variables,i=this.#t.context,a={client:this.#e,meta:this.options.meta,mutationKey:this.options.mutationKey};e?.type==="success"?(this.#i.onSuccess?.(e.data,n,i,a),this.#i.onSettled?.(e.data,null,n,i,a)):e?.type==="error"&&(this.#i.onError?.(e.error,n,i,a),this.#i.onSettled?.(void 0,e.error,n,i,a))}this.listeners.forEach(n=>{n(this.#t)})})}},yD=class extends gl{constructor(t={}){super(),this.config=t,this.#e=new Map}#e;build(t,e,n){const i=e.queryKey,a=e.queryHash??kg(i,e);let l=this.get(a);return l||(l=new cD({client:t,queryKey:i,queryHash:a,options:t.defaultQueryOptions(e),state:n,defaultOptions:t.getQueryDefaults(i)}),this.add(l)),l}add(t){this.#e.has(t.queryHash)||(this.#e.set(t.queryHash,t),this.notify({type:"added",query:t}))}remove(t){const e=this.#e.get(t.queryHash);e&&(t.destroy(),e===t&&this.#e.delete(t.queryHash),this.notify({type:"removed",query:t}))}clear(){an.batch(()=>{this.getAll().forEach(t=>{this.remove(t)})})}get(t){return this.#e.get(t)}getAll(){return[...this.#e.values()]}find(t){const e={exact:!0,...t};return this.getAll().find(n=>Tb(e,n))}findAll(t={}){const e=this.getAll();return Object.keys(t).length>0?e.filter(n=>Tb(t,n)):e}notify(t){an.batch(()=>{this.listeners.forEach(e=>{e(t)})})}onFocus(){an.batch(()=>{this.getAll().forEach(t=>{t.onFocus()})})}onOnline(){an.batch(()=>{this.getAll().forEach(t=>{t.onOnline()})})}},_D=class{#e;#t;#n;#i;#r;#a;#o;#s;constructor(t={}){this.#e=t.queryCache||new yD,this.#t=t.mutationCache||new pD,this.#n=t.defaultOptions||{},this.#i=new Map,this.#r=new Map,this.#a=0}mount(){this.#a++,this.#a===1&&(this.#o=Pg.subscribe(async t=>{t&&(await this.resumePausedMutations(),this.#e.onFocus())}),this.#s=xh.subscribe(async t=>{t&&(await this.resumePausedMutations(),this.#e.onOnline())}))}unmount(){this.#a--,this.#a===0&&(this.#o?.(),this.#o=void 0,this.#s?.(),this.#s=void 0)}isFetching(t){return this.#e.findAll({...t,fetchStatus:"fetching"}).length}isMutating(t){return this.#t.findAll({...t,status:"pending"}).length}getQueryData(t){const e=this.defaultQueryOptions({queryKey:t});return this.#e.get(e.queryHash)?.state.data}ensureQueryData(t){const e=this.defaultQueryOptions(t),n=this.#e.build(this,e),i=n.state.data;return i===void 0?this.fetchQuery(t):(t.revalidateIfStale&&n.isStaleByTime(Bs(e.staleTime,n))&&this.prefetchQuery(e),Promise.resolve(i))}getQueriesData(t){return this.#e.findAll(t).map(({queryKey:e,state:n})=>{const i=n.data;return[e,i]})}setQueryData(t,e,n){const i=this.defaultQueryOptions({queryKey:t}),l=this.#e.get(i.queryHash)?.state.data,u=HR(e,l);if(u!==void 0)return this.#e.build(this,i).setData(u,{...n,manual:!0})}setQueriesData(t,e,n){return an.batch(()=>this.#e.findAll(t).map(({queryKey:i})=>[i,this.setQueryData(i,e,n)]))}getQueryState(t){const e=this.defaultQueryOptions({queryKey:t});return this.#e.get(e.queryHash)?.state}removeQueries(t){const e=this.#e;an.batch(()=>{e.findAll(t).forEach(n=>{e.remove(n)})})}resetQueries(t,e){const n=this.#e;return an.batch(()=>(n.findAll(t).forEach(i=>{i.reset()}),this.refetchQueries({type:"active",...t},e)))}cancelQueries(t,e={}){const n={revert:!0,...e},i=an.batch(()=>this.#e.findAll(t).map(a=>a.cancel(n)));return Promise.all(i).then(sn).catch(sn)}invalidateQueries(t,e={}){return an.batch(()=>(this.#e.findAll(t).forEach(n=>{n.invalidate()}),t?.refetchType==="none"?Promise.resolve():this.refetchQueries({...t,type:t?.refetchType??t?.type??"active"},e)))}refetchQueries(t,e={}){const n={...e,cancelRefetch:e.cancelRefetch??!0},i=an.batch(()=>this.#e.findAll(t).filter(a=>!a.isDisabled()&&!a.isStatic()).map(a=>{let l=a.fetch(void 0,n);return n.throwOnError||(l=l.catch(sn)),a.state.fetchStatus==="paused"?Promise.resolve():l}));return Promise.all(i).then(sn)}fetchQuery(t){const e=this.defaultQueryOptions(t);e.retry===void 0&&(e.retry=!1);const n=this.#e.build(this,e);return n.isStaleByTime(Bs(e.staleTime,n))?n.fetch(e):Promise.resolve(n.state.data)}prefetchQuery(t){return this.fetchQuery(t).then(sn).catch(sn)}fetchInfiniteQuery(t){return t.behavior=Mb(t.pages),this.fetchQuery(t)}prefetchInfiniteQuery(t){return this.fetchInfiniteQuery(t).then(sn).catch(sn)}ensureInfiniteQueryData(t){return t.behavior=Mb(t.pages),this.ensureQueryData(t)}resumePausedMutations(){return xh.isOnline()?this.#t.resumePausedMutations():Promise.resolve()}getQueryCache(){return this.#e}getMutationCache(){return this.#t}getDefaultOptions(){return this.#n}setDefaultOptions(t){this.#n=t}setQueryDefaults(t,e){this.#i.set(Va(t),{queryKey:t,defaultOptions:e})}getQueryDefaults(t){const e=[...this.#i.values()],n={};return e.forEach(i=>{Wc(t,i.queryKey)&&Object.assign(n,i.defaultOptions)}),n}setMutationDefaults(t,e){this.#r.set(Va(t),{mutationKey:t,defaultOptions:e})}getMutationDefaults(t){const e=[...this.#r.values()],n={};return e.forEach(i=>{Wc(t,i.mutationKey)&&Object.assign(n,i.defaultOptions)}),n}defaultQueryOptions(t){if(t._defaulted)return t;const e={...this.#n.queries,...this.getQueryDefaults(t.queryKey),...t,_defaulted:!0};return e.queryHash||(e.queryHash=kg(e.queryKey,e)),e.refetchOnReconnect===void 0&&(e.refetchOnReconnect=e.networkMode!=="always"),e.throwOnError===void 0&&(e.throwOnError=!!e.suspense),!e.networkMode&&e.persister&&(e.networkMode="offlineFirst"),e.queryFn===Ng&&(e.enabled=!1),e}defaultMutationOptions(t){return t?._defaulted?t:{...this.#n.mutations,...t?.mutationKey&&this.getMutationDefaults(t.mutationKey),...t,_defaulted:!0}}clear(){this.#e.clear(),this.#t.clear()}},_S=A.createContext(void 0),ln=t=>{const e=A.useContext(_S);if(!e)throw new Error("No QueryClient set, use QueryClientProvider to set one");return e},vD=({client:t,children:e})=>(A.useEffect(()=>(t.mount(),()=>{t.unmount()}),[t]),d.jsx(_S.Provider,{value:t,children:e})),vS=A.createContext(!1),bD=()=>A.useContext(vS),xD=vS.Provider;function ED(){let t=!1;return{clearReset:()=>{t=!1},reset:()=>{t=!0},isReset:()=>t}}var SD=A.createContext(ED()),wD=()=>A.useContext(SD),TD=(t,e)=>{(t.suspense||t.throwOnError||t.experimental_prefetchInRender)&&(e.isReset()||(t.retryOnMount=!1))},AD=t=>{A.useEffect(()=>{t.clearReset()},[t])},CD=({result:t,errorResetBoundary:e,throwOnError:n,query:i,suspense:a})=>t.isError&&!e.isReset()&&!t.isFetching&&i&&(a&&t.data===void 0||dS(n,[t.error,i])),RD=t=>{if(t.suspense){const n=a=>a==="static"?a:Math.max(a??1e3,1e3),i=t.staleTime;t.staleTime=typeof i=="function"?(...a)=>n(i(...a)):n(i),typeof t.gcTime=="number"&&(t.gcTime=Math.max(t.gcTime,1e3))}},DD=(t,e)=>t.isLoading&&t.isFetching&&!e,ID=(t,e)=>t?.suspense&&e.isPending,Nb=(t,e,n)=>e.fetchOptimistic(t).catch(()=>{n.clearReset()});function jD(t,e,n){const i=bD(),a=wD(),l=ln(),u=l.defaultQueryOptions(t);l.getDefaultOptions().queries?._experimental_beforeQuery?.(u),u._optimisticResults=i?"isRestoring":"optimistic",RD(u),TD(u,a),AD(a);const h=!l.getQueryCache().get(u.queryHash),[m]=A.useState(()=>new e(l,u)),g=m.getOptimisticResult(u),_=!i&&t.subscribed!==!1;if(A.useSyncExternalStore(A.useCallback(v=>{const b=_?m.subscribe(an.batchCalls(v)):sn;return m.updateResult(),b},[m,_]),()=>m.getCurrentResult(),()=>m.getCurrentResult()),A.useEffect(()=>{m.setOptions(u)},[u,m]),ID(u,g))throw Nb(u,m,a);if(CD({result:g,errorResetBoundary:a,throwOnError:u.throwOnError,query:l.getQueryCache().get(u.queryHash),suspense:u.suspense}))throw g.error;return l.getDefaultOptions().queries?._experimental_afterQuery?.(u,g),u.experimental_prefetchInRender&&!La&&DD(g,i)&&(h?Nb(u,m,a):l.getQueryCache().get(u.queryHash)?.promise)?.catch(sn).finally(()=>{m.updateResult()}),u.notifyOnChangeProps?g:m.trackResult(g)}function yl(t,e){return jD(t,uD)}function ir(t,e){const n=ln(),[i]=A.useState(()=>new gD(n,t));A.useEffect(()=>{i.setOptions(t)},[i,t]);const a=A.useSyncExternalStore(A.useCallback(u=>i.subscribe(an.batchCalls(u)),[i]),()=>i.getCurrentResult(),()=>i.getCurrentResult()),l=A.useCallback((u,h)=>{i.mutate(u,h).catch(sn)},[i]);if(a.error&&dS(i.options.throwOnError,[a.error]))throw a.error;return{...a,mutate:l,mutateAsync:a.mutate}}function Kp(){}function OD(t,{interval:e=1e3,onError:n=Kp}={}){if(typeof t!="function")throw new Error("argument is not function.");let i=0,a=null,l=!1,u=!1;return async(...h)=>{if(a=h,!u){for(u=!0;l;)await new Promise(m=>Bi.setTimeout(m,e));for(;Date.now()<i;)await new Promise(m=>Bi.setTimeout(m,i-Date.now()));u=!1,l=!0;try{await t(...a)}catch(m){try{n(m)}catch{}}i=Date.now()+e,l=!1}}}var MD=({storage:t,key:e="REACT_QUERY_OFFLINE_CACHE",throttleTime:n=1e3,serialize:i=JSON.stringify,deserialize:a=JSON.parse,retry:l})=>{if(t){const u=async h=>{try{const m=await i(h);await t.setItem(e,m);return}catch(m){return m}};return{persistClient:OD(async h=>{let m=h,g=await u(m),_=0;for(;g&&m;)_++,m=await l?.({persistedClient:m,error:g,errorCount:_}),m&&(g=await u(m))},{interval:n}),restoreClient:async()=>{const h=await t.getItem(e);if(h)return await a(h)},removeClient:()=>t.removeItem(e)}}return{persistClient:Kp,restoreClient:()=>Promise.resolve(void 0),removeClient:Kp}};const bS=300*1e3,kD=1440*60*1e3,vt=new _D({defaultOptions:{queries:{staleTime:bS,gcTime:kD,refetchOnWindowFocus:!1,refetchOnReconnect:!0,retry:1,refetchOnMount:!1},mutations:{retry:1}}});vt.getQueryCache().subscribe(t=>{const e=t?.query;if(e&&t.type==="updated"){const{state:n}=e;n.status==="error"&&n.error&&console.error("[RQ] Query FAILED:",e.queryKey,n.error)}});const ND=MD({storage:typeof window<"u"?{getItem:t=>Promise.resolve(localStorage.getItem(t)),setItem:(t,e)=>Promise.resolve(localStorage.setItem(t,e)),removeItem:t=>Promise.resolve(localStorage.removeItem(t))}:void 0,key:"BUDGET_APP_QUERY_CACHE"}),xe={user:t=>["user",t],budget:t=>["budget",t],month:(t,e,n)=>["month",t,e,n],payees:t=>["payees",t],accessibleBudgets:t=>["accessibleBudgets",t],feedback:()=>["feedback"]};var PD=["added","removed","updated"];function Pb(t){return PD.includes(t)}async function LD({queryClient:t,persister:e,maxAge:n=1e3*60*60*24,buster:i="",hydrateOptions:a}){try{const l=await e.restoreClient();if(l)if(l.timestamp){const u=Date.now()-l.timestamp>n,h=l.buster!==i;if(u||h)return e.removeClient();iD(t,l.clientState,a)}else return e.removeClient()}catch(l){throw await e.removeClient(),l}}async function Lb({queryClient:t,persister:e,buster:n="",dehydrateOptions:i}){const a={buster:n,timestamp:Date.now(),clientState:rD(t,i)};await e.persistClient(a)}function VD(t){const e=t.queryClient.getQueryCache().subscribe(i=>{Pb(i.type)&&Lb(t)}),n=t.queryClient.getMutationCache().subscribe(i=>{Pb(i.type)&&Lb(t)});return()=>{e(),n()}}var zD=({children:t,persistOptions:e,onSuccess:n,onError:i,...a})=>{const[l,u]=A.useState(!0),h=A.useRef({persistOptions:e,onSuccess:n,onError:i}),m=A.useRef(!1);return A.useEffect(()=>{h.current={persistOptions:e,onSuccess:n,onError:i}}),A.useEffect(()=>{const g={...h.current.persistOptions,queryClient:a.client};return m.current||(m.current=!0,LD(g).then(()=>h.current.onSuccess?.()).catch(()=>h.current.onError?.()).finally(()=>{u(!1)})),l?void 0:VD(g)},[a.client,l]),d.jsx(vD,{...a,children:d.jsx(xD,{value:l,children:t})})};function UD({children:t}){return d.jsx(zD,{client:vt,persistOptions:{persister:ND,maxAge:1440*60*1e3,buster:"v1"},children:t})}const BD=()=>{};var Vb={};const xS=function(t){const e=[];let n=0;for(let i=0;i<t.length;i++){let a=t.charCodeAt(i);a<128?e[n++]=a:a<2048?(e[n++]=a>>6|192,e[n++]=a&63|128):(a&64512)===55296&&i+1<t.length&&(t.charCodeAt(i+1)&64512)===56320?(a=65536+((a&1023)<<10)+(t.charCodeAt(++i)&1023),e[n++]=a>>18|240,e[n++]=a>>12&63|128,e[n++]=a>>6&63|128,e[n++]=a&63|128):(e[n++]=a>>12|224,e[n++]=a>>6&63|128,e[n++]=a&63|128)}return e},FD=function(t){const e=[];let n=0,i=0;for(;n<t.length;){const a=t[n++];if(a<128)e[i++]=String.fromCharCode(a);else if(a>191&&a<224){const l=t[n++];e[i++]=String.fromCharCode((a&31)<<6|l&63)}else if(a>239&&a<365){const l=t[n++],u=t[n++],h=t[n++],m=((a&7)<<18|(l&63)<<12|(u&63)<<6|h&63)-65536;e[i++]=String.fromCharCode(55296+(m>>10)),e[i++]=String.fromCharCode(56320+(m&1023))}else{const l=t[n++],u=t[n++];e[i++]=String.fromCharCode((a&15)<<12|(l&63)<<6|u&63)}}return e.join("")},ES={byteToCharMap_:null,charToByteMap_:null,byteToCharMapWebSafe_:null,charToByteMapWebSafe_:null,ENCODED_VALS_BASE:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",get ENCODED_VALS(){return this.ENCODED_VALS_BASE+"+/="},get ENCODED_VALS_WEBSAFE(){return this.ENCODED_VALS_BASE+"-_."},HAS_NATIVE_SUPPORT:typeof atob=="function",encodeByteArray(t,e){if(!Array.isArray(t))throw Error("encodeByteArray takes an array as a parameter");this.init_();const n=e?this.byteToCharMapWebSafe_:this.byteToCharMap_,i=[];for(let a=0;a<t.length;a+=3){const l=t[a],u=a+1<t.length,h=u?t[a+1]:0,m=a+2<t.length,g=m?t[a+2]:0,_=l>>2,v=(l&3)<<4|h>>4;let b=(h&15)<<2|g>>6,w=g&63;m||(w=64,u||(b=64)),i.push(n[_],n[v],n[b],n[w])}return i.join("")},encodeString(t,e){return this.HAS_NATIVE_SUPPORT&&!e?btoa(t):this.encodeByteArray(xS(t),e)},decodeString(t,e){return this.HAS_NATIVE_SUPPORT&&!e?atob(t):FD(this.decodeStringToByteArray(t,e))},decodeStringToByteArray(t,e){this.init_();const n=e?this.charToByteMapWebSafe_:this.charToByteMap_,i=[];for(let a=0;a<t.length;){const l=n[t.charAt(a++)],h=a<t.length?n[t.charAt(a)]:0;++a;const g=a<t.length?n[t.charAt(a)]:64;++a;const v=a<t.length?n[t.charAt(a)]:64;if(++a,l==null||h==null||g==null||v==null)throw new qD;const b=l<<2|h>>4;if(i.push(b),g!==64){const w=h<<4&240|g>>2;if(i.push(w),v!==64){const C=g<<6&192|v;i.push(C)}}}return i},init_(){if(!this.byteToCharMap_){this.byteToCharMap_={},this.charToByteMap_={},this.byteToCharMapWebSafe_={},this.charToByteMapWebSafe_={};for(let t=0;t<this.ENCODED_VALS.length;t++)this.byteToCharMap_[t]=this.ENCODED_VALS.charAt(t),this.charToByteMap_[this.byteToCharMap_[t]]=t,this.byteToCharMapWebSafe_[t]=this.ENCODED_VALS_WEBSAFE.charAt(t),this.charToByteMapWebSafe_[this.byteToCharMapWebSafe_[t]]=t,t>=this.ENCODED_VALS_BASE.length&&(this.charToByteMap_[this.ENCODED_VALS_WEBSAFE.charAt(t)]=t,this.charToByteMapWebSafe_[this.ENCODED_VALS.charAt(t)]=t)}}};class qD extends Error{constructor(){super(...arguments),this.name="DecodeBase64StringError"}}const GD=function(t){const e=xS(t);return ES.encodeByteArray(e,!0)},Eh=function(t){return GD(t).replace(/\./g,"")},SS=function(t){try{return ES.decodeString(t,!0)}catch(e){console.error("base64Decode failed: ",e)}return null};function HD(){if(typeof self<"u")return self;if(typeof window<"u")return window;if(typeof global<"u")return global;throw new Error("Unable to locate global object.")}const QD=()=>HD().__FIREBASE_DEFAULTS__,$D=()=>{if(typeof process>"u"||typeof Vb>"u")return;const t=Vb.__FIREBASE_DEFAULTS__;if(t)return JSON.parse(t)},KD=()=>{if(typeof document>"u")return;let t;try{t=document.cookie.match(/__FIREBASE_DEFAULTS__=([^;]+)/)}catch{return}const e=t&&SS(t[1]);return e&&JSON.parse(e)},Kh=()=>{try{return BD()||QD()||$D()||KD()}catch(t){console.info(`Unable to get __FIREBASE_DEFAULTS__ due to: ${t}`);return}},wS=t=>Kh()?.emulatorHosts?.[t],WD=t=>{const e=wS(t);if(!e)return;const n=e.lastIndexOf(":");if(n<=0||n+1===e.length)throw new Error(`Invalid host ${e} with no separate hostname and port!`);const i=parseInt(e.substring(n+1),10);return e[0]==="["?[e.substring(1,n-1),i]:[e.substring(0,n),i]},TS=()=>Kh()?.config,AS=t=>Kh()?.[`_${t}`];class YD{constructor(){this.reject=()=>{},this.resolve=()=>{},this.promise=new Promise((e,n)=>{this.resolve=e,this.reject=n})}wrapCallback(e){return(n,i)=>{n?this.reject(n):this.resolve(i),typeof e=="function"&&(this.promise.catch(()=>{}),e.length===1?e(n):e(n,i))}}}function _l(t){try{return(t.startsWith("http://")||t.startsWith("https://")?new URL(t).hostname:t).endsWith(".cloudworkstations.dev")}catch{return!1}}async function CS(t){return(await fetch(t,{credentials:"include"})).ok}function XD(t,e){if(t.uid)throw new Error('The "uid" field is no longer supported by mockUserToken. Please use "sub" instead for Firebase Auth User ID.');const n={alg:"none",type:"JWT"},i=e||"demo-project",a=t.iat||0,l=t.sub||t.user_id;if(!l)throw new Error("mockUserToken must contain 'sub' or 'user_id' field!");const u={iss:`https://securetoken.google.com/${i}`,aud:i,iat:a,exp:a+3600,auth_time:a,sub:l,user_id:l,firebase:{sign_in_provider:"custom",identities:{}},...t};return[Eh(JSON.stringify(n)),Eh(JSON.stringify(u)),""].join(".")}const Fc={};function JD(){const t={prod:[],emulator:[]};for(const e of Object.keys(Fc))Fc[e]?t.emulator.push(e):t.prod.push(e);return t}function ZD(t){let e=document.getElementById(t),n=!1;return e||(e=document.createElement("div"),e.setAttribute("id",t),n=!0),{created:n,element:e}}let zb=!1;function RS(t,e){if(typeof window>"u"||typeof document>"u"||!_l(window.location.host)||Fc[t]===e||Fc[t]||zb)return;Fc[t]=e;function n(b){return`__firebase__banner__${b}`}const i="__firebase__banner",l=JD().prod.length>0;function u(){const b=document.getElementById(i);b&&b.remove()}function h(b){b.style.display="flex",b.style.background="#7faaf0",b.style.position="fixed",b.style.bottom="5px",b.style.left="5px",b.style.padding=".5em",b.style.borderRadius="5px",b.style.alignItems="center"}function m(b,w){b.setAttribute("width","24"),b.setAttribute("id",w),b.setAttribute("height","24"),b.setAttribute("viewBox","0 0 24 24"),b.setAttribute("fill","none"),b.style.marginLeft="-6px"}function g(){const b=document.createElement("span");return b.style.cursor="pointer",b.style.marginLeft="16px",b.style.fontSize="24px",b.innerHTML=" &times;",b.onclick=()=>{zb=!0,u()},b}function _(b,w){b.setAttribute("id",w),b.innerText="Learn more",b.href="https://firebase.google.com/docs/studio/preview-apps#preview-backend",b.setAttribute("target","__blank"),b.style.paddingLeft="5px",b.style.textDecoration="underline"}function v(){const b=ZD(i),w=n("text"),C=document.getElementById(w)||document.createElement("span"),R=n("learnmore"),N=document.getElementById(R)||document.createElement("a"),B=n("preprendIcon"),H=document.getElementById(B)||document.createElementNS("http://www.w3.org/2000/svg","svg");if(b.created){const F=b.element;h(F),_(N,R);const ae=g();m(H,B),F.append(H,C,N,ae),document.body.appendChild(F)}l?(C.innerText="Preview backend disconnected.",H.innerHTML=`<g clip-path="url(#clip0_6013_33858)">
<path d="M4.8 17.6L12 5.6L19.2 17.6H4.8ZM6.91667 16.4H17.0833L12 7.93333L6.91667 16.4ZM12 15.6C12.1667 15.6 12.3056 15.5444 12.4167 15.4333C12.5389 15.3111 12.6 15.1667 12.6 15C12.6 14.8333 12.5389 14.6944 12.4167 14.5833C12.3056 14.4611 12.1667 14.4 12 14.4C11.8333 14.4 11.6889 14.4611 11.5667 14.5833C11.4556 14.6944 11.4 14.8333 11.4 15C11.4 15.1667 11.4556 15.3111 11.5667 15.4333C11.6889 15.5444 11.8333 15.6 12 15.6ZM11.4 13.6H12.6V10.4H11.4V13.6Z" fill="#212121"/>
</g>
<defs>
<clipPath id="clip0_6013_33858">
<rect width="24" height="24" fill="white"/>
</clipPath>
</defs>`):(H.innerHTML=`<g clip-path="url(#clip0_6083_34804)">
<path d="M11.4 15.2H12.6V11.2H11.4V15.2ZM12 10C12.1667 10 12.3056 9.94444 12.4167 9.83333C12.5389 9.71111 12.6 9.56667 12.6 9.4C12.6 9.23333 12.5389 9.09444 12.4167 8.98333C12.3056 8.86111 12.1667 8.8 12 8.8C11.8333 8.8 11.6889 8.86111 11.5667 8.98333C11.4556 9.09444 11.4 9.23333 11.4 9.4C11.4 9.56667 11.4556 9.71111 11.5667 9.83333C11.6889 9.94444 11.8333 10 12 10ZM12 18.4C11.1222 18.4 10.2944 18.2333 9.51667 17.9C8.73889 17.5667 8.05556 17.1111 7.46667 16.5333C6.88889 15.9444 6.43333 15.2611 6.1 14.4833C5.76667 13.7056 5.6 12.8778 5.6 12C5.6 11.1111 5.76667 10.2833 6.1 9.51667C6.43333 8.73889 6.88889 8.06111 7.46667 7.48333C8.05556 6.89444 8.73889 6.43333 9.51667 6.1C10.2944 5.76667 11.1222 5.6 12 5.6C12.8889 5.6 13.7167 5.76667 14.4833 6.1C15.2611 6.43333 15.9389 6.89444 16.5167 7.48333C17.1056 8.06111 17.5667 8.73889 17.9 9.51667C18.2333 10.2833 18.4 11.1111 18.4 12C18.4 12.8778 18.2333 13.7056 17.9 14.4833C17.5667 15.2611 17.1056 15.9444 16.5167 16.5333C15.9389 17.1111 15.2611 17.5667 14.4833 17.9C13.7167 18.2333 12.8889 18.4 12 18.4ZM12 17.2C13.4444 17.2 14.6722 16.6944 15.6833 15.6833C16.6944 14.6722 17.2 13.4444 17.2 12C17.2 10.5556 16.6944 9.32778 15.6833 8.31667C14.6722 7.30555 13.4444 6.8 12 6.8C10.5556 6.8 9.32778 7.30555 8.31667 8.31667C7.30556 9.32778 6.8 10.5556 6.8 12C6.8 13.4444 7.30556 14.6722 8.31667 15.6833C9.32778 16.6944 10.5556 17.2 12 17.2Z" fill="#212121"/>
</g>
<defs>
<clipPath id="clip0_6083_34804">
<rect width="24" height="24" fill="white"/>
</clipPath>
</defs>`,C.innerText="Preview backend running in this workspace."),C.setAttribute("id",w)}document.readyState==="loading"?window.addEventListener("DOMContentLoaded",v):v()}function In(){return typeof navigator<"u"&&typeof navigator.userAgent=="string"?navigator.userAgent:""}function eI(){return typeof window<"u"&&!!(window.cordova||window.phonegap||window.PhoneGap)&&/ios|iphone|ipod|ipad|android|blackberry|iemobile/i.test(In())}function tI(){const t=Kh()?.forceEnvironment;if(t==="node")return!0;if(t==="browser")return!1;try{return Object.prototype.toString.call(global.process)==="[object process]"}catch{return!1}}function nI(){return typeof navigator<"u"&&navigator.userAgent==="Cloudflare-Workers"}function rI(){const t=typeof chrome=="object"?chrome.runtime:typeof browser=="object"?browser.runtime:void 0;return typeof t=="object"&&t.id!==void 0}function iI(){return typeof navigator=="object"&&navigator.product==="ReactNative"}function sI(){const t=In();return t.indexOf("MSIE ")>=0||t.indexOf("Trident/")>=0}function aI(){return!tI()&&!!navigator.userAgent&&navigator.userAgent.includes("Safari")&&!navigator.userAgent.includes("Chrome")}function oI(){try{return typeof indexedDB=="object"}catch{return!1}}function lI(){return new Promise((t,e)=>{try{let n=!0;const i="validate-browser-context-for-indexeddb-analytics-module",a=self.indexedDB.open(i);a.onsuccess=()=>{a.result.close(),n||self.indexedDB.deleteDatabase(i),t(!0)},a.onupgradeneeded=()=>{n=!1},a.onerror=()=>{e(a.error?.message||"")}}catch(n){e(n)}})}const cI="FirebaseError";class Xi extends Error{constructor(e,n,i){super(n),this.code=e,this.customData=i,this.name=cI,Object.setPrototypeOf(this,Xi.prototype),Error.captureStackTrace&&Error.captureStackTrace(this,uu.prototype.create)}}class uu{constructor(e,n,i){this.service=e,this.serviceName=n,this.errors=i}create(e,...n){const i=n[0]||{},a=`${this.service}/${e}`,l=this.errors[e],u=l?uI(l,i):"Error",h=`${this.serviceName}: ${u} (${a}).`;return new Xi(a,h,i)}}function uI(t,e){return t.replace(dI,(n,i)=>{const a=e[i];return a!=null?String(a):`<${i}?>`})}const dI=/\{\$([^}]+)}/g;function hI(t){for(const e in t)if(Object.prototype.hasOwnProperty.call(t,e))return!1;return!0}function Ks(t,e){if(t===e)return!0;const n=Object.keys(t),i=Object.keys(e);for(const a of n){if(!i.includes(a))return!1;const l=t[a],u=e[a];if(Ub(l)&&Ub(u)){if(!Ks(l,u))return!1}else if(l!==u)return!1}for(const a of i)if(!n.includes(a))return!1;return!0}function Ub(t){return t!==null&&typeof t=="object"}function du(t){const e=[];for(const[n,i]of Object.entries(t))Array.isArray(i)?i.forEach(a=>{e.push(encodeURIComponent(n)+"="+encodeURIComponent(a))}):e.push(encodeURIComponent(n)+"="+encodeURIComponent(i));return e.length?"&"+e.join("&"):""}function Pc(t){const e={};return t.replace(/^\?/,"").split("&").forEach(i=>{if(i){const[a,l]=i.split("=");e[decodeURIComponent(a)]=decodeURIComponent(l)}}),e}function Lc(t){const e=t.indexOf("?");if(!e)return"";const n=t.indexOf("#",e);return t.substring(e,n>0?n:void 0)}function fI(t,e){const n=new mI(t,e);return n.subscribe.bind(n)}class mI{constructor(e,n){this.observers=[],this.unsubscribes=[],this.observerCount=0,this.task=Promise.resolve(),this.finalized=!1,this.onNoObservers=n,this.task.then(()=>{e(this)}).catch(i=>{this.error(i)})}next(e){this.forEachObserver(n=>{n.next(e)})}error(e){this.forEachObserver(n=>{n.error(e)}),this.close(e)}complete(){this.forEachObserver(e=>{e.complete()}),this.close()}subscribe(e,n,i){let a;if(e===void 0&&n===void 0&&i===void 0)throw new Error("Missing Observer.");pI(e,["next","error","complete"])?a=e:a={next:e,error:n,complete:i},a.next===void 0&&(a.next=Tp),a.error===void 0&&(a.error=Tp),a.complete===void 0&&(a.complete=Tp);const l=this.unsubscribeOne.bind(this,this.observers.length);return this.finalized&&this.task.then(()=>{try{this.finalError?a.error(this.finalError):a.complete()}catch{}}),this.observers.push(a),l}unsubscribeOne(e){this.observers===void 0||this.observers[e]===void 0||(delete this.observers[e],this.observerCount-=1,this.observerCount===0&&this.onNoObservers!==void 0&&this.onNoObservers(this))}forEachObserver(e){if(!this.finalized)for(let n=0;n<this.observers.length;n++)this.sendOne(n,e)}sendOne(e,n){this.task.then(()=>{if(this.observers!==void 0&&this.observers[e]!==void 0)try{n(this.observers[e])}catch(i){typeof console<"u"&&console.error&&console.error(i)}})}close(e){this.finalized||(this.finalized=!0,e!==void 0&&(this.finalError=e),this.task.then(()=>{this.observers=void 0,this.onNoObservers=void 0}))}}function pI(t,e){if(typeof t!="object"||t===null)return!1;for(const n of e)if(n in t&&typeof t[n]=="function")return!0;return!1}function Tp(){}function mn(t){return t&&t._delegate?t._delegate:t}class za{constructor(e,n,i){this.name=e,this.instanceFactory=n,this.type=i,this.multipleInstances=!1,this.serviceProps={},this.instantiationMode="LAZY",this.onInstanceCreated=null}setInstantiationMode(e){return this.instantiationMode=e,this}setMultipleInstances(e){return this.multipleInstances=e,this}setServiceProps(e){return this.serviceProps=e,this}setInstanceCreatedCallback(e){return this.onInstanceCreated=e,this}}const Ma="[DEFAULT]";class gI{constructor(e,n){this.name=e,this.container=n,this.component=null,this.instances=new Map,this.instancesDeferred=new Map,this.instancesOptions=new Map,this.onInitCallbacks=new Map}get(e){const n=this.normalizeInstanceIdentifier(e);if(!this.instancesDeferred.has(n)){const i=new YD;if(this.instancesDeferred.set(n,i),this.isInitialized(n)||this.shouldAutoInitialize())try{const a=this.getOrInitializeService({instanceIdentifier:n});a&&i.resolve(a)}catch{}}return this.instancesDeferred.get(n).promise}getImmediate(e){const n=this.normalizeInstanceIdentifier(e?.identifier),i=e?.optional??!1;if(this.isInitialized(n)||this.shouldAutoInitialize())try{return this.getOrInitializeService({instanceIdentifier:n})}catch(a){if(i)return null;throw a}else{if(i)return null;throw Error(`Service ${this.name} is not available`)}}getComponent(){return this.component}setComponent(e){if(e.name!==this.name)throw Error(`Mismatching Component ${e.name} for Provider ${this.name}.`);if(this.component)throw Error(`Component for ${this.name} has already been provided`);if(this.component=e,!!this.shouldAutoInitialize()){if(_I(e))try{this.getOrInitializeService({instanceIdentifier:Ma})}catch{}for(const[n,i]of this.instancesDeferred.entries()){const a=this.normalizeInstanceIdentifier(n);try{const l=this.getOrInitializeService({instanceIdentifier:a});i.resolve(l)}catch{}}}}clearInstance(e=Ma){this.instancesDeferred.delete(e),this.instancesOptions.delete(e),this.instances.delete(e)}async delete(){const e=Array.from(this.instances.values());await Promise.all([...e.filter(n=>"INTERNAL"in n).map(n=>n.INTERNAL.delete()),...e.filter(n=>"_delete"in n).map(n=>n._delete())])}isComponentSet(){return this.component!=null}isInitialized(e=Ma){return this.instances.has(e)}getOptions(e=Ma){return this.instancesOptions.get(e)||{}}initialize(e={}){const{options:n={}}=e,i=this.normalizeInstanceIdentifier(e.instanceIdentifier);if(this.isInitialized(i))throw Error(`${this.name}(${i}) has already been initialized`);if(!this.isComponentSet())throw Error(`Component ${this.name} has not been registered yet`);const a=this.getOrInitializeService({instanceIdentifier:i,options:n});for(const[l,u]of this.instancesDeferred.entries()){const h=this.normalizeInstanceIdentifier(l);i===h&&u.resolve(a)}return a}onInit(e,n){const i=this.normalizeInstanceIdentifier(n),a=this.onInitCallbacks.get(i)??new Set;a.add(e),this.onInitCallbacks.set(i,a);const l=this.instances.get(i);return l&&e(l,i),()=>{a.delete(e)}}invokeOnInitCallbacks(e,n){const i=this.onInitCallbacks.get(n);if(i)for(const a of i)try{a(e,n)}catch{}}getOrInitializeService({instanceIdentifier:e,options:n={}}){let i=this.instances.get(e);if(!i&&this.component&&(i=this.component.instanceFactory(this.container,{instanceIdentifier:yI(e),options:n}),this.instances.set(e,i),this.instancesOptions.set(e,n),this.invokeOnInitCallbacks(i,e),this.component.onInstanceCreated))try{this.component.onInstanceCreated(this.container,e,i)}catch{}return i||null}normalizeInstanceIdentifier(e=Ma){return this.component?this.component.multipleInstances?e:Ma:e}shouldAutoInitialize(){return!!this.component&&this.component.instantiationMode!=="EXPLICIT"}}function yI(t){return t===Ma?void 0:t}function _I(t){return t.instantiationMode==="EAGER"}class vI{constructor(e){this.name=e,this.providers=new Map}addComponent(e){const n=this.getProvider(e.name);if(n.isComponentSet())throw new Error(`Component ${e.name} has already been registered with ${this.name}`);n.setComponent(e)}addOrOverwriteComponent(e){this.getProvider(e.name).isComponentSet()&&this.providers.delete(e.name),this.addComponent(e)}getProvider(e){if(this.providers.has(e))return this.providers.get(e);const n=new gI(e,this);return this.providers.set(e,n),n}getProviders(){return Array.from(this.providers.values())}}var Je;(function(t){t[t.DEBUG=0]="DEBUG",t[t.VERBOSE=1]="VERBOSE",t[t.INFO=2]="INFO",t[t.WARN=3]="WARN",t[t.ERROR=4]="ERROR",t[t.SILENT=5]="SILENT"})(Je||(Je={}));const bI={debug:Je.DEBUG,verbose:Je.VERBOSE,info:Je.INFO,warn:Je.WARN,error:Je.ERROR,silent:Je.SILENT},xI=Je.INFO,EI={[Je.DEBUG]:"log",[Je.VERBOSE]:"log",[Je.INFO]:"info",[Je.WARN]:"warn",[Je.ERROR]:"error"},SI=(t,e,...n)=>{if(e<t.logLevel)return;const i=new Date().toISOString(),a=EI[e];if(a)console[a](`[${i}]  ${t.name}:`,...n);else throw new Error(`Attempted to log a message with an invalid logType (value: ${e})`)};class Vg{constructor(e){this.name=e,this._logLevel=xI,this._logHandler=SI,this._userLogHandler=null}get logLevel(){return this._logLevel}set logLevel(e){if(!(e in Je))throw new TypeError(`Invalid value "${e}" assigned to \`logLevel\``);this._logLevel=e}setLogLevel(e){this._logLevel=typeof e=="string"?bI[e]:e}get logHandler(){return this._logHandler}set logHandler(e){if(typeof e!="function")throw new TypeError("Value assigned to `logHandler` must be a function");this._logHandler=e}get userLogHandler(){return this._userLogHandler}set userLogHandler(e){this._userLogHandler=e}debug(...e){this._userLogHandler&&this._userLogHandler(this,Je.DEBUG,...e),this._logHandler(this,Je.DEBUG,...e)}log(...e){this._userLogHandler&&this._userLogHandler(this,Je.VERBOSE,...e),this._logHandler(this,Je.VERBOSE,...e)}info(...e){this._userLogHandler&&this._userLogHandler(this,Je.INFO,...e),this._logHandler(this,Je.INFO,...e)}warn(...e){this._userLogHandler&&this._userLogHandler(this,Je.WARN,...e),this._logHandler(this,Je.WARN,...e)}error(...e){this._userLogHandler&&this._userLogHandler(this,Je.ERROR,...e),this._logHandler(this,Je.ERROR,...e)}}const wI=(t,e)=>e.some(n=>t instanceof n);let Bb,Fb;function TI(){return Bb||(Bb=[IDBDatabase,IDBObjectStore,IDBIndex,IDBCursor,IDBTransaction])}function AI(){return Fb||(Fb=[IDBCursor.prototype.advance,IDBCursor.prototype.continue,IDBCursor.prototype.continuePrimaryKey])}const DS=new WeakMap,Wp=new WeakMap,IS=new WeakMap,Ap=new WeakMap,zg=new WeakMap;function CI(t){const e=new Promise((n,i)=>{const a=()=>{t.removeEventListener("success",l),t.removeEventListener("error",u)},l=()=>{n(Fs(t.result)),a()},u=()=>{i(t.error),a()};t.addEventListener("success",l),t.addEventListener("error",u)});return e.then(n=>{n instanceof IDBCursor&&DS.set(n,t)}).catch(()=>{}),zg.set(e,t),e}function RI(t){if(Wp.has(t))return;const e=new Promise((n,i)=>{const a=()=>{t.removeEventListener("complete",l),t.removeEventListener("error",u),t.removeEventListener("abort",u)},l=()=>{n(),a()},u=()=>{i(t.error||new DOMException("AbortError","AbortError")),a()};t.addEventListener("complete",l),t.addEventListener("error",u),t.addEventListener("abort",u)});Wp.set(t,e)}let Yp={get(t,e,n){if(t instanceof IDBTransaction){if(e==="done")return Wp.get(t);if(e==="objectStoreNames")return t.objectStoreNames||IS.get(t);if(e==="store")return n.objectStoreNames[1]?void 0:n.objectStore(n.objectStoreNames[0])}return Fs(t[e])},set(t,e,n){return t[e]=n,!0},has(t,e){return t instanceof IDBTransaction&&(e==="done"||e==="store")?!0:e in t}};function DI(t){Yp=t(Yp)}function II(t){return t===IDBDatabase.prototype.transaction&&!("objectStoreNames"in IDBTransaction.prototype)?function(e,...n){const i=t.call(Cp(this),e,...n);return IS.set(i,e.sort?e.sort():[e]),Fs(i)}:AI().includes(t)?function(...e){return t.apply(Cp(this),e),Fs(DS.get(this))}:function(...e){return Fs(t.apply(Cp(this),e))}}function jI(t){return typeof t=="function"?II(t):(t instanceof IDBTransaction&&RI(t),wI(t,TI())?new Proxy(t,Yp):t)}function Fs(t){if(t instanceof IDBRequest)return CI(t);if(Ap.has(t))return Ap.get(t);const e=jI(t);return e!==t&&(Ap.set(t,e),zg.set(e,t)),e}const Cp=t=>zg.get(t);function OI(t,e,{blocked:n,upgrade:i,blocking:a,terminated:l}={}){const u=indexedDB.open(t,e),h=Fs(u);return i&&u.addEventListener("upgradeneeded",m=>{i(Fs(u.result),m.oldVersion,m.newVersion,Fs(u.transaction),m)}),n&&u.addEventListener("blocked",m=>n(m.oldVersion,m.newVersion,m)),h.then(m=>{l&&m.addEventListener("close",()=>l()),a&&m.addEventListener("versionchange",g=>a(g.oldVersion,g.newVersion,g))}).catch(()=>{}),h}const MI=["get","getKey","getAll","getAllKeys","count"],kI=["put","add","delete","clear"],Rp=new Map;function qb(t,e){if(!(t instanceof IDBDatabase&&!(e in t)&&typeof e=="string"))return;if(Rp.get(e))return Rp.get(e);const n=e.replace(/FromIndex$/,""),i=e!==n,a=kI.includes(n);if(!(n in(i?IDBIndex:IDBObjectStore).prototype)||!(a||MI.includes(n)))return;const l=async function(u,...h){const m=this.transaction(u,a?"readwrite":"readonly");let g=m.store;return i&&(g=g.index(h.shift())),(await Promise.all([g[n](...h),a&&m.done]))[0]};return Rp.set(e,l),l}DI(t=>({...t,get:(e,n,i)=>qb(e,n)||t.get(e,n,i),has:(e,n)=>!!qb(e,n)||t.has(e,n)}));class NI{constructor(e){this.container=e}getPlatformInfoString(){return this.container.getProviders().map(n=>{if(PI(n)){const i=n.getImmediate();return`${i.library}/${i.version}`}else return null}).filter(n=>n).join(" ")}}function PI(t){return t.getComponent()?.type==="VERSION"}const Xp="@firebase/app",Gb="0.14.6";const $i=new Vg("@firebase/app"),LI="@firebase/app-compat",VI="@firebase/analytics-compat",zI="@firebase/analytics",UI="@firebase/app-check-compat",BI="@firebase/app-check",FI="@firebase/auth",qI="@firebase/auth-compat",GI="@firebase/database",HI="@firebase/data-connect",QI="@firebase/database-compat",$I="@firebase/functions",KI="@firebase/functions-compat",WI="@firebase/installations",YI="@firebase/installations-compat",XI="@firebase/messaging",JI="@firebase/messaging-compat",ZI="@firebase/performance",ej="@firebase/performance-compat",tj="@firebase/remote-config",nj="@firebase/remote-config-compat",rj="@firebase/storage",ij="@firebase/storage-compat",sj="@firebase/firestore",aj="@firebase/ai",oj="@firebase/firestore-compat",lj="firebase",cj="12.6.0";const Jp="[DEFAULT]",uj={[Xp]:"fire-core",[LI]:"fire-core-compat",[zI]:"fire-analytics",[VI]:"fire-analytics-compat",[BI]:"fire-app-check",[UI]:"fire-app-check-compat",[FI]:"fire-auth",[qI]:"fire-auth-compat",[GI]:"fire-rtdb",[HI]:"fire-data-connect",[QI]:"fire-rtdb-compat",[$I]:"fire-fn",[KI]:"fire-fn-compat",[WI]:"fire-iid",[YI]:"fire-iid-compat",[XI]:"fire-fcm",[JI]:"fire-fcm-compat",[ZI]:"fire-perf",[ej]:"fire-perf-compat",[tj]:"fire-rc",[nj]:"fire-rc-compat",[rj]:"fire-gcs",[ij]:"fire-gcs-compat",[sj]:"fire-fst",[oj]:"fire-fst-compat",[aj]:"fire-vertex","fire-js":"fire-js",[lj]:"fire-js-all"};const Sh=new Map,dj=new Map,Zp=new Map;function Hb(t,e){try{t.container.addComponent(e)}catch(n){$i.debug(`Component ${e.name} failed to register with FirebaseApp ${t.name}`,n)}}function tl(t){const e=t.name;if(Zp.has(e))return $i.debug(`There were multiple attempts to register component ${e}.`),!1;Zp.set(e,t);for(const n of Sh.values())Hb(n,t);for(const n of dj.values())Hb(n,t);return!0}function Ug(t,e){const n=t.container.getProvider("heartbeat").getImmediate({optional:!0});return n&&n.triggerHeartbeat(),t.container.getProvider(e)}function Vr(t){return t==null?!1:t.settings!==void 0}const hj={"no-app":"No Firebase App '{$appName}' has been created - call initializeApp() first","bad-app-name":"Illegal App name: '{$appName}'","duplicate-app":"Firebase App named '{$appName}' already exists with different options or config","app-deleted":"Firebase App named '{$appName}' already deleted","server-app-deleted":"Firebase Server App has been deleted","no-options":"Need to provide options, when not being deployed to hosting via source.","invalid-app-argument":"firebase.{$appName}() takes either no argument or a Firebase App instance.","invalid-log-argument":"First argument to `onLog` must be null or a function.","idb-open":"Error thrown when opening IndexedDB. Original error: {$originalErrorMessage}.","idb-get":"Error thrown when reading from IndexedDB. Original error: {$originalErrorMessage}.","idb-set":"Error thrown when writing to IndexedDB. Original error: {$originalErrorMessage}.","idb-delete":"Error thrown when deleting from IndexedDB. Original error: {$originalErrorMessage}.","finalization-registry-not-supported":"FirebaseServerApp deleteOnDeref field defined but the JS runtime does not support FinalizationRegistry.","invalid-server-app-environment":"FirebaseServerApp is not for use in browser environments."},qs=new uu("app","Firebase",hj);class fj{constructor(e,n,i){this._isDeleted=!1,this._options={...e},this._config={...n},this._name=n.name,this._automaticDataCollectionEnabled=n.automaticDataCollectionEnabled,this._container=i,this.container.addComponent(new za("app",()=>this,"PUBLIC"))}get automaticDataCollectionEnabled(){return this.checkDestroyed(),this._automaticDataCollectionEnabled}set automaticDataCollectionEnabled(e){this.checkDestroyed(),this._automaticDataCollectionEnabled=e}get name(){return this.checkDestroyed(),this._name}get options(){return this.checkDestroyed(),this._options}get config(){return this.checkDestroyed(),this._config}get container(){return this._container}get isDeleted(){return this._isDeleted}set isDeleted(e){this._isDeleted=e}checkDestroyed(){if(this.isDeleted)throw qs.create("app-deleted",{appName:this._name})}}const vl=cj;function jS(t,e={}){let n=t;typeof e!="object"&&(e={name:e});const i={name:Jp,automaticDataCollectionEnabled:!0,...e},a=i.name;if(typeof a!="string"||!a)throw qs.create("bad-app-name",{appName:String(a)});if(n||(n=TS()),!n)throw qs.create("no-options");const l=Sh.get(a);if(l){if(Ks(n,l.options)&&Ks(i,l.config))return l;throw qs.create("duplicate-app",{appName:a})}const u=new vI(a);for(const m of Zp.values())u.addComponent(m);const h=new fj(n,i,u);return Sh.set(a,h),h}function OS(t=Jp){const e=Sh.get(t);if(!e&&t===Jp&&TS())return jS();if(!e)throw qs.create("no-app",{appName:t});return e}function Gs(t,e,n){let i=uj[t]??t;n&&(i+=`-${n}`);const a=i.match(/\s|\//),l=e.match(/\s|\//);if(a||l){const u=[`Unable to register library "${i}" with version "${e}":`];a&&u.push(`library name "${i}" contains illegal characters (whitespace or "/")`),a&&l&&u.push("and"),l&&u.push(`version name "${e}" contains illegal characters (whitespace or "/")`),$i.warn(u.join(" "));return}tl(new za(`${i}-version`,()=>({library:i,version:e}),"VERSION"))}const mj="firebase-heartbeat-database",pj=1,Yc="firebase-heartbeat-store";let Dp=null;function MS(){return Dp||(Dp=OI(mj,pj,{upgrade:(t,e)=>{switch(e){case 0:try{t.createObjectStore(Yc)}catch(n){console.warn(n)}}}}).catch(t=>{throw qs.create("idb-open",{originalErrorMessage:t.message})})),Dp}async function gj(t){try{const n=(await MS()).transaction(Yc),i=await n.objectStore(Yc).get(kS(t));return await n.done,i}catch(e){if(e instanceof Xi)$i.warn(e.message);else{const n=qs.create("idb-get",{originalErrorMessage:e?.message});$i.warn(n.message)}}}async function Qb(t,e){try{const i=(await MS()).transaction(Yc,"readwrite");await i.objectStore(Yc).put(e,kS(t)),await i.done}catch(n){if(n instanceof Xi)$i.warn(n.message);else{const i=qs.create("idb-set",{originalErrorMessage:n?.message});$i.warn(i.message)}}}function kS(t){return`${t.name}!${t.options.appId}`}const yj=1024,_j=30;class vj{constructor(e){this.container=e,this._heartbeatsCache=null;const n=this.container.getProvider("app").getImmediate();this._storage=new xj(n),this._heartbeatsCachePromise=this._storage.read().then(i=>(this._heartbeatsCache=i,i))}async triggerHeartbeat(){try{const n=this.container.getProvider("platform-logger").getImmediate().getPlatformInfoString(),i=$b();if(this._heartbeatsCache?.heartbeats==null&&(this._heartbeatsCache=await this._heartbeatsCachePromise,this._heartbeatsCache?.heartbeats==null)||this._heartbeatsCache.lastSentHeartbeatDate===i||this._heartbeatsCache.heartbeats.some(a=>a.date===i))return;if(this._heartbeatsCache.heartbeats.push({date:i,agent:n}),this._heartbeatsCache.heartbeats.length>_j){const a=Ej(this._heartbeatsCache.heartbeats);this._heartbeatsCache.heartbeats.splice(a,1)}return this._storage.overwrite(this._heartbeatsCache)}catch(e){$i.warn(e)}}async getHeartbeatsHeader(){try{if(this._heartbeatsCache===null&&await this._heartbeatsCachePromise,this._heartbeatsCache?.heartbeats==null||this._heartbeatsCache.heartbeats.length===0)return"";const e=$b(),{heartbeatsToSend:n,unsentEntries:i}=bj(this._heartbeatsCache.heartbeats),a=Eh(JSON.stringify({version:2,heartbeats:n}));return this._heartbeatsCache.lastSentHeartbeatDate=e,i.length>0?(this._heartbeatsCache.heartbeats=i,await this._storage.overwrite(this._heartbeatsCache)):(this._heartbeatsCache.heartbeats=[],this._storage.overwrite(this._heartbeatsCache)),a}catch(e){return $i.warn(e),""}}}function $b(){return new Date().toISOString().substring(0,10)}function bj(t,e=yj){const n=[];let i=t.slice();for(const a of t){const l=n.find(u=>u.agent===a.agent);if(l){if(l.dates.push(a.date),Kb(n)>e){l.dates.pop();break}}else if(n.push({agent:a.agent,dates:[a.date]}),Kb(n)>e){n.pop();break}i=i.slice(1)}return{heartbeatsToSend:n,unsentEntries:i}}class xj{constructor(e){this.app=e,this._canUseIndexedDBPromise=this.runIndexedDBEnvironmentCheck()}async runIndexedDBEnvironmentCheck(){return oI()?lI().then(()=>!0).catch(()=>!1):!1}async read(){if(await this._canUseIndexedDBPromise){const n=await gj(this.app);return n?.heartbeats?n:{heartbeats:[]}}else return{heartbeats:[]}}async overwrite(e){if(await this._canUseIndexedDBPromise){const i=await this.read();return Qb(this.app,{lastSentHeartbeatDate:e.lastSentHeartbeatDate??i.lastSentHeartbeatDate,heartbeats:e.heartbeats})}else return}async add(e){if(await this._canUseIndexedDBPromise){const i=await this.read();return Qb(this.app,{lastSentHeartbeatDate:e.lastSentHeartbeatDate??i.lastSentHeartbeatDate,heartbeats:[...i.heartbeats,...e.heartbeats]})}else return}}function Kb(t){return Eh(JSON.stringify({version:2,heartbeats:t})).length}function Ej(t){if(t.length===0)return-1;let e=0,n=t[0].date;for(let i=1;i<t.length;i++)t[i].date<n&&(n=t[i].date,e=i);return e}function Sj(t){tl(new za("platform-logger",e=>new NI(e),"PRIVATE")),tl(new za("heartbeat",e=>new vj(e),"PRIVATE")),Gs(Xp,Gb,t),Gs(Xp,Gb,"esm2020"),Gs("fire-js","")}Sj("");var wj="firebase",Tj="12.7.0";Gs(wj,Tj,"app");const Aj={apiKey:"AIzaSyCfvR8bEeW2CXdD31Ec34doRNThnbryXJo",authDomain:"budget-tkl.firebaseapp.com",projectId:"budget-tkl",storageBucket:"budget-tkl.firebasestorage.app",messagingSenderId:"631248313026",appId:"1:631248313026:web:36574d789a42b2d102f95b"},NS=jS(Aj);var Wb=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};var Hs,PS;(function(){var t;function e(L,I){function D(){}D.prototype=I.prototype,L.F=I.prototype,L.prototype=new D,L.prototype.constructor=L,L.D=function(k,O,j){for(var T=Array(arguments.length-2),Z=2;Z<arguments.length;Z++)T[Z-2]=arguments[Z];return I.prototype[O].apply(k,T)}}function n(){this.blockSize=-1}function i(){this.blockSize=-1,this.blockSize=64,this.g=Array(4),this.C=Array(this.blockSize),this.o=this.h=0,this.u()}e(i,n),i.prototype.u=function(){this.g[0]=1732584193,this.g[1]=4023233417,this.g[2]=2562383102,this.g[3]=271733878,this.o=this.h=0};function a(L,I,D){D||(D=0);const k=Array(16);if(typeof I=="string")for(var O=0;O<16;++O)k[O]=I.charCodeAt(D++)|I.charCodeAt(D++)<<8|I.charCodeAt(D++)<<16|I.charCodeAt(D++)<<24;else for(O=0;O<16;++O)k[O]=I[D++]|I[D++]<<8|I[D++]<<16|I[D++]<<24;I=L.g[0],D=L.g[1],O=L.g[2];let j=L.g[3],T;T=I+(j^D&(O^j))+k[0]+3614090360&4294967295,I=D+(T<<7&4294967295|T>>>25),T=j+(O^I&(D^O))+k[1]+3905402710&4294967295,j=I+(T<<12&4294967295|T>>>20),T=O+(D^j&(I^D))+k[2]+606105819&4294967295,O=j+(T<<17&4294967295|T>>>15),T=D+(I^O&(j^I))+k[3]+3250441966&4294967295,D=O+(T<<22&4294967295|T>>>10),T=I+(j^D&(O^j))+k[4]+4118548399&4294967295,I=D+(T<<7&4294967295|T>>>25),T=j+(O^I&(D^O))+k[5]+1200080426&4294967295,j=I+(T<<12&4294967295|T>>>20),T=O+(D^j&(I^D))+k[6]+2821735955&4294967295,O=j+(T<<17&4294967295|T>>>15),T=D+(I^O&(j^I))+k[7]+4249261313&4294967295,D=O+(T<<22&4294967295|T>>>10),T=I+(j^D&(O^j))+k[8]+1770035416&4294967295,I=D+(T<<7&4294967295|T>>>25),T=j+(O^I&(D^O))+k[9]+2336552879&4294967295,j=I+(T<<12&4294967295|T>>>20),T=O+(D^j&(I^D))+k[10]+4294925233&4294967295,O=j+(T<<17&4294967295|T>>>15),T=D+(I^O&(j^I))+k[11]+2304563134&4294967295,D=O+(T<<22&4294967295|T>>>10),T=I+(j^D&(O^j))+k[12]+1804603682&4294967295,I=D+(T<<7&4294967295|T>>>25),T=j+(O^I&(D^O))+k[13]+4254626195&4294967295,j=I+(T<<12&4294967295|T>>>20),T=O+(D^j&(I^D))+k[14]+2792965006&4294967295,O=j+(T<<17&4294967295|T>>>15),T=D+(I^O&(j^I))+k[15]+1236535329&4294967295,D=O+(T<<22&4294967295|T>>>10),T=I+(O^j&(D^O))+k[1]+4129170786&4294967295,I=D+(T<<5&4294967295|T>>>27),T=j+(D^O&(I^D))+k[6]+3225465664&4294967295,j=I+(T<<9&4294967295|T>>>23),T=O+(I^D&(j^I))+k[11]+643717713&4294967295,O=j+(T<<14&4294967295|T>>>18),T=D+(j^I&(O^j))+k[0]+3921069994&4294967295,D=O+(T<<20&4294967295|T>>>12),T=I+(O^j&(D^O))+k[5]+3593408605&4294967295,I=D+(T<<5&4294967295|T>>>27),T=j+(D^O&(I^D))+k[10]+38016083&4294967295,j=I+(T<<9&4294967295|T>>>23),T=O+(I^D&(j^I))+k[15]+3634488961&4294967295,O=j+(T<<14&4294967295|T>>>18),T=D+(j^I&(O^j))+k[4]+3889429448&4294967295,D=O+(T<<20&4294967295|T>>>12),T=I+(O^j&(D^O))+k[9]+568446438&4294967295,I=D+(T<<5&4294967295|T>>>27),T=j+(D^O&(I^D))+k[14]+3275163606&4294967295,j=I+(T<<9&4294967295|T>>>23),T=O+(I^D&(j^I))+k[3]+4107603335&4294967295,O=j+(T<<14&4294967295|T>>>18),T=D+(j^I&(O^j))+k[8]+1163531501&4294967295,D=O+(T<<20&4294967295|T>>>12),T=I+(O^j&(D^O))+k[13]+2850285829&4294967295,I=D+(T<<5&4294967295|T>>>27),T=j+(D^O&(I^D))+k[2]+4243563512&4294967295,j=I+(T<<9&4294967295|T>>>23),T=O+(I^D&(j^I))+k[7]+1735328473&4294967295,O=j+(T<<14&4294967295|T>>>18),T=D+(j^I&(O^j))+k[12]+2368359562&4294967295,D=O+(T<<20&4294967295|T>>>12),T=I+(D^O^j)+k[5]+4294588738&4294967295,I=D+(T<<4&4294967295|T>>>28),T=j+(I^D^O)+k[8]+2272392833&4294967295,j=I+(T<<11&4294967295|T>>>21),T=O+(j^I^D)+k[11]+1839030562&4294967295,O=j+(T<<16&4294967295|T>>>16),T=D+(O^j^I)+k[14]+4259657740&4294967295,D=O+(T<<23&4294967295|T>>>9),T=I+(D^O^j)+k[1]+2763975236&4294967295,I=D+(T<<4&4294967295|T>>>28),T=j+(I^D^O)+k[4]+1272893353&4294967295,j=I+(T<<11&4294967295|T>>>21),T=O+(j^I^D)+k[7]+4139469664&4294967295,O=j+(T<<16&4294967295|T>>>16),T=D+(O^j^I)+k[10]+3200236656&4294967295,D=O+(T<<23&4294967295|T>>>9),T=I+(D^O^j)+k[13]+681279174&4294967295,I=D+(T<<4&4294967295|T>>>28),T=j+(I^D^O)+k[0]+3936430074&4294967295,j=I+(T<<11&4294967295|T>>>21),T=O+(j^I^D)+k[3]+3572445317&4294967295,O=j+(T<<16&4294967295|T>>>16),T=D+(O^j^I)+k[6]+76029189&4294967295,D=O+(T<<23&4294967295|T>>>9),T=I+(D^O^j)+k[9]+3654602809&4294967295,I=D+(T<<4&4294967295|T>>>28),T=j+(I^D^O)+k[12]+3873151461&4294967295,j=I+(T<<11&4294967295|T>>>21),T=O+(j^I^D)+k[15]+530742520&4294967295,O=j+(T<<16&4294967295|T>>>16),T=D+(O^j^I)+k[2]+3299628645&4294967295,D=O+(T<<23&4294967295|T>>>9),T=I+(O^(D|~j))+k[0]+4096336452&4294967295,I=D+(T<<6&4294967295|T>>>26),T=j+(D^(I|~O))+k[7]+1126891415&4294967295,j=I+(T<<10&4294967295|T>>>22),T=O+(I^(j|~D))+k[14]+2878612391&4294967295,O=j+(T<<15&4294967295|T>>>17),T=D+(j^(O|~I))+k[5]+4237533241&4294967295,D=O+(T<<21&4294967295|T>>>11),T=I+(O^(D|~j))+k[12]+1700485571&4294967295,I=D+(T<<6&4294967295|T>>>26),T=j+(D^(I|~O))+k[3]+2399980690&4294967295,j=I+(T<<10&4294967295|T>>>22),T=O+(I^(j|~D))+k[10]+4293915773&4294967295,O=j+(T<<15&4294967295|T>>>17),T=D+(j^(O|~I))+k[1]+2240044497&4294967295,D=O+(T<<21&4294967295|T>>>11),T=I+(O^(D|~j))+k[8]+1873313359&4294967295,I=D+(T<<6&4294967295|T>>>26),T=j+(D^(I|~O))+k[15]+4264355552&4294967295,j=I+(T<<10&4294967295|T>>>22),T=O+(I^(j|~D))+k[6]+2734768916&4294967295,O=j+(T<<15&4294967295|T>>>17),T=D+(j^(O|~I))+k[13]+1309151649&4294967295,D=O+(T<<21&4294967295|T>>>11),T=I+(O^(D|~j))+k[4]+4149444226&4294967295,I=D+(T<<6&4294967295|T>>>26),T=j+(D^(I|~O))+k[11]+3174756917&4294967295,j=I+(T<<10&4294967295|T>>>22),T=O+(I^(j|~D))+k[2]+718787259&4294967295,O=j+(T<<15&4294967295|T>>>17),T=D+(j^(O|~I))+k[9]+3951481745&4294967295,L.g[0]=L.g[0]+I&4294967295,L.g[1]=L.g[1]+(O+(T<<21&4294967295|T>>>11))&4294967295,L.g[2]=L.g[2]+O&4294967295,L.g[3]=L.g[3]+j&4294967295}i.prototype.v=function(L,I){I===void 0&&(I=L.length);const D=I-this.blockSize,k=this.C;let O=this.h,j=0;for(;j<I;){if(O==0)for(;j<=D;)a(this,L,j),j+=this.blockSize;if(typeof L=="string"){for(;j<I;)if(k[O++]=L.charCodeAt(j++),O==this.blockSize){a(this,k),O=0;break}}else for(;j<I;)if(k[O++]=L[j++],O==this.blockSize){a(this,k),O=0;break}}this.h=O,this.o+=I},i.prototype.A=function(){var L=Array((this.h<56?this.blockSize:this.blockSize*2)-this.h);L[0]=128;for(var I=1;I<L.length-8;++I)L[I]=0;I=this.o*8;for(var D=L.length-8;D<L.length;++D)L[D]=I&255,I/=256;for(this.v(L),L=Array(16),I=0,D=0;D<4;++D)for(let k=0;k<32;k+=8)L[I++]=this.g[D]>>>k&255;return L};function l(L,I){var D=h;return Object.prototype.hasOwnProperty.call(D,L)?D[L]:D[L]=I(L)}function u(L,I){this.h=I;const D=[];let k=!0;for(let O=L.length-1;O>=0;O--){const j=L[O]|0;k&&j==I||(D[O]=j,k=!1)}this.g=D}var h={};function m(L){return-128<=L&&L<128?l(L,function(I){return new u([I|0],I<0?-1:0)}):new u([L|0],L<0?-1:0)}function g(L){if(isNaN(L)||!isFinite(L))return v;if(L<0)return N(g(-L));const I=[];let D=1;for(let k=0;L>=D;k++)I[k]=L/D|0,D*=4294967296;return new u(I,0)}function _(L,I){if(L.length==0)throw Error("number format error: empty string");if(I=I||10,I<2||36<I)throw Error("radix out of range: "+I);if(L.charAt(0)=="-")return N(_(L.substring(1),I));if(L.indexOf("-")>=0)throw Error('number format error: interior "-" character');const D=g(Math.pow(I,8));let k=v;for(let j=0;j<L.length;j+=8){var O=Math.min(8,L.length-j);const T=parseInt(L.substring(j,j+O),I);O<8?(O=g(Math.pow(I,O)),k=k.j(O).add(g(T))):(k=k.j(D),k=k.add(g(T)))}return k}var v=m(0),b=m(1),w=m(16777216);t=u.prototype,t.m=function(){if(R(this))return-N(this).m();let L=0,I=1;for(let D=0;D<this.g.length;D++){const k=this.i(D);L+=(k>=0?k:4294967296+k)*I,I*=4294967296}return L},t.toString=function(L){if(L=L||10,L<2||36<L)throw Error("radix out of range: "+L);if(C(this))return"0";if(R(this))return"-"+N(this).toString(L);const I=g(Math.pow(L,6));var D=this;let k="";for(;;){const O=ae(D,I).g;D=B(D,O.j(I));let j=((D.g.length>0?D.g[0]:D.h)>>>0).toString(L);if(D=O,C(D))return j+k;for(;j.length<6;)j="0"+j;k=j+k}},t.i=function(L){return L<0?0:L<this.g.length?this.g[L]:this.h};function C(L){if(L.h!=0)return!1;for(let I=0;I<L.g.length;I++)if(L.g[I]!=0)return!1;return!0}function R(L){return L.h==-1}t.l=function(L){return L=B(this,L),R(L)?-1:C(L)?0:1};function N(L){const I=L.g.length,D=[];for(let k=0;k<I;k++)D[k]=~L.g[k];return new u(D,~L.h).add(b)}t.abs=function(){return R(this)?N(this):this},t.add=function(L){const I=Math.max(this.g.length,L.g.length),D=[];let k=0;for(let O=0;O<=I;O++){let j=k+(this.i(O)&65535)+(L.i(O)&65535),T=(j>>>16)+(this.i(O)>>>16)+(L.i(O)>>>16);k=T>>>16,j&=65535,T&=65535,D[O]=T<<16|j}return new u(D,D[D.length-1]&-2147483648?-1:0)};function B(L,I){return L.add(N(I))}t.j=function(L){if(C(this)||C(L))return v;if(R(this))return R(L)?N(this).j(N(L)):N(N(this).j(L));if(R(L))return N(this.j(N(L)));if(this.l(w)<0&&L.l(w)<0)return g(this.m()*L.m());const I=this.g.length+L.g.length,D=[];for(var k=0;k<2*I;k++)D[k]=0;for(k=0;k<this.g.length;k++)for(let O=0;O<L.g.length;O++){const j=this.i(k)>>>16,T=this.i(k)&65535,Z=L.i(O)>>>16,U=L.i(O)&65535;D[2*k+2*O]+=T*U,H(D,2*k+2*O),D[2*k+2*O+1]+=j*U,H(D,2*k+2*O+1),D[2*k+2*O+1]+=T*Z,H(D,2*k+2*O+1),D[2*k+2*O+2]+=j*Z,H(D,2*k+2*O+2)}for(L=0;L<I;L++)D[L]=D[2*L+1]<<16|D[2*L];for(L=I;L<2*I;L++)D[L]=0;return new u(D,0)};function H(L,I){for(;(L[I]&65535)!=L[I];)L[I+1]+=L[I]>>>16,L[I]&=65535,I++}function F(L,I){this.g=L,this.h=I}function ae(L,I){if(C(I))throw Error("division by zero");if(C(L))return new F(v,v);if(R(L))return I=ae(N(L),I),new F(N(I.g),N(I.h));if(R(I))return I=ae(L,N(I)),new F(N(I.g),I.h);if(L.g.length>30){if(R(L)||R(I))throw Error("slowDivide_ only works with positive integers.");for(var D=b,k=I;k.l(L)<=0;)D=te(D),k=te(k);var O=he(D,1),j=he(k,1);for(k=he(k,2),D=he(D,2);!C(k);){var T=j.add(k);T.l(L)<=0&&(O=O.add(D),j=T),k=he(k,1),D=he(D,1)}return I=B(L,O.j(I)),new F(O,I)}for(O=v;L.l(I)>=0;){for(D=Math.max(1,Math.floor(L.m()/I.m())),k=Math.ceil(Math.log(D)/Math.LN2),k=k<=48?1:Math.pow(2,k-48),j=g(D),T=j.j(I);R(T)||T.l(L)>0;)D-=k,j=g(D),T=j.j(I);C(j)&&(j=b),O=O.add(j),L=B(L,T)}return new F(O,L)}t.B=function(L){return ae(this,L).h},t.and=function(L){const I=Math.max(this.g.length,L.g.length),D=[];for(let k=0;k<I;k++)D[k]=this.i(k)&L.i(k);return new u(D,this.h&L.h)},t.or=function(L){const I=Math.max(this.g.length,L.g.length),D=[];for(let k=0;k<I;k++)D[k]=this.i(k)|L.i(k);return new u(D,this.h|L.h)},t.xor=function(L){const I=Math.max(this.g.length,L.g.length),D=[];for(let k=0;k<I;k++)D[k]=this.i(k)^L.i(k);return new u(D,this.h^L.h)};function te(L){const I=L.g.length+1,D=[];for(let k=0;k<I;k++)D[k]=L.i(k)<<1|L.i(k-1)>>>31;return new u(D,L.h)}function he(L,I){const D=I>>5;I%=32;const k=L.g.length-D,O=[];for(let j=0;j<k;j++)O[j]=I>0?L.i(j+D)>>>I|L.i(j+D+1)<<32-I:L.i(j+D);return new u(O,L.h)}i.prototype.digest=i.prototype.A,i.prototype.reset=i.prototype.u,i.prototype.update=i.prototype.v,PS=i,u.prototype.add=u.prototype.add,u.prototype.multiply=u.prototype.j,u.prototype.modulo=u.prototype.B,u.prototype.compare=u.prototype.l,u.prototype.toNumber=u.prototype.m,u.prototype.toString=u.prototype.toString,u.prototype.getBits=u.prototype.i,u.fromNumber=g,u.fromString=_,Hs=u}).apply(typeof Wb<"u"?Wb:typeof self<"u"?self:typeof window<"u"?window:{});var Zd=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};var LS,Vc,VS,oh,eg,zS,US,BS;(function(){var t,e=Object.defineProperty;function n(f){f=[typeof globalThis=="object"&&globalThis,f,typeof window=="object"&&window,typeof self=="object"&&self,typeof Zd=="object"&&Zd];for(var x=0;x<f.length;++x){var S=f[x];if(S&&S.Math==Math)return S}throw Error("Cannot find global object")}var i=n(this);function a(f,x){if(x)e:{var S=i;f=f.split(".");for(var V=0;V<f.length-1;V++){var ne=f[V];if(!(ne in S))break e;S=S[ne]}f=f[f.length-1],V=S[f],x=x(V),x!=V&&x!=null&&e(S,f,{configurable:!0,writable:!0,value:x})}}a("Symbol.dispose",function(f){return f||Symbol("Symbol.dispose")}),a("Array.prototype.values",function(f){return f||function(){return this[Symbol.iterator]()}}),a("Object.entries",function(f){return f||function(x){var S=[],V;for(V in x)Object.prototype.hasOwnProperty.call(x,V)&&S.push([V,x[V]]);return S}});var l=l||{},u=this||self;function h(f){var x=typeof f;return x=="object"&&f!=null||x=="function"}function m(f,x,S){return f.call.apply(f.bind,arguments)}function g(f,x,S){return g=m,g.apply(null,arguments)}function _(f,x){var S=Array.prototype.slice.call(arguments,1);return function(){var V=S.slice();return V.push.apply(V,arguments),f.apply(this,V)}}function v(f,x){function S(){}S.prototype=x.prototype,f.Z=x.prototype,f.prototype=new S,f.prototype.constructor=f,f.Ob=function(V,ne,le){for(var Se=Array(arguments.length-2),qe=2;qe<arguments.length;qe++)Se[qe-2]=arguments[qe];return x.prototype[ne].apply(V,Se)}}var b=typeof AsyncContext<"u"&&typeof AsyncContext.Snapshot=="function"?f=>f&&AsyncContext.Snapshot.wrap(f):f=>f;function w(f){const x=f.length;if(x>0){const S=Array(x);for(let V=0;V<x;V++)S[V]=f[V];return S}return[]}function C(f,x){for(let V=1;V<arguments.length;V++){const ne=arguments[V];var S=typeof ne;if(S=S!="object"?S:ne?Array.isArray(ne)?"array":S:"null",S=="array"||S=="object"&&typeof ne.length=="number"){S=f.length||0;const le=ne.length||0;f.length=S+le;for(let Se=0;Se<le;Se++)f[S+Se]=ne[Se]}else f.push(ne)}}class R{constructor(x,S){this.i=x,this.j=S,this.h=0,this.g=null}get(){let x;return this.h>0?(this.h--,x=this.g,this.g=x.next,x.next=null):x=this.i(),x}}function N(f){u.setTimeout(()=>{throw f},0)}function B(){var f=L;let x=null;return f.g&&(x=f.g,f.g=f.g.next,f.g||(f.h=null),x.next=null),x}class H{constructor(){this.h=this.g=null}add(x,S){const V=F.get();V.set(x,S),this.h?this.h.next=V:this.g=V,this.h=V}}var F=new R(()=>new ae,f=>f.reset());class ae{constructor(){this.next=this.g=this.h=null}set(x,S){this.h=x,this.g=S,this.next=null}reset(){this.next=this.g=this.h=null}}let te,he=!1,L=new H,I=()=>{const f=Promise.resolve(void 0);te=()=>{f.then(D)}};function D(){for(var f;f=B();){try{f.h.call(f.g)}catch(S){N(S)}var x=F;x.j(f),x.h<100&&(x.h++,f.next=x.g,x.g=f)}he=!1}function k(){this.u=this.u,this.C=this.C}k.prototype.u=!1,k.prototype.dispose=function(){this.u||(this.u=!0,this.N())},k.prototype[Symbol.dispose]=function(){this.dispose()},k.prototype.N=function(){if(this.C)for(;this.C.length;)this.C.shift()()};function O(f,x){this.type=f,this.g=this.target=x,this.defaultPrevented=!1}O.prototype.h=function(){this.defaultPrevented=!0};var j=(function(){if(!u.addEventListener||!Object.defineProperty)return!1;var f=!1,x=Object.defineProperty({},"passive",{get:function(){f=!0}});try{const S=()=>{};u.addEventListener("test",S,x),u.removeEventListener("test",S,x)}catch{}return f})();function T(f){return/^[\s\xa0]*$/.test(f)}function Z(f,x){O.call(this,f?f.type:""),this.relatedTarget=this.g=this.target=null,this.button=this.screenY=this.screenX=this.clientY=this.clientX=0,this.key="",this.metaKey=this.shiftKey=this.altKey=this.ctrlKey=!1,this.state=null,this.pointerId=0,this.pointerType="",this.i=null,f&&this.init(f,x)}v(Z,O),Z.prototype.init=function(f,x){const S=this.type=f.type,V=f.changedTouches&&f.changedTouches.length?f.changedTouches[0]:null;this.target=f.target||f.srcElement,this.g=x,x=f.relatedTarget,x||(S=="mouseover"?x=f.fromElement:S=="mouseout"&&(x=f.toElement)),this.relatedTarget=x,V?(this.clientX=V.clientX!==void 0?V.clientX:V.pageX,this.clientY=V.clientY!==void 0?V.clientY:V.pageY,this.screenX=V.screenX||0,this.screenY=V.screenY||0):(this.clientX=f.clientX!==void 0?f.clientX:f.pageX,this.clientY=f.clientY!==void 0?f.clientY:f.pageY,this.screenX=f.screenX||0,this.screenY=f.screenY||0),this.button=f.button,this.key=f.key||"",this.ctrlKey=f.ctrlKey,this.altKey=f.altKey,this.shiftKey=f.shiftKey,this.metaKey=f.metaKey,this.pointerId=f.pointerId||0,this.pointerType=f.pointerType,this.state=f.state,this.i=f,f.defaultPrevented&&Z.Z.h.call(this)},Z.prototype.h=function(){Z.Z.h.call(this);const f=this.i;f.preventDefault?f.preventDefault():f.returnValue=!1};var U="closure_listenable_"+(Math.random()*1e6|0),z=0;function q(f,x,S,V,ne){this.listener=f,this.proxy=null,this.src=x,this.type=S,this.capture=!!V,this.ha=ne,this.key=++z,this.da=this.fa=!1}function K(f){f.da=!0,f.listener=null,f.proxy=null,f.src=null,f.ha=null}function ee(f,x,S){for(const V in f)x.call(S,f[V],V,f)}function X(f,x){for(const S in f)x.call(void 0,f[S],S,f)}function P(f){const x={};for(const S in f)x[S]=f[S];return x}const W="constructor hasOwnProperty isPrototypeOf propertyIsEnumerable toLocaleString toString valueOf".split(" ");function Y(f,x){let S,V;for(let ne=1;ne<arguments.length;ne++){V=arguments[ne];for(S in V)f[S]=V[S];for(let le=0;le<W.length;le++)S=W[le],Object.prototype.hasOwnProperty.call(V,S)&&(f[S]=V[S])}}function Q(f){this.src=f,this.g={},this.h=0}Q.prototype.add=function(f,x,S,V,ne){const le=f.toString();f=this.g[le],f||(f=this.g[le]=[],this.h++);const Se=ce(f,x,V,ne);return Se>-1?(x=f[Se],S||(x.fa=!1)):(x=new q(x,this.src,le,!!V,ne),x.fa=S,f.push(x)),x};function fe(f,x){const S=x.type;if(S in f.g){var V=f.g[S],ne=Array.prototype.indexOf.call(V,x,void 0),le;(le=ne>=0)&&Array.prototype.splice.call(V,ne,1),le&&(K(x),f.g[S].length==0&&(delete f.g[S],f.h--))}}function ce(f,x,S,V){for(let ne=0;ne<f.length;++ne){const le=f[ne];if(!le.da&&le.listener==x&&le.capture==!!S&&le.ha==V)return ne}return-1}var me="closure_lm_"+(Math.random()*1e6|0),ge={};function Ee(f,x,S,V,ne){if(Array.isArray(x)){for(let le=0;le<x.length;le++)Ee(f,x[le],S,V,ne);return null}return S=qr(S),f&&f[U]?f.J(x,S,h(V)?!!V.capture:!1,ne):re(f,x,S,!1,V,ne)}function re(f,x,S,V,ne,le){if(!x)throw Error("Invalid event type");const Se=h(ne)?!!ne.capture:!!ne;let qe=sr(f);if(qe||(f[me]=qe=new Q(f)),S=qe.add(x,S,V,Se,le),S.proxy)return S;if(V=ke(),S.proxy=V,V.src=f,V.listener=S,f.addEventListener)j||(ne=Se),ne===void 0&&(ne=!1),f.addEventListener(x.toString(),V,ne);else if(f.attachEvent)f.attachEvent(Ot(x.toString()),V);else if(f.addListener&&f.removeListener)f.addListener(V);else throw Error("addEventListener and attachEvent are unavailable.");return S}function ke(){function f(S){return x.call(f.src,f.listener,S)}const x=Mt;return f}function Ve(f,x,S,V,ne){if(Array.isArray(x))for(var le=0;le<x.length;le++)Ve(f,x[le],S,V,ne);else V=h(V)?!!V.capture:!!V,S=qr(S),f&&f[U]?(f=f.i,le=String(x).toString(),le in f.g&&(x=f.g[le],S=ce(x,S,V,ne),S>-1&&(K(x[S]),Array.prototype.splice.call(x,S,1),x.length==0&&(delete f.g[le],f.h--)))):f&&(f=sr(f))&&(x=f.g[x.toString()],f=-1,x&&(f=ce(x,S,V,ne)),(S=f>-1?x[f]:null)&&jt(S))}function jt(f){if(typeof f!="number"&&f&&!f.da){var x=f.src;if(x&&x[U])fe(x.i,f);else{var S=f.type,V=f.proxy;x.removeEventListener?x.removeEventListener(S,V,f.capture):x.detachEvent?x.detachEvent(Ot(S),V):x.addListener&&x.removeListener&&x.removeListener(V),(S=sr(x))?(fe(S,f),S.h==0&&(S.src=null,x[me]=null)):K(f)}}}function Ot(f){return f in ge?ge[f]:ge[f]="on"+f}function Mt(f,x){if(f.da)f=!0;else{x=new Z(x,this);const S=f.listener,V=f.ha||f.src;f.fa&&jt(f),f=S.call(V,x)}return f}function sr(f){return f=f[me],f instanceof Q?f:null}var ar="__closure_events_fn_"+(Math.random()*1e9>>>0);function qr(f){return typeof f=="function"?f:(f[ar]||(f[ar]=function(x){return f.handleEvent(x)}),f[ar])}function ut(){k.call(this),this.i=new Q(this),this.M=this,this.G=null}v(ut,k),ut.prototype[U]=!0,ut.prototype.removeEventListener=function(f,x,S,V){Ve(this,f,x,S,V)};function dt(f,x){var S,V=f.G;if(V)for(S=[];V;V=V.G)S.push(V);if(f=f.M,V=x.type||x,typeof x=="string")x=new O(x,f);else if(x instanceof O)x.target=x.target||f;else{var ne=x;x=new O(V,f),Y(x,ne)}ne=!0;let le,Se;if(S)for(Se=S.length-1;Se>=0;Se--)le=x.g=S[Se],ne=we(le,V,!0,x)&&ne;if(le=x.g=f,ne=we(le,V,!0,x)&&ne,ne=we(le,V,!1,x)&&ne,S)for(Se=0;Se<S.length;Se++)le=x.g=S[Se],ne=we(le,V,!1,x)&&ne}ut.prototype.N=function(){if(ut.Z.N.call(this),this.i){var f=this.i;for(const x in f.g){const S=f.g[x];for(let V=0;V<S.length;V++)K(S[V]);delete f.g[x],f.h--}}this.G=null},ut.prototype.J=function(f,x,S,V){return this.i.add(String(f),x,!1,S,V)},ut.prototype.K=function(f,x,S,V){return this.i.add(String(f),x,!0,S,V)};function we(f,x,S,V){if(x=f.i.g[String(x)],!x)return!0;x=x.concat();let ne=!0;for(let le=0;le<x.length;++le){const Se=x[le];if(Se&&!Se.da&&Se.capture==S){const qe=Se.listener,Vt=Se.ha||Se.src;Se.fa&&fe(f.i,Se),ne=qe.call(Vt,V)!==!1&&ne}}return ne&&!V.defaultPrevented}function Le(f,x){if(typeof f!="function")if(f&&typeof f.handleEvent=="function")f=g(f.handleEvent,f);else throw Error("Invalid listener argument");return Number(x)>2147483647?-1:u.setTimeout(f,x||0)}function He(f){f.g=Le(()=>{f.g=null,f.i&&(f.i=!1,He(f))},f.l);const x=f.h;f.h=null,f.m.apply(null,x)}class $e extends k{constructor(x,S){super(),this.m=x,this.l=S,this.h=null,this.i=!1,this.g=null}j(x){this.h=arguments,this.g?this.i=!0:He(this)}N(){super.N(),this.g&&(u.clearTimeout(this.g),this.g=null,this.i=!1,this.h=null)}}function at(f){k.call(this),this.h=f,this.g={}}v(at,k);var rt=[];function qt(f){ee(f.g,function(x,S){this.g.hasOwnProperty(S)&&jt(x)},f),f.g={}}at.prototype.N=function(){at.Z.N.call(this),qt(this)},at.prototype.handleEvent=function(){throw Error("EventHandler.handleEvent not implemented")};var pn=u.JSON.stringify,Xa=u.JSON.parse,or=class{stringify(f){return u.JSON.stringify(f,void 0)}parse(f){return u.JSON.parse(f,void 0)}};function ts(){}function Tu(){}var Tr={OPEN:"a",hb:"b",ERROR:"c",tb:"d"};function gn(){O.call(this,"d")}v(gn,O);function lr(){O.call(this,"c")}v(lr,O);var Lt={},Au=null;function Ja(){return Au=Au||new ut}Lt.Ia="serverreachability";function Cu(f){O.call(this,Lt.Ia,f)}v(Cu,O);function Gr(f){const x=Ja();dt(x,new Cu(x))}Lt.STAT_EVENT="statevent";function sa(f,x){O.call(this,Lt.STAT_EVENT,f),this.stat=x}v(sa,O);function Gt(f){const x=Ja();dt(x,new sa(x,f))}Lt.Ja="timingevent";function Hr(f,x){O.call(this,Lt.Ja,f),this.size=x}v(Hr,O);function Qr(f,x){if(typeof f!="function")throw Error("Fn must not be null and must be a function");return u.setTimeout(function(){f()},x)}function Ar(){this.g=!0}Ar.prototype.ua=function(){this.g=!1};function bf(f,x,S,V,ne,le){f.info(function(){if(f.g)if(le){var Se="",qe=le.split("&");for(let ot=0;ot<qe.length;ot++){var Vt=qe[ot].split("=");if(Vt.length>1){const At=Vt[0];Vt=Vt[1];const hr=At.split("_");Se=hr.length>=2&&hr[1]=="type"?Se+(At+"="+Vt+"&"):Se+(At+"=redacted&")}}}else Se=null;else Se=le;return"XMLHTTP REQ ("+V+") [attempt "+ne+"]: "+x+`
`+S+`
`+Se})}function Ru(f,x,S,V,ne,le,Se){f.info(function(){return"XMLHTTP RESP ("+V+") [ attempt "+ne+"]: "+x+`
`+S+`
`+le+" "+Se})}function $r(f,x,S,V){f.info(function(){return"XMLHTTP TEXT ("+x+"): "+xf(f,S)+(V?" "+V:"")})}function aa(f,x){f.info(function(){return"TIMEOUT: "+x})}Ar.prototype.info=function(){};function xf(f,x){if(!f.g)return x;if(!x)return null;try{const le=JSON.parse(x);if(le){for(f=0;f<le.length;f++)if(Array.isArray(le[f])){var S=le[f];if(!(S.length<2)){var V=S[1];if(Array.isArray(V)&&!(V.length<1)){var ne=V[0];if(ne!="noop"&&ne!="stop"&&ne!="close")for(let Se=1;Se<V.length;Se++)V[Se]=""}}}}return pn(le)}catch{return x}}var oa={NO_ERROR:0,cb:1,qb:2,pb:3,kb:4,ob:5,rb:6,Ga:7,TIMEOUT:8,ub:9},Ml={ib:"complete",Fb:"success",ERROR:"error",Ga:"abort",xb:"ready",yb:"readystatechange",TIMEOUT:"timeout",sb:"incrementaldata",wb:"progress",lb:"downloadprogress",Nb:"uploadprogress"},kl;function la(){}v(la,ts),la.prototype.g=function(){return new XMLHttpRequest},kl=new la;function Ei(f){return encodeURIComponent(String(f))}function Du(f){var x=1;f=f.split(":");const S=[];for(;x>0&&f.length;)S.push(f.shift()),x--;return f.length&&S.push(f.join(":")),S}function Cr(f,x,S,V){this.j=f,this.i=x,this.l=S,this.S=V||1,this.V=new at(this),this.H=45e3,this.J=null,this.o=!1,this.u=this.B=this.A=this.M=this.F=this.T=this.D=null,this.G=[],this.g=null,this.C=0,this.m=this.v=null,this.X=-1,this.K=!1,this.P=0,this.O=null,this.W=this.L=this.U=this.R=!1,this.h=new Rr}function Rr(){this.i=null,this.g="",this.h=!1}var Ht={},cn={};function Kr(f,x,S){f.M=1,f.A=ca($t(x)),f.u=S,f.R=!0,Za(f,null)}function Za(f,x){f.F=Date.now(),Wr(f),f.B=$t(f.A);var S=f.B,V=f.S;Array.isArray(V)||(V=[String(V)]),ro(S.i,"t",V),f.C=0,S=f.j.L,f.h=new Rr,f.g=Gu(f.j,S?x:null,!f.u),f.P>0&&(f.O=new $e(g(f.Y,f,f.g),f.P)),x=f.V,S=f.g,V=f.ba;var ne="readystatechange";Array.isArray(ne)||(ne&&(rt[0]=ne.toString()),ne=rt);for(let le=0;le<ne.length;le++){const Se=Ee(S,ne[le],V||x.handleEvent,!1,x.h||x);if(!Se)break;x.g[Se.key]=Se}x=f.J?P(f.J):{},f.u?(f.v||(f.v="POST"),x["Content-Type"]="application/x-www-form-urlencoded",f.g.ea(f.B,f.v,f.u,x)):(f.v="GET",f.g.ea(f.B,f.v,null,x)),Gr(),bf(f.i,f.v,f.B,f.l,f.S,f.u)}Cr.prototype.ba=function(f){f=f.target;const x=this.O;x&&jr(f)==3?x.j():this.Y(f)},Cr.prototype.Y=function(f){try{if(f==this.g)e:{const qe=jr(this.g),Vt=this.g.ya(),ot=this.g.ca();if(!(qe<3)&&(qe!=3||this.g&&(this.h.h||this.g.la()||yn(this.g)))){this.K||qe!=4||Vt==7||(Vt==8||ot<=0?Gr(3):Gr(2)),Yr(this);var x=this.g.ca();this.X=x;var S=Ef(this);if(this.o=x==200,Ru(this.i,this.v,this.B,this.l,this.S,qe,x),this.o){if(this.U&&!this.L){t:{if(this.g){var V,ne=this.g;if((V=ne.g?ne.g.getResponseHeader("X-HTTP-Initial-Response"):null)&&!T(V)){var le=V;break t}}le=null}if(f=le)$r(this.i,this.l,f,"Initial handshake response via X-HTTP-Initial-Response"),this.L=!0,Xr(this,f);else{this.o=!1,this.m=3,Gt(12),Qn(this),cr(this);break e}}if(this.R){f=!0;let At;for(;!this.K&&this.C<S.length;)if(At=ju(this,S),At==cn){qe==4&&(this.m=4,Gt(14),f=!1),$r(this.i,this.l,null,"[Incomplete Response]");break}else if(At==Ht){this.m=4,Gt(15),$r(this.i,this.l,S,"[Invalid Chunk]"),f=!1;break}else $r(this.i,this.l,At,null),Xr(this,At);if(Iu(this)&&this.C!=0&&(this.h.g=this.h.g.slice(this.C),this.C=0),qe!=4||S.length!=0||this.h.h||(this.m=1,Gt(16),f=!1),this.o=this.o&&f,!f)$r(this.i,this.l,S,"[Invalid Chunked Response]"),Qn(this),cr(this);else if(S.length>0&&!this.W){this.W=!0;var Se=this.j;Se.g==this&&Se.aa&&!Se.P&&(Se.j.info("Great, no buffering proxy detected. Bytes received: "+S.length),Wl(Se),Se.P=!0,Gt(11))}}else $r(this.i,this.l,S,null),Xr(this,S);qe==4&&Qn(this),this.o&&!this.K&&(qe==4?Uu(this.j,this):(this.o=!1,Wr(this)))}else wi(this.g),x==400&&S.indexOf("Unknown SID")>0?(this.m=3,Gt(12)):(this.m=0,Gt(13)),Qn(this),cr(this)}}}catch{}};function Ef(f){if(!Iu(f))return f.g.la();const x=yn(f.g);if(x==="")return"";let S="";const V=x.length,ne=jr(f.g)==4;if(!f.h.i){if(typeof TextDecoder>"u")return Qn(f),cr(f),"";f.h.i=new u.TextDecoder}for(let le=0;le<V;le++)f.h.h=!0,S+=f.h.i.decode(x[le],{stream:!(ne&&le==V-1)});return x.length=0,f.h.g+=S,f.C=0,f.h.g}function Iu(f){return f.g?f.v=="GET"&&f.M!=2&&f.j.Aa:!1}function ju(f,x){var S=f.C,V=x.indexOf(`
`,S);return V==-1?cn:(S=Number(x.substring(S,V)),isNaN(S)?Ht:(V+=1,V+S>x.length?cn:(x=x.slice(V,V+S),f.C=V+S,x)))}Cr.prototype.cancel=function(){this.K=!0,Qn(this)};function Wr(f){f.T=Date.now()+f.H,eo(f,f.H)}function eo(f,x){if(f.D!=null)throw Error("WatchDog timer not null");f.D=Qr(g(f.aa,f),x)}function Yr(f){f.D&&(u.clearTimeout(f.D),f.D=null)}Cr.prototype.aa=function(){this.D=null;const f=Date.now();f-this.T>=0?(aa(this.i,this.B),this.M!=2&&(Gr(),Gt(17)),Qn(this),this.m=2,cr(this)):eo(this,this.T-f)};function cr(f){f.j.I==0||f.K||Uu(f.j,f)}function Qn(f){Yr(f);var x=f.O;x&&typeof x.dispose=="function"&&x.dispose(),f.O=null,qt(f.V),f.g&&(x=f.g,f.g=null,x.abort(),x.dispose())}function Xr(f,x){try{var S=f.j;if(S.I!=0&&(S.g==f||Zr(S.h,f))){if(!f.L&&Zr(S.h,f)&&S.I==3){try{var V=S.Ba.g.parse(x)}catch{V=null}if(Array.isArray(V)&&V.length==3){var ne=V;if(ne[0]==0){e:if(!S.v){if(S.g)if(S.g.F+3e3<f.F)lo(S),cs(S);else break e;ga(S),Gt(18)}}else S.xa=ne[1],0<S.xa-S.K&&ne[2]<37500&&S.F&&S.A==0&&!S.C&&(S.C=Qr(g(S.Va,S),6e3));Jr(S.h)<=1&&S.ta&&(S.ta=void 0)}else si(S,11)}else if((f.L||S.g==f)&&lo(S),!T(x))for(ne=S.Ba.g.parse(x),x=0;x<ne.length;x++){let ot=ne[x];const At=ot[0];if(!(At<=S.K))if(S.K=At,ot=ot[1],S.I==2)if(ot[0]=="c"){S.M=ot[1],S.ba=ot[2];const hr=ot[3];hr!=null&&(S.ka=hr,S.j.info("VER="+S.ka));const ai=ot[4];ai!=null&&(S.za=ai,S.j.info("SVER="+S.za));const Or=ot[5];Or!=null&&typeof Or=="number"&&Or>0&&(V=1.5*Or,S.O=V,S.j.info("backChannelRequestTimeoutMs_="+V)),V=S;const Mr=f.g;if(Mr){const ya=Mr.g?Mr.g.getResponseHeader("X-Client-Wire-Protocol"):null;if(ya){var le=V.h;le.g||ya.indexOf("spdy")==-1&&ya.indexOf("quic")==-1&&ya.indexOf("h2")==-1||(le.j=le.l,le.g=new Set,le.h&&(Ll(le,le.h),le.h=null))}if(V.G){const co=Mr.g?Mr.g.getResponseHeader("X-HTTP-Session-Id"):null;co&&(V.wa=co,ht(V.J,V.G,co))}}S.I=3,S.l&&S.l.ra(),S.aa&&(S.T=Date.now()-f.F,S.j.info("Handshake RTT: "+S.T+"ms")),V=S;var Se=f;if(V.na=qu(V,V.L?V.ba:null,V.W),Se.L){Vl(V.h,Se);var qe=Se,Vt=V.O;Vt&&(qe.H=Vt),qe.D&&(Yr(qe),Wr(qe)),V.g=Se}else Vu(V);S.i.length>0&&ii(S)}else ot[0]!="stop"&&ot[0]!="close"||si(S,7);else S.I==3&&(ot[0]=="stop"||ot[0]=="close"?ot[0]=="stop"?si(S,7):$l(S):ot[0]!="noop"&&S.l&&S.l.qa(ot),S.A=0)}}Gr(4)}catch{}}var Qt=class{constructor(f,x){this.g=f,this.map=x}};function Nl(f){this.l=f||10,u.PerformanceNavigationTiming?(f=u.performance.getEntriesByType("navigation"),f=f.length>0&&(f[0].nextHopProtocol=="hq"||f[0].nextHopProtocol=="h2")):f=!!(u.chrome&&u.chrome.loadTimes&&u.chrome.loadTimes()&&u.chrome.loadTimes().wasFetchedViaSpdy),this.j=f?this.l:1,this.g=null,this.j>1&&(this.g=new Set),this.h=null,this.i=[]}function Pl(f){return f.h?!0:f.g?f.g.size>=f.j:!1}function Jr(f){return f.h?1:f.g?f.g.size:0}function Zr(f,x){return f.h?f.h==x:f.g?f.g.has(x):!1}function Ll(f,x){f.g?f.g.add(x):f.h=x}function Vl(f,x){f.h&&f.h==x?f.h=null:f.g&&f.g.has(x)&&f.g.delete(x)}Nl.prototype.cancel=function(){if(this.i=zl(this),this.h)this.h.cancel(),this.h=null;else if(this.g&&this.g.size!==0){for(const f of this.g.values())f.cancel();this.g.clear()}};function zl(f){if(f.h!=null)return f.i.concat(f.h.G);if(f.g!=null&&f.g.size!==0){let x=f.i;for(const S of f.g.values())x=x.concat(S.G);return x}return w(f.i)}var Ou=RegExp("^(?:([^:/?#.]+):)?(?://(?:([^\\\\/?#]*)@)?([^\\\\/?#]*?)(?::([0-9]+))?(?=[\\\\/?#]|$))?([^?#]+)?(?:\\?([^#]*))?(?:#([\\s\\S]*))?$");function to(f,x){if(f){f=f.split("&");for(let S=0;S<f.length;S++){const V=f[S].indexOf("=");let ne,le=null;V>=0?(ne=f[S].substring(0,V),le=f[S].substring(V+1)):ne=f[S],x(ne,le?decodeURIComponent(le.replace(/\+/g," ")):"")}}}function $n(f){this.g=this.o=this.j="",this.u=null,this.m=this.h="",this.l=!1;let x;f instanceof $n?(this.l=f.l,un(this,f.j),this.o=f.o,this.g=f.g,ns(this,f.u),this.h=f.h,Ul(this,Pu(f.i)),this.m=f.m):f&&(x=String(f).match(Ou))?(this.l=!1,un(this,x[1]||"",!0),this.o=ei(x[2]||""),this.g=ei(x[3]||"",!0),ns(this,x[4]),this.h=ei(x[5]||"",!0),Ul(this,x[6]||"",!0),this.m=ei(x[7]||"")):(this.l=!1,this.i=new is(null,this.l))}$n.prototype.toString=function(){const f=[];var x=this.j;x&&f.push(ua(x,no,!0),":");var S=this.g;return(S||x=="file")&&(f.push("//"),(x=this.o)&&f.push(ua(x,no,!0),"@"),f.push(Ei(S).replace(/%25([0-9a-fA-F]{2})/g,"%$1")),S=this.u,S!=null&&f.push(":",String(S))),(S=this.h)&&(this.g&&S.charAt(0)!="/"&&f.push("/"),f.push(ua(S,S.charAt(0)=="/"?Bl:Mu,!0))),(S=this.i.toString())&&f.push("?",S),(S=this.m)&&f.push("#",ua(S,ku)),f.join("")},$n.prototype.resolve=function(f){const x=$t(this);let S=!!f.j;S?un(x,f.j):S=!!f.o,S?x.o=f.o:S=!!f.g,S?x.g=f.g:S=f.u!=null;var V=f.h;if(S)ns(x,f.u);else if(S=!!f.h){if(V.charAt(0)!="/")if(this.g&&!this.h)V="/"+V;else{var ne=x.h.lastIndexOf("/");ne!=-1&&(V=x.h.slice(0,ne+1)+V)}if(ne=V,ne==".."||ne==".")V="";else if(ne.indexOf("./")!=-1||ne.indexOf("/.")!=-1){V=ne.lastIndexOf("/",0)==0,ne=ne.split("/");const le=[];for(let Se=0;Se<ne.length;){const qe=ne[Se++];qe=="."?V&&Se==ne.length&&le.push(""):qe==".."?((le.length>1||le.length==1&&le[0]!="")&&le.pop(),V&&Se==ne.length&&le.push("")):(le.push(qe),V=!0)}V=le.join("/")}else V=ne}return S?x.h=V:S=f.i.toString()!=="",S?Ul(x,Pu(f.i)):S=!!f.m,S&&(x.m=f.m),x};function $t(f){return new $n(f)}function un(f,x,S){f.j=S?ei(x,!0):x,f.j&&(f.j=f.j.replace(/:$/,""))}function ns(f,x){if(x){if(x=Number(x),isNaN(x)||x<0)throw Error("Bad port number "+x);f.u=x}else f.u=null}function Ul(f,x,S){x instanceof is?(f.i=x,io(f.i,f.l)):(S||(x=ua(x,rs)),f.i=new is(x,f.l))}function ht(f,x,S){f.i.set(x,S)}function ca(f){return ht(f,"zx",Math.floor(Math.random()*2147483648).toString(36)+Math.abs(Math.floor(Math.random()*2147483648)^Date.now()).toString(36)),f}function ei(f,x){return f?x?decodeURI(f.replace(/%25/g,"%2525")):decodeURIComponent(f):""}function ua(f,x,S){return typeof f=="string"?(f=encodeURI(f).replace(x,Nn),S&&(f=f.replace(/%25([0-9a-fA-F]{2})/g,"%$1")),f):null}function Nn(f){return f=f.charCodeAt(0),"%"+(f>>4&15).toString(16)+(f&15).toString(16)}var no=/[#\/\?@]/g,Mu=/[#\?:]/g,Bl=/[#\?]/g,rs=/[#\?@]/g,ku=/#/g;function is(f,x){this.h=this.g=null,this.i=f||null,this.j=!!x}function Pn(f){f.g||(f.g=new Map,f.h=0,f.i&&to(f.i,function(x,S){f.add(decodeURIComponent(x.replace(/\+/g," ")),S)}))}t=is.prototype,t.add=function(f,x){Pn(this),this.i=null,f=ss(this,f);let S=this.g.get(f);return S||this.g.set(f,S=[]),S.push(x),this.h+=1,this};function Nu(f,x){Pn(f),x=ss(f,x),f.g.has(x)&&(f.i=null,f.h-=f.g.get(x).length,f.g.delete(x))}function Fl(f,x){return Pn(f),x=ss(f,x),f.g.has(x)}t.forEach=function(f,x){Pn(this),this.g.forEach(function(S,V){S.forEach(function(ne){f.call(x,ne,V,this)},this)},this)};function ql(f,x){Pn(f);let S=[];if(typeof x=="string")Fl(f,x)&&(S=S.concat(f.g.get(ss(f,x))));else for(f=Array.from(f.g.values()),x=0;x<f.length;x++)S=S.concat(f[x]);return S}t.set=function(f,x){return Pn(this),this.i=null,f=ss(this,f),Fl(this,f)&&(this.h-=this.g.get(f).length),this.g.set(f,[x]),this.h+=1,this},t.get=function(f,x){return f?(f=ql(this,f),f.length>0?String(f[0]):x):x};function ro(f,x,S){Nu(f,x),S.length>0&&(f.i=null,f.g.set(ss(f,x),w(S)),f.h+=S.length)}t.toString=function(){if(this.i)return this.i;if(!this.g)return"";const f=[],x=Array.from(this.g.keys());for(let V=0;V<x.length;V++){var S=x[V];const ne=Ei(S);S=ql(this,S);for(let le=0;le<S.length;le++){let Se=ne;S[le]!==""&&(Se+="="+Ei(S[le])),f.push(Se)}}return this.i=f.join("&")};function Pu(f){const x=new is;return x.i=f.i,f.g&&(x.g=new Map(f.g),x.h=f.h),x}function ss(f,x){return x=String(x),f.j&&(x=x.toLowerCase()),x}function io(f,x){x&&!f.j&&(Pn(f),f.i=null,f.g.forEach(function(S,V){const ne=V.toLowerCase();V!=ne&&(Nu(this,V),ro(this,ne,S))},f)),f.j=x}function Dr(f,x){const S=new Ar;if(u.Image){const V=new Image;V.onload=_(ur,S,"TestLoadImage: loaded",!0,x,V),V.onerror=_(ur,S,"TestLoadImage: error",!1,x,V),V.onabort=_(ur,S,"TestLoadImage: abort",!1,x,V),V.ontimeout=_(ur,S,"TestLoadImage: timeout",!1,x,V),u.setTimeout(function(){V.ontimeout&&V.ontimeout()},1e4),V.src=f}else x(!1)}function Gl(f,x){const S=new Ar,V=new AbortController,ne=setTimeout(()=>{V.abort(),ur(S,"TestPingServer: timeout",!1,x)},1e4);fetch(f,{signal:V.signal}).then(le=>{clearTimeout(ne),le.ok?ur(S,"TestPingServer: ok",!0,x):ur(S,"TestPingServer: server error",!1,x)}).catch(()=>{clearTimeout(ne),ur(S,"TestPingServer: error",!1,x)})}function ur(f,x,S,V,ne){try{ne&&(ne.onload=null,ne.onerror=null,ne.onabort=null,ne.ontimeout=null),V(S)}catch{}}function as(){this.g=new or}function ti(f){this.i=f.Sb||null,this.h=f.ab||!1}v(ti,ts),ti.prototype.g=function(){return new da(this.i,this.h)};function da(f,x){ut.call(this),this.H=f,this.o=x,this.m=void 0,this.status=this.readyState=0,this.responseType=this.responseText=this.response=this.statusText="",this.onreadystatechange=null,this.A=new Headers,this.h=null,this.F="GET",this.D="",this.g=!1,this.B=this.j=this.l=null,this.v=new AbortController}v(da,ut),t=da.prototype,t.open=function(f,x){if(this.readyState!=0)throw this.abort(),Error("Error reopening a connection");this.F=f,this.D=x,this.readyState=1,Ir(this)},t.send=function(f){if(this.readyState!=1)throw this.abort(),Error("need to call open() first. ");if(this.v.signal.aborted)throw this.abort(),Error("Request was aborted.");this.g=!0;const x={headers:this.A,method:this.F,credentials:this.m,cache:void 0,signal:this.v.signal};f&&(x.body=f),(this.H||u).fetch(new Request(this.D,x)).then(this.Pa.bind(this),this.ga.bind(this))},t.abort=function(){this.response=this.responseText="",this.A=new Headers,this.status=0,this.v.abort(),this.j&&this.j.cancel("Request was aborted.").catch(()=>{}),this.readyState>=1&&this.g&&this.readyState!=4&&(this.g=!1,os(this)),this.readyState=0},t.Pa=function(f){if(this.g&&(this.l=f,this.h||(this.status=this.l.status,this.statusText=this.l.statusText,this.h=f.headers,this.readyState=2,Ir(this)),this.g&&(this.readyState=3,Ir(this),this.g)))if(this.responseType==="arraybuffer")f.arrayBuffer().then(this.Na.bind(this),this.ga.bind(this));else if(typeof u.ReadableStream<"u"&&"body"in f){if(this.j=f.body.getReader(),this.o){if(this.responseType)throw Error('responseType must be empty for "streamBinaryChunks" mode responses.');this.response=[]}else this.response=this.responseText="",this.B=new TextDecoder;so(this)}else f.text().then(this.Oa.bind(this),this.ga.bind(this))};function so(f){f.j.read().then(f.Ma.bind(f)).catch(f.ga.bind(f))}t.Ma=function(f){if(this.g){if(this.o&&f.value)this.response.push(f.value);else if(!this.o){var x=f.value?f.value:new Uint8Array(0);(x=this.B.decode(x,{stream:!f.done}))&&(this.response=this.responseText+=x)}f.done?os(this):Ir(this),this.readyState==3&&so(this)}},t.Oa=function(f){this.g&&(this.response=this.responseText=f,os(this))},t.Na=function(f){this.g&&(this.response=f,os(this))},t.ga=function(){this.g&&os(this)};function os(f){f.readyState=4,f.l=null,f.j=null,f.B=null,Ir(f)}t.setRequestHeader=function(f,x){this.A.append(f,x)},t.getResponseHeader=function(f){return this.h&&this.h.get(f.toLowerCase())||""},t.getAllResponseHeaders=function(){if(!this.h)return"";const f=[],x=this.h.entries();for(var S=x.next();!S.done;)S=S.value,f.push(S[0]+": "+S[1]),S=x.next();return f.join(`\r
`)};function Ir(f){f.onreadystatechange&&f.onreadystatechange.call(f)}Object.defineProperty(da.prototype,"withCredentials",{get:function(){return this.m==="include"},set:function(f){this.m=f?"include":"same-origin"}});function dr(f){let x="";return ee(f,function(S,V){x+=V,x+=":",x+=S,x+=`\r
`}),x}function ha(f,x,S){e:{for(V in S){var V=!1;break e}V=!0}V||(S=dr(S),typeof f=="string"?S!=null&&Ei(S):ht(f,x,S))}function pt(f){ut.call(this),this.headers=new Map,this.L=f||null,this.h=!1,this.g=null,this.D="",this.o=0,this.l="",this.j=this.B=this.v=this.A=!1,this.m=null,this.F="",this.H=!1}v(pt,ut);var ni=/^https?$/i,Hl=["POST","PUT"];t=pt.prototype,t.Fa=function(f){this.H=f},t.ea=function(f,x,S,V){if(this.g)throw Error("[goog.net.XhrIo] Object is active with another request="+this.D+"; newUri="+f);x=x?x.toUpperCase():"GET",this.D=f,this.l="",this.o=0,this.A=!1,this.h=!0,this.g=this.L?this.L.g():kl.g(),this.g.onreadystatechange=b(g(this.Ca,this));try{this.B=!0,this.g.open(x,String(f),!0),this.B=!1}catch(le){fa(this,le);return}if(f=S||"",S=new Map(this.headers),V)if(Object.getPrototypeOf(V)===Object.prototype)for(var ne in V)S.set(ne,V[ne]);else if(typeof V.keys=="function"&&typeof V.get=="function")for(const le of V.keys())S.set(le,V.get(le));else throw Error("Unknown input type for opt_headers: "+String(V));V=Array.from(S.keys()).find(le=>le.toLowerCase()=="content-type"),ne=u.FormData&&f instanceof u.FormData,!(Array.prototype.indexOf.call(Hl,x,void 0)>=0)||V||ne||S.set("Content-Type","application/x-www-form-urlencoded;charset=utf-8");for(const[le,Se]of S)this.g.setRequestHeader(le,Se);this.F&&(this.g.responseType=this.F),"withCredentials"in this.g&&this.g.withCredentials!==this.H&&(this.g.withCredentials=this.H);try{this.m&&(clearTimeout(this.m),this.m=null),this.v=!0,this.g.send(f),this.v=!1}catch(le){fa(this,le)}};function fa(f,x){f.h=!1,f.g&&(f.j=!0,f.g.abort(),f.j=!1),f.l=x,f.o=5,Ql(f),Si(f)}function Ql(f){f.A||(f.A=!0,dt(f,"complete"),dt(f,"error"))}t.abort=function(f){this.g&&this.h&&(this.h=!1,this.j=!0,this.g.abort(),this.j=!1,this.o=f||7,dt(this,"complete"),dt(this,"abort"),Si(this))},t.N=function(){this.g&&(this.h&&(this.h=!1,this.j=!0,this.g.abort(),this.j=!1),Si(this,!0)),pt.Z.N.call(this)},t.Ca=function(){this.u||(this.B||this.v||this.j?ma(this):this.Xa())},t.Xa=function(){ma(this)};function ma(f){if(f.h&&typeof l<"u"){if(f.v&&jr(f)==4)setTimeout(f.Ca.bind(f),0);else if(dt(f,"readystatechange"),jr(f)==4){f.h=!1;try{const le=f.ca();e:switch(le){case 200:case 201:case 202:case 204:case 206:case 304:case 1223:var x=!0;break e;default:x=!1}var S;if(!(S=x)){var V;if(V=le===0){let Se=String(f.D).match(Ou)[1]||null;!Se&&u.self&&u.self.location&&(Se=u.self.location.protocol.slice(0,-1)),V=!ni.test(Se?Se.toLowerCase():"")}S=V}if(S)dt(f,"complete"),dt(f,"success");else{f.o=6;try{var ne=jr(f)>2?f.g.statusText:""}catch{ne=""}f.l=ne+" ["+f.ca()+"]",Ql(f)}}finally{Si(f)}}}}function Si(f,x){if(f.g){f.m&&(clearTimeout(f.m),f.m=null);const S=f.g;f.g=null,x||dt(f,"ready");try{S.onreadystatechange=null}catch{}}}t.isActive=function(){return!!this.g};function jr(f){return f.g?f.g.readyState:0}t.ca=function(){try{return jr(this)>2?this.g.status:-1}catch{return-1}},t.la=function(){try{return this.g?this.g.responseText:""}catch{return""}},t.La=function(f){if(this.g){var x=this.g.responseText;return f&&x.indexOf(f)==0&&(x=x.substring(f.length)),Xa(x)}};function yn(f){try{if(!f.g)return null;if("response"in f.g)return f.g.response;switch(f.F){case"":case"text":return f.g.responseText;case"arraybuffer":if("mozResponseArrayBuffer"in f.g)return f.g.mozResponseArrayBuffer}return null}catch{return null}}function wi(f){const x={};f=(f.g&&jr(f)>=2&&f.g.getAllResponseHeaders()||"").split(`\r
`);for(let V=0;V<f.length;V++){if(T(f[V]))continue;var S=Du(f[V]);const ne=S[0];if(S=S[1],typeof S!="string")continue;S=S.trim();const le=x[ne]||[];x[ne]=le,le.push(S)}X(x,function(V){return V.join(", ")})}t.ya=function(){return this.o},t.Ha=function(){return typeof this.l=="string"?this.l:String(this.l)};function ri(f,x,S){return S&&S.internalChannelParams&&S.internalChannelParams[f]||x}function ls(f){this.za=0,this.i=[],this.j=new Ar,this.ba=this.na=this.J=this.W=this.g=this.wa=this.G=this.H=this.u=this.U=this.o=null,this.Ya=this.V=0,this.Sa=ri("failFast",!1,f),this.F=this.C=this.v=this.m=this.l=null,this.X=!0,this.xa=this.K=-1,this.Y=this.A=this.D=0,this.Qa=ri("baseRetryDelayMs",5e3,f),this.Za=ri("retryDelaySeedMs",1e4,f),this.Ta=ri("forwardChannelMaxRetries",2,f),this.va=ri("forwardChannelRequestTimeoutMs",2e4,f),this.ma=f&&f.xmlHttpFactory||void 0,this.Ua=f&&f.Rb||void 0,this.Aa=f&&f.useFetchStreams||!1,this.O=void 0,this.L=f&&f.supportsCrossDomainXhr||!1,this.M="",this.h=new Nl(f&&f.concurrentRequestLimit),this.Ba=new as,this.S=f&&f.fastHandshake||!1,this.R=f&&f.encodeInitMessageHeaders||!1,this.S&&this.R&&(this.R=!1),this.Ra=f&&f.Pb||!1,f&&f.ua&&this.j.ua(),f&&f.forceLongPolling&&(this.X=!1),this.aa=!this.S&&this.X&&f&&f.detectBufferingProxy||!1,this.ia=void 0,f&&f.longPollingTimeout&&f.longPollingTimeout>0&&(this.ia=f.longPollingTimeout),this.ta=void 0,this.T=0,this.P=!1,this.ja=this.B=null}t=ls.prototype,t.ka=8,t.I=1,t.connect=function(f,x,S,V){Gt(0),this.W=f,this.H=x||{},S&&V!==void 0&&(this.H.OSID=S,this.H.OAID=V),this.F=this.X,this.J=qu(this,null,this.W),ii(this)};function $l(f){if(ao(f),f.I==3){var x=f.V++,S=$t(f.J);if(ht(S,"SID",f.M),ht(S,"RID",x),ht(S,"TYPE","terminate"),pa(f,S),x=new Cr(f,f.j,x),x.M=2,x.A=ca($t(S)),S=!1,u.navigator&&u.navigator.sendBeacon)try{S=u.navigator.sendBeacon(x.A.toString(),"")}catch{}!S&&u.Image&&(new Image().src=x.A,S=!0),S||(x.g=Gu(x.j,null),x.g.ea(x.A)),x.F=Date.now(),Wr(x)}Fu(f)}function cs(f){f.g&&(Wl(f),f.g.cancel(),f.g=null)}function ao(f){cs(f),f.v&&(u.clearTimeout(f.v),f.v=null),lo(f),f.h.cancel(),f.m&&(typeof f.m=="number"&&u.clearTimeout(f.m),f.m=null)}function ii(f){if(!Pl(f.h)&&!f.m){f.m=!0;var x=f.Ea;te||I(),he||(te(),he=!0),L.add(x,f),f.D=0}}function oo(f,x){return Jr(f.h)>=f.h.j-(f.m?1:0)?!1:f.m?(f.i=x.G.concat(f.i),!0):f.I==1||f.I==2||f.D>=(f.Sa?0:f.Ta)?!1:(f.m=Qr(g(f.Ea,f,x),Bu(f,f.D)),f.D++,!0)}t.Ea=function(f){if(this.m)if(this.m=null,this.I==1){if(!f){this.V=Math.floor(Math.random()*1e5),f=this.V++;const ne=new Cr(this,this.j,f);let le=this.o;if(this.U&&(le?(le=P(le),Y(le,this.U)):le=this.U),this.u!==null||this.R||(ne.J=le,le=null),this.S)e:{for(var x=0,S=0;S<this.i.length;S++){t:{var V=this.i[S];if("__data__"in V.map&&(V=V.map.__data__,typeof V=="string")){V=V.length;break t}V=void 0}if(V===void 0)break;if(x+=V,x>4096){x=S;break e}if(x===4096||S===this.i.length-1){x=S+1;break e}}x=1e3}else x=1e3;x=Lu(this,ne,x),S=$t(this.J),ht(S,"RID",f),ht(S,"CVER",22),this.G&&ht(S,"X-HTTP-Session-Id",this.G),pa(this,S),le&&(this.R?x="headers="+Ei(dr(le))+"&"+x:this.u&&ha(S,this.u,le)),Ll(this.h,ne),this.Ra&&ht(S,"TYPE","init"),this.S?(ht(S,"$req",x),ht(S,"SID","null"),ne.U=!0,Kr(ne,S,null)):Kr(ne,S,x),this.I=2}}else this.I==3&&(f?Kl(this,f):this.i.length==0||Pl(this.h)||Kl(this))};function Kl(f,x){var S;x?S=x.l:S=f.V++;const V=$t(f.J);ht(V,"SID",f.M),ht(V,"RID",S),ht(V,"AID",f.K),pa(f,V),f.u&&f.o&&ha(V,f.u,f.o),S=new Cr(f,f.j,S,f.D+1),f.u===null&&(S.J=f.o),x&&(f.i=x.G.concat(f.i)),x=Lu(f,S,1e3),S.H=Math.round(f.va*.5)+Math.round(f.va*.5*Math.random()),Ll(f.h,S),Kr(S,V,x)}function pa(f,x){f.H&&ee(f.H,function(S,V){ht(x,V,S)}),f.l&&ee({},function(S,V){ht(x,V,S)})}function Lu(f,x,S){S=Math.min(f.i.length,S);const V=f.l?g(f.l.Ka,f.l,f):null;e:{var ne=f.i;let qe=-1;for(;;){const Vt=["count="+S];qe==-1?S>0?(qe=ne[0].g,Vt.push("ofs="+qe)):qe=0:Vt.push("ofs="+qe);let ot=!0;for(let At=0;At<S;At++){var le=ne[At].g;const hr=ne[At].map;if(le-=qe,le<0)qe=Math.max(0,ne[At].g-100),ot=!1;else try{le="req"+le+"_"||"";try{var Se=hr instanceof Map?hr:Object.entries(hr);for(const[ai,Or]of Se){let Mr=Or;h(Or)&&(Mr=pn(Or)),Vt.push(le+ai+"="+encodeURIComponent(Mr))}}catch(ai){throw Vt.push(le+"type="+encodeURIComponent("_badmap")),ai}}catch{V&&V(hr)}}if(ot){Se=Vt.join("&");break e}}Se=void 0}return f=f.i.splice(0,S),x.G=f,Se}function Vu(f){if(!f.g&&!f.v){f.Y=1;var x=f.Da;te||I(),he||(te(),he=!0),L.add(x,f),f.A=0}}function ga(f){return f.g||f.v||f.A>=3?!1:(f.Y++,f.v=Qr(g(f.Da,f),Bu(f,f.A)),f.A++,!0)}t.Da=function(){if(this.v=null,zu(this),this.aa&&!(this.P||this.g==null||this.T<=0)){var f=4*this.T;this.j.info("BP detection timer enabled: "+f),this.B=Qr(g(this.Wa,this),f)}},t.Wa=function(){this.B&&(this.B=null,this.j.info("BP detection timeout reached."),this.j.info("Buffering proxy detected and switch to long-polling!"),this.F=!1,this.P=!0,Gt(10),cs(this),zu(this))};function Wl(f){f.B!=null&&(u.clearTimeout(f.B),f.B=null)}function zu(f){f.g=new Cr(f,f.j,"rpc",f.Y),f.u===null&&(f.g.J=f.o),f.g.P=0;var x=$t(f.na);ht(x,"RID","rpc"),ht(x,"SID",f.M),ht(x,"AID",f.K),ht(x,"CI",f.F?"0":"1"),!f.F&&f.ia&&ht(x,"TO",f.ia),ht(x,"TYPE","xmlhttp"),pa(f,x),f.u&&f.o&&ha(x,f.u,f.o),f.O&&(f.g.H=f.O);var S=f.g;f=f.ba,S.M=1,S.A=ca($t(x)),S.u=null,S.R=!0,Za(S,f)}t.Va=function(){this.C!=null&&(this.C=null,cs(this),ga(this),Gt(19))};function lo(f){f.C!=null&&(u.clearTimeout(f.C),f.C=null)}function Uu(f,x){var S=null;if(f.g==x){lo(f),Wl(f),f.g=null;var V=2}else if(Zr(f.h,x))S=x.G,Vl(f.h,x),V=1;else return;if(f.I!=0){if(x.o)if(V==1){S=x.u?x.u.length:0,x=Date.now()-x.F;var ne=f.D;V=Ja(),dt(V,new Hr(V,S)),ii(f)}else Vu(f);else if(ne=x.m,ne==3||ne==0&&x.X>0||!(V==1&&oo(f,x)||V==2&&ga(f)))switch(S&&S.length>0&&(x=f.h,x.i=x.i.concat(S)),ne){case 1:si(f,5);break;case 4:si(f,10);break;case 3:si(f,6);break;default:si(f,2)}}}function Bu(f,x){let S=f.Qa+Math.floor(Math.random()*f.Za);return f.isActive()||(S*=2),S*x}function si(f,x){if(f.j.info("Error code "+x),x==2){var S=g(f.bb,f),V=f.Ua;const ne=!V;V=new $n(V||"//www.google.com/images/cleardot.gif"),u.location&&u.location.protocol=="http"||un(V,"https"),ca(V),ne?Dr(V.toString(),S):Gl(V.toString(),S)}else Gt(2);f.I=0,f.l&&f.l.pa(x),Fu(f),ao(f)}t.bb=function(f){f?(this.j.info("Successfully pinged google.com"),Gt(2)):(this.j.info("Failed to ping google.com"),Gt(1))};function Fu(f){if(f.I=0,f.ja=[],f.l){const x=zl(f.h);(x.length!=0||f.i.length!=0)&&(C(f.ja,x),C(f.ja,f.i),f.h.i.length=0,w(f.i),f.i.length=0),f.l.oa()}}function qu(f,x,S){var V=S instanceof $n?$t(S):new $n(S);if(V.g!="")x&&(V.g=x+"."+V.g),ns(V,V.u);else{var ne=u.location;V=ne.protocol,x=x?x+"."+ne.hostname:ne.hostname,ne=+ne.port;const le=new $n(null);V&&un(le,V),x&&(le.g=x),ne&&ns(le,ne),S&&(le.h=S),V=le}return S=f.G,x=f.wa,S&&x&&ht(V,S,x),ht(V,"VER",f.ka),pa(f,V),V}function Gu(f,x,S){if(x&&!f.L)throw Error("Can't create secondary domain capable XhrIo object.");return x=f.Aa&&!f.ma?new pt(new ti({ab:S})):new pt(f.ma),x.Fa(f.L),x}t.isActive=function(){return!!this.l&&this.l.isActive(this)};function Hu(){}t=Hu.prototype,t.ra=function(){},t.qa=function(){},t.pa=function(){},t.oa=function(){},t.isActive=function(){return!0},t.Ka=function(){};function us(){}us.prototype.g=function(f,x){return new jn(f,x)};function jn(f,x){ut.call(this),this.g=new ls(x),this.l=f,this.h=x&&x.messageUrlParams||null,f=x&&x.messageHeaders||null,x&&x.clientProtocolHeaderRequired&&(f?f["X-Client-Protocol"]="webchannel":f={"X-Client-Protocol":"webchannel"}),this.g.o=f,f=x&&x.initMessageHeaders||null,x&&x.messageContentType&&(f?f["X-WebChannel-Content-Type"]=x.messageContentType:f={"X-WebChannel-Content-Type":x.messageContentType}),x&&x.sa&&(f?f["X-WebChannel-Client-Profile"]=x.sa:f={"X-WebChannel-Client-Profile":x.sa}),this.g.U=f,(f=x&&x.Qb)&&!T(f)&&(this.g.u=f),this.A=x&&x.supportsCrossDomainXhr||!1,this.v=x&&x.sendRawJson||!1,(x=x&&x.httpSessionIdParam)&&!T(x)&&(this.g.G=x,f=this.h,f!==null&&x in f&&(f=this.h,x in f&&delete f[x])),this.j=new Ti(this)}v(jn,ut),jn.prototype.m=function(){this.g.l=this.j,this.A&&(this.g.L=!0),this.g.connect(this.l,this.h||void 0)},jn.prototype.close=function(){$l(this.g)},jn.prototype.o=function(f){var x=this.g;if(typeof f=="string"){var S={};S.__data__=f,f=S}else this.v&&(S={},S.__data__=pn(f),f=S);x.i.push(new Qt(x.Ya++,f)),x.I==3&&ii(x)},jn.prototype.N=function(){this.g.l=null,delete this.j,$l(this.g),delete this.g,jn.Z.N.call(this)};function Qu(f){gn.call(this),f.__headers__&&(this.headers=f.__headers__,this.statusCode=f.__status__,delete f.__headers__,delete f.__status__);var x=f.__sm__;if(x){e:{for(const S in x){f=S;break e}f=void 0}(this.i=f)&&(f=this.i,x=x!==null&&f in x?x[f]:void 0),this.data=x}else this.data=f}v(Qu,gn);function $u(){lr.call(this),this.status=1}v($u,lr);function Ti(f){this.g=f}v(Ti,Hu),Ti.prototype.ra=function(){dt(this.g,"a")},Ti.prototype.qa=function(f){dt(this.g,new Qu(f))},Ti.prototype.pa=function(f){dt(this.g,new $u)},Ti.prototype.oa=function(){dt(this.g,"b")},us.prototype.createWebChannel=us.prototype.g,jn.prototype.send=jn.prototype.o,jn.prototype.open=jn.prototype.m,jn.prototype.close=jn.prototype.close,BS=function(){return new us},US=function(){return Ja()},zS=Lt,eg={jb:0,mb:1,nb:2,Hb:3,Mb:4,Jb:5,Kb:6,Ib:7,Gb:8,Lb:9,PROXY:10,NOPROXY:11,Eb:12,Ab:13,Bb:14,zb:15,Cb:16,Db:17,fb:18,eb:19,gb:20},oa.NO_ERROR=0,oa.TIMEOUT=8,oa.HTTP_ERROR=6,oh=oa,Ml.COMPLETE="complete",VS=Ml,Tu.EventType=Tr,Tr.OPEN="a",Tr.CLOSE="b",Tr.ERROR="c",Tr.MESSAGE="d",ut.prototype.listen=ut.prototype.J,Vc=Tu,pt.prototype.listenOnce=pt.prototype.K,pt.prototype.getLastError=pt.prototype.Ha,pt.prototype.getLastErrorCode=pt.prototype.ya,pt.prototype.getStatus=pt.prototype.ca,pt.prototype.getResponseJson=pt.prototype.La,pt.prototype.getResponseText=pt.prototype.la,pt.prototype.send=pt.prototype.ea,pt.prototype.setWithCredentials=pt.prototype.Fa,LS=pt}).apply(typeof Zd<"u"?Zd:typeof self<"u"?self:typeof window<"u"?window:{});const Yb="@firebase/firestore",Xb="4.9.3";class Rn{constructor(e){this.uid=e}isAuthenticated(){return this.uid!=null}toKey(){return this.isAuthenticated()?"uid:"+this.uid:"anonymous-user"}isEqual(e){return e.uid===this.uid}}Rn.UNAUTHENTICATED=new Rn(null),Rn.GOOGLE_CREDENTIALS=new Rn("google-credentials-uid"),Rn.FIRST_PARTY=new Rn("first-party-uid"),Rn.MOCK_USER=new Rn("mock-user");let bl="12.7.0";const Ua=new Vg("@firebase/firestore");function qo(){return Ua.logLevel}function Ae(t,...e){if(Ua.logLevel<=Je.DEBUG){const n=e.map(Bg);Ua.debug(`Firestore (${bl}): ${t}`,...n)}}function Ki(t,...e){if(Ua.logLevel<=Je.ERROR){const n=e.map(Bg);Ua.error(`Firestore (${bl}): ${t}`,...n)}}function nl(t,...e){if(Ua.logLevel<=Je.WARN){const n=e.map(Bg);Ua.warn(`Firestore (${bl}): ${t}`,...n)}}function Bg(t){if(typeof t=="string")return t;try{return(function(n){return JSON.stringify(n)})(t)}catch{return t}}function Pe(t,e,n){let i="Unexpected state";typeof e=="string"?i=e:n=e,FS(t,i,n)}function FS(t,e,n){let i=`FIRESTORE (${bl}) INTERNAL ASSERTION FAILED: ${e} (ID: ${t.toString(16)})`;if(n!==void 0)try{i+=" CONTEXT: "+JSON.stringify(n)}catch{i+=" CONTEXT: "+n}throw Ki(i),new Error(i)}function ct(t,e,n,i){let a="Unexpected state";typeof n=="string"?a=n:i=n,t||FS(e,a,i)}function Fe(t,e){return t}const ve={OK:"ok",CANCELLED:"cancelled",UNKNOWN:"unknown",INVALID_ARGUMENT:"invalid-argument",DEADLINE_EXCEEDED:"deadline-exceeded",NOT_FOUND:"not-found",ALREADY_EXISTS:"already-exists",PERMISSION_DENIED:"permission-denied",UNAUTHENTICATED:"unauthenticated",RESOURCE_EXHAUSTED:"resource-exhausted",FAILED_PRECONDITION:"failed-precondition",ABORTED:"aborted",OUT_OF_RANGE:"out-of-range",UNIMPLEMENTED:"unimplemented",INTERNAL:"internal",UNAVAILABLE:"unavailable",DATA_LOSS:"data-loss"};class Te extends Xi{constructor(e,n){super(e,n),this.code=e,this.message=n,this.toString=()=>`${this.name}: [code=${this.code}]: ${this.message}`}}class Hi{constructor(){this.promise=new Promise(((e,n)=>{this.resolve=e,this.reject=n}))}}class qS{constructor(e,n){this.user=n,this.type="OAuth",this.headers=new Map,this.headers.set("Authorization",`Bearer ${e}`)}}class Cj{getToken(){return Promise.resolve(null)}invalidateToken(){}start(e,n){e.enqueueRetryable((()=>n(Rn.UNAUTHENTICATED)))}shutdown(){}}class Rj{constructor(e){this.token=e,this.changeListener=null}getToken(){return Promise.resolve(this.token)}invalidateToken(){}start(e,n){this.changeListener=n,e.enqueueRetryable((()=>n(this.token.user)))}shutdown(){this.changeListener=null}}class Dj{constructor(e){this.t=e,this.currentUser=Rn.UNAUTHENTICATED,this.i=0,this.forceRefresh=!1,this.auth=null}start(e,n){ct(this.o===void 0,42304);let i=this.i;const a=m=>this.i!==i?(i=this.i,n(m)):Promise.resolve();let l=new Hi;this.o=()=>{this.i++,this.currentUser=this.u(),l.resolve(),l=new Hi,e.enqueueRetryable((()=>a(this.currentUser)))};const u=()=>{const m=l;e.enqueueRetryable((async()=>{await m.promise,await a(this.currentUser)}))},h=m=>{Ae("FirebaseAuthCredentialsProvider","Auth detected"),this.auth=m,this.o&&(this.auth.addAuthTokenListener(this.o),u())};this.t.onInit((m=>h(m))),setTimeout((()=>{if(!this.auth){const m=this.t.getImmediate({optional:!0});m?h(m):(Ae("FirebaseAuthCredentialsProvider","Auth not yet detected"),l.resolve(),l=new Hi)}}),0),u()}getToken(){const e=this.i,n=this.forceRefresh;return this.forceRefresh=!1,this.auth?this.auth.getToken(n).then((i=>this.i!==e?(Ae("FirebaseAuthCredentialsProvider","getToken aborted due to token change."),this.getToken()):i?(ct(typeof i.accessToken=="string",31837,{l:i}),new qS(i.accessToken,this.currentUser)):null)):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.auth&&this.o&&this.auth.removeAuthTokenListener(this.o),this.o=void 0}u(){const e=this.auth&&this.auth.getUid();return ct(e===null||typeof e=="string",2055,{h:e}),new Rn(e)}}class Ij{constructor(e,n,i){this.P=e,this.T=n,this.I=i,this.type="FirstParty",this.user=Rn.FIRST_PARTY,this.A=new Map}R(){return this.I?this.I():null}get headers(){this.A.set("X-Goog-AuthUser",this.P);const e=this.R();return e&&this.A.set("Authorization",e),this.T&&this.A.set("X-Goog-Iam-Authorization-Token",this.T),this.A}}class jj{constructor(e,n,i){this.P=e,this.T=n,this.I=i}getToken(){return Promise.resolve(new Ij(this.P,this.T,this.I))}start(e,n){e.enqueueRetryable((()=>n(Rn.FIRST_PARTY)))}shutdown(){}invalidateToken(){}}class Jb{constructor(e){this.value=e,this.type="AppCheck",this.headers=new Map,e&&e.length>0&&this.headers.set("x-firebase-appcheck",this.value)}}class Oj{constructor(e,n){this.V=n,this.forceRefresh=!1,this.appCheck=null,this.m=null,this.p=null,Vr(e)&&e.settings.appCheckToken&&(this.p=e.settings.appCheckToken)}start(e,n){ct(this.o===void 0,3512);const i=l=>{l.error!=null&&Ae("FirebaseAppCheckTokenProvider",`Error getting App Check token; using placeholder token instead. Error: ${l.error.message}`);const u=l.token!==this.m;return this.m=l.token,Ae("FirebaseAppCheckTokenProvider",`Received ${u?"new":"existing"} token.`),u?n(l.token):Promise.resolve()};this.o=l=>{e.enqueueRetryable((()=>i(l)))};const a=l=>{Ae("FirebaseAppCheckTokenProvider","AppCheck detected"),this.appCheck=l,this.o&&this.appCheck.addTokenListener(this.o)};this.V.onInit((l=>a(l))),setTimeout((()=>{if(!this.appCheck){const l=this.V.getImmediate({optional:!0});l?a(l):Ae("FirebaseAppCheckTokenProvider","AppCheck not yet detected")}}),0)}getToken(){if(this.p)return Promise.resolve(new Jb(this.p));const e=this.forceRefresh;return this.forceRefresh=!1,this.appCheck?this.appCheck.getToken(e).then((n=>n?(ct(typeof n.token=="string",44558,{tokenResult:n}),this.m=n.token,new Jb(n.token)):null)):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.appCheck&&this.o&&this.appCheck.removeTokenListener(this.o),this.o=void 0}}function Mj(t){const e=typeof self<"u"&&(self.crypto||self.msCrypto),n=new Uint8Array(t);if(e&&typeof e.getRandomValues=="function")e.getRandomValues(n);else for(let i=0;i<t;i++)n[i]=Math.floor(256*Math.random());return n}class Fg{static newId(){const e="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",n=62*Math.floor(4.129032258064516);let i="";for(;i.length<20;){const a=Mj(40);for(let l=0;l<a.length;++l)i.length<20&&a[l]<n&&(i+=e.charAt(a[l]%62))}return i}}function Ze(t,e){return t<e?-1:t>e?1:0}function tg(t,e){const n=Math.min(t.length,e.length);for(let i=0;i<n;i++){const a=t.charAt(i),l=e.charAt(i);if(a!==l)return Ip(a)===Ip(l)?Ze(a,l):Ip(a)?1:-1}return Ze(t.length,e.length)}const kj=55296,Nj=57343;function Ip(t){const e=t.charCodeAt(0);return e>=kj&&e<=Nj}function rl(t,e,n){return t.length===e.length&&t.every(((i,a)=>n(i,e[a])))}const Zb="__name__";class di{constructor(e,n,i){n===void 0?n=0:n>e.length&&Pe(637,{offset:n,range:e.length}),i===void 0?i=e.length-n:i>e.length-n&&Pe(1746,{length:i,range:e.length-n}),this.segments=e,this.offset=n,this.len=i}get length(){return this.len}isEqual(e){return di.comparator(this,e)===0}child(e){const n=this.segments.slice(this.offset,this.limit());return e instanceof di?e.forEach((i=>{n.push(i)})):n.push(e),this.construct(n)}limit(){return this.offset+this.length}popFirst(e){return e=e===void 0?1:e,this.construct(this.segments,this.offset+e,this.length-e)}popLast(){return this.construct(this.segments,this.offset,this.length-1)}firstSegment(){return this.segments[this.offset]}lastSegment(){return this.get(this.length-1)}get(e){return this.segments[this.offset+e]}isEmpty(){return this.length===0}isPrefixOf(e){if(e.length<this.length)return!1;for(let n=0;n<this.length;n++)if(this.get(n)!==e.get(n))return!1;return!0}isImmediateParentOf(e){if(this.length+1!==e.length)return!1;for(let n=0;n<this.length;n++)if(this.get(n)!==e.get(n))return!1;return!0}forEach(e){for(let n=this.offset,i=this.limit();n<i;n++)e(this.segments[n])}toArray(){return this.segments.slice(this.offset,this.limit())}static comparator(e,n){const i=Math.min(e.length,n.length);for(let a=0;a<i;a++){const l=di.compareSegments(e.get(a),n.get(a));if(l!==0)return l}return Ze(e.length,n.length)}static compareSegments(e,n){const i=di.isNumericId(e),a=di.isNumericId(n);return i&&!a?-1:!i&&a?1:i&&a?di.extractNumericId(e).compare(di.extractNumericId(n)):tg(e,n)}static isNumericId(e){return e.startsWith("__id")&&e.endsWith("__")}static extractNumericId(e){return Hs.fromString(e.substring(4,e.length-2))}}class Et extends di{construct(e,n,i){return new Et(e,n,i)}canonicalString(){return this.toArray().join("/")}toString(){return this.canonicalString()}toUriEncodedString(){return this.toArray().map(encodeURIComponent).join("/")}static fromString(...e){const n=[];for(const i of e){if(i.indexOf("//")>=0)throw new Te(ve.INVALID_ARGUMENT,`Invalid segment (${i}). Paths must not contain // in them.`);n.push(...i.split("/").filter((a=>a.length>0)))}return new Et(n)}static emptyPath(){return new Et([])}}const Pj=/^[_a-zA-Z][_a-zA-Z0-9]*$/;class Sn extends di{construct(e,n,i){return new Sn(e,n,i)}static isValidIdentifier(e){return Pj.test(e)}canonicalString(){return this.toArray().map((e=>(e=e.replace(/\\/g,"\\\\").replace(/`/g,"\\`"),Sn.isValidIdentifier(e)||(e="`"+e+"`"),e))).join(".")}toString(){return this.canonicalString()}isKeyField(){return this.length===1&&this.get(0)===Zb}static keyField(){return new Sn([Zb])}static fromServerFormat(e){const n=[];let i="",a=0;const l=()=>{if(i.length===0)throw new Te(ve.INVALID_ARGUMENT,`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`);n.push(i),i=""};let u=!1;for(;a<e.length;){const h=e[a];if(h==="\\"){if(a+1===e.length)throw new Te(ve.INVALID_ARGUMENT,"Path has trailing escape character: "+e);const m=e[a+1];if(m!=="\\"&&m!=="."&&m!=="`")throw new Te(ve.INVALID_ARGUMENT,"Path has invalid escape sequence: "+e);i+=m,a+=2}else h==="`"?(u=!u,a++):h!=="."||u?(i+=h,a++):(l(),a++)}if(l(),u)throw new Te(ve.INVALID_ARGUMENT,"Unterminated ` in path: "+e);return new Sn(n)}static emptyPath(){return new Sn([])}}class je{constructor(e){this.path=e}static fromPath(e){return new je(Et.fromString(e))}static fromName(e){return new je(Et.fromString(e).popFirst(5))}static empty(){return new je(Et.emptyPath())}get collectionGroup(){return this.path.popLast().lastSegment()}hasCollectionId(e){return this.path.length>=2&&this.path.get(this.path.length-2)===e}getCollectionGroup(){return this.path.get(this.path.length-2)}getCollectionPath(){return this.path.popLast()}isEqual(e){return e!==null&&Et.comparator(this.path,e.path)===0}toString(){return this.path.toString()}static comparator(e,n){return Et.comparator(e.path,n.path)}static isDocumentKey(e){return e.length%2==0}static fromSegments(e){return new je(new Et(e.slice()))}}function GS(t,e,n){if(!n)throw new Te(ve.INVALID_ARGUMENT,`Function ${t}() cannot be called with an empty ${e}.`)}function Lj(t,e,n,i){if(e===!0&&i===!0)throw new Te(ve.INVALID_ARGUMENT,`${t} and ${n} cannot be used together.`)}function ex(t){if(!je.isDocumentKey(t))throw new Te(ve.INVALID_ARGUMENT,`Invalid document reference. Document references must have an even number of segments, but ${t} has ${t.length}.`)}function tx(t){if(je.isDocumentKey(t))throw new Te(ve.INVALID_ARGUMENT,`Invalid collection reference. Collection references must have an odd number of segments, but ${t} has ${t.length}.`)}function HS(t){return typeof t=="object"&&t!==null&&(Object.getPrototypeOf(t)===Object.prototype||Object.getPrototypeOf(t)===null)}function Wh(t){if(t===void 0)return"undefined";if(t===null)return"null";if(typeof t=="string")return t.length>20&&(t=`${t.substring(0,20)}...`),JSON.stringify(t);if(typeof t=="number"||typeof t=="boolean")return""+t;if(typeof t=="object"){if(t instanceof Array)return"an array";{const e=(function(i){return i.constructor?i.constructor.name:null})(t);return e?`a custom ${e} object`:"an object"}}return typeof t=="function"?"a function":Pe(12329,{type:typeof t})}function bi(t,e){if("_delegate"in t&&(t=t._delegate),!(t instanceof e)){if(e.name===t.constructor.name)throw new Te(ve.INVALID_ARGUMENT,"Type does not match the expected instance. Did you pass a reference from a different Firestore SDK?");{const n=Wh(t);throw new Te(ve.INVALID_ARGUMENT,`Expected type '${e.name}', but it was: ${n}`)}}return t}function nn(t,e){const n={typeString:t};return e&&(n.value=e),n}function hu(t,e){if(!HS(t))throw new Te(ve.INVALID_ARGUMENT,"JSON must be an object");let n;for(const i in e)if(e[i]){const a=e[i].typeString,l="value"in e[i]?{value:e[i].value}:void 0;if(!(i in t)){n=`JSON missing required field: '${i}'`;break}const u=t[i];if(a&&typeof u!==a){n=`JSON field '${i}' must be a ${a}.`;break}if(l!==void 0&&u!==l.value){n=`Expected '${i}' field to equal '${l.value}'`;break}}if(n)throw new Te(ve.INVALID_ARGUMENT,n);return!0}const nx=-62135596800,rx=1e6;class Tt{static now(){return Tt.fromMillis(Date.now())}static fromDate(e){return Tt.fromMillis(e.getTime())}static fromMillis(e){const n=Math.floor(e/1e3),i=Math.floor((e-1e3*n)*rx);return new Tt(n,i)}constructor(e,n){if(this.seconds=e,this.nanoseconds=n,n<0)throw new Te(ve.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+n);if(n>=1e9)throw new Te(ve.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+n);if(e<nx)throw new Te(ve.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e);if(e>=253402300800)throw new Te(ve.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e)}toDate(){return new Date(this.toMillis())}toMillis(){return 1e3*this.seconds+this.nanoseconds/rx}_compareTo(e){return this.seconds===e.seconds?Ze(this.nanoseconds,e.nanoseconds):Ze(this.seconds,e.seconds)}isEqual(e){return e.seconds===this.seconds&&e.nanoseconds===this.nanoseconds}toString(){return"Timestamp(seconds="+this.seconds+", nanoseconds="+this.nanoseconds+")"}toJSON(){return{type:Tt._jsonSchemaVersion,seconds:this.seconds,nanoseconds:this.nanoseconds}}static fromJSON(e){if(hu(e,Tt._jsonSchema))return new Tt(e.seconds,e.nanoseconds)}valueOf(){const e=this.seconds-nx;return String(e).padStart(12,"0")+"."+String(this.nanoseconds).padStart(9,"0")}}Tt._jsonSchemaVersion="firestore/timestamp/1.0",Tt._jsonSchema={type:nn("string",Tt._jsonSchemaVersion),seconds:nn("number"),nanoseconds:nn("number")};class Ue{static fromTimestamp(e){return new Ue(e)}static min(){return new Ue(new Tt(0,0))}static max(){return new Ue(new Tt(253402300799,999999999))}constructor(e){this.timestamp=e}compareTo(e){return this.timestamp._compareTo(e.timestamp)}isEqual(e){return this.timestamp.isEqual(e.timestamp)}toMicroseconds(){return 1e6*this.timestamp.seconds+this.timestamp.nanoseconds/1e3}toString(){return"SnapshotVersion("+this.timestamp.toString()+")"}toTimestamp(){return this.timestamp}}const Xc=-1;function Vj(t,e){const n=t.toTimestamp().seconds,i=t.toTimestamp().nanoseconds+1,a=Ue.fromTimestamp(i===1e9?new Tt(n+1,0):new Tt(n,i));return new Ws(a,je.empty(),e)}function zj(t){return new Ws(t.readTime,t.key,Xc)}class Ws{constructor(e,n,i){this.readTime=e,this.documentKey=n,this.largestBatchId=i}static min(){return new Ws(Ue.min(),je.empty(),Xc)}static max(){return new Ws(Ue.max(),je.empty(),Xc)}}function Uj(t,e){let n=t.readTime.compareTo(e.readTime);return n!==0?n:(n=je.comparator(t.documentKey,e.documentKey),n!==0?n:Ze(t.largestBatchId,e.largestBatchId))}const Bj="The current tab is not in the required state to perform this operation. It might be necessary to refresh the browser tab.";class Fj{constructor(){this.onCommittedListeners=[]}addOnCommittedListener(e){this.onCommittedListeners.push(e)}raiseOnCommittedEvent(){this.onCommittedListeners.forEach((e=>e()))}}async function xl(t){if(t.code!==ve.FAILED_PRECONDITION||t.message!==Bj)throw t;Ae("LocalStore","Unexpectedly lost primary lease")}class be{constructor(e){this.nextCallback=null,this.catchCallback=null,this.result=void 0,this.error=void 0,this.isDone=!1,this.callbackAttached=!1,e((n=>{this.isDone=!0,this.result=n,this.nextCallback&&this.nextCallback(n)}),(n=>{this.isDone=!0,this.error=n,this.catchCallback&&this.catchCallback(n)}))}catch(e){return this.next(void 0,e)}next(e,n){return this.callbackAttached&&Pe(59440),this.callbackAttached=!0,this.isDone?this.error?this.wrapFailure(n,this.error):this.wrapSuccess(e,this.result):new be(((i,a)=>{this.nextCallback=l=>{this.wrapSuccess(e,l).next(i,a)},this.catchCallback=l=>{this.wrapFailure(n,l).next(i,a)}}))}toPromise(){return new Promise(((e,n)=>{this.next(e,n)}))}wrapUserFunction(e){try{const n=e();return n instanceof be?n:be.resolve(n)}catch(n){return be.reject(n)}}wrapSuccess(e,n){return e?this.wrapUserFunction((()=>e(n))):be.resolve(n)}wrapFailure(e,n){return e?this.wrapUserFunction((()=>e(n))):be.reject(n)}static resolve(e){return new be(((n,i)=>{n(e)}))}static reject(e){return new be(((n,i)=>{i(e)}))}static waitFor(e){return new be(((n,i)=>{let a=0,l=0,u=!1;e.forEach((h=>{++a,h.next((()=>{++l,u&&l===a&&n()}),(m=>i(m)))})),u=!0,l===a&&n()}))}static or(e){let n=be.resolve(!1);for(const i of e)n=n.next((a=>a?be.resolve(a):i()));return n}static forEach(e,n){const i=[];return e.forEach(((a,l)=>{i.push(n.call(this,a,l))})),this.waitFor(i)}static mapArray(e,n){return new be(((i,a)=>{const l=e.length,u=new Array(l);let h=0;for(let m=0;m<l;m++){const g=m;n(e[g]).next((_=>{u[g]=_,++h,h===l&&i(u)}),(_=>a(_)))}}))}static doWhile(e,n){return new be(((i,a)=>{const l=()=>{e()===!0?n().next((()=>{l()}),a):i()};l()}))}}function qj(t){const e=t.match(/Android ([\d.]+)/i),n=e?e[1].split(".").slice(0,2).join("."):"-1";return Number(n)}function El(t){return t.name==="IndexedDbTransactionError"}class Yh{constructor(e,n){this.previousValue=e,n&&(n.sequenceNumberHandler=i=>this.ae(i),this.ue=i=>n.writeSequenceNumber(i))}ae(e){return this.previousValue=Math.max(e,this.previousValue),this.previousValue}next(){const e=++this.previousValue;return this.ue&&this.ue(e),e}}Yh.ce=-1;const qg=-1;function Xh(t){return t==null}function wh(t){return t===0&&1/t==-1/0}function Gj(t){return typeof t=="number"&&Number.isInteger(t)&&!wh(t)&&t<=Number.MAX_SAFE_INTEGER&&t>=Number.MIN_SAFE_INTEGER}const QS="";function Hj(t){let e="";for(let n=0;n<t.length;n++)e.length>0&&(e=ix(e)),e=Qj(t.get(n),e);return ix(e)}function Qj(t,e){let n=e;const i=t.length;for(let a=0;a<i;a++){const l=t.charAt(a);switch(l){case"\0":n+="";break;case QS:n+="";break;default:n+=l}}return n}function ix(t){return t+QS+""}function sx(t){let e=0;for(const n in t)Object.prototype.hasOwnProperty.call(t,n)&&e++;return e}function na(t,e){for(const n in t)Object.prototype.hasOwnProperty.call(t,n)&&e(n,t[n])}function $S(t){for(const e in t)if(Object.prototype.hasOwnProperty.call(t,e))return!1;return!0}class It{constructor(e,n){this.comparator=e,this.root=n||En.EMPTY}insert(e,n){return new It(this.comparator,this.root.insert(e,n,this.comparator).copy(null,null,En.BLACK,null,null))}remove(e){return new It(this.comparator,this.root.remove(e,this.comparator).copy(null,null,En.BLACK,null,null))}get(e){let n=this.root;for(;!n.isEmpty();){const i=this.comparator(e,n.key);if(i===0)return n.value;i<0?n=n.left:i>0&&(n=n.right)}return null}indexOf(e){let n=0,i=this.root;for(;!i.isEmpty();){const a=this.comparator(e,i.key);if(a===0)return n+i.left.size;a<0?i=i.left:(n+=i.left.size+1,i=i.right)}return-1}isEmpty(){return this.root.isEmpty()}get size(){return this.root.size}minKey(){return this.root.minKey()}maxKey(){return this.root.maxKey()}inorderTraversal(e){return this.root.inorderTraversal(e)}forEach(e){this.inorderTraversal(((n,i)=>(e(n,i),!1)))}toString(){const e=[];return this.inorderTraversal(((n,i)=>(e.push(`${n}:${i}`),!1))),`{${e.join(", ")}}`}reverseTraversal(e){return this.root.reverseTraversal(e)}getIterator(){return new eh(this.root,null,this.comparator,!1)}getIteratorFrom(e){return new eh(this.root,e,this.comparator,!1)}getReverseIterator(){return new eh(this.root,null,this.comparator,!0)}getReverseIteratorFrom(e){return new eh(this.root,e,this.comparator,!0)}}class eh{constructor(e,n,i,a){this.isReverse=a,this.nodeStack=[];let l=1;for(;!e.isEmpty();)if(l=n?i(e.key,n):1,n&&a&&(l*=-1),l<0)e=this.isReverse?e.left:e.right;else{if(l===0){this.nodeStack.push(e);break}this.nodeStack.push(e),e=this.isReverse?e.right:e.left}}getNext(){let e=this.nodeStack.pop();const n={key:e.key,value:e.value};if(this.isReverse)for(e=e.left;!e.isEmpty();)this.nodeStack.push(e),e=e.right;else for(e=e.right;!e.isEmpty();)this.nodeStack.push(e),e=e.left;return n}hasNext(){return this.nodeStack.length>0}peek(){if(this.nodeStack.length===0)return null;const e=this.nodeStack[this.nodeStack.length-1];return{key:e.key,value:e.value}}}class En{constructor(e,n,i,a,l){this.key=e,this.value=n,this.color=i??En.RED,this.left=a??En.EMPTY,this.right=l??En.EMPTY,this.size=this.left.size+1+this.right.size}copy(e,n,i,a,l){return new En(e??this.key,n??this.value,i??this.color,a??this.left,l??this.right)}isEmpty(){return!1}inorderTraversal(e){return this.left.inorderTraversal(e)||e(this.key,this.value)||this.right.inorderTraversal(e)}reverseTraversal(e){return this.right.reverseTraversal(e)||e(this.key,this.value)||this.left.reverseTraversal(e)}min(){return this.left.isEmpty()?this:this.left.min()}minKey(){return this.min().key}maxKey(){return this.right.isEmpty()?this.key:this.right.maxKey()}insert(e,n,i){let a=this;const l=i(e,a.key);return a=l<0?a.copy(null,null,null,a.left.insert(e,n,i),null):l===0?a.copy(null,n,null,null,null):a.copy(null,null,null,null,a.right.insert(e,n,i)),a.fixUp()}removeMin(){if(this.left.isEmpty())return En.EMPTY;let e=this;return e.left.isRed()||e.left.left.isRed()||(e=e.moveRedLeft()),e=e.copy(null,null,null,e.left.removeMin(),null),e.fixUp()}remove(e,n){let i,a=this;if(n(e,a.key)<0)a.left.isEmpty()||a.left.isRed()||a.left.left.isRed()||(a=a.moveRedLeft()),a=a.copy(null,null,null,a.left.remove(e,n),null);else{if(a.left.isRed()&&(a=a.rotateRight()),a.right.isEmpty()||a.right.isRed()||a.right.left.isRed()||(a=a.moveRedRight()),n(e,a.key)===0){if(a.right.isEmpty())return En.EMPTY;i=a.right.min(),a=a.copy(i.key,i.value,null,null,a.right.removeMin())}a=a.copy(null,null,null,null,a.right.remove(e,n))}return a.fixUp()}isRed(){return this.color}fixUp(){let e=this;return e.right.isRed()&&!e.left.isRed()&&(e=e.rotateLeft()),e.left.isRed()&&e.left.left.isRed()&&(e=e.rotateRight()),e.left.isRed()&&e.right.isRed()&&(e=e.colorFlip()),e}moveRedLeft(){let e=this.colorFlip();return e.right.left.isRed()&&(e=e.copy(null,null,null,null,e.right.rotateRight()),e=e.rotateLeft(),e=e.colorFlip()),e}moveRedRight(){let e=this.colorFlip();return e.left.left.isRed()&&(e=e.rotateRight(),e=e.colorFlip()),e}rotateLeft(){const e=this.copy(null,null,En.RED,null,this.right.left);return this.right.copy(null,null,this.color,e,null)}rotateRight(){const e=this.copy(null,null,En.RED,this.left.right,null);return this.left.copy(null,null,this.color,null,e)}colorFlip(){const e=this.left.copy(null,null,!this.left.color,null,null),n=this.right.copy(null,null,!this.right.color,null,null);return this.copy(null,null,!this.color,e,n)}checkMaxDepth(){const e=this.check();return Math.pow(2,e)<=this.size+1}check(){if(this.isRed()&&this.left.isRed())throw Pe(43730,{key:this.key,value:this.value});if(this.right.isRed())throw Pe(14113,{key:this.key,value:this.value});const e=this.left.check();if(e!==this.right.check())throw Pe(27949);return e+(this.isRed()?0:1)}}En.EMPTY=null,En.RED=!0,En.BLACK=!1;En.EMPTY=new class{constructor(){this.size=0}get key(){throw Pe(57766)}get value(){throw Pe(16141)}get color(){throw Pe(16727)}get left(){throw Pe(29726)}get right(){throw Pe(36894)}copy(e,n,i,a,l){return this}insert(e,n,i){return new En(e,n)}remove(e,n){return this}isEmpty(){return!0}inorderTraversal(e){return!1}reverseTraversal(e){return!1}minKey(){return null}maxKey(){return null}isRed(){return!1}checkMaxDepth(){return!0}check(){return 0}};class on{constructor(e){this.comparator=e,this.data=new It(this.comparator)}has(e){return this.data.get(e)!==null}first(){return this.data.minKey()}last(){return this.data.maxKey()}get size(){return this.data.size}indexOf(e){return this.data.indexOf(e)}forEach(e){this.data.inorderTraversal(((n,i)=>(e(n),!1)))}forEachInRange(e,n){const i=this.data.getIteratorFrom(e[0]);for(;i.hasNext();){const a=i.getNext();if(this.comparator(a.key,e[1])>=0)return;n(a.key)}}forEachWhile(e,n){let i;for(i=n!==void 0?this.data.getIteratorFrom(n):this.data.getIterator();i.hasNext();)if(!e(i.getNext().key))return}firstAfterOrEqual(e){const n=this.data.getIteratorFrom(e);return n.hasNext()?n.getNext().key:null}getIterator(){return new ax(this.data.getIterator())}getIteratorFrom(e){return new ax(this.data.getIteratorFrom(e))}add(e){return this.copy(this.data.remove(e).insert(e,!0))}delete(e){return this.has(e)?this.copy(this.data.remove(e)):this}isEmpty(){return this.data.isEmpty()}unionWith(e){let n=this;return n.size<e.size&&(n=e,e=this),e.forEach((i=>{n=n.add(i)})),n}isEqual(e){if(!(e instanceof on)||this.size!==e.size)return!1;const n=this.data.getIterator(),i=e.data.getIterator();for(;n.hasNext();){const a=n.getNext().key,l=i.getNext().key;if(this.comparator(a,l)!==0)return!1}return!0}toArray(){const e=[];return this.forEach((n=>{e.push(n)})),e}toString(){const e=[];return this.forEach((n=>e.push(n))),"SortedSet("+e.toString()+")"}copy(e){const n=new on(this.comparator);return n.data=e,n}}class ax{constructor(e){this.iter=e}getNext(){return this.iter.getNext().key}hasNext(){return this.iter.hasNext()}}class tr{constructor(e){this.fields=e,e.sort(Sn.comparator)}static empty(){return new tr([])}unionWith(e){let n=new on(Sn.comparator);for(const i of this.fields)n=n.add(i);for(const i of e)n=n.add(i);return new tr(n.toArray())}covers(e){for(const n of this.fields)if(n.isPrefixOf(e))return!0;return!1}isEqual(e){return rl(this.fields,e.fields,((n,i)=>n.isEqual(i)))}}class KS extends Error{constructor(){super(...arguments),this.name="Base64DecodeError"}}class wn{constructor(e){this.binaryString=e}static fromBase64String(e){const n=(function(a){try{return atob(a)}catch(l){throw typeof DOMException<"u"&&l instanceof DOMException?new KS("Invalid base64 string: "+l):l}})(e);return new wn(n)}static fromUint8Array(e){const n=(function(a){let l="";for(let u=0;u<a.length;++u)l+=String.fromCharCode(a[u]);return l})(e);return new wn(n)}[Symbol.iterator](){let e=0;return{next:()=>e<this.binaryString.length?{value:this.binaryString.charCodeAt(e++),done:!1}:{value:void 0,done:!0}}}toBase64(){return(function(n){return btoa(n)})(this.binaryString)}toUint8Array(){return(function(n){const i=new Uint8Array(n.length);for(let a=0;a<n.length;a++)i[a]=n.charCodeAt(a);return i})(this.binaryString)}approximateByteSize(){return 2*this.binaryString.length}compareTo(e){return Ze(this.binaryString,e.binaryString)}isEqual(e){return this.binaryString===e.binaryString}}wn.EMPTY_BYTE_STRING=new wn("");const $j=new RegExp(/^\d{4}-\d\d-\d\dT\d\d:\d\d:\d\d(?:\.(\d+))?Z$/);function Ys(t){if(ct(!!t,39018),typeof t=="string"){let e=0;const n=$j.exec(t);if(ct(!!n,46558,{timestamp:t}),n[1]){let a=n[1];a=(a+"000000000").substr(0,9),e=Number(a)}const i=new Date(t);return{seconds:Math.floor(i.getTime()/1e3),nanos:e}}return{seconds:Bt(t.seconds),nanos:Bt(t.nanos)}}function Bt(t){return typeof t=="number"?t:typeof t=="string"?Number(t):0}function Xs(t){return typeof t=="string"?wn.fromBase64String(t):wn.fromUint8Array(t)}const WS="server_timestamp",YS="__type__",XS="__previous_value__",JS="__local_write_time__";function Gg(t){return(t?.mapValue?.fields||{})[YS]?.stringValue===WS}function Jh(t){const e=t.mapValue.fields[XS];return Gg(e)?Jh(e):e}function Jc(t){const e=Ys(t.mapValue.fields[JS].timestampValue);return new Tt(e.seconds,e.nanos)}class Kj{constructor(e,n,i,a,l,u,h,m,g,_){this.databaseId=e,this.appId=n,this.persistenceKey=i,this.host=a,this.ssl=l,this.forceLongPolling=u,this.autoDetectLongPolling=h,this.longPollingOptions=m,this.useFetchStreams=g,this.isUsingEmulator=_}}const Th="(default)";class Zc{constructor(e,n){this.projectId=e,this.database=n||Th}static empty(){return new Zc("","")}get isDefaultDatabase(){return this.database===Th}isEqual(e){return e instanceof Zc&&e.projectId===this.projectId&&e.database===this.database}}const ZS="__type__",Wj="__max__",th={mapValue:{}},ew="__vector__",Ah="value";function Js(t){return"nullValue"in t?0:"booleanValue"in t?1:"integerValue"in t||"doubleValue"in t?2:"timestampValue"in t?3:"stringValue"in t?5:"bytesValue"in t?6:"referenceValue"in t?7:"geoPointValue"in t?8:"arrayValue"in t?9:"mapValue"in t?Gg(t)?4:Xj(t)?9007199254740991:Yj(t)?10:11:Pe(28295,{value:t})}function xi(t,e){if(t===e)return!0;const n=Js(t);if(n!==Js(e))return!1;switch(n){case 0:case 9007199254740991:return!0;case 1:return t.booleanValue===e.booleanValue;case 4:return Jc(t).isEqual(Jc(e));case 3:return(function(a,l){if(typeof a.timestampValue=="string"&&typeof l.timestampValue=="string"&&a.timestampValue.length===l.timestampValue.length)return a.timestampValue===l.timestampValue;const u=Ys(a.timestampValue),h=Ys(l.timestampValue);return u.seconds===h.seconds&&u.nanos===h.nanos})(t,e);case 5:return t.stringValue===e.stringValue;case 6:return(function(a,l){return Xs(a.bytesValue).isEqual(Xs(l.bytesValue))})(t,e);case 7:return t.referenceValue===e.referenceValue;case 8:return(function(a,l){return Bt(a.geoPointValue.latitude)===Bt(l.geoPointValue.latitude)&&Bt(a.geoPointValue.longitude)===Bt(l.geoPointValue.longitude)})(t,e);case 2:return(function(a,l){if("integerValue"in a&&"integerValue"in l)return Bt(a.integerValue)===Bt(l.integerValue);if("doubleValue"in a&&"doubleValue"in l){const u=Bt(a.doubleValue),h=Bt(l.doubleValue);return u===h?wh(u)===wh(h):isNaN(u)&&isNaN(h)}return!1})(t,e);case 9:return rl(t.arrayValue.values||[],e.arrayValue.values||[],xi);case 10:case 11:return(function(a,l){const u=a.mapValue.fields||{},h=l.mapValue.fields||{};if(sx(u)!==sx(h))return!1;for(const m in u)if(u.hasOwnProperty(m)&&(h[m]===void 0||!xi(u[m],h[m])))return!1;return!0})(t,e);default:return Pe(52216,{left:t})}}function eu(t,e){return(t.values||[]).find((n=>xi(n,e)))!==void 0}function il(t,e){if(t===e)return 0;const n=Js(t),i=Js(e);if(n!==i)return Ze(n,i);switch(n){case 0:case 9007199254740991:return 0;case 1:return Ze(t.booleanValue,e.booleanValue);case 2:return(function(l,u){const h=Bt(l.integerValue||l.doubleValue),m=Bt(u.integerValue||u.doubleValue);return h<m?-1:h>m?1:h===m?0:isNaN(h)?isNaN(m)?0:-1:1})(t,e);case 3:return ox(t.timestampValue,e.timestampValue);case 4:return ox(Jc(t),Jc(e));case 5:return tg(t.stringValue,e.stringValue);case 6:return(function(l,u){const h=Xs(l),m=Xs(u);return h.compareTo(m)})(t.bytesValue,e.bytesValue);case 7:return(function(l,u){const h=l.split("/"),m=u.split("/");for(let g=0;g<h.length&&g<m.length;g++){const _=Ze(h[g],m[g]);if(_!==0)return _}return Ze(h.length,m.length)})(t.referenceValue,e.referenceValue);case 8:return(function(l,u){const h=Ze(Bt(l.latitude),Bt(u.latitude));return h!==0?h:Ze(Bt(l.longitude),Bt(u.longitude))})(t.geoPointValue,e.geoPointValue);case 9:return lx(t.arrayValue,e.arrayValue);case 10:return(function(l,u){const h=l.fields||{},m=u.fields||{},g=h[Ah]?.arrayValue,_=m[Ah]?.arrayValue,v=Ze(g?.values?.length||0,_?.values?.length||0);return v!==0?v:lx(g,_)})(t.mapValue,e.mapValue);case 11:return(function(l,u){if(l===th.mapValue&&u===th.mapValue)return 0;if(l===th.mapValue)return 1;if(u===th.mapValue)return-1;const h=l.fields||{},m=Object.keys(h),g=u.fields||{},_=Object.keys(g);m.sort(),_.sort();for(let v=0;v<m.length&&v<_.length;++v){const b=tg(m[v],_[v]);if(b!==0)return b;const w=il(h[m[v]],g[_[v]]);if(w!==0)return w}return Ze(m.length,_.length)})(t.mapValue,e.mapValue);default:throw Pe(23264,{he:n})}}function ox(t,e){if(typeof t=="string"&&typeof e=="string"&&t.length===e.length)return Ze(t,e);const n=Ys(t),i=Ys(e),a=Ze(n.seconds,i.seconds);return a!==0?a:Ze(n.nanos,i.nanos)}function lx(t,e){const n=t.values||[],i=e.values||[];for(let a=0;a<n.length&&a<i.length;++a){const l=il(n[a],i[a]);if(l)return l}return Ze(n.length,i.length)}function sl(t){return ng(t)}function ng(t){return"nullValue"in t?"null":"booleanValue"in t?""+t.booleanValue:"integerValue"in t?""+t.integerValue:"doubleValue"in t?""+t.doubleValue:"timestampValue"in t?(function(n){const i=Ys(n);return`time(${i.seconds},${i.nanos})`})(t.timestampValue):"stringValue"in t?t.stringValue:"bytesValue"in t?(function(n){return Xs(n).toBase64()})(t.bytesValue):"referenceValue"in t?(function(n){return je.fromName(n).toString()})(t.referenceValue):"geoPointValue"in t?(function(n){return`geo(${n.latitude},${n.longitude})`})(t.geoPointValue):"arrayValue"in t?(function(n){let i="[",a=!0;for(const l of n.values||[])a?a=!1:i+=",",i+=ng(l);return i+"]"})(t.arrayValue):"mapValue"in t?(function(n){const i=Object.keys(n.fields||{}).sort();let a="{",l=!0;for(const u of i)l?l=!1:a+=",",a+=`${u}:${ng(n.fields[u])}`;return a+"}"})(t.mapValue):Pe(61005,{value:t})}function lh(t){switch(Js(t)){case 0:case 1:return 4;case 2:return 8;case 3:case 8:return 16;case 4:const e=Jh(t);return e?16+lh(e):16;case 5:return 2*t.stringValue.length;case 6:return Xs(t.bytesValue).approximateByteSize();case 7:return t.referenceValue.length;case 9:return(function(i){return(i.values||[]).reduce(((a,l)=>a+lh(l)),0)})(t.arrayValue);case 10:case 11:return(function(i){let a=0;return na(i.fields,((l,u)=>{a+=l.length+lh(u)})),a})(t.mapValue);default:throw Pe(13486,{value:t})}}function cx(t,e){return{referenceValue:`projects/${t.projectId}/databases/${t.database}/documents/${e.path.canonicalString()}`}}function rg(t){return!!t&&"integerValue"in t}function Hg(t){return!!t&&"arrayValue"in t}function ux(t){return!!t&&"nullValue"in t}function dx(t){return!!t&&"doubleValue"in t&&isNaN(Number(t.doubleValue))}function ch(t){return!!t&&"mapValue"in t}function Yj(t){return(t?.mapValue?.fields||{})[ZS]?.stringValue===ew}function qc(t){if(t.geoPointValue)return{geoPointValue:{...t.geoPointValue}};if(t.timestampValue&&typeof t.timestampValue=="object")return{timestampValue:{...t.timestampValue}};if(t.mapValue){const e={mapValue:{fields:{}}};return na(t.mapValue.fields,((n,i)=>e.mapValue.fields[n]=qc(i))),e}if(t.arrayValue){const e={arrayValue:{values:[]}};for(let n=0;n<(t.arrayValue.values||[]).length;++n)e.arrayValue.values[n]=qc(t.arrayValue.values[n]);return e}return{...t}}function Xj(t){return(((t.mapValue||{}).fields||{}).__type__||{}).stringValue===Wj}class qn{constructor(e){this.value=e}static empty(){return new qn({mapValue:{}})}field(e){if(e.isEmpty())return this.value;{let n=this.value;for(let i=0;i<e.length-1;++i)if(n=(n.mapValue.fields||{})[e.get(i)],!ch(n))return null;return n=(n.mapValue.fields||{})[e.lastSegment()],n||null}}set(e,n){this.getFieldsMap(e.popLast())[e.lastSegment()]=qc(n)}setAll(e){let n=Sn.emptyPath(),i={},a=[];e.forEach(((u,h)=>{if(!n.isImmediateParentOf(h)){const m=this.getFieldsMap(n);this.applyChanges(m,i,a),i={},a=[],n=h.popLast()}u?i[h.lastSegment()]=qc(u):a.push(h.lastSegment())}));const l=this.getFieldsMap(n);this.applyChanges(l,i,a)}delete(e){const n=this.field(e.popLast());ch(n)&&n.mapValue.fields&&delete n.mapValue.fields[e.lastSegment()]}isEqual(e){return xi(this.value,e.value)}getFieldsMap(e){let n=this.value;n.mapValue.fields||(n.mapValue={fields:{}});for(let i=0;i<e.length;++i){let a=n.mapValue.fields[e.get(i)];ch(a)&&a.mapValue.fields||(a={mapValue:{fields:{}}},n.mapValue.fields[e.get(i)]=a),n=a}return n.mapValue.fields}applyChanges(e,n,i){na(n,((a,l)=>e[a]=l));for(const a of i)delete e[a]}clone(){return new qn(qc(this.value))}}function tw(t){const e=[];return na(t.fields,((n,i)=>{const a=new Sn([n]);if(ch(i)){const l=tw(i.mapValue).fields;if(l.length===0)e.push(a);else for(const u of l)e.push(a.child(u))}else e.push(a)})),new tr(e)}class Dn{constructor(e,n,i,a,l,u,h){this.key=e,this.documentType=n,this.version=i,this.readTime=a,this.createTime=l,this.data=u,this.documentState=h}static newInvalidDocument(e){return new Dn(e,0,Ue.min(),Ue.min(),Ue.min(),qn.empty(),0)}static newFoundDocument(e,n,i,a){return new Dn(e,1,n,Ue.min(),i,a,0)}static newNoDocument(e,n){return new Dn(e,2,n,Ue.min(),Ue.min(),qn.empty(),0)}static newUnknownDocument(e,n){return new Dn(e,3,n,Ue.min(),Ue.min(),qn.empty(),2)}convertToFoundDocument(e,n){return!this.createTime.isEqual(Ue.min())||this.documentType!==2&&this.documentType!==0||(this.createTime=e),this.version=e,this.documentType=1,this.data=n,this.documentState=0,this}convertToNoDocument(e){return this.version=e,this.documentType=2,this.data=qn.empty(),this.documentState=0,this}convertToUnknownDocument(e){return this.version=e,this.documentType=3,this.data=qn.empty(),this.documentState=2,this}setHasCommittedMutations(){return this.documentState=2,this}setHasLocalMutations(){return this.documentState=1,this.version=Ue.min(),this}setReadTime(e){return this.readTime=e,this}get hasLocalMutations(){return this.documentState===1}get hasCommittedMutations(){return this.documentState===2}get hasPendingWrites(){return this.hasLocalMutations||this.hasCommittedMutations}isValidDocument(){return this.documentType!==0}isFoundDocument(){return this.documentType===1}isNoDocument(){return this.documentType===2}isUnknownDocument(){return this.documentType===3}isEqual(e){return e instanceof Dn&&this.key.isEqual(e.key)&&this.version.isEqual(e.version)&&this.documentType===e.documentType&&this.documentState===e.documentState&&this.data.isEqual(e.data)}mutableCopy(){return new Dn(this.key,this.documentType,this.version,this.readTime,this.createTime,this.data.clone(),this.documentState)}toString(){return`Document(${this.key}, ${this.version}, ${JSON.stringify(this.data.value)}, {createTime: ${this.createTime}}), {documentType: ${this.documentType}}), {documentState: ${this.documentState}})`}}class Ch{constructor(e,n){this.position=e,this.inclusive=n}}function hx(t,e,n){let i=0;for(let a=0;a<t.position.length;a++){const l=e[a],u=t.position[a];if(l.field.isKeyField()?i=je.comparator(je.fromName(u.referenceValue),n.key):i=il(u,n.data.field(l.field)),l.dir==="desc"&&(i*=-1),i!==0)break}return i}function fx(t,e){if(t===null)return e===null;if(e===null||t.inclusive!==e.inclusive||t.position.length!==e.position.length)return!1;for(let n=0;n<t.position.length;n++)if(!xi(t.position[n],e.position[n]))return!1;return!0}class Rh{constructor(e,n="asc"){this.field=e,this.dir=n}}function Jj(t,e){return t.dir===e.dir&&t.field.isEqual(e.field)}class nw{}class tn extends nw{constructor(e,n,i){super(),this.field=e,this.op=n,this.value=i}static create(e,n,i){return e.isKeyField()?n==="in"||n==="not-in"?this.createKeyFieldInFilter(e,n,i):new e2(e,n,i):n==="array-contains"?new r2(e,i):n==="in"?new i2(e,i):n==="not-in"?new s2(e,i):n==="array-contains-any"?new a2(e,i):new tn(e,n,i)}static createKeyFieldInFilter(e,n,i){return n==="in"?new t2(e,i):new n2(e,i)}matches(e){const n=e.data.field(this.field);return this.op==="!="?n!==null&&n.nullValue===void 0&&this.matchesComparison(il(n,this.value)):n!==null&&Js(this.value)===Js(n)&&this.matchesComparison(il(n,this.value))}matchesComparison(e){switch(this.op){case"<":return e<0;case"<=":return e<=0;case"==":return e===0;case"!=":return e!==0;case">":return e>0;case">=":return e>=0;default:return Pe(47266,{operator:this.op})}}isInequality(){return["<","<=",">",">=","!=","not-in"].indexOf(this.op)>=0}getFlattenedFilters(){return[this]}getFilters(){return[this]}}class Br extends nw{constructor(e,n){super(),this.filters=e,this.op=n,this.Pe=null}static create(e,n){return new Br(e,n)}matches(e){return rw(this)?this.filters.find((n=>!n.matches(e)))===void 0:this.filters.find((n=>n.matches(e)))!==void 0}getFlattenedFilters(){return this.Pe!==null||(this.Pe=this.filters.reduce(((e,n)=>e.concat(n.getFlattenedFilters())),[])),this.Pe}getFilters(){return Object.assign([],this.filters)}}function rw(t){return t.op==="and"}function iw(t){return Zj(t)&&rw(t)}function Zj(t){for(const e of t.filters)if(e instanceof Br)return!1;return!0}function ig(t){if(t instanceof tn)return t.field.canonicalString()+t.op.toString()+sl(t.value);if(iw(t))return t.filters.map((e=>ig(e))).join(",");{const e=t.filters.map((n=>ig(n))).join(",");return`${t.op}(${e})`}}function sw(t,e){return t instanceof tn?(function(i,a){return a instanceof tn&&i.op===a.op&&i.field.isEqual(a.field)&&xi(i.value,a.value)})(t,e):t instanceof Br?(function(i,a){return a instanceof Br&&i.op===a.op&&i.filters.length===a.filters.length?i.filters.reduce(((l,u,h)=>l&&sw(u,a.filters[h])),!0):!1})(t,e):void Pe(19439)}function aw(t){return t instanceof tn?(function(n){return`${n.field.canonicalString()} ${n.op} ${sl(n.value)}`})(t):t instanceof Br?(function(n){return n.op.toString()+" {"+n.getFilters().map(aw).join(" ,")+"}"})(t):"Filter"}class e2 extends tn{constructor(e,n,i){super(e,n,i),this.key=je.fromName(i.referenceValue)}matches(e){const n=je.comparator(e.key,this.key);return this.matchesComparison(n)}}class t2 extends tn{constructor(e,n){super(e,"in",n),this.keys=ow("in",n)}matches(e){return this.keys.some((n=>n.isEqual(e.key)))}}class n2 extends tn{constructor(e,n){super(e,"not-in",n),this.keys=ow("not-in",n)}matches(e){return!this.keys.some((n=>n.isEqual(e.key)))}}function ow(t,e){return(e.arrayValue?.values||[]).map((n=>je.fromName(n.referenceValue)))}class r2 extends tn{constructor(e,n){super(e,"array-contains",n)}matches(e){const n=e.data.field(this.field);return Hg(n)&&eu(n.arrayValue,this.value)}}class i2 extends tn{constructor(e,n){super(e,"in",n)}matches(e){const n=e.data.field(this.field);return n!==null&&eu(this.value.arrayValue,n)}}class s2 extends tn{constructor(e,n){super(e,"not-in",n)}matches(e){if(eu(this.value.arrayValue,{nullValue:"NULL_VALUE"}))return!1;const n=e.data.field(this.field);return n!==null&&n.nullValue===void 0&&!eu(this.value.arrayValue,n)}}class a2 extends tn{constructor(e,n){super(e,"array-contains-any",n)}matches(e){const n=e.data.field(this.field);return!(!Hg(n)||!n.arrayValue.values)&&n.arrayValue.values.some((i=>eu(this.value.arrayValue,i)))}}class o2{constructor(e,n=null,i=[],a=[],l=null,u=null,h=null){this.path=e,this.collectionGroup=n,this.orderBy=i,this.filters=a,this.limit=l,this.startAt=u,this.endAt=h,this.Te=null}}function mx(t,e=null,n=[],i=[],a=null,l=null,u=null){return new o2(t,e,n,i,a,l,u)}function Qg(t){const e=Fe(t);if(e.Te===null){let n=e.path.canonicalString();e.collectionGroup!==null&&(n+="|cg:"+e.collectionGroup),n+="|f:",n+=e.filters.map((i=>ig(i))).join(","),n+="|ob:",n+=e.orderBy.map((i=>(function(l){return l.field.canonicalString()+l.dir})(i))).join(","),Xh(e.limit)||(n+="|l:",n+=e.limit),e.startAt&&(n+="|lb:",n+=e.startAt.inclusive?"b:":"a:",n+=e.startAt.position.map((i=>sl(i))).join(",")),e.endAt&&(n+="|ub:",n+=e.endAt.inclusive?"a:":"b:",n+=e.endAt.position.map((i=>sl(i))).join(",")),e.Te=n}return e.Te}function $g(t,e){if(t.limit!==e.limit||t.orderBy.length!==e.orderBy.length)return!1;for(let n=0;n<t.orderBy.length;n++)if(!Jj(t.orderBy[n],e.orderBy[n]))return!1;if(t.filters.length!==e.filters.length)return!1;for(let n=0;n<t.filters.length;n++)if(!sw(t.filters[n],e.filters[n]))return!1;return t.collectionGroup===e.collectionGroup&&!!t.path.isEqual(e.path)&&!!fx(t.startAt,e.startAt)&&fx(t.endAt,e.endAt)}function sg(t){return je.isDocumentKey(t.path)&&t.collectionGroup===null&&t.filters.length===0}class fu{constructor(e,n=null,i=[],a=[],l=null,u="F",h=null,m=null){this.path=e,this.collectionGroup=n,this.explicitOrderBy=i,this.filters=a,this.limit=l,this.limitType=u,this.startAt=h,this.endAt=m,this.Ie=null,this.Ee=null,this.de=null,this.startAt,this.endAt}}function l2(t,e,n,i,a,l,u,h){return new fu(t,e,n,i,a,l,u,h)}function Kg(t){return new fu(t)}function px(t){return t.filters.length===0&&t.limit===null&&t.startAt==null&&t.endAt==null&&(t.explicitOrderBy.length===0||t.explicitOrderBy.length===1&&t.explicitOrderBy[0].field.isKeyField())}function lw(t){return t.collectionGroup!==null}function Gc(t){const e=Fe(t);if(e.Ie===null){e.Ie=[];const n=new Set;for(const l of e.explicitOrderBy)e.Ie.push(l),n.add(l.field.canonicalString());const i=e.explicitOrderBy.length>0?e.explicitOrderBy[e.explicitOrderBy.length-1].dir:"asc";(function(u){let h=new on(Sn.comparator);return u.filters.forEach((m=>{m.getFlattenedFilters().forEach((g=>{g.isInequality()&&(h=h.add(g.field))}))})),h})(e).forEach((l=>{n.has(l.canonicalString())||l.isKeyField()||e.Ie.push(new Rh(l,i))})),n.has(Sn.keyField().canonicalString())||e.Ie.push(new Rh(Sn.keyField(),i))}return e.Ie}function hi(t){const e=Fe(t);return e.Ee||(e.Ee=c2(e,Gc(t))),e.Ee}function c2(t,e){if(t.limitType==="F")return mx(t.path,t.collectionGroup,e,t.filters,t.limit,t.startAt,t.endAt);{e=e.map((a=>{const l=a.dir==="desc"?"asc":"desc";return new Rh(a.field,l)}));const n=t.endAt?new Ch(t.endAt.position,t.endAt.inclusive):null,i=t.startAt?new Ch(t.startAt.position,t.startAt.inclusive):null;return mx(t.path,t.collectionGroup,e,t.filters,t.limit,n,i)}}function ag(t,e){const n=t.filters.concat([e]);return new fu(t.path,t.collectionGroup,t.explicitOrderBy.slice(),n,t.limit,t.limitType,t.startAt,t.endAt)}function og(t,e,n){return new fu(t.path,t.collectionGroup,t.explicitOrderBy.slice(),t.filters.slice(),e,n,t.startAt,t.endAt)}function Zh(t,e){return $g(hi(t),hi(e))&&t.limitType===e.limitType}function cw(t){return`${Qg(hi(t))}|lt:${t.limitType}`}function Go(t){return`Query(target=${(function(n){let i=n.path.canonicalString();return n.collectionGroup!==null&&(i+=" collectionGroup="+n.collectionGroup),n.filters.length>0&&(i+=`, filters: [${n.filters.map((a=>aw(a))).join(", ")}]`),Xh(n.limit)||(i+=", limit: "+n.limit),n.orderBy.length>0&&(i+=`, orderBy: [${n.orderBy.map((a=>(function(u){return`${u.field.canonicalString()} (${u.dir})`})(a))).join(", ")}]`),n.startAt&&(i+=", startAt: ",i+=n.startAt.inclusive?"b:":"a:",i+=n.startAt.position.map((a=>sl(a))).join(",")),n.endAt&&(i+=", endAt: ",i+=n.endAt.inclusive?"a:":"b:",i+=n.endAt.position.map((a=>sl(a))).join(",")),`Target(${i})`})(hi(t))}; limitType=${t.limitType})`}function ef(t,e){return e.isFoundDocument()&&(function(i,a){const l=a.key.path;return i.collectionGroup!==null?a.key.hasCollectionId(i.collectionGroup)&&i.path.isPrefixOf(l):je.isDocumentKey(i.path)?i.path.isEqual(l):i.path.isImmediateParentOf(l)})(t,e)&&(function(i,a){for(const l of Gc(i))if(!l.field.isKeyField()&&a.data.field(l.field)===null)return!1;return!0})(t,e)&&(function(i,a){for(const l of i.filters)if(!l.matches(a))return!1;return!0})(t,e)&&(function(i,a){return!(i.startAt&&!(function(u,h,m){const g=hx(u,h,m);return u.inclusive?g<=0:g<0})(i.startAt,Gc(i),a)||i.endAt&&!(function(u,h,m){const g=hx(u,h,m);return u.inclusive?g>=0:g>0})(i.endAt,Gc(i),a))})(t,e)}function u2(t){return t.collectionGroup||(t.path.length%2==1?t.path.lastSegment():t.path.get(t.path.length-2))}function uw(t){return(e,n)=>{let i=!1;for(const a of Gc(t)){const l=d2(a,e,n);if(l!==0)return l;i=i||a.field.isKeyField()}return 0}}function d2(t,e,n){const i=t.field.isKeyField()?je.comparator(e.key,n.key):(function(l,u,h){const m=u.data.field(l),g=h.data.field(l);return m!==null&&g!==null?il(m,g):Pe(42886)})(t.field,e,n);switch(t.dir){case"asc":return i;case"desc":return-1*i;default:return Pe(19790,{direction:t.dir})}}class Ha{constructor(e,n){this.mapKeyFn=e,this.equalsFn=n,this.inner={},this.innerSize=0}get(e){const n=this.mapKeyFn(e),i=this.inner[n];if(i!==void 0){for(const[a,l]of i)if(this.equalsFn(a,e))return l}}has(e){return this.get(e)!==void 0}set(e,n){const i=this.mapKeyFn(e),a=this.inner[i];if(a===void 0)return this.inner[i]=[[e,n]],void this.innerSize++;for(let l=0;l<a.length;l++)if(this.equalsFn(a[l][0],e))return void(a[l]=[e,n]);a.push([e,n]),this.innerSize++}delete(e){const n=this.mapKeyFn(e),i=this.inner[n];if(i===void 0)return!1;for(let a=0;a<i.length;a++)if(this.equalsFn(i[a][0],e))return i.length===1?delete this.inner[n]:i.splice(a,1),this.innerSize--,!0;return!1}forEach(e){na(this.inner,((n,i)=>{for(const[a,l]of i)e(a,l)}))}isEmpty(){return $S(this.inner)}size(){return this.innerSize}}const h2=new It(je.comparator);function Wi(){return h2}const dw=new It(je.comparator);function zc(...t){let e=dw;for(const n of t)e=e.insert(n.key,n);return e}function hw(t){let e=dw;return t.forEach(((n,i)=>e=e.insert(n,i.overlayedDocument))),e}function ka(){return Hc()}function fw(){return Hc()}function Hc(){return new Ha((t=>t.toString()),((t,e)=>t.isEqual(e)))}const f2=new It(je.comparator),m2=new on(je.comparator);function et(...t){let e=m2;for(const n of t)e=e.add(n);return e}const p2=new on(Ze);function g2(){return p2}function Wg(t,e){if(t.useProto3Json){if(isNaN(e))return{doubleValue:"NaN"};if(e===1/0)return{doubleValue:"Infinity"};if(e===-1/0)return{doubleValue:"-Infinity"}}return{doubleValue:wh(e)?"-0":e}}function mw(t){return{integerValue:""+t}}function y2(t,e){return Gj(e)?mw(e):Wg(t,e)}class tf{constructor(){this._=void 0}}function _2(t,e,n){return t instanceof Dh?(function(a,l){const u={fields:{[YS]:{stringValue:WS},[JS]:{timestampValue:{seconds:a.seconds,nanos:a.nanoseconds}}}};return l&&Gg(l)&&(l=Jh(l)),l&&(u.fields[XS]=l),{mapValue:u}})(n,e):t instanceof al?gw(t,e):t instanceof tu?yw(t,e):(function(a,l){const u=pw(a,l),h=gx(u)+gx(a.Ae);return rg(u)&&rg(a.Ae)?mw(h):Wg(a.serializer,h)})(t,e)}function v2(t,e,n){return t instanceof al?gw(t,e):t instanceof tu?yw(t,e):n}function pw(t,e){return t instanceof Ih?(function(i){return rg(i)||(function(l){return!!l&&"doubleValue"in l})(i)})(e)?e:{integerValue:0}:null}class Dh extends tf{}class al extends tf{constructor(e){super(),this.elements=e}}function gw(t,e){const n=_w(e);for(const i of t.elements)n.some((a=>xi(a,i)))||n.push(i);return{arrayValue:{values:n}}}class tu extends tf{constructor(e){super(),this.elements=e}}function yw(t,e){let n=_w(e);for(const i of t.elements)n=n.filter((a=>!xi(a,i)));return{arrayValue:{values:n}}}class Ih extends tf{constructor(e,n){super(),this.serializer=e,this.Ae=n}}function gx(t){return Bt(t.integerValue||t.doubleValue)}function _w(t){return Hg(t)&&t.arrayValue.values?t.arrayValue.values.slice():[]}class b2{constructor(e,n){this.field=e,this.transform=n}}function x2(t,e){return t.field.isEqual(e.field)&&(function(i,a){return i instanceof al&&a instanceof al||i instanceof tu&&a instanceof tu?rl(i.elements,a.elements,xi):i instanceof Ih&&a instanceof Ih?xi(i.Ae,a.Ae):i instanceof Dh&&a instanceof Dh})(t.transform,e.transform)}class E2{constructor(e,n){this.version=e,this.transformResults=n}}class Ur{constructor(e,n){this.updateTime=e,this.exists=n}static none(){return new Ur}static exists(e){return new Ur(void 0,e)}static updateTime(e){return new Ur(e)}get isNone(){return this.updateTime===void 0&&this.exists===void 0}isEqual(e){return this.exists===e.exists&&(this.updateTime?!!e.updateTime&&this.updateTime.isEqual(e.updateTime):!e.updateTime)}}function uh(t,e){return t.updateTime!==void 0?e.isFoundDocument()&&e.version.isEqual(t.updateTime):t.exists===void 0||t.exists===e.isFoundDocument()}class nf{}function vw(t,e){if(!t.hasLocalMutations||e&&e.fields.length===0)return null;if(e===null)return t.isNoDocument()?new Yg(t.key,Ur.none()):new mu(t.key,t.data,Ur.none());{const n=t.data,i=qn.empty();let a=new on(Sn.comparator);for(let l of e.fields)if(!a.has(l)){let u=n.field(l);u===null&&l.length>1&&(l=l.popLast(),u=n.field(l)),u===null?i.delete(l):i.set(l,u),a=a.add(l)}return new ra(t.key,i,new tr(a.toArray()),Ur.none())}}function S2(t,e,n){t instanceof mu?(function(a,l,u){const h=a.value.clone(),m=_x(a.fieldTransforms,l,u.transformResults);h.setAll(m),l.convertToFoundDocument(u.version,h).setHasCommittedMutations()})(t,e,n):t instanceof ra?(function(a,l,u){if(!uh(a.precondition,l))return void l.convertToUnknownDocument(u.version);const h=_x(a.fieldTransforms,l,u.transformResults),m=l.data;m.setAll(bw(a)),m.setAll(h),l.convertToFoundDocument(u.version,m).setHasCommittedMutations()})(t,e,n):(function(a,l,u){l.convertToNoDocument(u.version).setHasCommittedMutations()})(0,e,n)}function Qc(t,e,n,i){return t instanceof mu?(function(l,u,h,m){if(!uh(l.precondition,u))return h;const g=l.value.clone(),_=vx(l.fieldTransforms,m,u);return g.setAll(_),u.convertToFoundDocument(u.version,g).setHasLocalMutations(),null})(t,e,n,i):t instanceof ra?(function(l,u,h,m){if(!uh(l.precondition,u))return h;const g=vx(l.fieldTransforms,m,u),_=u.data;return _.setAll(bw(l)),_.setAll(g),u.convertToFoundDocument(u.version,_).setHasLocalMutations(),h===null?null:h.unionWith(l.fieldMask.fields).unionWith(l.fieldTransforms.map((v=>v.field)))})(t,e,n,i):(function(l,u,h){return uh(l.precondition,u)?(u.convertToNoDocument(u.version).setHasLocalMutations(),null):h})(t,e,n)}function w2(t,e){let n=null;for(const i of t.fieldTransforms){const a=e.data.field(i.field),l=pw(i.transform,a||null);l!=null&&(n===null&&(n=qn.empty()),n.set(i.field,l))}return n||null}function yx(t,e){return t.type===e.type&&!!t.key.isEqual(e.key)&&!!t.precondition.isEqual(e.precondition)&&!!(function(i,a){return i===void 0&&a===void 0||!(!i||!a)&&rl(i,a,((l,u)=>x2(l,u)))})(t.fieldTransforms,e.fieldTransforms)&&(t.type===0?t.value.isEqual(e.value):t.type!==1||t.data.isEqual(e.data)&&t.fieldMask.isEqual(e.fieldMask))}class mu extends nf{constructor(e,n,i,a=[]){super(),this.key=e,this.value=n,this.precondition=i,this.fieldTransforms=a,this.type=0}getFieldMask(){return null}}class ra extends nf{constructor(e,n,i,a,l=[]){super(),this.key=e,this.data=n,this.fieldMask=i,this.precondition=a,this.fieldTransforms=l,this.type=1}getFieldMask(){return this.fieldMask}}function bw(t){const e=new Map;return t.fieldMask.fields.forEach((n=>{if(!n.isEmpty()){const i=t.data.field(n);e.set(n,i)}})),e}function _x(t,e,n){const i=new Map;ct(t.length===n.length,32656,{Re:n.length,Ve:t.length});for(let a=0;a<n.length;a++){const l=t[a],u=l.transform,h=e.data.field(l.field);i.set(l.field,v2(u,h,n[a]))}return i}function vx(t,e,n){const i=new Map;for(const a of t){const l=a.transform,u=n.data.field(a.field);i.set(a.field,_2(l,u,e))}return i}class Yg extends nf{constructor(e,n){super(),this.key=e,this.precondition=n,this.type=2,this.fieldTransforms=[]}getFieldMask(){return null}}class T2 extends nf{constructor(e,n){super(),this.key=e,this.precondition=n,this.type=3,this.fieldTransforms=[]}getFieldMask(){return null}}class A2{constructor(e,n,i,a){this.batchId=e,this.localWriteTime=n,this.baseMutations=i,this.mutations=a}applyToRemoteDocument(e,n){const i=n.mutationResults;for(let a=0;a<this.mutations.length;a++){const l=this.mutations[a];l.key.isEqual(e.key)&&S2(l,e,i[a])}}applyToLocalView(e,n){for(const i of this.baseMutations)i.key.isEqual(e.key)&&(n=Qc(i,e,n,this.localWriteTime));for(const i of this.mutations)i.key.isEqual(e.key)&&(n=Qc(i,e,n,this.localWriteTime));return n}applyToLocalDocumentSet(e,n){const i=fw();return this.mutations.forEach((a=>{const l=e.get(a.key),u=l.overlayedDocument;let h=this.applyToLocalView(u,l.mutatedFields);h=n.has(a.key)?null:h;const m=vw(u,h);m!==null&&i.set(a.key,m),u.isValidDocument()||u.convertToNoDocument(Ue.min())})),i}keys(){return this.mutations.reduce(((e,n)=>e.add(n.key)),et())}isEqual(e){return this.batchId===e.batchId&&rl(this.mutations,e.mutations,((n,i)=>yx(n,i)))&&rl(this.baseMutations,e.baseMutations,((n,i)=>yx(n,i)))}}class Xg{constructor(e,n,i,a){this.batch=e,this.commitVersion=n,this.mutationResults=i,this.docVersions=a}static from(e,n,i){ct(e.mutations.length===i.length,58842,{me:e.mutations.length,fe:i.length});let a=(function(){return f2})();const l=e.mutations;for(let u=0;u<l.length;u++)a=a.insert(l[u].key,i[u].version);return new Xg(e,n,i,a)}}class C2{constructor(e,n){this.largestBatchId=e,this.mutation=n}getKey(){return this.mutation.key}isEqual(e){return e!==null&&this.mutation===e.mutation}toString(){return`Overlay{
      largestBatchId: ${this.largestBatchId},
      mutation: ${this.mutation.toString()}
    }`}}class R2{constructor(e,n){this.count=e,this.unchangedNames=n}}var Zt,nt;function D2(t){switch(t){case ve.OK:return Pe(64938);case ve.CANCELLED:case ve.UNKNOWN:case ve.DEADLINE_EXCEEDED:case ve.RESOURCE_EXHAUSTED:case ve.INTERNAL:case ve.UNAVAILABLE:case ve.UNAUTHENTICATED:return!1;case ve.INVALID_ARGUMENT:case ve.NOT_FOUND:case ve.ALREADY_EXISTS:case ve.PERMISSION_DENIED:case ve.FAILED_PRECONDITION:case ve.ABORTED:case ve.OUT_OF_RANGE:case ve.UNIMPLEMENTED:case ve.DATA_LOSS:return!0;default:return Pe(15467,{code:t})}}function xw(t){if(t===void 0)return Ki("GRPC error has no .code"),ve.UNKNOWN;switch(t){case Zt.OK:return ve.OK;case Zt.CANCELLED:return ve.CANCELLED;case Zt.UNKNOWN:return ve.UNKNOWN;case Zt.DEADLINE_EXCEEDED:return ve.DEADLINE_EXCEEDED;case Zt.RESOURCE_EXHAUSTED:return ve.RESOURCE_EXHAUSTED;case Zt.INTERNAL:return ve.INTERNAL;case Zt.UNAVAILABLE:return ve.UNAVAILABLE;case Zt.UNAUTHENTICATED:return ve.UNAUTHENTICATED;case Zt.INVALID_ARGUMENT:return ve.INVALID_ARGUMENT;case Zt.NOT_FOUND:return ve.NOT_FOUND;case Zt.ALREADY_EXISTS:return ve.ALREADY_EXISTS;case Zt.PERMISSION_DENIED:return ve.PERMISSION_DENIED;case Zt.FAILED_PRECONDITION:return ve.FAILED_PRECONDITION;case Zt.ABORTED:return ve.ABORTED;case Zt.OUT_OF_RANGE:return ve.OUT_OF_RANGE;case Zt.UNIMPLEMENTED:return ve.UNIMPLEMENTED;case Zt.DATA_LOSS:return ve.DATA_LOSS;default:return Pe(39323,{code:t})}}(nt=Zt||(Zt={}))[nt.OK=0]="OK",nt[nt.CANCELLED=1]="CANCELLED",nt[nt.UNKNOWN=2]="UNKNOWN",nt[nt.INVALID_ARGUMENT=3]="INVALID_ARGUMENT",nt[nt.DEADLINE_EXCEEDED=4]="DEADLINE_EXCEEDED",nt[nt.NOT_FOUND=5]="NOT_FOUND",nt[nt.ALREADY_EXISTS=6]="ALREADY_EXISTS",nt[nt.PERMISSION_DENIED=7]="PERMISSION_DENIED",nt[nt.UNAUTHENTICATED=16]="UNAUTHENTICATED",nt[nt.RESOURCE_EXHAUSTED=8]="RESOURCE_EXHAUSTED",nt[nt.FAILED_PRECONDITION=9]="FAILED_PRECONDITION",nt[nt.ABORTED=10]="ABORTED",nt[nt.OUT_OF_RANGE=11]="OUT_OF_RANGE",nt[nt.UNIMPLEMENTED=12]="UNIMPLEMENTED",nt[nt.INTERNAL=13]="INTERNAL",nt[nt.UNAVAILABLE=14]="UNAVAILABLE",nt[nt.DATA_LOSS=15]="DATA_LOSS";function I2(){return new TextEncoder}const j2=new Hs([4294967295,4294967295],0);function bx(t){const e=I2().encode(t),n=new PS;return n.update(e),new Uint8Array(n.digest())}function xx(t){const e=new DataView(t.buffer),n=e.getUint32(0,!0),i=e.getUint32(4,!0),a=e.getUint32(8,!0),l=e.getUint32(12,!0);return[new Hs([n,i],0),new Hs([a,l],0)]}class Jg{constructor(e,n,i){if(this.bitmap=e,this.padding=n,this.hashCount=i,n<0||n>=8)throw new Uc(`Invalid padding: ${n}`);if(i<0)throw new Uc(`Invalid hash count: ${i}`);if(e.length>0&&this.hashCount===0)throw new Uc(`Invalid hash count: ${i}`);if(e.length===0&&n!==0)throw new Uc(`Invalid padding when bitmap length is 0: ${n}`);this.ge=8*e.length-n,this.pe=Hs.fromNumber(this.ge)}ye(e,n,i){let a=e.add(n.multiply(Hs.fromNumber(i)));return a.compare(j2)===1&&(a=new Hs([a.getBits(0),a.getBits(1)],0)),a.modulo(this.pe).toNumber()}we(e){return!!(this.bitmap[Math.floor(e/8)]&1<<e%8)}mightContain(e){if(this.ge===0)return!1;const n=bx(e),[i,a]=xx(n);for(let l=0;l<this.hashCount;l++){const u=this.ye(i,a,l);if(!this.we(u))return!1}return!0}static create(e,n,i){const a=e%8==0?0:8-e%8,l=new Uint8Array(Math.ceil(e/8)),u=new Jg(l,a,n);return i.forEach((h=>u.insert(h))),u}insert(e){if(this.ge===0)return;const n=bx(e),[i,a]=xx(n);for(let l=0;l<this.hashCount;l++){const u=this.ye(i,a,l);this.Se(u)}}Se(e){const n=Math.floor(e/8),i=e%8;this.bitmap[n]|=1<<i}}class Uc extends Error{constructor(){super(...arguments),this.name="BloomFilterError"}}class rf{constructor(e,n,i,a,l){this.snapshotVersion=e,this.targetChanges=n,this.targetMismatches=i,this.documentUpdates=a,this.resolvedLimboDocuments=l}static createSynthesizedRemoteEventForCurrentChange(e,n,i){const a=new Map;return a.set(e,pu.createSynthesizedTargetChangeForCurrentChange(e,n,i)),new rf(Ue.min(),a,new It(Ze),Wi(),et())}}class pu{constructor(e,n,i,a,l){this.resumeToken=e,this.current=n,this.addedDocuments=i,this.modifiedDocuments=a,this.removedDocuments=l}static createSynthesizedTargetChangeForCurrentChange(e,n,i){return new pu(i,n,et(),et(),et())}}class dh{constructor(e,n,i,a){this.be=e,this.removedTargetIds=n,this.key=i,this.De=a}}class Ew{constructor(e,n){this.targetId=e,this.Ce=n}}class Sw{constructor(e,n,i=wn.EMPTY_BYTE_STRING,a=null){this.state=e,this.targetIds=n,this.resumeToken=i,this.cause=a}}class Ex{constructor(){this.ve=0,this.Fe=Sx(),this.Me=wn.EMPTY_BYTE_STRING,this.xe=!1,this.Oe=!0}get current(){return this.xe}get resumeToken(){return this.Me}get Ne(){return this.ve!==0}get Be(){return this.Oe}Le(e){e.approximateByteSize()>0&&(this.Oe=!0,this.Me=e)}ke(){let e=et(),n=et(),i=et();return this.Fe.forEach(((a,l)=>{switch(l){case 0:e=e.add(a);break;case 2:n=n.add(a);break;case 1:i=i.add(a);break;default:Pe(38017,{changeType:l})}})),new pu(this.Me,this.xe,e,n,i)}qe(){this.Oe=!1,this.Fe=Sx()}Qe(e,n){this.Oe=!0,this.Fe=this.Fe.insert(e,n)}$e(e){this.Oe=!0,this.Fe=this.Fe.remove(e)}Ue(){this.ve+=1}Ke(){this.ve-=1,ct(this.ve>=0,3241,{ve:this.ve})}We(){this.Oe=!0,this.xe=!0}}class O2{constructor(e){this.Ge=e,this.ze=new Map,this.je=Wi(),this.Je=nh(),this.He=nh(),this.Ye=new It(Ze)}Ze(e){for(const n of e.be)e.De&&e.De.isFoundDocument()?this.Xe(n,e.De):this.et(n,e.key,e.De);for(const n of e.removedTargetIds)this.et(n,e.key,e.De)}tt(e){this.forEachTarget(e,(n=>{const i=this.nt(n);switch(e.state){case 0:this.rt(n)&&i.Le(e.resumeToken);break;case 1:i.Ke(),i.Ne||i.qe(),i.Le(e.resumeToken);break;case 2:i.Ke(),i.Ne||this.removeTarget(n);break;case 3:this.rt(n)&&(i.We(),i.Le(e.resumeToken));break;case 4:this.rt(n)&&(this.it(n),i.Le(e.resumeToken));break;default:Pe(56790,{state:e.state})}}))}forEachTarget(e,n){e.targetIds.length>0?e.targetIds.forEach(n):this.ze.forEach(((i,a)=>{this.rt(a)&&n(a)}))}st(e){const n=e.targetId,i=e.Ce.count,a=this.ot(n);if(a){const l=a.target;if(sg(l))if(i===0){const u=new je(l.path);this.et(n,u,Dn.newNoDocument(u,Ue.min()))}else ct(i===1,20013,{expectedCount:i});else{const u=this._t(n);if(u!==i){const h=this.ut(e),m=h?this.ct(h,e,u):1;if(m!==0){this.it(n);const g=m===2?"TargetPurposeExistenceFilterMismatchBloom":"TargetPurposeExistenceFilterMismatch";this.Ye=this.Ye.insert(n,g)}}}}}ut(e){const n=e.Ce.unchangedNames;if(!n||!n.bits)return null;const{bits:{bitmap:i="",padding:a=0},hashCount:l=0}=n;let u,h;try{u=Xs(i).toUint8Array()}catch(m){if(m instanceof KS)return nl("Decoding the base64 bloom filter in existence filter failed ("+m.message+"); ignoring the bloom filter and falling back to full re-query."),null;throw m}try{h=new Jg(u,a,l)}catch(m){return nl(m instanceof Uc?"BloomFilter error: ":"Applying bloom filter failed: ",m),null}return h.ge===0?null:h}ct(e,n,i){return n.Ce.count===i-this.Pt(e,n.targetId)?0:2}Pt(e,n){const i=this.Ge.getRemoteKeysForTarget(n);let a=0;return i.forEach((l=>{const u=this.Ge.ht(),h=`projects/${u.projectId}/databases/${u.database}/documents/${l.path.canonicalString()}`;e.mightContain(h)||(this.et(n,l,null),a++)})),a}Tt(e){const n=new Map;this.ze.forEach(((l,u)=>{const h=this.ot(u);if(h){if(l.current&&sg(h.target)){const m=new je(h.target.path);this.It(m).has(u)||this.Et(u,m)||this.et(u,m,Dn.newNoDocument(m,e))}l.Be&&(n.set(u,l.ke()),l.qe())}}));let i=et();this.He.forEach(((l,u)=>{let h=!0;u.forEachWhile((m=>{const g=this.ot(m);return!g||g.purpose==="TargetPurposeLimboResolution"||(h=!1,!1)})),h&&(i=i.add(l))})),this.je.forEach(((l,u)=>u.setReadTime(e)));const a=new rf(e,n,this.Ye,this.je,i);return this.je=Wi(),this.Je=nh(),this.He=nh(),this.Ye=new It(Ze),a}Xe(e,n){if(!this.rt(e))return;const i=this.Et(e,n.key)?2:0;this.nt(e).Qe(n.key,i),this.je=this.je.insert(n.key,n),this.Je=this.Je.insert(n.key,this.It(n.key).add(e)),this.He=this.He.insert(n.key,this.dt(n.key).add(e))}et(e,n,i){if(!this.rt(e))return;const a=this.nt(e);this.Et(e,n)?a.Qe(n,1):a.$e(n),this.He=this.He.insert(n,this.dt(n).delete(e)),this.He=this.He.insert(n,this.dt(n).add(e)),i&&(this.je=this.je.insert(n,i))}removeTarget(e){this.ze.delete(e)}_t(e){const n=this.nt(e).ke();return this.Ge.getRemoteKeysForTarget(e).size+n.addedDocuments.size-n.removedDocuments.size}Ue(e){this.nt(e).Ue()}nt(e){let n=this.ze.get(e);return n||(n=new Ex,this.ze.set(e,n)),n}dt(e){let n=this.He.get(e);return n||(n=new on(Ze),this.He=this.He.insert(e,n)),n}It(e){let n=this.Je.get(e);return n||(n=new on(Ze),this.Je=this.Je.insert(e,n)),n}rt(e){const n=this.ot(e)!==null;return n||Ae("WatchChangeAggregator","Detected inactive target",e),n}ot(e){const n=this.ze.get(e);return n&&n.Ne?null:this.Ge.At(e)}it(e){this.ze.set(e,new Ex),this.Ge.getRemoteKeysForTarget(e).forEach((n=>{this.et(e,n,null)}))}Et(e,n){return this.Ge.getRemoteKeysForTarget(e).has(n)}}function nh(){return new It(je.comparator)}function Sx(){return new It(je.comparator)}const M2={asc:"ASCENDING",desc:"DESCENDING"},k2={"<":"LESS_THAN","<=":"LESS_THAN_OR_EQUAL",">":"GREATER_THAN",">=":"GREATER_THAN_OR_EQUAL","==":"EQUAL","!=":"NOT_EQUAL","array-contains":"ARRAY_CONTAINS",in:"IN","not-in":"NOT_IN","array-contains-any":"ARRAY_CONTAINS_ANY"},N2={and:"AND",or:"OR"};class P2{constructor(e,n){this.databaseId=e,this.useProto3Json=n}}function lg(t,e){return t.useProto3Json||Xh(e)?e:{value:e}}function jh(t,e){return t.useProto3Json?`${new Date(1e3*e.seconds).toISOString().replace(/\.\d*/,"").replace("Z","")}.${("000000000"+e.nanoseconds).slice(-9)}Z`:{seconds:""+e.seconds,nanos:e.nanoseconds}}function ww(t,e){return t.useProto3Json?e.toBase64():e.toUint8Array()}function L2(t,e){return jh(t,e.toTimestamp())}function fi(t){return ct(!!t,49232),Ue.fromTimestamp((function(n){const i=Ys(n);return new Tt(i.seconds,i.nanos)})(t))}function Zg(t,e){return cg(t,e).canonicalString()}function cg(t,e){const n=(function(a){return new Et(["projects",a.projectId,"databases",a.database])})(t).child("documents");return e===void 0?n:n.child(e)}function Tw(t){const e=Et.fromString(t);return ct(Iw(e),10190,{key:e.toString()}),e}function ug(t,e){return Zg(t.databaseId,e.path)}function jp(t,e){const n=Tw(e);if(n.get(1)!==t.databaseId.projectId)throw new Te(ve.INVALID_ARGUMENT,"Tried to deserialize key from different project: "+n.get(1)+" vs "+t.databaseId.projectId);if(n.get(3)!==t.databaseId.database)throw new Te(ve.INVALID_ARGUMENT,"Tried to deserialize key from different database: "+n.get(3)+" vs "+t.databaseId.database);return new je(Cw(n))}function Aw(t,e){return Zg(t.databaseId,e)}function V2(t){const e=Tw(t);return e.length===4?Et.emptyPath():Cw(e)}function dg(t){return new Et(["projects",t.databaseId.projectId,"databases",t.databaseId.database]).canonicalString()}function Cw(t){return ct(t.length>4&&t.get(4)==="documents",29091,{key:t.toString()}),t.popFirst(5)}function wx(t,e,n){return{name:ug(t,e),fields:n.value.mapValue.fields}}function z2(t,e){let n;if("targetChange"in e){e.targetChange;const i=(function(g){return g==="NO_CHANGE"?0:g==="ADD"?1:g==="REMOVE"?2:g==="CURRENT"?3:g==="RESET"?4:Pe(39313,{state:g})})(e.targetChange.targetChangeType||"NO_CHANGE"),a=e.targetChange.targetIds||[],l=(function(g,_){return g.useProto3Json?(ct(_===void 0||typeof _=="string",58123),wn.fromBase64String(_||"")):(ct(_===void 0||_ instanceof Buffer||_ instanceof Uint8Array,16193),wn.fromUint8Array(_||new Uint8Array))})(t,e.targetChange.resumeToken),u=e.targetChange.cause,h=u&&(function(g){const _=g.code===void 0?ve.UNKNOWN:xw(g.code);return new Te(_,g.message||"")})(u);n=new Sw(i,a,l,h||null)}else if("documentChange"in e){e.documentChange;const i=e.documentChange;i.document,i.document.name,i.document.updateTime;const a=jp(t,i.document.name),l=fi(i.document.updateTime),u=i.document.createTime?fi(i.document.createTime):Ue.min(),h=new qn({mapValue:{fields:i.document.fields}}),m=Dn.newFoundDocument(a,l,u,h),g=i.targetIds||[],_=i.removedTargetIds||[];n=new dh(g,_,m.key,m)}else if("documentDelete"in e){e.documentDelete;const i=e.documentDelete;i.document;const a=jp(t,i.document),l=i.readTime?fi(i.readTime):Ue.min(),u=Dn.newNoDocument(a,l),h=i.removedTargetIds||[];n=new dh([],h,u.key,u)}else if("documentRemove"in e){e.documentRemove;const i=e.documentRemove;i.document;const a=jp(t,i.document),l=i.removedTargetIds||[];n=new dh([],l,a,null)}else{if(!("filter"in e))return Pe(11601,{Rt:e});{e.filter;const i=e.filter;i.targetId;const{count:a=0,unchangedNames:l}=i,u=new R2(a,l),h=i.targetId;n=new Ew(h,u)}}return n}function U2(t,e){let n;if(e instanceof mu)n={update:wx(t,e.key,e.value)};else if(e instanceof Yg)n={delete:ug(t,e.key)};else if(e instanceof ra)n={update:wx(t,e.key,e.data),updateMask:W2(e.fieldMask)};else{if(!(e instanceof T2))return Pe(16599,{Vt:e.type});n={verify:ug(t,e.key)}}return e.fieldTransforms.length>0&&(n.updateTransforms=e.fieldTransforms.map((i=>(function(l,u){const h=u.transform;if(h instanceof Dh)return{fieldPath:u.field.canonicalString(),setToServerValue:"REQUEST_TIME"};if(h instanceof al)return{fieldPath:u.field.canonicalString(),appendMissingElements:{values:h.elements}};if(h instanceof tu)return{fieldPath:u.field.canonicalString(),removeAllFromArray:{values:h.elements}};if(h instanceof Ih)return{fieldPath:u.field.canonicalString(),increment:h.Ae};throw Pe(20930,{transform:u.transform})})(0,i)))),e.precondition.isNone||(n.currentDocument=(function(a,l){return l.updateTime!==void 0?{updateTime:L2(a,l.updateTime)}:l.exists!==void 0?{exists:l.exists}:Pe(27497)})(t,e.precondition)),n}function B2(t,e){return t&&t.length>0?(ct(e!==void 0,14353),t.map((n=>(function(a,l){let u=a.updateTime?fi(a.updateTime):fi(l);return u.isEqual(Ue.min())&&(u=fi(l)),new E2(u,a.transformResults||[])})(n,e)))):[]}function F2(t,e){return{documents:[Aw(t,e.path)]}}function q2(t,e){const n={structuredQuery:{}},i=e.path;let a;e.collectionGroup!==null?(a=i,n.structuredQuery.from=[{collectionId:e.collectionGroup,allDescendants:!0}]):(a=i.popLast(),n.structuredQuery.from=[{collectionId:i.lastSegment()}]),n.parent=Aw(t,a);const l=(function(g){if(g.length!==0)return Dw(Br.create(g,"and"))})(e.filters);l&&(n.structuredQuery.where=l);const u=(function(g){if(g.length!==0)return g.map((_=>(function(b){return{field:Ho(b.field),direction:Q2(b.dir)}})(_)))})(e.orderBy);u&&(n.structuredQuery.orderBy=u);const h=lg(t,e.limit);return h!==null&&(n.structuredQuery.limit=h),e.startAt&&(n.structuredQuery.startAt=(function(g){return{before:g.inclusive,values:g.position}})(e.startAt)),e.endAt&&(n.structuredQuery.endAt=(function(g){return{before:!g.inclusive,values:g.position}})(e.endAt)),{ft:n,parent:a}}function G2(t){let e=V2(t.parent);const n=t.structuredQuery,i=n.from?n.from.length:0;let a=null;if(i>0){ct(i===1,65062);const _=n.from[0];_.allDescendants?a=_.collectionId:e=e.child(_.collectionId)}let l=[];n.where&&(l=(function(v){const b=Rw(v);return b instanceof Br&&iw(b)?b.getFilters():[b]})(n.where));let u=[];n.orderBy&&(u=(function(v){return v.map((b=>(function(C){return new Rh(Qo(C.field),(function(N){switch(N){case"ASCENDING":return"asc";case"DESCENDING":return"desc";default:return}})(C.direction))})(b)))})(n.orderBy));let h=null;n.limit&&(h=(function(v){let b;return b=typeof v=="object"?v.value:v,Xh(b)?null:b})(n.limit));let m=null;n.startAt&&(m=(function(v){const b=!!v.before,w=v.values||[];return new Ch(w,b)})(n.startAt));let g=null;return n.endAt&&(g=(function(v){const b=!v.before,w=v.values||[];return new Ch(w,b)})(n.endAt)),l2(e,a,u,l,h,"F",m,g)}function H2(t,e){const n=(function(a){switch(a){case"TargetPurposeListen":return null;case"TargetPurposeExistenceFilterMismatch":return"existence-filter-mismatch";case"TargetPurposeExistenceFilterMismatchBloom":return"existence-filter-mismatch-bloom";case"TargetPurposeLimboResolution":return"limbo-document";default:return Pe(28987,{purpose:a})}})(e.purpose);return n==null?null:{"goog-listen-tags":n}}function Rw(t){return t.unaryFilter!==void 0?(function(n){switch(n.unaryFilter.op){case"IS_NAN":const i=Qo(n.unaryFilter.field);return tn.create(i,"==",{doubleValue:NaN});case"IS_NULL":const a=Qo(n.unaryFilter.field);return tn.create(a,"==",{nullValue:"NULL_VALUE"});case"IS_NOT_NAN":const l=Qo(n.unaryFilter.field);return tn.create(l,"!=",{doubleValue:NaN});case"IS_NOT_NULL":const u=Qo(n.unaryFilter.field);return tn.create(u,"!=",{nullValue:"NULL_VALUE"});case"OPERATOR_UNSPECIFIED":return Pe(61313);default:return Pe(60726)}})(t):t.fieldFilter!==void 0?(function(n){return tn.create(Qo(n.fieldFilter.field),(function(a){switch(a){case"EQUAL":return"==";case"NOT_EQUAL":return"!=";case"GREATER_THAN":return">";case"GREATER_THAN_OR_EQUAL":return">=";case"LESS_THAN":return"<";case"LESS_THAN_OR_EQUAL":return"<=";case"ARRAY_CONTAINS":return"array-contains";case"IN":return"in";case"NOT_IN":return"not-in";case"ARRAY_CONTAINS_ANY":return"array-contains-any";case"OPERATOR_UNSPECIFIED":return Pe(58110);default:return Pe(50506)}})(n.fieldFilter.op),n.fieldFilter.value)})(t):t.compositeFilter!==void 0?(function(n){return Br.create(n.compositeFilter.filters.map((i=>Rw(i))),(function(a){switch(a){case"AND":return"and";case"OR":return"or";default:return Pe(1026)}})(n.compositeFilter.op))})(t):Pe(30097,{filter:t})}function Q2(t){return M2[t]}function $2(t){return k2[t]}function K2(t){return N2[t]}function Ho(t){return{fieldPath:t.canonicalString()}}function Qo(t){return Sn.fromServerFormat(t.fieldPath)}function Dw(t){return t instanceof tn?(function(n){if(n.op==="=="){if(dx(n.value))return{unaryFilter:{field:Ho(n.field),op:"IS_NAN"}};if(ux(n.value))return{unaryFilter:{field:Ho(n.field),op:"IS_NULL"}}}else if(n.op==="!="){if(dx(n.value))return{unaryFilter:{field:Ho(n.field),op:"IS_NOT_NAN"}};if(ux(n.value))return{unaryFilter:{field:Ho(n.field),op:"IS_NOT_NULL"}}}return{fieldFilter:{field:Ho(n.field),op:$2(n.op),value:n.value}}})(t):t instanceof Br?(function(n){const i=n.getFilters().map((a=>Dw(a)));return i.length===1?i[0]:{compositeFilter:{op:K2(n.op),filters:i}}})(t):Pe(54877,{filter:t})}function W2(t){const e=[];return t.fields.forEach((n=>e.push(n.canonicalString()))),{fieldPaths:e}}function Iw(t){return t.length>=4&&t.get(0)==="projects"&&t.get(2)==="databases"}class Us{constructor(e,n,i,a,l=Ue.min(),u=Ue.min(),h=wn.EMPTY_BYTE_STRING,m=null){this.target=e,this.targetId=n,this.purpose=i,this.sequenceNumber=a,this.snapshotVersion=l,this.lastLimboFreeSnapshotVersion=u,this.resumeToken=h,this.expectedCount=m}withSequenceNumber(e){return new Us(this.target,this.targetId,this.purpose,e,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,this.expectedCount)}withResumeToken(e,n){return new Us(this.target,this.targetId,this.purpose,this.sequenceNumber,n,this.lastLimboFreeSnapshotVersion,e,null)}withExpectedCount(e){return new Us(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,e)}withLastLimboFreeSnapshotVersion(e){return new Us(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,e,this.resumeToken,this.expectedCount)}}class Y2{constructor(e){this.yt=e}}function X2(t){const e=G2({parent:t.parent,structuredQuery:t.structuredQuery});return t.limitType==="LAST"?og(e,e.limit,"L"):e}class J2{constructor(){this.Cn=new Z2}addToCollectionParentIndex(e,n){return this.Cn.add(n),be.resolve()}getCollectionParents(e,n){return be.resolve(this.Cn.getEntries(n))}addFieldIndex(e,n){return be.resolve()}deleteFieldIndex(e,n){return be.resolve()}deleteAllFieldIndexes(e){return be.resolve()}createTargetIndexes(e,n){return be.resolve()}getDocumentsMatchingTarget(e,n){return be.resolve(null)}getIndexType(e,n){return be.resolve(0)}getFieldIndexes(e,n){return be.resolve([])}getNextCollectionGroupToUpdate(e){return be.resolve(null)}getMinOffset(e,n){return be.resolve(Ws.min())}getMinOffsetFromCollectionGroup(e,n){return be.resolve(Ws.min())}updateCollectionGroup(e,n,i){return be.resolve()}updateIndexEntries(e,n){return be.resolve()}}class Z2{constructor(){this.index={}}add(e){const n=e.lastSegment(),i=e.popLast(),a=this.index[n]||new on(Et.comparator),l=!a.has(i);return this.index[n]=a.add(i),l}has(e){const n=e.lastSegment(),i=e.popLast(),a=this.index[n];return a&&a.has(i)}getEntries(e){return(this.index[e]||new on(Et.comparator)).toArray()}}const Tx={didRun:!1,sequenceNumbersCollected:0,targetsRemoved:0,documentsRemoved:0},jw=41943040;class Fn{static withCacheSize(e){return new Fn(e,Fn.DEFAULT_COLLECTION_PERCENTILE,Fn.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT)}constructor(e,n,i){this.cacheSizeCollectionThreshold=e,this.percentileToCollect=n,this.maximumSequenceNumbersToCollect=i}}Fn.DEFAULT_COLLECTION_PERCENTILE=10,Fn.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT=1e3,Fn.DEFAULT=new Fn(jw,Fn.DEFAULT_COLLECTION_PERCENTILE,Fn.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT),Fn.DISABLED=new Fn(-1,0,0);class ol{constructor(e){this.ar=e}next(){return this.ar+=2,this.ar}static ur(){return new ol(0)}static cr(){return new ol(-1)}}const Ax="LruGarbageCollector",e5=1048576;function Cx([t,e],[n,i]){const a=Ze(t,n);return a===0?Ze(e,i):a}class t5{constructor(e){this.Ir=e,this.buffer=new on(Cx),this.Er=0}dr(){return++this.Er}Ar(e){const n=[e,this.dr()];if(this.buffer.size<this.Ir)this.buffer=this.buffer.add(n);else{const i=this.buffer.last();Cx(n,i)<0&&(this.buffer=this.buffer.delete(i).add(n))}}get maxValue(){return this.buffer.last()[0]}}class n5{constructor(e,n,i){this.garbageCollector=e,this.asyncQueue=n,this.localStore=i,this.Rr=null}start(){this.garbageCollector.params.cacheSizeCollectionThreshold!==-1&&this.Vr(6e4)}stop(){this.Rr&&(this.Rr.cancel(),this.Rr=null)}get started(){return this.Rr!==null}Vr(e){Ae(Ax,`Garbage collection scheduled in ${e}ms`),this.Rr=this.asyncQueue.enqueueAfterDelay("lru_garbage_collection",e,(async()=>{this.Rr=null;try{await this.localStore.collectGarbage(this.garbageCollector)}catch(n){El(n)?Ae(Ax,"Ignoring IndexedDB error during garbage collection: ",n):await xl(n)}await this.Vr(3e5)}))}}class r5{constructor(e,n){this.mr=e,this.params=n}calculateTargetCount(e,n){return this.mr.gr(e).next((i=>Math.floor(n/100*i)))}nthSequenceNumber(e,n){if(n===0)return be.resolve(Yh.ce);const i=new t5(n);return this.mr.forEachTarget(e,(a=>i.Ar(a.sequenceNumber))).next((()=>this.mr.pr(e,(a=>i.Ar(a))))).next((()=>i.maxValue))}removeTargets(e,n,i){return this.mr.removeTargets(e,n,i)}removeOrphanedDocuments(e,n){return this.mr.removeOrphanedDocuments(e,n)}collect(e,n){return this.params.cacheSizeCollectionThreshold===-1?(Ae("LruGarbageCollector","Garbage collection skipped; disabled"),be.resolve(Tx)):this.getCacheSize(e).next((i=>i<this.params.cacheSizeCollectionThreshold?(Ae("LruGarbageCollector",`Garbage collection skipped; Cache size ${i} is lower than threshold ${this.params.cacheSizeCollectionThreshold}`),Tx):this.yr(e,n)))}getCacheSize(e){return this.mr.getCacheSize(e)}yr(e,n){let i,a,l,u,h,m,g;const _=Date.now();return this.calculateTargetCount(e,this.params.percentileToCollect).next((v=>(v>this.params.maximumSequenceNumbersToCollect?(Ae("LruGarbageCollector",`Capping sequence numbers to collect down to the maximum of ${this.params.maximumSequenceNumbersToCollect} from ${v}`),a=this.params.maximumSequenceNumbersToCollect):a=v,u=Date.now(),this.nthSequenceNumber(e,a)))).next((v=>(i=v,h=Date.now(),this.removeTargets(e,i,n)))).next((v=>(l=v,m=Date.now(),this.removeOrphanedDocuments(e,i)))).next((v=>(g=Date.now(),qo()<=Je.DEBUG&&Ae("LruGarbageCollector",`LRU Garbage Collection
	Counted targets in ${u-_}ms
	Determined least recently used ${a} in `+(h-u)+`ms
	Removed ${l} targets in `+(m-h)+`ms
	Removed ${v} documents in `+(g-m)+`ms
Total Duration: ${g-_}ms`),be.resolve({didRun:!0,sequenceNumbersCollected:a,targetsRemoved:l,documentsRemoved:v}))))}}function i5(t,e){return new r5(t,e)}class s5{constructor(){this.changes=new Ha((e=>e.toString()),((e,n)=>e.isEqual(n))),this.changesApplied=!1}addEntry(e){this.assertNotApplied(),this.changes.set(e.key,e)}removeEntry(e,n){this.assertNotApplied(),this.changes.set(e,Dn.newInvalidDocument(e).setReadTime(n))}getEntry(e,n){this.assertNotApplied();const i=this.changes.get(n);return i!==void 0?be.resolve(i):this.getFromCache(e,n)}getEntries(e,n){return this.getAllFromCache(e,n)}apply(e){return this.assertNotApplied(),this.changesApplied=!0,this.applyChanges(e)}assertNotApplied(){}}class a5{constructor(e,n){this.overlayedDocument=e,this.mutatedFields=n}}class o5{constructor(e,n,i,a){this.remoteDocumentCache=e,this.mutationQueue=n,this.documentOverlayCache=i,this.indexManager=a}getDocument(e,n){let i=null;return this.documentOverlayCache.getOverlay(e,n).next((a=>(i=a,this.remoteDocumentCache.getEntry(e,n)))).next((a=>(i!==null&&Qc(i.mutation,a,tr.empty(),Tt.now()),a)))}getDocuments(e,n){return this.remoteDocumentCache.getEntries(e,n).next((i=>this.getLocalViewOfDocuments(e,i,et()).next((()=>i))))}getLocalViewOfDocuments(e,n,i=et()){const a=ka();return this.populateOverlays(e,a,n).next((()=>this.computeViews(e,n,a,i).next((l=>{let u=zc();return l.forEach(((h,m)=>{u=u.insert(h,m.overlayedDocument)})),u}))))}getOverlayedDocuments(e,n){const i=ka();return this.populateOverlays(e,i,n).next((()=>this.computeViews(e,n,i,et())))}populateOverlays(e,n,i){const a=[];return i.forEach((l=>{n.has(l)||a.push(l)})),this.documentOverlayCache.getOverlays(e,a).next((l=>{l.forEach(((u,h)=>{n.set(u,h)}))}))}computeViews(e,n,i,a){let l=Wi();const u=Hc(),h=(function(){return Hc()})();return n.forEach(((m,g)=>{const _=i.get(g.key);a.has(g.key)&&(_===void 0||_.mutation instanceof ra)?l=l.insert(g.key,g):_!==void 0?(u.set(g.key,_.mutation.getFieldMask()),Qc(_.mutation,g,_.mutation.getFieldMask(),Tt.now())):u.set(g.key,tr.empty())})),this.recalculateAndSaveOverlays(e,l).next((m=>(m.forEach(((g,_)=>u.set(g,_))),n.forEach(((g,_)=>h.set(g,new a5(_,u.get(g)??null)))),h)))}recalculateAndSaveOverlays(e,n){const i=Hc();let a=new It(((u,h)=>u-h)),l=et();return this.mutationQueue.getAllMutationBatchesAffectingDocumentKeys(e,n).next((u=>{for(const h of u)h.keys().forEach((m=>{const g=n.get(m);if(g===null)return;let _=i.get(m)||tr.empty();_=h.applyToLocalView(g,_),i.set(m,_);const v=(a.get(h.batchId)||et()).add(m);a=a.insert(h.batchId,v)}))})).next((()=>{const u=[],h=a.getReverseIterator();for(;h.hasNext();){const m=h.getNext(),g=m.key,_=m.value,v=fw();_.forEach((b=>{if(!l.has(b)){const w=vw(n.get(b),i.get(b));w!==null&&v.set(b,w),l=l.add(b)}})),u.push(this.documentOverlayCache.saveOverlays(e,g,v))}return be.waitFor(u)})).next((()=>i))}recalculateAndSaveOverlaysForDocumentKeys(e,n){return this.remoteDocumentCache.getEntries(e,n).next((i=>this.recalculateAndSaveOverlays(e,i)))}getDocumentsMatchingQuery(e,n,i,a){return(function(u){return je.isDocumentKey(u.path)&&u.collectionGroup===null&&u.filters.length===0})(n)?this.getDocumentsMatchingDocumentQuery(e,n.path):lw(n)?this.getDocumentsMatchingCollectionGroupQuery(e,n,i,a):this.getDocumentsMatchingCollectionQuery(e,n,i,a)}getNextDocuments(e,n,i,a){return this.remoteDocumentCache.getAllFromCollectionGroup(e,n,i,a).next((l=>{const u=a-l.size>0?this.documentOverlayCache.getOverlaysForCollectionGroup(e,n,i.largestBatchId,a-l.size):be.resolve(ka());let h=Xc,m=l;return u.next((g=>be.forEach(g,((_,v)=>(h<v.largestBatchId&&(h=v.largestBatchId),l.get(_)?be.resolve():this.remoteDocumentCache.getEntry(e,_).next((b=>{m=m.insert(_,b)}))))).next((()=>this.populateOverlays(e,g,l))).next((()=>this.computeViews(e,m,g,et()))).next((_=>({batchId:h,changes:hw(_)})))))}))}getDocumentsMatchingDocumentQuery(e,n){return this.getDocument(e,new je(n)).next((i=>{let a=zc();return i.isFoundDocument()&&(a=a.insert(i.key,i)),a}))}getDocumentsMatchingCollectionGroupQuery(e,n,i,a){const l=n.collectionGroup;let u=zc();return this.indexManager.getCollectionParents(e,l).next((h=>be.forEach(h,(m=>{const g=(function(v,b){return new fu(b,null,v.explicitOrderBy.slice(),v.filters.slice(),v.limit,v.limitType,v.startAt,v.endAt)})(n,m.child(l));return this.getDocumentsMatchingCollectionQuery(e,g,i,a).next((_=>{_.forEach(((v,b)=>{u=u.insert(v,b)}))}))})).next((()=>u))))}getDocumentsMatchingCollectionQuery(e,n,i,a){let l;return this.documentOverlayCache.getOverlaysForCollection(e,n.path,i.largestBatchId).next((u=>(l=u,this.remoteDocumentCache.getDocumentsMatchingQuery(e,n,i,l,a)))).next((u=>{l.forEach(((m,g)=>{const _=g.getKey();u.get(_)===null&&(u=u.insert(_,Dn.newInvalidDocument(_)))}));let h=zc();return u.forEach(((m,g)=>{const _=l.get(m);_!==void 0&&Qc(_.mutation,g,tr.empty(),Tt.now()),ef(n,g)&&(h=h.insert(m,g))})),h}))}}class l5{constructor(e){this.serializer=e,this.Lr=new Map,this.kr=new Map}getBundleMetadata(e,n){return be.resolve(this.Lr.get(n))}saveBundleMetadata(e,n){return this.Lr.set(n.id,(function(a){return{id:a.id,version:a.version,createTime:fi(a.createTime)}})(n)),be.resolve()}getNamedQuery(e,n){return be.resolve(this.kr.get(n))}saveNamedQuery(e,n){return this.kr.set(n.name,(function(a){return{name:a.name,query:X2(a.bundledQuery),readTime:fi(a.readTime)}})(n)),be.resolve()}}class c5{constructor(){this.overlays=new It(je.comparator),this.qr=new Map}getOverlay(e,n){return be.resolve(this.overlays.get(n))}getOverlays(e,n){const i=ka();return be.forEach(n,(a=>this.getOverlay(e,a).next((l=>{l!==null&&i.set(a,l)})))).next((()=>i))}saveOverlays(e,n,i){return i.forEach(((a,l)=>{this.St(e,n,l)})),be.resolve()}removeOverlaysForBatchId(e,n,i){const a=this.qr.get(i);return a!==void 0&&(a.forEach((l=>this.overlays=this.overlays.remove(l))),this.qr.delete(i)),be.resolve()}getOverlaysForCollection(e,n,i){const a=ka(),l=n.length+1,u=new je(n.child("")),h=this.overlays.getIteratorFrom(u);for(;h.hasNext();){const m=h.getNext().value,g=m.getKey();if(!n.isPrefixOf(g.path))break;g.path.length===l&&m.largestBatchId>i&&a.set(m.getKey(),m)}return be.resolve(a)}getOverlaysForCollectionGroup(e,n,i,a){let l=new It(((g,_)=>g-_));const u=this.overlays.getIterator();for(;u.hasNext();){const g=u.getNext().value;if(g.getKey().getCollectionGroup()===n&&g.largestBatchId>i){let _=l.get(g.largestBatchId);_===null&&(_=ka(),l=l.insert(g.largestBatchId,_)),_.set(g.getKey(),g)}}const h=ka(),m=l.getIterator();for(;m.hasNext()&&(m.getNext().value.forEach(((g,_)=>h.set(g,_))),!(h.size()>=a)););return be.resolve(h)}St(e,n,i){const a=this.overlays.get(i.key);if(a!==null){const u=this.qr.get(a.largestBatchId).delete(i.key);this.qr.set(a.largestBatchId,u)}this.overlays=this.overlays.insert(i.key,new C2(n,i));let l=this.qr.get(n);l===void 0&&(l=et(),this.qr.set(n,l)),this.qr.set(n,l.add(i.key))}}class u5{constructor(){this.sessionToken=wn.EMPTY_BYTE_STRING}getSessionToken(e){return be.resolve(this.sessionToken)}setSessionToken(e,n){return this.sessionToken=n,be.resolve()}}class ey{constructor(){this.Qr=new on(hn.$r),this.Ur=new on(hn.Kr)}isEmpty(){return this.Qr.isEmpty()}addReference(e,n){const i=new hn(e,n);this.Qr=this.Qr.add(i),this.Ur=this.Ur.add(i)}Wr(e,n){e.forEach((i=>this.addReference(i,n)))}removeReference(e,n){this.Gr(new hn(e,n))}zr(e,n){e.forEach((i=>this.removeReference(i,n)))}jr(e){const n=new je(new Et([])),i=new hn(n,e),a=new hn(n,e+1),l=[];return this.Ur.forEachInRange([i,a],(u=>{this.Gr(u),l.push(u.key)})),l}Jr(){this.Qr.forEach((e=>this.Gr(e)))}Gr(e){this.Qr=this.Qr.delete(e),this.Ur=this.Ur.delete(e)}Hr(e){const n=new je(new Et([])),i=new hn(n,e),a=new hn(n,e+1);let l=et();return this.Ur.forEachInRange([i,a],(u=>{l=l.add(u.key)})),l}containsKey(e){const n=new hn(e,0),i=this.Qr.firstAfterOrEqual(n);return i!==null&&e.isEqual(i.key)}}class hn{constructor(e,n){this.key=e,this.Yr=n}static $r(e,n){return je.comparator(e.key,n.key)||Ze(e.Yr,n.Yr)}static Kr(e,n){return Ze(e.Yr,n.Yr)||je.comparator(e.key,n.key)}}class d5{constructor(e,n){this.indexManager=e,this.referenceDelegate=n,this.mutationQueue=[],this.tr=1,this.Zr=new on(hn.$r)}checkEmpty(e){return be.resolve(this.mutationQueue.length===0)}addMutationBatch(e,n,i,a){const l=this.tr;this.tr++,this.mutationQueue.length>0&&this.mutationQueue[this.mutationQueue.length-1];const u=new A2(l,n,i,a);this.mutationQueue.push(u);for(const h of a)this.Zr=this.Zr.add(new hn(h.key,l)),this.indexManager.addToCollectionParentIndex(e,h.key.path.popLast());return be.resolve(u)}lookupMutationBatch(e,n){return be.resolve(this.Xr(n))}getNextMutationBatchAfterBatchId(e,n){const i=n+1,a=this.ei(i),l=a<0?0:a;return be.resolve(this.mutationQueue.length>l?this.mutationQueue[l]:null)}getHighestUnacknowledgedBatchId(){return be.resolve(this.mutationQueue.length===0?qg:this.tr-1)}getAllMutationBatches(e){return be.resolve(this.mutationQueue.slice())}getAllMutationBatchesAffectingDocumentKey(e,n){const i=new hn(n,0),a=new hn(n,Number.POSITIVE_INFINITY),l=[];return this.Zr.forEachInRange([i,a],(u=>{const h=this.Xr(u.Yr);l.push(h)})),be.resolve(l)}getAllMutationBatchesAffectingDocumentKeys(e,n){let i=new on(Ze);return n.forEach((a=>{const l=new hn(a,0),u=new hn(a,Number.POSITIVE_INFINITY);this.Zr.forEachInRange([l,u],(h=>{i=i.add(h.Yr)}))})),be.resolve(this.ti(i))}getAllMutationBatchesAffectingQuery(e,n){const i=n.path,a=i.length+1;let l=i;je.isDocumentKey(l)||(l=l.child(""));const u=new hn(new je(l),0);let h=new on(Ze);return this.Zr.forEachWhile((m=>{const g=m.key.path;return!!i.isPrefixOf(g)&&(g.length===a&&(h=h.add(m.Yr)),!0)}),u),be.resolve(this.ti(h))}ti(e){const n=[];return e.forEach((i=>{const a=this.Xr(i);a!==null&&n.push(a)})),n}removeMutationBatch(e,n){ct(this.ni(n.batchId,"removed")===0,55003),this.mutationQueue.shift();let i=this.Zr;return be.forEach(n.mutations,(a=>{const l=new hn(a.key,n.batchId);return i=i.delete(l),this.referenceDelegate.markPotentiallyOrphaned(e,a.key)})).next((()=>{this.Zr=i}))}ir(e){}containsKey(e,n){const i=new hn(n,0),a=this.Zr.firstAfterOrEqual(i);return be.resolve(n.isEqual(a&&a.key))}performConsistencyCheck(e){return this.mutationQueue.length,be.resolve()}ni(e,n){return this.ei(e)}ei(e){return this.mutationQueue.length===0?0:e-this.mutationQueue[0].batchId}Xr(e){const n=this.ei(e);return n<0||n>=this.mutationQueue.length?null:this.mutationQueue[n]}}class h5{constructor(e){this.ri=e,this.docs=(function(){return new It(je.comparator)})(),this.size=0}setIndexManager(e){this.indexManager=e}addEntry(e,n){const i=n.key,a=this.docs.get(i),l=a?a.size:0,u=this.ri(n);return this.docs=this.docs.insert(i,{document:n.mutableCopy(),size:u}),this.size+=u-l,this.indexManager.addToCollectionParentIndex(e,i.path.popLast())}removeEntry(e){const n=this.docs.get(e);n&&(this.docs=this.docs.remove(e),this.size-=n.size)}getEntry(e,n){const i=this.docs.get(n);return be.resolve(i?i.document.mutableCopy():Dn.newInvalidDocument(n))}getEntries(e,n){let i=Wi();return n.forEach((a=>{const l=this.docs.get(a);i=i.insert(a,l?l.document.mutableCopy():Dn.newInvalidDocument(a))})),be.resolve(i)}getDocumentsMatchingQuery(e,n,i,a){let l=Wi();const u=n.path,h=new je(u.child("__id-9223372036854775808__")),m=this.docs.getIteratorFrom(h);for(;m.hasNext();){const{key:g,value:{document:_}}=m.getNext();if(!u.isPrefixOf(g.path))break;g.path.length>u.length+1||Uj(zj(_),i)<=0||(a.has(_.key)||ef(n,_))&&(l=l.insert(_.key,_.mutableCopy()))}return be.resolve(l)}getAllFromCollectionGroup(e,n,i,a){Pe(9500)}ii(e,n){return be.forEach(this.docs,(i=>n(i)))}newChangeBuffer(e){return new f5(this)}getSize(e){return be.resolve(this.size)}}class f5 extends s5{constructor(e){super(),this.Nr=e}applyChanges(e){const n=[];return this.changes.forEach(((i,a)=>{a.isValidDocument()?n.push(this.Nr.addEntry(e,a)):this.Nr.removeEntry(i)})),be.waitFor(n)}getFromCache(e,n){return this.Nr.getEntry(e,n)}getAllFromCache(e,n){return this.Nr.getEntries(e,n)}}class m5{constructor(e){this.persistence=e,this.si=new Ha((n=>Qg(n)),$g),this.lastRemoteSnapshotVersion=Ue.min(),this.highestTargetId=0,this.oi=0,this._i=new ey,this.targetCount=0,this.ai=ol.ur()}forEachTarget(e,n){return this.si.forEach(((i,a)=>n(a))),be.resolve()}getLastRemoteSnapshotVersion(e){return be.resolve(this.lastRemoteSnapshotVersion)}getHighestSequenceNumber(e){return be.resolve(this.oi)}allocateTargetId(e){return this.highestTargetId=this.ai.next(),be.resolve(this.highestTargetId)}setTargetsMetadata(e,n,i){return i&&(this.lastRemoteSnapshotVersion=i),n>this.oi&&(this.oi=n),be.resolve()}Pr(e){this.si.set(e.target,e);const n=e.targetId;n>this.highestTargetId&&(this.ai=new ol(n),this.highestTargetId=n),e.sequenceNumber>this.oi&&(this.oi=e.sequenceNumber)}addTargetData(e,n){return this.Pr(n),this.targetCount+=1,be.resolve()}updateTargetData(e,n){return this.Pr(n),be.resolve()}removeTargetData(e,n){return this.si.delete(n.target),this._i.jr(n.targetId),this.targetCount-=1,be.resolve()}removeTargets(e,n,i){let a=0;const l=[];return this.si.forEach(((u,h)=>{h.sequenceNumber<=n&&i.get(h.targetId)===null&&(this.si.delete(u),l.push(this.removeMatchingKeysForTargetId(e,h.targetId)),a++)})),be.waitFor(l).next((()=>a))}getTargetCount(e){return be.resolve(this.targetCount)}getTargetData(e,n){const i=this.si.get(n)||null;return be.resolve(i)}addMatchingKeys(e,n,i){return this._i.Wr(n,i),be.resolve()}removeMatchingKeys(e,n,i){this._i.zr(n,i);const a=this.persistence.referenceDelegate,l=[];return a&&n.forEach((u=>{l.push(a.markPotentiallyOrphaned(e,u))})),be.waitFor(l)}removeMatchingKeysForTargetId(e,n){return this._i.jr(n),be.resolve()}getMatchingKeysForTargetId(e,n){const i=this._i.Hr(n);return be.resolve(i)}containsKey(e,n){return be.resolve(this._i.containsKey(n))}}class Ow{constructor(e,n){this.ui={},this.overlays={},this.ci=new Yh(0),this.li=!1,this.li=!0,this.hi=new u5,this.referenceDelegate=e(this),this.Pi=new m5(this),this.indexManager=new J2,this.remoteDocumentCache=(function(a){return new h5(a)})((i=>this.referenceDelegate.Ti(i))),this.serializer=new Y2(n),this.Ii=new l5(this.serializer)}start(){return Promise.resolve()}shutdown(){return this.li=!1,Promise.resolve()}get started(){return this.li}setDatabaseDeletedListener(){}setNetworkEnabled(){}getIndexManager(e){return this.indexManager}getDocumentOverlayCache(e){let n=this.overlays[e.toKey()];return n||(n=new c5,this.overlays[e.toKey()]=n),n}getMutationQueue(e,n){let i=this.ui[e.toKey()];return i||(i=new d5(n,this.referenceDelegate),this.ui[e.toKey()]=i),i}getGlobalsCache(){return this.hi}getTargetCache(){return this.Pi}getRemoteDocumentCache(){return this.remoteDocumentCache}getBundleCache(){return this.Ii}runTransaction(e,n,i){Ae("MemoryPersistence","Starting transaction:",e);const a=new p5(this.ci.next());return this.referenceDelegate.Ei(),i(a).next((l=>this.referenceDelegate.di(a).next((()=>l)))).toPromise().then((l=>(a.raiseOnCommittedEvent(),l)))}Ai(e,n){return be.or(Object.values(this.ui).map((i=>()=>i.containsKey(e,n))))}}class p5 extends Fj{constructor(e){super(),this.currentSequenceNumber=e}}class ty{constructor(e){this.persistence=e,this.Ri=new ey,this.Vi=null}static mi(e){return new ty(e)}get fi(){if(this.Vi)return this.Vi;throw Pe(60996)}addReference(e,n,i){return this.Ri.addReference(i,n),this.fi.delete(i.toString()),be.resolve()}removeReference(e,n,i){return this.Ri.removeReference(i,n),this.fi.add(i.toString()),be.resolve()}markPotentiallyOrphaned(e,n){return this.fi.add(n.toString()),be.resolve()}removeTarget(e,n){this.Ri.jr(n.targetId).forEach((a=>this.fi.add(a.toString())));const i=this.persistence.getTargetCache();return i.getMatchingKeysForTargetId(e,n.targetId).next((a=>{a.forEach((l=>this.fi.add(l.toString())))})).next((()=>i.removeTargetData(e,n)))}Ei(){this.Vi=new Set}di(e){const n=this.persistence.getRemoteDocumentCache().newChangeBuffer();return be.forEach(this.fi,(i=>{const a=je.fromPath(i);return this.gi(e,a).next((l=>{l||n.removeEntry(a,Ue.min())}))})).next((()=>(this.Vi=null,n.apply(e))))}updateLimboDocument(e,n){return this.gi(e,n).next((i=>{i?this.fi.delete(n.toString()):this.fi.add(n.toString())}))}Ti(e){return 0}gi(e,n){return be.or([()=>be.resolve(this.Ri.containsKey(n)),()=>this.persistence.getTargetCache().containsKey(e,n),()=>this.persistence.Ai(e,n)])}}class Oh{constructor(e,n){this.persistence=e,this.pi=new Ha((i=>Hj(i.path)),((i,a)=>i.isEqual(a))),this.garbageCollector=i5(this,n)}static mi(e,n){return new Oh(e,n)}Ei(){}di(e){return be.resolve()}forEachTarget(e,n){return this.persistence.getTargetCache().forEachTarget(e,n)}gr(e){const n=this.wr(e);return this.persistence.getTargetCache().getTargetCount(e).next((i=>n.next((a=>i+a))))}wr(e){let n=0;return this.pr(e,(i=>{n++})).next((()=>n))}pr(e,n){return be.forEach(this.pi,((i,a)=>this.br(e,i,a).next((l=>l?be.resolve():n(a)))))}removeTargets(e,n,i){return this.persistence.getTargetCache().removeTargets(e,n,i)}removeOrphanedDocuments(e,n){let i=0;const a=this.persistence.getRemoteDocumentCache(),l=a.newChangeBuffer();return a.ii(e,(u=>this.br(e,u,n).next((h=>{h||(i++,l.removeEntry(u,Ue.min()))})))).next((()=>l.apply(e))).next((()=>i))}markPotentiallyOrphaned(e,n){return this.pi.set(n,e.currentSequenceNumber),be.resolve()}removeTarget(e,n){const i=n.withSequenceNumber(e.currentSequenceNumber);return this.persistence.getTargetCache().updateTargetData(e,i)}addReference(e,n,i){return this.pi.set(i,e.currentSequenceNumber),be.resolve()}removeReference(e,n,i){return this.pi.set(i,e.currentSequenceNumber),be.resolve()}updateLimboDocument(e,n){return this.pi.set(n,e.currentSequenceNumber),be.resolve()}Ti(e){let n=e.key.toString().length;return e.isFoundDocument()&&(n+=lh(e.data.value)),n}br(e,n,i){return be.or([()=>this.persistence.Ai(e,n),()=>this.persistence.getTargetCache().containsKey(e,n),()=>{const a=this.pi.get(n);return be.resolve(a!==void 0&&a>i)}])}getCacheSize(e){return this.persistence.getRemoteDocumentCache().getSize(e)}}class ny{constructor(e,n,i,a){this.targetId=e,this.fromCache=n,this.Es=i,this.ds=a}static As(e,n){let i=et(),a=et();for(const l of n.docChanges)switch(l.type){case 0:i=i.add(l.doc.key);break;case 1:a=a.add(l.doc.key)}return new ny(e,n.fromCache,i,a)}}class g5{constructor(){this._documentReadCount=0}get documentReadCount(){return this._documentReadCount}incrementDocumentReadCount(e){this._documentReadCount+=e}}class y5{constructor(){this.Rs=!1,this.Vs=!1,this.fs=100,this.gs=(function(){return aI()?8:qj(In())>0?6:4})()}initialize(e,n){this.ps=e,this.indexManager=n,this.Rs=!0}getDocumentsMatchingQuery(e,n,i,a){const l={result:null};return this.ys(e,n).next((u=>{l.result=u})).next((()=>{if(!l.result)return this.ws(e,n,a,i).next((u=>{l.result=u}))})).next((()=>{if(l.result)return;const u=new g5;return this.Ss(e,n,u).next((h=>{if(l.result=h,this.Vs)return this.bs(e,n,u,h.size)}))})).next((()=>l.result))}bs(e,n,i,a){return i.documentReadCount<this.fs?(qo()<=Je.DEBUG&&Ae("QueryEngine","SDK will not create cache indexes for query:",Go(n),"since it only creates cache indexes for collection contains","more than or equal to",this.fs,"documents"),be.resolve()):(qo()<=Je.DEBUG&&Ae("QueryEngine","Query:",Go(n),"scans",i.documentReadCount,"local documents and returns",a,"documents as results."),i.documentReadCount>this.gs*a?(qo()<=Je.DEBUG&&Ae("QueryEngine","The SDK decides to create cache indexes for query:",Go(n),"as using cache indexes may help improve performance."),this.indexManager.createTargetIndexes(e,hi(n))):be.resolve())}ys(e,n){if(px(n))return be.resolve(null);let i=hi(n);return this.indexManager.getIndexType(e,i).next((a=>a===0?null:(n.limit!==null&&a===1&&(n=og(n,null,"F"),i=hi(n)),this.indexManager.getDocumentsMatchingTarget(e,i).next((l=>{const u=et(...l);return this.ps.getDocuments(e,u).next((h=>this.indexManager.getMinOffset(e,i).next((m=>{const g=this.Ds(n,h);return this.Cs(n,g,u,m.readTime)?this.ys(e,og(n,null,"F")):this.vs(e,g,n,m)}))))})))))}ws(e,n,i,a){return px(n)||a.isEqual(Ue.min())?be.resolve(null):this.ps.getDocuments(e,i).next((l=>{const u=this.Ds(n,l);return this.Cs(n,u,i,a)?be.resolve(null):(qo()<=Je.DEBUG&&Ae("QueryEngine","Re-using previous result from %s to execute query: %s",a.toString(),Go(n)),this.vs(e,u,n,Vj(a,Xc)).next((h=>h)))}))}Ds(e,n){let i=new on(uw(e));return n.forEach(((a,l)=>{ef(e,l)&&(i=i.add(l))})),i}Cs(e,n,i,a){if(e.limit===null)return!1;if(i.size!==n.size)return!0;const l=e.limitType==="F"?n.last():n.first();return!!l&&(l.hasPendingWrites||l.version.compareTo(a)>0)}Ss(e,n,i){return qo()<=Je.DEBUG&&Ae("QueryEngine","Using full collection scan to execute query:",Go(n)),this.ps.getDocumentsMatchingQuery(e,n,Ws.min(),i)}vs(e,n,i,a){return this.ps.getDocumentsMatchingQuery(e,i,a).next((l=>(n.forEach((u=>{l=l.insert(u.key,u)})),l)))}}const ry="LocalStore",_5=3e8;class v5{constructor(e,n,i,a){this.persistence=e,this.Fs=n,this.serializer=a,this.Ms=new It(Ze),this.xs=new Ha((l=>Qg(l)),$g),this.Os=new Map,this.Ns=e.getRemoteDocumentCache(),this.Pi=e.getTargetCache(),this.Ii=e.getBundleCache(),this.Bs(i)}Bs(e){this.documentOverlayCache=this.persistence.getDocumentOverlayCache(e),this.indexManager=this.persistence.getIndexManager(e),this.mutationQueue=this.persistence.getMutationQueue(e,this.indexManager),this.localDocuments=new o5(this.Ns,this.mutationQueue,this.documentOverlayCache,this.indexManager),this.Ns.setIndexManager(this.indexManager),this.Fs.initialize(this.localDocuments,this.indexManager)}collectGarbage(e){return this.persistence.runTransaction("Collect garbage","readwrite-primary",(n=>e.collect(n,this.Ms)))}}function b5(t,e,n,i){return new v5(t,e,n,i)}async function Mw(t,e){const n=Fe(t);return await n.persistence.runTransaction("Handle user change","readonly",(i=>{let a;return n.mutationQueue.getAllMutationBatches(i).next((l=>(a=l,n.Bs(e),n.mutationQueue.getAllMutationBatches(i)))).next((l=>{const u=[],h=[];let m=et();for(const g of a){u.push(g.batchId);for(const _ of g.mutations)m=m.add(_.key)}for(const g of l){h.push(g.batchId);for(const _ of g.mutations)m=m.add(_.key)}return n.localDocuments.getDocuments(i,m).next((g=>({Ls:g,removedBatchIds:u,addedBatchIds:h})))}))}))}function x5(t,e){const n=Fe(t);return n.persistence.runTransaction("Acknowledge batch","readwrite-primary",(i=>{const a=e.batch.keys(),l=n.Ns.newChangeBuffer({trackRemovals:!0});return(function(h,m,g,_){const v=g.batch,b=v.keys();let w=be.resolve();return b.forEach((C=>{w=w.next((()=>_.getEntry(m,C))).next((R=>{const N=g.docVersions.get(C);ct(N!==null,48541),R.version.compareTo(N)<0&&(v.applyToRemoteDocument(R,g),R.isValidDocument()&&(R.setReadTime(g.commitVersion),_.addEntry(R)))}))})),w.next((()=>h.mutationQueue.removeMutationBatch(m,v)))})(n,i,e,l).next((()=>l.apply(i))).next((()=>n.mutationQueue.performConsistencyCheck(i))).next((()=>n.documentOverlayCache.removeOverlaysForBatchId(i,a,e.batch.batchId))).next((()=>n.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(i,(function(h){let m=et();for(let g=0;g<h.mutationResults.length;++g)h.mutationResults[g].transformResults.length>0&&(m=m.add(h.batch.mutations[g].key));return m})(e)))).next((()=>n.localDocuments.getDocuments(i,a)))}))}function kw(t){const e=Fe(t);return e.persistence.runTransaction("Get last remote snapshot version","readonly",(n=>e.Pi.getLastRemoteSnapshotVersion(n)))}function E5(t,e){const n=Fe(t),i=e.snapshotVersion;let a=n.Ms;return n.persistence.runTransaction("Apply remote event","readwrite-primary",(l=>{const u=n.Ns.newChangeBuffer({trackRemovals:!0});a=n.Ms;const h=[];e.targetChanges.forEach(((_,v)=>{const b=a.get(v);if(!b)return;h.push(n.Pi.removeMatchingKeys(l,_.removedDocuments,v).next((()=>n.Pi.addMatchingKeys(l,_.addedDocuments,v))));let w=b.withSequenceNumber(l.currentSequenceNumber);e.targetMismatches.get(v)!==null?w=w.withResumeToken(wn.EMPTY_BYTE_STRING,Ue.min()).withLastLimboFreeSnapshotVersion(Ue.min()):_.resumeToken.approximateByteSize()>0&&(w=w.withResumeToken(_.resumeToken,i)),a=a.insert(v,w),(function(R,N,B){return R.resumeToken.approximateByteSize()===0||N.snapshotVersion.toMicroseconds()-R.snapshotVersion.toMicroseconds()>=_5?!0:B.addedDocuments.size+B.modifiedDocuments.size+B.removedDocuments.size>0})(b,w,_)&&h.push(n.Pi.updateTargetData(l,w))}));let m=Wi(),g=et();if(e.documentUpdates.forEach((_=>{e.resolvedLimboDocuments.has(_)&&h.push(n.persistence.referenceDelegate.updateLimboDocument(l,_))})),h.push(S5(l,u,e.documentUpdates).next((_=>{m=_.ks,g=_.qs}))),!i.isEqual(Ue.min())){const _=n.Pi.getLastRemoteSnapshotVersion(l).next((v=>n.Pi.setTargetsMetadata(l,l.currentSequenceNumber,i)));h.push(_)}return be.waitFor(h).next((()=>u.apply(l))).next((()=>n.localDocuments.getLocalViewOfDocuments(l,m,g))).next((()=>m))})).then((l=>(n.Ms=a,l)))}function S5(t,e,n){let i=et(),a=et();return n.forEach((l=>i=i.add(l))),e.getEntries(t,i).next((l=>{let u=Wi();return n.forEach(((h,m)=>{const g=l.get(h);m.isFoundDocument()!==g.isFoundDocument()&&(a=a.add(h)),m.isNoDocument()&&m.version.isEqual(Ue.min())?(e.removeEntry(h,m.readTime),u=u.insert(h,m)):!g.isValidDocument()||m.version.compareTo(g.version)>0||m.version.compareTo(g.version)===0&&g.hasPendingWrites?(e.addEntry(m),u=u.insert(h,m)):Ae(ry,"Ignoring outdated watch update for ",h,". Current version:",g.version," Watch version:",m.version)})),{ks:u,qs:a}}))}function w5(t,e){const n=Fe(t);return n.persistence.runTransaction("Get next mutation batch","readonly",(i=>(e===void 0&&(e=qg),n.mutationQueue.getNextMutationBatchAfterBatchId(i,e))))}function T5(t,e){const n=Fe(t);return n.persistence.runTransaction("Allocate target","readwrite",(i=>{let a;return n.Pi.getTargetData(i,e).next((l=>l?(a=l,be.resolve(a)):n.Pi.allocateTargetId(i).next((u=>(a=new Us(e,u,"TargetPurposeListen",i.currentSequenceNumber),n.Pi.addTargetData(i,a).next((()=>a)))))))})).then((i=>{const a=n.Ms.get(i.targetId);return(a===null||i.snapshotVersion.compareTo(a.snapshotVersion)>0)&&(n.Ms=n.Ms.insert(i.targetId,i),n.xs.set(e,i.targetId)),i}))}async function hg(t,e,n){const i=Fe(t),a=i.Ms.get(e),l=n?"readwrite":"readwrite-primary";try{n||await i.persistence.runTransaction("Release target",l,(u=>i.persistence.referenceDelegate.removeTarget(u,a)))}catch(u){if(!El(u))throw u;Ae(ry,`Failed to update sequence numbers for target ${e}: ${u}`)}i.Ms=i.Ms.remove(e),i.xs.delete(a.target)}function Rx(t,e,n){const i=Fe(t);let a=Ue.min(),l=et();return i.persistence.runTransaction("Execute query","readwrite",(u=>(function(m,g,_){const v=Fe(m),b=v.xs.get(_);return b!==void 0?be.resolve(v.Ms.get(b)):v.Pi.getTargetData(g,_)})(i,u,hi(e)).next((h=>{if(h)return a=h.lastLimboFreeSnapshotVersion,i.Pi.getMatchingKeysForTargetId(u,h.targetId).next((m=>{l=m}))})).next((()=>i.Fs.getDocumentsMatchingQuery(u,e,n?a:Ue.min(),n?l:et()))).next((h=>(A5(i,u2(e),h),{documents:h,Qs:l})))))}function A5(t,e,n){let i=t.Os.get(e)||Ue.min();n.forEach(((a,l)=>{l.readTime.compareTo(i)>0&&(i=l.readTime)})),t.Os.set(e,i)}class Dx{constructor(){this.activeTargetIds=g2()}zs(e){this.activeTargetIds=this.activeTargetIds.add(e)}js(e){this.activeTargetIds=this.activeTargetIds.delete(e)}Gs(){const e={activeTargetIds:this.activeTargetIds.toArray(),updateTimeMs:Date.now()};return JSON.stringify(e)}}class C5{constructor(){this.Mo=new Dx,this.xo={},this.onlineStateHandler=null,this.sequenceNumberHandler=null}addPendingMutation(e){}updateMutationState(e,n,i){}addLocalQueryTarget(e,n=!0){return n&&this.Mo.zs(e),this.xo[e]||"not-current"}updateQueryState(e,n,i){this.xo[e]=n}removeLocalQueryTarget(e){this.Mo.js(e)}isLocalQueryTarget(e){return this.Mo.activeTargetIds.has(e)}clearQueryState(e){delete this.xo[e]}getAllActiveQueryTargets(){return this.Mo.activeTargetIds}isActiveQueryTarget(e){return this.Mo.activeTargetIds.has(e)}start(){return this.Mo=new Dx,Promise.resolve()}handleUserChange(e,n,i){}setOnlineState(e){}shutdown(){}writeSequenceNumber(e){}notifyBundleLoaded(e){}}class R5{Oo(e){}shutdown(){}}const Ix="ConnectivityMonitor";class jx{constructor(){this.No=()=>this.Bo(),this.Lo=()=>this.ko(),this.qo=[],this.Qo()}Oo(e){this.qo.push(e)}shutdown(){window.removeEventListener("online",this.No),window.removeEventListener("offline",this.Lo)}Qo(){window.addEventListener("online",this.No),window.addEventListener("offline",this.Lo)}Bo(){Ae(Ix,"Network connectivity changed: AVAILABLE");for(const e of this.qo)e(0)}ko(){Ae(Ix,"Network connectivity changed: UNAVAILABLE");for(const e of this.qo)e(1)}static v(){return typeof window<"u"&&window.addEventListener!==void 0&&window.removeEventListener!==void 0}}let rh=null;function fg(){return rh===null?rh=(function(){return 268435456+Math.round(2147483648*Math.random())})():rh++,"0x"+rh.toString(16)}const Op="RestConnection",D5={BatchGetDocuments:"batchGet",Commit:"commit",RunQuery:"runQuery",RunAggregationQuery:"runAggregationQuery"};class I5{get $o(){return!1}constructor(e){this.databaseInfo=e,this.databaseId=e.databaseId;const n=e.ssl?"https":"http",i=encodeURIComponent(this.databaseId.projectId),a=encodeURIComponent(this.databaseId.database);this.Uo=n+"://"+e.host,this.Ko=`projects/${i}/databases/${a}`,this.Wo=this.databaseId.database===Th?`project_id=${i}`:`project_id=${i}&database_id=${a}`}Go(e,n,i,a,l){const u=fg(),h=this.zo(e,n.toUriEncodedString());Ae(Op,`Sending RPC '${e}' ${u}:`,h,i);const m={"google-cloud-resource-prefix":this.Ko,"x-goog-request-params":this.Wo};this.jo(m,a,l);const{host:g}=new URL(h),_=_l(g);return this.Jo(e,h,m,i,_).then((v=>(Ae(Op,`Received RPC '${e}' ${u}: `,v),v)),(v=>{throw nl(Op,`RPC '${e}' ${u} failed with error: `,v,"url: ",h,"request:",i),v}))}Ho(e,n,i,a,l,u){return this.Go(e,n,i,a,l)}jo(e,n,i){e["X-Goog-Api-Client"]=(function(){return"gl-js/ fire/"+bl})(),e["Content-Type"]="text/plain",this.databaseInfo.appId&&(e["X-Firebase-GMPID"]=this.databaseInfo.appId),n&&n.headers.forEach(((a,l)=>e[l]=a)),i&&i.headers.forEach(((a,l)=>e[l]=a))}zo(e,n){const i=D5[e];return`${this.Uo}/v1/${n}:${i}`}terminate(){}}class j5{constructor(e){this.Yo=e.Yo,this.Zo=e.Zo}Xo(e){this.e_=e}t_(e){this.n_=e}r_(e){this.i_=e}onMessage(e){this.s_=e}close(){this.Zo()}send(e){this.Yo(e)}o_(){this.e_()}__(){this.n_()}a_(e){this.i_(e)}u_(e){this.s_(e)}}const Cn="WebChannelConnection";class O5 extends I5{constructor(e){super(e),this.c_=[],this.forceLongPolling=e.forceLongPolling,this.autoDetectLongPolling=e.autoDetectLongPolling,this.useFetchStreams=e.useFetchStreams,this.longPollingOptions=e.longPollingOptions}Jo(e,n,i,a,l){const u=fg();return new Promise(((h,m)=>{const g=new LS;g.setWithCredentials(!0),g.listenOnce(VS.COMPLETE,(()=>{try{switch(g.getLastErrorCode()){case oh.NO_ERROR:const v=g.getResponseJson();Ae(Cn,`XHR for RPC '${e}' ${u} received:`,JSON.stringify(v)),h(v);break;case oh.TIMEOUT:Ae(Cn,`RPC '${e}' ${u} timed out`),m(new Te(ve.DEADLINE_EXCEEDED,"Request time out"));break;case oh.HTTP_ERROR:const b=g.getStatus();if(Ae(Cn,`RPC '${e}' ${u} failed with status:`,b,"response text:",g.getResponseText()),b>0){let w=g.getResponseJson();Array.isArray(w)&&(w=w[0]);const C=w?.error;if(C&&C.status&&C.message){const R=(function(B){const H=B.toLowerCase().replace(/_/g,"-");return Object.values(ve).indexOf(H)>=0?H:ve.UNKNOWN})(C.status);m(new Te(R,C.message))}else m(new Te(ve.UNKNOWN,"Server responded with status "+g.getStatus()))}else m(new Te(ve.UNAVAILABLE,"Connection failed."));break;default:Pe(9055,{l_:e,streamId:u,h_:g.getLastErrorCode(),P_:g.getLastError()})}}finally{Ae(Cn,`RPC '${e}' ${u} completed.`)}}));const _=JSON.stringify(a);Ae(Cn,`RPC '${e}' ${u} sending request:`,a),g.send(n,"POST",_,i,15)}))}T_(e,n,i){const a=fg(),l=[this.Uo,"/","google.firestore.v1.Firestore","/",e,"/channel"],u=BS(),h=US(),m={httpSessionIdParam:"gsessionid",initMessageHeaders:{},messageUrlParams:{database:`projects/${this.databaseId.projectId}/databases/${this.databaseId.database}`},sendRawJson:!0,supportsCrossDomainXhr:!0,internalChannelParams:{forwardChannelRequestTimeoutMs:6e5},forceLongPolling:this.forceLongPolling,detectBufferingProxy:this.autoDetectLongPolling},g=this.longPollingOptions.timeoutSeconds;g!==void 0&&(m.longPollingTimeout=Math.round(1e3*g)),this.useFetchStreams&&(m.useFetchStreams=!0),this.jo(m.initMessageHeaders,n,i),m.encodeInitMessageHeaders=!0;const _=l.join("");Ae(Cn,`Creating RPC '${e}' stream ${a}: ${_}`,m);const v=u.createWebChannel(_,m);this.I_(v);let b=!1,w=!1;const C=new j5({Yo:N=>{w?Ae(Cn,`Not sending because RPC '${e}' stream ${a} is closed:`,N):(b||(Ae(Cn,`Opening RPC '${e}' stream ${a} transport.`),v.open(),b=!0),Ae(Cn,`RPC '${e}' stream ${a} sending:`,N),v.send(N))},Zo:()=>v.close()}),R=(N,B,H)=>{N.listen(B,(F=>{try{H(F)}catch(ae){setTimeout((()=>{throw ae}),0)}}))};return R(v,Vc.EventType.OPEN,(()=>{w||(Ae(Cn,`RPC '${e}' stream ${a} transport opened.`),C.o_())})),R(v,Vc.EventType.CLOSE,(()=>{w||(w=!0,Ae(Cn,`RPC '${e}' stream ${a} transport closed`),C.a_(),this.E_(v))})),R(v,Vc.EventType.ERROR,(N=>{w||(w=!0,nl(Cn,`RPC '${e}' stream ${a} transport errored. Name:`,N.name,"Message:",N.message),C.a_(new Te(ve.UNAVAILABLE,"The operation could not be completed")))})),R(v,Vc.EventType.MESSAGE,(N=>{if(!w){const B=N.data[0];ct(!!B,16349);const H=B,F=H?.error||H[0]?.error;if(F){Ae(Cn,`RPC '${e}' stream ${a} received error:`,F);const ae=F.status;let te=(function(I){const D=Zt[I];if(D!==void 0)return xw(D)})(ae),he=F.message;te===void 0&&(te=ve.INTERNAL,he="Unknown error status: "+ae+" with message "+F.message),w=!0,C.a_(new Te(te,he)),v.close()}else Ae(Cn,`RPC '${e}' stream ${a} received:`,B),C.u_(B)}})),R(h,zS.STAT_EVENT,(N=>{N.stat===eg.PROXY?Ae(Cn,`RPC '${e}' stream ${a} detected buffering proxy`):N.stat===eg.NOPROXY&&Ae(Cn,`RPC '${e}' stream ${a} detected no buffering proxy`)})),setTimeout((()=>{C.__()}),0),C}terminate(){this.c_.forEach((e=>e.close())),this.c_=[]}I_(e){this.c_.push(e)}E_(e){this.c_=this.c_.filter((n=>n===e))}}function Mp(){return typeof document<"u"?document:null}function sf(t){return new P2(t,!0)}class Nw{constructor(e,n,i=1e3,a=1.5,l=6e4){this.Mi=e,this.timerId=n,this.d_=i,this.A_=a,this.R_=l,this.V_=0,this.m_=null,this.f_=Date.now(),this.reset()}reset(){this.V_=0}g_(){this.V_=this.R_}p_(e){this.cancel();const n=Math.floor(this.V_+this.y_()),i=Math.max(0,Date.now()-this.f_),a=Math.max(0,n-i);a>0&&Ae("ExponentialBackoff",`Backing off for ${a} ms (base delay: ${this.V_} ms, delay with jitter: ${n} ms, last attempt: ${i} ms ago)`),this.m_=this.Mi.enqueueAfterDelay(this.timerId,a,(()=>(this.f_=Date.now(),e()))),this.V_*=this.A_,this.V_<this.d_&&(this.V_=this.d_),this.V_>this.R_&&(this.V_=this.R_)}w_(){this.m_!==null&&(this.m_.skipDelay(),this.m_=null)}cancel(){this.m_!==null&&(this.m_.cancel(),this.m_=null)}y_(){return(Math.random()-.5)*this.V_}}const Ox="PersistentStream";class Pw{constructor(e,n,i,a,l,u,h,m){this.Mi=e,this.S_=i,this.b_=a,this.connection=l,this.authCredentialsProvider=u,this.appCheckCredentialsProvider=h,this.listener=m,this.state=0,this.D_=0,this.C_=null,this.v_=null,this.stream=null,this.F_=0,this.M_=new Nw(e,n)}x_(){return this.state===1||this.state===5||this.O_()}O_(){return this.state===2||this.state===3}start(){this.F_=0,this.state!==4?this.auth():this.N_()}async stop(){this.x_()&&await this.close(0)}B_(){this.state=0,this.M_.reset()}L_(){this.O_()&&this.C_===null&&(this.C_=this.Mi.enqueueAfterDelay(this.S_,6e4,(()=>this.k_())))}q_(e){this.Q_(),this.stream.send(e)}async k_(){if(this.O_())return this.close(0)}Q_(){this.C_&&(this.C_.cancel(),this.C_=null)}U_(){this.v_&&(this.v_.cancel(),this.v_=null)}async close(e,n){this.Q_(),this.U_(),this.M_.cancel(),this.D_++,e!==4?this.M_.reset():n&&n.code===ve.RESOURCE_EXHAUSTED?(Ki(n.toString()),Ki("Using maximum backoff delay to prevent overloading the backend."),this.M_.g_()):n&&n.code===ve.UNAUTHENTICATED&&this.state!==3&&(this.authCredentialsProvider.invalidateToken(),this.appCheckCredentialsProvider.invalidateToken()),this.stream!==null&&(this.K_(),this.stream.close(),this.stream=null),this.state=e,await this.listener.r_(n)}K_(){}auth(){this.state=1;const e=this.W_(this.D_),n=this.D_;Promise.all([this.authCredentialsProvider.getToken(),this.appCheckCredentialsProvider.getToken()]).then((([i,a])=>{this.D_===n&&this.G_(i,a)}),(i=>{e((()=>{const a=new Te(ve.UNKNOWN,"Fetching auth token failed: "+i.message);return this.z_(a)}))}))}G_(e,n){const i=this.W_(this.D_);this.stream=this.j_(e,n),this.stream.Xo((()=>{i((()=>this.listener.Xo()))})),this.stream.t_((()=>{i((()=>(this.state=2,this.v_=this.Mi.enqueueAfterDelay(this.b_,1e4,(()=>(this.O_()&&(this.state=3),Promise.resolve()))),this.listener.t_())))})),this.stream.r_((a=>{i((()=>this.z_(a)))})),this.stream.onMessage((a=>{i((()=>++this.F_==1?this.J_(a):this.onNext(a)))}))}N_(){this.state=5,this.M_.p_((async()=>{this.state=0,this.start()}))}z_(e){return Ae(Ox,`close with error: ${e}`),this.stream=null,this.close(4,e)}W_(e){return n=>{this.Mi.enqueueAndForget((()=>this.D_===e?n():(Ae(Ox,"stream callback skipped by getCloseGuardedDispatcher."),Promise.resolve())))}}}class M5 extends Pw{constructor(e,n,i,a,l,u){super(e,"listen_stream_connection_backoff","listen_stream_idle","health_check_timeout",n,i,a,u),this.serializer=l}j_(e,n){return this.connection.T_("Listen",e,n)}J_(e){return this.onNext(e)}onNext(e){this.M_.reset();const n=z2(this.serializer,e),i=(function(l){if(!("targetChange"in l))return Ue.min();const u=l.targetChange;return u.targetIds&&u.targetIds.length?Ue.min():u.readTime?fi(u.readTime):Ue.min()})(e);return this.listener.H_(n,i)}Y_(e){const n={};n.database=dg(this.serializer),n.addTarget=(function(l,u){let h;const m=u.target;if(h=sg(m)?{documents:F2(l,m)}:{query:q2(l,m).ft},h.targetId=u.targetId,u.resumeToken.approximateByteSize()>0){h.resumeToken=ww(l,u.resumeToken);const g=lg(l,u.expectedCount);g!==null&&(h.expectedCount=g)}else if(u.snapshotVersion.compareTo(Ue.min())>0){h.readTime=jh(l,u.snapshotVersion.toTimestamp());const g=lg(l,u.expectedCount);g!==null&&(h.expectedCount=g)}return h})(this.serializer,e);const i=H2(this.serializer,e);i&&(n.labels=i),this.q_(n)}Z_(e){const n={};n.database=dg(this.serializer),n.removeTarget=e,this.q_(n)}}class k5 extends Pw{constructor(e,n,i,a,l,u){super(e,"write_stream_connection_backoff","write_stream_idle","health_check_timeout",n,i,a,u),this.serializer=l}get X_(){return this.F_>0}start(){this.lastStreamToken=void 0,super.start()}K_(){this.X_&&this.ea([])}j_(e,n){return this.connection.T_("Write",e,n)}J_(e){return ct(!!e.streamToken,31322),this.lastStreamToken=e.streamToken,ct(!e.writeResults||e.writeResults.length===0,55816),this.listener.ta()}onNext(e){ct(!!e.streamToken,12678),this.lastStreamToken=e.streamToken,this.M_.reset();const n=B2(e.writeResults,e.commitTime),i=fi(e.commitTime);return this.listener.na(i,n)}ra(){const e={};e.database=dg(this.serializer),this.q_(e)}ea(e){const n={streamToken:this.lastStreamToken,writes:e.map((i=>U2(this.serializer,i)))};this.q_(n)}}class N5{}class P5 extends N5{constructor(e,n,i,a){super(),this.authCredentials=e,this.appCheckCredentials=n,this.connection=i,this.serializer=a,this.ia=!1}sa(){if(this.ia)throw new Te(ve.FAILED_PRECONDITION,"The client has already been terminated.")}Go(e,n,i,a){return this.sa(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then((([l,u])=>this.connection.Go(e,cg(n,i),a,l,u))).catch((l=>{throw l.name==="FirebaseError"?(l.code===ve.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),l):new Te(ve.UNKNOWN,l.toString())}))}Ho(e,n,i,a,l){return this.sa(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then((([u,h])=>this.connection.Ho(e,cg(n,i),a,u,h,l))).catch((u=>{throw u.name==="FirebaseError"?(u.code===ve.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),u):new Te(ve.UNKNOWN,u.toString())}))}terminate(){this.ia=!0,this.connection.terminate()}}class L5{constructor(e,n){this.asyncQueue=e,this.onlineStateHandler=n,this.state="Unknown",this.oa=0,this._a=null,this.aa=!0}ua(){this.oa===0&&(this.ca("Unknown"),this._a=this.asyncQueue.enqueueAfterDelay("online_state_timeout",1e4,(()=>(this._a=null,this.la("Backend didn't respond within 10 seconds."),this.ca("Offline"),Promise.resolve()))))}ha(e){this.state==="Online"?this.ca("Unknown"):(this.oa++,this.oa>=1&&(this.Pa(),this.la(`Connection failed 1 times. Most recent error: ${e.toString()}`),this.ca("Offline")))}set(e){this.Pa(),this.oa=0,e==="Online"&&(this.aa=!1),this.ca(e)}ca(e){e!==this.state&&(this.state=e,this.onlineStateHandler(e))}la(e){const n=`Could not reach Cloud Firestore backend. ${e}
This typically indicates that your device does not have a healthy Internet connection at the moment. The client will operate in offline mode until it is able to successfully connect to the backend.`;this.aa?(Ki(n),this.aa=!1):Ae("OnlineStateTracker",n)}Pa(){this._a!==null&&(this._a.cancel(),this._a=null)}}const Ba="RemoteStore";class V5{constructor(e,n,i,a,l){this.localStore=e,this.datastore=n,this.asyncQueue=i,this.remoteSyncer={},this.Ta=[],this.Ia=new Map,this.Ea=new Set,this.da=[],this.Aa=l,this.Aa.Oo((u=>{i.enqueueAndForget((async()=>{Qa(this)&&(Ae(Ba,"Restarting streams for network reachability change."),await(async function(m){const g=Fe(m);g.Ea.add(4),await gu(g),g.Ra.set("Unknown"),g.Ea.delete(4),await af(g)})(this))}))})),this.Ra=new L5(i,a)}}async function af(t){if(Qa(t))for(const e of t.da)await e(!0)}async function gu(t){for(const e of t.da)await e(!1)}function Lw(t,e){const n=Fe(t);n.Ia.has(e.targetId)||(n.Ia.set(e.targetId,e),oy(n)?ay(n):Sl(n).O_()&&sy(n,e))}function iy(t,e){const n=Fe(t),i=Sl(n);n.Ia.delete(e),i.O_()&&Vw(n,e),n.Ia.size===0&&(i.O_()?i.L_():Qa(n)&&n.Ra.set("Unknown"))}function sy(t,e){if(t.Va.Ue(e.targetId),e.resumeToken.approximateByteSize()>0||e.snapshotVersion.compareTo(Ue.min())>0){const n=t.remoteSyncer.getRemoteKeysForTarget(e.targetId).size;e=e.withExpectedCount(n)}Sl(t).Y_(e)}function Vw(t,e){t.Va.Ue(e),Sl(t).Z_(e)}function ay(t){t.Va=new O2({getRemoteKeysForTarget:e=>t.remoteSyncer.getRemoteKeysForTarget(e),At:e=>t.Ia.get(e)||null,ht:()=>t.datastore.serializer.databaseId}),Sl(t).start(),t.Ra.ua()}function oy(t){return Qa(t)&&!Sl(t).x_()&&t.Ia.size>0}function Qa(t){return Fe(t).Ea.size===0}function zw(t){t.Va=void 0}async function z5(t){t.Ra.set("Online")}async function U5(t){t.Ia.forEach(((e,n)=>{sy(t,e)}))}async function B5(t,e){zw(t),oy(t)?(t.Ra.ha(e),ay(t)):t.Ra.set("Unknown")}async function F5(t,e,n){if(t.Ra.set("Online"),e instanceof Sw&&e.state===2&&e.cause)try{await(async function(a,l){const u=l.cause;for(const h of l.targetIds)a.Ia.has(h)&&(await a.remoteSyncer.rejectListen(h,u),a.Ia.delete(h),a.Va.removeTarget(h))})(t,e)}catch(i){Ae(Ba,"Failed to remove targets %s: %s ",e.targetIds.join(","),i),await Mh(t,i)}else if(e instanceof dh?t.Va.Ze(e):e instanceof Ew?t.Va.st(e):t.Va.tt(e),!n.isEqual(Ue.min()))try{const i=await kw(t.localStore);n.compareTo(i)>=0&&await(function(l,u){const h=l.Va.Tt(u);return h.targetChanges.forEach(((m,g)=>{if(m.resumeToken.approximateByteSize()>0){const _=l.Ia.get(g);_&&l.Ia.set(g,_.withResumeToken(m.resumeToken,u))}})),h.targetMismatches.forEach(((m,g)=>{const _=l.Ia.get(m);if(!_)return;l.Ia.set(m,_.withResumeToken(wn.EMPTY_BYTE_STRING,_.snapshotVersion)),Vw(l,m);const v=new Us(_.target,m,g,_.sequenceNumber);sy(l,v)})),l.remoteSyncer.applyRemoteEvent(h)})(t,n)}catch(i){Ae(Ba,"Failed to raise snapshot:",i),await Mh(t,i)}}async function Mh(t,e,n){if(!El(e))throw e;t.Ea.add(1),await gu(t),t.Ra.set("Offline"),n||(n=()=>kw(t.localStore)),t.asyncQueue.enqueueRetryable((async()=>{Ae(Ba,"Retrying IndexedDB access"),await n(),t.Ea.delete(1),await af(t)}))}function Uw(t,e){return e().catch((n=>Mh(t,n,e)))}async function of(t){const e=Fe(t),n=Zs(e);let i=e.Ta.length>0?e.Ta[e.Ta.length-1].batchId:qg;for(;q5(e);)try{const a=await w5(e.localStore,i);if(a===null){e.Ta.length===0&&n.L_();break}i=a.batchId,G5(e,a)}catch(a){await Mh(e,a)}Bw(e)&&Fw(e)}function q5(t){return Qa(t)&&t.Ta.length<10}function G5(t,e){t.Ta.push(e);const n=Zs(t);n.O_()&&n.X_&&n.ea(e.mutations)}function Bw(t){return Qa(t)&&!Zs(t).x_()&&t.Ta.length>0}function Fw(t){Zs(t).start()}async function H5(t){Zs(t).ra()}async function Q5(t){const e=Zs(t);for(const n of t.Ta)e.ea(n.mutations)}async function $5(t,e,n){const i=t.Ta.shift(),a=Xg.from(i,e,n);await Uw(t,(()=>t.remoteSyncer.applySuccessfulWrite(a))),await of(t)}async function K5(t,e){e&&Zs(t).X_&&await(async function(i,a){if((function(u){return D2(u)&&u!==ve.ABORTED})(a.code)){const l=i.Ta.shift();Zs(i).B_(),await Uw(i,(()=>i.remoteSyncer.rejectFailedWrite(l.batchId,a))),await of(i)}})(t,e),Bw(t)&&Fw(t)}async function Mx(t,e){const n=Fe(t);n.asyncQueue.verifyOperationInProgress(),Ae(Ba,"RemoteStore received new credentials");const i=Qa(n);n.Ea.add(3),await gu(n),i&&n.Ra.set("Unknown"),await n.remoteSyncer.handleCredentialChange(e),n.Ea.delete(3),await af(n)}async function W5(t,e){const n=Fe(t);e?(n.Ea.delete(2),await af(n)):e||(n.Ea.add(2),await gu(n),n.Ra.set("Unknown"))}function Sl(t){return t.ma||(t.ma=(function(n,i,a){const l=Fe(n);return l.sa(),new M5(i,l.connection,l.authCredentials,l.appCheckCredentials,l.serializer,a)})(t.datastore,t.asyncQueue,{Xo:z5.bind(null,t),t_:U5.bind(null,t),r_:B5.bind(null,t),H_:F5.bind(null,t)}),t.da.push((async e=>{e?(t.ma.B_(),oy(t)?ay(t):t.Ra.set("Unknown")):(await t.ma.stop(),zw(t))}))),t.ma}function Zs(t){return t.fa||(t.fa=(function(n,i,a){const l=Fe(n);return l.sa(),new k5(i,l.connection,l.authCredentials,l.appCheckCredentials,l.serializer,a)})(t.datastore,t.asyncQueue,{Xo:()=>Promise.resolve(),t_:H5.bind(null,t),r_:K5.bind(null,t),ta:Q5.bind(null,t),na:$5.bind(null,t)}),t.da.push((async e=>{e?(t.fa.B_(),await of(t)):(await t.fa.stop(),t.Ta.length>0&&(Ae(Ba,`Stopping write stream with ${t.Ta.length} pending writes`),t.Ta=[]))}))),t.fa}class ly{constructor(e,n,i,a,l){this.asyncQueue=e,this.timerId=n,this.targetTimeMs=i,this.op=a,this.removalCallback=l,this.deferred=new Hi,this.then=this.deferred.promise.then.bind(this.deferred.promise),this.deferred.promise.catch((u=>{}))}get promise(){return this.deferred.promise}static createAndSchedule(e,n,i,a,l){const u=Date.now()+i,h=new ly(e,n,u,a,l);return h.start(i),h}start(e){this.timerHandle=setTimeout((()=>this.handleDelayElapsed()),e)}skipDelay(){return this.handleDelayElapsed()}cancel(e){this.timerHandle!==null&&(this.clearTimeout(),this.deferred.reject(new Te(ve.CANCELLED,"Operation cancelled"+(e?": "+e:""))))}handleDelayElapsed(){this.asyncQueue.enqueueAndForget((()=>this.timerHandle!==null?(this.clearTimeout(),this.op().then((e=>this.deferred.resolve(e)))):Promise.resolve()))}clearTimeout(){this.timerHandle!==null&&(this.removalCallback(this),clearTimeout(this.timerHandle),this.timerHandle=null)}}function cy(t,e){if(Ki("AsyncQueue",`${e}: ${t}`),El(t))return new Te(ve.UNAVAILABLE,`${e}: ${t}`);throw t}class Ko{static emptySet(e){return new Ko(e.comparator)}constructor(e){this.comparator=e?(n,i)=>e(n,i)||je.comparator(n.key,i.key):(n,i)=>je.comparator(n.key,i.key),this.keyedMap=zc(),this.sortedSet=new It(this.comparator)}has(e){return this.keyedMap.get(e)!=null}get(e){return this.keyedMap.get(e)}first(){return this.sortedSet.minKey()}last(){return this.sortedSet.maxKey()}isEmpty(){return this.sortedSet.isEmpty()}indexOf(e){const n=this.keyedMap.get(e);return n?this.sortedSet.indexOf(n):-1}get size(){return this.sortedSet.size}forEach(e){this.sortedSet.inorderTraversal(((n,i)=>(e(n),!1)))}add(e){const n=this.delete(e.key);return n.copy(n.keyedMap.insert(e.key,e),n.sortedSet.insert(e,null))}delete(e){const n=this.get(e);return n?this.copy(this.keyedMap.remove(e),this.sortedSet.remove(n)):this}isEqual(e){if(!(e instanceof Ko)||this.size!==e.size)return!1;const n=this.sortedSet.getIterator(),i=e.sortedSet.getIterator();for(;n.hasNext();){const a=n.getNext().key,l=i.getNext().key;if(!a.isEqual(l))return!1}return!0}toString(){const e=[];return this.forEach((n=>{e.push(n.toString())})),e.length===0?"DocumentSet ()":`DocumentSet (
  `+e.join(`  
`)+`
)`}copy(e,n){const i=new Ko;return i.comparator=this.comparator,i.keyedMap=e,i.sortedSet=n,i}}class kx{constructor(){this.ga=new It(je.comparator)}track(e){const n=e.doc.key,i=this.ga.get(n);i?e.type!==0&&i.type===3?this.ga=this.ga.insert(n,e):e.type===3&&i.type!==1?this.ga=this.ga.insert(n,{type:i.type,doc:e.doc}):e.type===2&&i.type===2?this.ga=this.ga.insert(n,{type:2,doc:e.doc}):e.type===2&&i.type===0?this.ga=this.ga.insert(n,{type:0,doc:e.doc}):e.type===1&&i.type===0?this.ga=this.ga.remove(n):e.type===1&&i.type===2?this.ga=this.ga.insert(n,{type:1,doc:i.doc}):e.type===0&&i.type===1?this.ga=this.ga.insert(n,{type:2,doc:e.doc}):Pe(63341,{Rt:e,pa:i}):this.ga=this.ga.insert(n,e)}ya(){const e=[];return this.ga.inorderTraversal(((n,i)=>{e.push(i)})),e}}class ll{constructor(e,n,i,a,l,u,h,m,g){this.query=e,this.docs=n,this.oldDocs=i,this.docChanges=a,this.mutatedKeys=l,this.fromCache=u,this.syncStateChanged=h,this.excludesMetadataChanges=m,this.hasCachedResults=g}static fromInitialDocuments(e,n,i,a,l){const u=[];return n.forEach((h=>{u.push({type:0,doc:h})})),new ll(e,n,Ko.emptySet(n),u,i,a,!0,!1,l)}get hasPendingWrites(){return!this.mutatedKeys.isEmpty()}isEqual(e){if(!(this.fromCache===e.fromCache&&this.hasCachedResults===e.hasCachedResults&&this.syncStateChanged===e.syncStateChanged&&this.mutatedKeys.isEqual(e.mutatedKeys)&&Zh(this.query,e.query)&&this.docs.isEqual(e.docs)&&this.oldDocs.isEqual(e.oldDocs)))return!1;const n=this.docChanges,i=e.docChanges;if(n.length!==i.length)return!1;for(let a=0;a<n.length;a++)if(n[a].type!==i[a].type||!n[a].doc.isEqual(i[a].doc))return!1;return!0}}class Y5{constructor(){this.wa=void 0,this.Sa=[]}ba(){return this.Sa.some((e=>e.Da()))}}class X5{constructor(){this.queries=Nx(),this.onlineState="Unknown",this.Ca=new Set}terminate(){(function(n,i){const a=Fe(n),l=a.queries;a.queries=Nx(),l.forEach(((u,h)=>{for(const m of h.Sa)m.onError(i)}))})(this,new Te(ve.ABORTED,"Firestore shutting down"))}}function Nx(){return new Ha((t=>cw(t)),Zh)}async function qw(t,e){const n=Fe(t);let i=3;const a=e.query;let l=n.queries.get(a);l?!l.ba()&&e.Da()&&(i=2):(l=new Y5,i=e.Da()?0:1);try{switch(i){case 0:l.wa=await n.onListen(a,!0);break;case 1:l.wa=await n.onListen(a,!1);break;case 2:await n.onFirstRemoteStoreListen(a)}}catch(u){const h=cy(u,`Initialization of query '${Go(e.query)}' failed`);return void e.onError(h)}n.queries.set(a,l),l.Sa.push(e),e.va(n.onlineState),l.wa&&e.Fa(l.wa)&&uy(n)}async function Gw(t,e){const n=Fe(t),i=e.query;let a=3;const l=n.queries.get(i);if(l){const u=l.Sa.indexOf(e);u>=0&&(l.Sa.splice(u,1),l.Sa.length===0?a=e.Da()?0:1:!l.ba()&&e.Da()&&(a=2))}switch(a){case 0:return n.queries.delete(i),n.onUnlisten(i,!0);case 1:return n.queries.delete(i),n.onUnlisten(i,!1);case 2:return n.onLastRemoteStoreUnlisten(i);default:return}}function J5(t,e){const n=Fe(t);let i=!1;for(const a of e){const l=a.query,u=n.queries.get(l);if(u){for(const h of u.Sa)h.Fa(a)&&(i=!0);u.wa=a}}i&&uy(n)}function Z5(t,e,n){const i=Fe(t),a=i.queries.get(e);if(a)for(const l of a.Sa)l.onError(n);i.queries.delete(e)}function uy(t){t.Ca.forEach((e=>{e.next()}))}var mg,Px;(Px=mg||(mg={})).Ma="default",Px.Cache="cache";class Hw{constructor(e,n,i){this.query=e,this.xa=n,this.Oa=!1,this.Na=null,this.onlineState="Unknown",this.options=i||{}}Fa(e){if(!this.options.includeMetadataChanges){const i=[];for(const a of e.docChanges)a.type!==3&&i.push(a);e=new ll(e.query,e.docs,e.oldDocs,i,e.mutatedKeys,e.fromCache,e.syncStateChanged,!0,e.hasCachedResults)}let n=!1;return this.Oa?this.Ba(e)&&(this.xa.next(e),n=!0):this.La(e,this.onlineState)&&(this.ka(e),n=!0),this.Na=e,n}onError(e){this.xa.error(e)}va(e){this.onlineState=e;let n=!1;return this.Na&&!this.Oa&&this.La(this.Na,e)&&(this.ka(this.Na),n=!0),n}La(e,n){if(!e.fromCache||!this.Da())return!0;const i=n!=="Offline";return(!this.options.qa||!i)&&(!e.docs.isEmpty()||e.hasCachedResults||n==="Offline")}Ba(e){if(e.docChanges.length>0)return!0;const n=this.Na&&this.Na.hasPendingWrites!==e.hasPendingWrites;return!(!e.syncStateChanged&&!n)&&this.options.includeMetadataChanges===!0}ka(e){e=ll.fromInitialDocuments(e.query,e.docs,e.mutatedKeys,e.fromCache,e.hasCachedResults),this.Oa=!0,this.xa.next(e)}Da(){return this.options.source!==mg.Cache}}class Qw{constructor(e){this.key=e}}class $w{constructor(e){this.key=e}}class eO{constructor(e,n){this.query=e,this.Ya=n,this.Za=null,this.hasCachedResults=!1,this.current=!1,this.Xa=et(),this.mutatedKeys=et(),this.eu=uw(e),this.tu=new Ko(this.eu)}get nu(){return this.Ya}ru(e,n){const i=n?n.iu:new kx,a=n?n.tu:this.tu;let l=n?n.mutatedKeys:this.mutatedKeys,u=a,h=!1;const m=this.query.limitType==="F"&&a.size===this.query.limit?a.last():null,g=this.query.limitType==="L"&&a.size===this.query.limit?a.first():null;if(e.inorderTraversal(((_,v)=>{const b=a.get(_),w=ef(this.query,v)?v:null,C=!!b&&this.mutatedKeys.has(b.key),R=!!w&&(w.hasLocalMutations||this.mutatedKeys.has(w.key)&&w.hasCommittedMutations);let N=!1;b&&w?b.data.isEqual(w.data)?C!==R&&(i.track({type:3,doc:w}),N=!0):this.su(b,w)||(i.track({type:2,doc:w}),N=!0,(m&&this.eu(w,m)>0||g&&this.eu(w,g)<0)&&(h=!0)):!b&&w?(i.track({type:0,doc:w}),N=!0):b&&!w&&(i.track({type:1,doc:b}),N=!0,(m||g)&&(h=!0)),N&&(w?(u=u.add(w),l=R?l.add(_):l.delete(_)):(u=u.delete(_),l=l.delete(_)))})),this.query.limit!==null)for(;u.size>this.query.limit;){const _=this.query.limitType==="F"?u.last():u.first();u=u.delete(_.key),l=l.delete(_.key),i.track({type:1,doc:_})}return{tu:u,iu:i,Cs:h,mutatedKeys:l}}su(e,n){return e.hasLocalMutations&&n.hasCommittedMutations&&!n.hasLocalMutations}applyChanges(e,n,i,a){const l=this.tu;this.tu=e.tu,this.mutatedKeys=e.mutatedKeys;const u=e.iu.ya();u.sort(((_,v)=>(function(w,C){const R=N=>{switch(N){case 0:return 1;case 2:case 3:return 2;case 1:return 0;default:return Pe(20277,{Rt:N})}};return R(w)-R(C)})(_.type,v.type)||this.eu(_.doc,v.doc))),this.ou(i),a=a??!1;const h=n&&!a?this._u():[],m=this.Xa.size===0&&this.current&&!a?1:0,g=m!==this.Za;return this.Za=m,u.length!==0||g?{snapshot:new ll(this.query,e.tu,l,u,e.mutatedKeys,m===0,g,!1,!!i&&i.resumeToken.approximateByteSize()>0),au:h}:{au:h}}va(e){return this.current&&e==="Offline"?(this.current=!1,this.applyChanges({tu:this.tu,iu:new kx,mutatedKeys:this.mutatedKeys,Cs:!1},!1)):{au:[]}}uu(e){return!this.Ya.has(e)&&!!this.tu.has(e)&&!this.tu.get(e).hasLocalMutations}ou(e){e&&(e.addedDocuments.forEach((n=>this.Ya=this.Ya.add(n))),e.modifiedDocuments.forEach((n=>{})),e.removedDocuments.forEach((n=>this.Ya=this.Ya.delete(n))),this.current=e.current)}_u(){if(!this.current)return[];const e=this.Xa;this.Xa=et(),this.tu.forEach((i=>{this.uu(i.key)&&(this.Xa=this.Xa.add(i.key))}));const n=[];return e.forEach((i=>{this.Xa.has(i)||n.push(new $w(i))})),this.Xa.forEach((i=>{e.has(i)||n.push(new Qw(i))})),n}cu(e){this.Ya=e.Qs,this.Xa=et();const n=this.ru(e.documents);return this.applyChanges(n,!0)}lu(){return ll.fromInitialDocuments(this.query,this.tu,this.mutatedKeys,this.Za===0,this.hasCachedResults)}}const dy="SyncEngine";class tO{constructor(e,n,i){this.query=e,this.targetId=n,this.view=i}}class nO{constructor(e){this.key=e,this.hu=!1}}class rO{constructor(e,n,i,a,l,u){this.localStore=e,this.remoteStore=n,this.eventManager=i,this.sharedClientState=a,this.currentUser=l,this.maxConcurrentLimboResolutions=u,this.Pu={},this.Tu=new Ha((h=>cw(h)),Zh),this.Iu=new Map,this.Eu=new Set,this.du=new It(je.comparator),this.Au=new Map,this.Ru=new ey,this.Vu={},this.mu=new Map,this.fu=ol.cr(),this.onlineState="Unknown",this.gu=void 0}get isPrimaryClient(){return this.gu===!0}}async function iO(t,e,n=!0){const i=Zw(t);let a;const l=i.Tu.get(e);return l?(i.sharedClientState.addLocalQueryTarget(l.targetId),a=l.view.lu()):a=await Kw(i,e,n,!0),a}async function sO(t,e){const n=Zw(t);await Kw(n,e,!0,!1)}async function Kw(t,e,n,i){const a=await T5(t.localStore,hi(e)),l=a.targetId,u=t.sharedClientState.addLocalQueryTarget(l,n);let h;return i&&(h=await aO(t,e,l,u==="current",a.resumeToken)),t.isPrimaryClient&&n&&Lw(t.remoteStore,a),h}async function aO(t,e,n,i,a){t.pu=(v,b,w)=>(async function(R,N,B,H){let F=N.view.ru(B);F.Cs&&(F=await Rx(R.localStore,N.query,!1).then((({documents:L})=>N.view.ru(L,F))));const ae=H&&H.targetChanges.get(N.targetId),te=H&&H.targetMismatches.get(N.targetId)!=null,he=N.view.applyChanges(F,R.isPrimaryClient,ae,te);return Vx(R,N.targetId,he.au),he.snapshot})(t,v,b,w);const l=await Rx(t.localStore,e,!0),u=new eO(e,l.Qs),h=u.ru(l.documents),m=pu.createSynthesizedTargetChangeForCurrentChange(n,i&&t.onlineState!=="Offline",a),g=u.applyChanges(h,t.isPrimaryClient,m);Vx(t,n,g.au);const _=new tO(e,n,u);return t.Tu.set(e,_),t.Iu.has(n)?t.Iu.get(n).push(e):t.Iu.set(n,[e]),g.snapshot}async function oO(t,e,n){const i=Fe(t),a=i.Tu.get(e),l=i.Iu.get(a.targetId);if(l.length>1)return i.Iu.set(a.targetId,l.filter((u=>!Zh(u,e)))),void i.Tu.delete(e);i.isPrimaryClient?(i.sharedClientState.removeLocalQueryTarget(a.targetId),i.sharedClientState.isActiveQueryTarget(a.targetId)||await hg(i.localStore,a.targetId,!1).then((()=>{i.sharedClientState.clearQueryState(a.targetId),n&&iy(i.remoteStore,a.targetId),pg(i,a.targetId)})).catch(xl)):(pg(i,a.targetId),await hg(i.localStore,a.targetId,!0))}async function lO(t,e){const n=Fe(t),i=n.Tu.get(e),a=n.Iu.get(i.targetId);n.isPrimaryClient&&a.length===1&&(n.sharedClientState.removeLocalQueryTarget(i.targetId),iy(n.remoteStore,i.targetId))}async function cO(t,e,n){const i=gO(t);try{const a=await(function(u,h){const m=Fe(u),g=Tt.now(),_=h.reduce(((w,C)=>w.add(C.key)),et());let v,b;return m.persistence.runTransaction("Locally write mutations","readwrite",(w=>{let C=Wi(),R=et();return m.Ns.getEntries(w,_).next((N=>{C=N,C.forEach(((B,H)=>{H.isValidDocument()||(R=R.add(B))}))})).next((()=>m.localDocuments.getOverlayedDocuments(w,C))).next((N=>{v=N;const B=[];for(const H of h){const F=w2(H,v.get(H.key).overlayedDocument);F!=null&&B.push(new ra(H.key,F,tw(F.value.mapValue),Ur.exists(!0)))}return m.mutationQueue.addMutationBatch(w,g,B,h)})).next((N=>{b=N;const B=N.applyToLocalDocumentSet(v,R);return m.documentOverlayCache.saveOverlays(w,N.batchId,B)}))})).then((()=>({batchId:b.batchId,changes:hw(v)})))})(i.localStore,e);i.sharedClientState.addPendingMutation(a.batchId),(function(u,h,m){let g=u.Vu[u.currentUser.toKey()];g||(g=new It(Ze)),g=g.insert(h,m),u.Vu[u.currentUser.toKey()]=g})(i,a.batchId,n),await yu(i,a.changes),await of(i.remoteStore)}catch(a){const l=cy(a,"Failed to persist write");n.reject(l)}}async function Ww(t,e){const n=Fe(t);try{const i=await E5(n.localStore,e);e.targetChanges.forEach(((a,l)=>{const u=n.Au.get(l);u&&(ct(a.addedDocuments.size+a.modifiedDocuments.size+a.removedDocuments.size<=1,22616),a.addedDocuments.size>0?u.hu=!0:a.modifiedDocuments.size>0?ct(u.hu,14607):a.removedDocuments.size>0&&(ct(u.hu,42227),u.hu=!1))})),await yu(n,i,e)}catch(i){await xl(i)}}function Lx(t,e,n){const i=Fe(t);if(i.isPrimaryClient&&n===0||!i.isPrimaryClient&&n===1){const a=[];i.Tu.forEach(((l,u)=>{const h=u.view.va(e);h.snapshot&&a.push(h.snapshot)})),(function(u,h){const m=Fe(u);m.onlineState=h;let g=!1;m.queries.forEach(((_,v)=>{for(const b of v.Sa)b.va(h)&&(g=!0)})),g&&uy(m)})(i.eventManager,e),a.length&&i.Pu.H_(a),i.onlineState=e,i.isPrimaryClient&&i.sharedClientState.setOnlineState(e)}}async function uO(t,e,n){const i=Fe(t);i.sharedClientState.updateQueryState(e,"rejected",n);const a=i.Au.get(e),l=a&&a.key;if(l){let u=new It(je.comparator);u=u.insert(l,Dn.newNoDocument(l,Ue.min()));const h=et().add(l),m=new rf(Ue.min(),new Map,new It(Ze),u,h);await Ww(i,m),i.du=i.du.remove(l),i.Au.delete(e),hy(i)}else await hg(i.localStore,e,!1).then((()=>pg(i,e,n))).catch(xl)}async function dO(t,e){const n=Fe(t),i=e.batch.batchId;try{const a=await x5(n.localStore,e);Xw(n,i,null),Yw(n,i),n.sharedClientState.updateMutationState(i,"acknowledged"),await yu(n,a)}catch(a){await xl(a)}}async function hO(t,e,n){const i=Fe(t);try{const a=await(function(u,h){const m=Fe(u);return m.persistence.runTransaction("Reject batch","readwrite-primary",(g=>{let _;return m.mutationQueue.lookupMutationBatch(g,h).next((v=>(ct(v!==null,37113),_=v.keys(),m.mutationQueue.removeMutationBatch(g,v)))).next((()=>m.mutationQueue.performConsistencyCheck(g))).next((()=>m.documentOverlayCache.removeOverlaysForBatchId(g,_,h))).next((()=>m.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(g,_))).next((()=>m.localDocuments.getDocuments(g,_)))}))})(i.localStore,e);Xw(i,e,n),Yw(i,e),i.sharedClientState.updateMutationState(e,"rejected",n),await yu(i,a)}catch(a){await xl(a)}}function Yw(t,e){(t.mu.get(e)||[]).forEach((n=>{n.resolve()})),t.mu.delete(e)}function Xw(t,e,n){const i=Fe(t);let a=i.Vu[i.currentUser.toKey()];if(a){const l=a.get(e);l&&(n?l.reject(n):l.resolve(),a=a.remove(e)),i.Vu[i.currentUser.toKey()]=a}}function pg(t,e,n=null){t.sharedClientState.removeLocalQueryTarget(e);for(const i of t.Iu.get(e))t.Tu.delete(i),n&&t.Pu.yu(i,n);t.Iu.delete(e),t.isPrimaryClient&&t.Ru.jr(e).forEach((i=>{t.Ru.containsKey(i)||Jw(t,i)}))}function Jw(t,e){t.Eu.delete(e.path.canonicalString());const n=t.du.get(e);n!==null&&(iy(t.remoteStore,n),t.du=t.du.remove(e),t.Au.delete(n),hy(t))}function Vx(t,e,n){for(const i of n)i instanceof Qw?(t.Ru.addReference(i.key,e),fO(t,i)):i instanceof $w?(Ae(dy,"Document no longer in limbo: "+i.key),t.Ru.removeReference(i.key,e),t.Ru.containsKey(i.key)||Jw(t,i.key)):Pe(19791,{wu:i})}function fO(t,e){const n=e.key,i=n.path.canonicalString();t.du.get(n)||t.Eu.has(i)||(Ae(dy,"New document in limbo: "+n),t.Eu.add(i),hy(t))}function hy(t){for(;t.Eu.size>0&&t.du.size<t.maxConcurrentLimboResolutions;){const e=t.Eu.values().next().value;t.Eu.delete(e);const n=new je(Et.fromString(e)),i=t.fu.next();t.Au.set(i,new nO(n)),t.du=t.du.insert(n,i),Lw(t.remoteStore,new Us(hi(Kg(n.path)),i,"TargetPurposeLimboResolution",Yh.ce))}}async function yu(t,e,n){const i=Fe(t),a=[],l=[],u=[];i.Tu.isEmpty()||(i.Tu.forEach(((h,m)=>{u.push(i.pu(m,e,n).then((g=>{if((g||n)&&i.isPrimaryClient){const _=g?!g.fromCache:n?.targetChanges.get(m.targetId)?.current;i.sharedClientState.updateQueryState(m.targetId,_?"current":"not-current")}if(g){a.push(g);const _=ny.As(m.targetId,g);l.push(_)}})))})),await Promise.all(u),i.Pu.H_(a),await(async function(m,g){const _=Fe(m);try{await _.persistence.runTransaction("notifyLocalViewChanges","readwrite",(v=>be.forEach(g,(b=>be.forEach(b.Es,(w=>_.persistence.referenceDelegate.addReference(v,b.targetId,w))).next((()=>be.forEach(b.ds,(w=>_.persistence.referenceDelegate.removeReference(v,b.targetId,w)))))))))}catch(v){if(!El(v))throw v;Ae(ry,"Failed to update sequence numbers: "+v)}for(const v of g){const b=v.targetId;if(!v.fromCache){const w=_.Ms.get(b),C=w.snapshotVersion,R=w.withLastLimboFreeSnapshotVersion(C);_.Ms=_.Ms.insert(b,R)}}})(i.localStore,l))}async function mO(t,e){const n=Fe(t);if(!n.currentUser.isEqual(e)){Ae(dy,"User change. New user:",e.toKey());const i=await Mw(n.localStore,e);n.currentUser=e,(function(l,u){l.mu.forEach((h=>{h.forEach((m=>{m.reject(new Te(ve.CANCELLED,u))}))})),l.mu.clear()})(n,"'waitForPendingWrites' promise is rejected due to a user change."),n.sharedClientState.handleUserChange(e,i.removedBatchIds,i.addedBatchIds),await yu(n,i.Ls)}}function pO(t,e){const n=Fe(t),i=n.Au.get(e);if(i&&i.hu)return et().add(i.key);{let a=et();const l=n.Iu.get(e);if(!l)return a;for(const u of l){const h=n.Tu.get(u);a=a.unionWith(h.view.nu)}return a}}function Zw(t){const e=Fe(t);return e.remoteStore.remoteSyncer.applyRemoteEvent=Ww.bind(null,e),e.remoteStore.remoteSyncer.getRemoteKeysForTarget=pO.bind(null,e),e.remoteStore.remoteSyncer.rejectListen=uO.bind(null,e),e.Pu.H_=J5.bind(null,e.eventManager),e.Pu.yu=Z5.bind(null,e.eventManager),e}function gO(t){const e=Fe(t);return e.remoteStore.remoteSyncer.applySuccessfulWrite=dO.bind(null,e),e.remoteStore.remoteSyncer.rejectFailedWrite=hO.bind(null,e),e}class kh{constructor(){this.kind="memory",this.synchronizeTabs=!1}async initialize(e){this.serializer=sf(e.databaseInfo.databaseId),this.sharedClientState=this.Du(e),this.persistence=this.Cu(e),await this.persistence.start(),this.localStore=this.vu(e),this.gcScheduler=this.Fu(e,this.localStore),this.indexBackfillerScheduler=this.Mu(e,this.localStore)}Fu(e,n){return null}Mu(e,n){return null}vu(e){return b5(this.persistence,new y5,e.initialUser,this.serializer)}Cu(e){return new Ow(ty.mi,this.serializer)}Du(e){return new C5}async terminate(){this.gcScheduler?.stop(),this.indexBackfillerScheduler?.stop(),this.sharedClientState.shutdown(),await this.persistence.shutdown()}}kh.provider={build:()=>new kh};class yO extends kh{constructor(e){super(),this.cacheSizeBytes=e}Fu(e,n){ct(this.persistence.referenceDelegate instanceof Oh,46915);const i=this.persistence.referenceDelegate.garbageCollector;return new n5(i,e.asyncQueue,n)}Cu(e){const n=this.cacheSizeBytes!==void 0?Fn.withCacheSize(this.cacheSizeBytes):Fn.DEFAULT;return new Ow((i=>Oh.mi(i,n)),this.serializer)}}class gg{async initialize(e,n){this.localStore||(this.localStore=e.localStore,this.sharedClientState=e.sharedClientState,this.datastore=this.createDatastore(n),this.remoteStore=this.createRemoteStore(n),this.eventManager=this.createEventManager(n),this.syncEngine=this.createSyncEngine(n,!e.synchronizeTabs),this.sharedClientState.onlineStateHandler=i=>Lx(this.syncEngine,i,1),this.remoteStore.remoteSyncer.handleCredentialChange=mO.bind(null,this.syncEngine),await W5(this.remoteStore,this.syncEngine.isPrimaryClient))}createEventManager(e){return(function(){return new X5})()}createDatastore(e){const n=sf(e.databaseInfo.databaseId),i=(function(l){return new O5(l)})(e.databaseInfo);return(function(l,u,h,m){return new P5(l,u,h,m)})(e.authCredentials,e.appCheckCredentials,i,n)}createRemoteStore(e){return(function(i,a,l,u,h){return new V5(i,a,l,u,h)})(this.localStore,this.datastore,e.asyncQueue,(n=>Lx(this.syncEngine,n,0)),(function(){return jx.v()?new jx:new R5})())}createSyncEngine(e,n){return(function(a,l,u,h,m,g,_){const v=new rO(a,l,u,h,m,g);return _&&(v.gu=!0),v})(this.localStore,this.remoteStore,this.eventManager,this.sharedClientState,e.initialUser,e.maxConcurrentLimboResolutions,n)}async terminate(){await(async function(n){const i=Fe(n);Ae(Ba,"RemoteStore shutting down."),i.Ea.add(5),await gu(i),i.Aa.shutdown(),i.Ra.set("Unknown")})(this.remoteStore),this.datastore?.terminate(),this.eventManager?.terminate()}}gg.provider={build:()=>new gg};class e1{constructor(e){this.observer=e,this.muted=!1}next(e){this.muted||this.observer.next&&this.Ou(this.observer.next,e)}error(e){this.muted||(this.observer.error?this.Ou(this.observer.error,e):Ki("Uncaught Error in snapshot listener:",e.toString()))}Nu(){this.muted=!0}Ou(e,n){setTimeout((()=>{this.muted||e(n)}),0)}}const ea="FirestoreClient";class _O{constructor(e,n,i,a,l){this.authCredentials=e,this.appCheckCredentials=n,this.asyncQueue=i,this.databaseInfo=a,this.user=Rn.UNAUTHENTICATED,this.clientId=Fg.newId(),this.authCredentialListener=()=>Promise.resolve(),this.appCheckCredentialListener=()=>Promise.resolve(),this._uninitializedComponentsProvider=l,this.authCredentials.start(i,(async u=>{Ae(ea,"Received user=",u.uid),await this.authCredentialListener(u),this.user=u})),this.appCheckCredentials.start(i,(u=>(Ae(ea,"Received new app check token=",u),this.appCheckCredentialListener(u,this.user))))}get configuration(){return{asyncQueue:this.asyncQueue,databaseInfo:this.databaseInfo,clientId:this.clientId,authCredentials:this.authCredentials,appCheckCredentials:this.appCheckCredentials,initialUser:this.user,maxConcurrentLimboResolutions:100}}setCredentialChangeListener(e){this.authCredentialListener=e}setAppCheckTokenChangeListener(e){this.appCheckCredentialListener=e}terminate(){this.asyncQueue.enterRestrictedMode();const e=new Hi;return this.asyncQueue.enqueueAndForgetEvenWhileRestricted((async()=>{try{this._onlineComponents&&await this._onlineComponents.terminate(),this._offlineComponents&&await this._offlineComponents.terminate(),this.authCredentials.shutdown(),this.appCheckCredentials.shutdown(),e.resolve()}catch(n){const i=cy(n,"Failed to shutdown persistence");e.reject(i)}})),e.promise}}async function kp(t,e){t.asyncQueue.verifyOperationInProgress(),Ae(ea,"Initializing OfflineComponentProvider");const n=t.configuration;await e.initialize(n);let i=n.initialUser;t.setCredentialChangeListener((async a=>{i.isEqual(a)||(await Mw(e.localStore,a),i=a)})),e.persistence.setDatabaseDeletedListener((()=>t.terminate())),t._offlineComponents=e}async function zx(t,e){t.asyncQueue.verifyOperationInProgress();const n=await vO(t);Ae(ea,"Initializing OnlineComponentProvider"),await e.initialize(n,t.configuration),t.setCredentialChangeListener((i=>Mx(e.remoteStore,i))),t.setAppCheckTokenChangeListener(((i,a)=>Mx(e.remoteStore,a))),t._onlineComponents=e}async function vO(t){if(!t._offlineComponents)if(t._uninitializedComponentsProvider){Ae(ea,"Using user provided OfflineComponentProvider");try{await kp(t,t._uninitializedComponentsProvider._offline)}catch(e){const n=e;if(!(function(a){return a.name==="FirebaseError"?a.code===ve.FAILED_PRECONDITION||a.code===ve.UNIMPLEMENTED:!(typeof DOMException<"u"&&a instanceof DOMException)||a.code===22||a.code===20||a.code===11})(n))throw n;nl("Error using user provided cache. Falling back to memory cache: "+n),await kp(t,new kh)}}else Ae(ea,"Using default OfflineComponentProvider"),await kp(t,new yO(void 0));return t._offlineComponents}async function t1(t){return t._onlineComponents||(t._uninitializedComponentsProvider?(Ae(ea,"Using user provided OnlineComponentProvider"),await zx(t,t._uninitializedComponentsProvider._online)):(Ae(ea,"Using default OnlineComponentProvider"),await zx(t,new gg))),t._onlineComponents}function bO(t){return t1(t).then((e=>e.syncEngine))}async function n1(t){const e=await t1(t),n=e.eventManager;return n.onListen=iO.bind(null,e.syncEngine),n.onUnlisten=oO.bind(null,e.syncEngine),n.onFirstRemoteStoreListen=sO.bind(null,e.syncEngine),n.onLastRemoteStoreUnlisten=lO.bind(null,e.syncEngine),n}function xO(t,e,n={}){const i=new Hi;return t.asyncQueue.enqueueAndForget((async()=>(function(l,u,h,m,g){const _=new e1({next:b=>{_.Nu(),u.enqueueAndForget((()=>Gw(l,v)));const w=b.docs.has(h);!w&&b.fromCache?g.reject(new Te(ve.UNAVAILABLE,"Failed to get document because the client is offline.")):w&&b.fromCache&&m&&m.source==="server"?g.reject(new Te(ve.UNAVAILABLE,'Failed to get document from server. (However, this document does exist in the local cache. Run again without setting source to "server" to retrieve the cached document.)')):g.resolve(b)},error:b=>g.reject(b)}),v=new Hw(Kg(h.path),_,{includeMetadataChanges:!0,qa:!0});return qw(l,v)})(await n1(t),t.asyncQueue,e,n,i))),i.promise}function EO(t,e,n={}){const i=new Hi;return t.asyncQueue.enqueueAndForget((async()=>(function(l,u,h,m,g){const _=new e1({next:b=>{_.Nu(),u.enqueueAndForget((()=>Gw(l,v))),b.fromCache&&m.source==="server"?g.reject(new Te(ve.UNAVAILABLE,'Failed to get documents from server. (However, these documents may exist in the local cache. Run again without setting source to "server" to retrieve the cached documents.)')):g.resolve(b)},error:b=>g.reject(b)}),v=new Hw(h,_,{includeMetadataChanges:!0,qa:!0});return qw(l,v)})(await n1(t),t.asyncQueue,e,n,i))),i.promise}function r1(t){const e={};return t.timeoutSeconds!==void 0&&(e.timeoutSeconds=t.timeoutSeconds),e}const Ux=new Map;const i1="firestore.googleapis.com",Bx=!0;class Fx{constructor(e){if(e.host===void 0){if(e.ssl!==void 0)throw new Te(ve.INVALID_ARGUMENT,"Can't provide ssl option if host option is not set");this.host=i1,this.ssl=Bx}else this.host=e.host,this.ssl=e.ssl??Bx;if(this.isUsingEmulator=e.emulatorOptions!==void 0,this.credentials=e.credentials,this.ignoreUndefinedProperties=!!e.ignoreUndefinedProperties,this.localCache=e.localCache,e.cacheSizeBytes===void 0)this.cacheSizeBytes=jw;else{if(e.cacheSizeBytes!==-1&&e.cacheSizeBytes<e5)throw new Te(ve.INVALID_ARGUMENT,"cacheSizeBytes must be at least 1048576");this.cacheSizeBytes=e.cacheSizeBytes}Lj("experimentalForceLongPolling",e.experimentalForceLongPolling,"experimentalAutoDetectLongPolling",e.experimentalAutoDetectLongPolling),this.experimentalForceLongPolling=!!e.experimentalForceLongPolling,this.experimentalForceLongPolling?this.experimentalAutoDetectLongPolling=!1:e.experimentalAutoDetectLongPolling===void 0?this.experimentalAutoDetectLongPolling=!0:this.experimentalAutoDetectLongPolling=!!e.experimentalAutoDetectLongPolling,this.experimentalLongPollingOptions=r1(e.experimentalLongPollingOptions??{}),(function(i){if(i.timeoutSeconds!==void 0){if(isNaN(i.timeoutSeconds))throw new Te(ve.INVALID_ARGUMENT,`invalid long polling timeout: ${i.timeoutSeconds} (must not be NaN)`);if(i.timeoutSeconds<5)throw new Te(ve.INVALID_ARGUMENT,`invalid long polling timeout: ${i.timeoutSeconds} (minimum allowed value is 5)`);if(i.timeoutSeconds>30)throw new Te(ve.INVALID_ARGUMENT,`invalid long polling timeout: ${i.timeoutSeconds} (maximum allowed value is 30)`)}})(this.experimentalLongPollingOptions),this.useFetchStreams=!!e.useFetchStreams}isEqual(e){return this.host===e.host&&this.ssl===e.ssl&&this.credentials===e.credentials&&this.cacheSizeBytes===e.cacheSizeBytes&&this.experimentalForceLongPolling===e.experimentalForceLongPolling&&this.experimentalAutoDetectLongPolling===e.experimentalAutoDetectLongPolling&&(function(i,a){return i.timeoutSeconds===a.timeoutSeconds})(this.experimentalLongPollingOptions,e.experimentalLongPollingOptions)&&this.ignoreUndefinedProperties===e.ignoreUndefinedProperties&&this.useFetchStreams===e.useFetchStreams}}class lf{constructor(e,n,i,a){this._authCredentials=e,this._appCheckCredentials=n,this._databaseId=i,this._app=a,this.type="firestore-lite",this._persistenceKey="(lite)",this._settings=new Fx({}),this._settingsFrozen=!1,this._emulatorOptions={},this._terminateTask="notTerminated"}get app(){if(!this._app)throw new Te(ve.FAILED_PRECONDITION,"Firestore was not initialized using the Firebase SDK. 'app' is not available");return this._app}get _initialized(){return this._settingsFrozen}get _terminated(){return this._terminateTask!=="notTerminated"}_setSettings(e){if(this._settingsFrozen)throw new Te(ve.FAILED_PRECONDITION,"Firestore has already been started and its settings can no longer be changed. You can only modify settings before calling any other methods on a Firestore object.");this._settings=new Fx(e),this._emulatorOptions=e.emulatorOptions||{},e.credentials!==void 0&&(this._authCredentials=(function(i){if(!i)return new Cj;switch(i.type){case"firstParty":return new jj(i.sessionIndex||"0",i.iamToken||null,i.authTokenFactory||null);case"provider":return i.client;default:throw new Te(ve.INVALID_ARGUMENT,"makeAuthCredentialsProvider failed due to invalid credential type")}})(e.credentials))}_getSettings(){return this._settings}_getEmulatorOptions(){return this._emulatorOptions}_freezeSettings(){return this._settingsFrozen=!0,this._settings}_delete(){return this._terminateTask==="notTerminated"&&(this._terminateTask=this._terminate()),this._terminateTask}async _restart(){this._terminateTask==="notTerminated"?await this._terminate():this._terminateTask="notTerminated"}toJSON(){return{app:this._app,databaseId:this._databaseId,settings:this._settings}}_terminate(){return(function(n){const i=Ux.get(n);i&&(Ae("ComponentProvider","Removing Datastore"),Ux.delete(n),i.terminate())})(this),Promise.resolve()}}function SO(t,e,n,i={}){t=bi(t,lf);const a=_l(e),l=t._getSettings(),u={...l,emulatorOptions:t._getEmulatorOptions()},h=`${e}:${n}`;a&&(CS(`https://${h}`),RS("Firestore",!0)),l.host!==i1&&l.host!==h&&nl("Host has been set in both settings() and connectFirestoreEmulator(), emulator host will be used.");const m={...l,host:h,ssl:a,emulatorOptions:i};if(!Ks(m,u)&&(t._setSettings(m),i.mockUserToken)){let g,_;if(typeof i.mockUserToken=="string")g=i.mockUserToken,_=Rn.MOCK_USER;else{g=XD(i.mockUserToken,t._app?.options.projectId);const v=i.mockUserToken.sub||i.mockUserToken.user_id;if(!v)throw new Te(ve.INVALID_ARGUMENT,"mockUserToken must contain 'sub' or 'user_id' field!");_=new Rn(v)}t._authCredentials=new Rj(new qS(g,_))}}class wl{constructor(e,n,i){this.converter=n,this._query=i,this.type="query",this.firestore=e}withConverter(e){return new wl(this.firestore,e,this._query)}}class Ft{constructor(e,n,i){this.converter=n,this._key=i,this.type="document",this.firestore=e}get _path(){return this._key.path}get id(){return this._key.path.lastSegment()}get path(){return this._key.path.canonicalString()}get parent(){return new Qs(this.firestore,this.converter,this._key.path.popLast())}withConverter(e){return new Ft(this.firestore,e,this._key)}toJSON(){return{type:Ft._jsonSchemaVersion,referencePath:this._key.toString()}}static fromJSON(e,n,i){if(hu(n,Ft._jsonSchema))return new Ft(e,i||null,new je(Et.fromString(n.referencePath)))}}Ft._jsonSchemaVersion="firestore/documentReference/1.0",Ft._jsonSchema={type:nn("string",Ft._jsonSchemaVersion),referencePath:nn("string")};class Qs extends wl{constructor(e,n,i){super(e,n,Kg(i)),this._path=i,this.type="collection"}get id(){return this._query.path.lastSegment()}get path(){return this._query.path.canonicalString()}get parent(){const e=this._path.popLast();return e.isEmpty()?null:new Ft(this.firestore,null,new je(e))}withConverter(e){return new Qs(this.firestore,e,this._path)}}function wO(t,e,...n){if(t=mn(t),GS("collection","path",e),t instanceof lf){const i=Et.fromString(e,...n);return tx(i),new Qs(t,null,i)}{if(!(t instanceof Ft||t instanceof Qs))throw new Te(ve.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");const i=t._path.child(Et.fromString(e,...n));return tx(i),new Qs(t.firestore,null,i)}}function cf(t,e,...n){if(t=mn(t),arguments.length===1&&(e=Fg.newId()),GS("doc","path",e),t instanceof lf){const i=Et.fromString(e,...n);return ex(i),new Ft(t,null,new je(i))}{if(!(t instanceof Ft||t instanceof Qs))throw new Te(ve.INVALID_ARGUMENT,"Expected first argument to doc() to be a CollectionReference, a DocumentReference or FirebaseFirestore");const i=t._path.child(Et.fromString(e,...n));return ex(i),new Ft(t.firestore,t instanceof Qs?t.converter:null,new je(i))}}const qx="AsyncQueue";class Gx{constructor(e=Promise.resolve()){this.Xu=[],this.ec=!1,this.tc=[],this.nc=null,this.rc=!1,this.sc=!1,this.oc=[],this.M_=new Nw(this,"async_queue_retry"),this._c=()=>{const i=Mp();i&&Ae(qx,"Visibility state changed to "+i.visibilityState),this.M_.w_()},this.ac=e;const n=Mp();n&&typeof n.addEventListener=="function"&&n.addEventListener("visibilitychange",this._c)}get isShuttingDown(){return this.ec}enqueueAndForget(e){this.enqueue(e)}enqueueAndForgetEvenWhileRestricted(e){this.uc(),this.cc(e)}enterRestrictedMode(e){if(!this.ec){this.ec=!0,this.sc=e||!1;const n=Mp();n&&typeof n.removeEventListener=="function"&&n.removeEventListener("visibilitychange",this._c)}}enqueue(e){if(this.uc(),this.ec)return new Promise((()=>{}));const n=new Hi;return this.cc((()=>this.ec&&this.sc?Promise.resolve():(e().then(n.resolve,n.reject),n.promise))).then((()=>n.promise))}enqueueRetryable(e){this.enqueueAndForget((()=>(this.Xu.push(e),this.lc())))}async lc(){if(this.Xu.length!==0){try{await this.Xu[0](),this.Xu.shift(),this.M_.reset()}catch(e){if(!El(e))throw e;Ae(qx,"Operation failed with retryable error: "+e)}this.Xu.length>0&&this.M_.p_((()=>this.lc()))}}cc(e){const n=this.ac.then((()=>(this.rc=!0,e().catch((i=>{throw this.nc=i,this.rc=!1,Ki("INTERNAL UNHANDLED ERROR: ",Hx(i)),i})).then((i=>(this.rc=!1,i))))));return this.ac=n,n}enqueueAfterDelay(e,n,i){this.uc(),this.oc.indexOf(e)>-1&&(n=0);const a=ly.createAndSchedule(this,e,n,i,(l=>this.hc(l)));return this.tc.push(a),a}uc(){this.nc&&Pe(47125,{Pc:Hx(this.nc)})}verifyOperationInProgress(){}async Tc(){let e;do e=this.ac,await e;while(e!==this.ac)}Ic(e){for(const n of this.tc)if(n.timerId===e)return!0;return!1}Ec(e){return this.Tc().then((()=>{this.tc.sort(((n,i)=>n.targetTimeMs-i.targetTimeMs));for(const n of this.tc)if(n.skipDelay(),e!=="all"&&n.timerId===e)break;return this.Tc()}))}dc(e){this.oc.push(e)}hc(e){const n=this.tc.indexOf(e);this.tc.splice(n,1)}}function Hx(t){let e=t.message||"";return t.stack&&(e=t.stack.includes(t.message)?t.stack:t.message+`
`+t.stack),e}class Tl extends lf{constructor(e,n,i,a){super(e,n,i,a),this.type="firestore",this._queue=new Gx,this._persistenceKey=a?.name||"[DEFAULT]"}async _terminate(){if(this._firestoreClient){const e=this._firestoreClient.terminate();this._queue=new Gx(e),this._firestoreClient=void 0,await e}}}function TO(t,e){const n=typeof t=="object"?t:OS(),i=typeof t=="string"?t:Th,a=Ug(n,"firestore").getImmediate({identifier:i});if(!a._initialized){const l=WD("firestore");l&&SO(a,...l)}return a}function fy(t){if(t._terminated)throw new Te(ve.FAILED_PRECONDITION,"The client has already been terminated.");return t._firestoreClient||AO(t),t._firestoreClient}function AO(t){const e=t._freezeSettings(),n=(function(a,l,u,h){return new Kj(a,l,u,h.host,h.ssl,h.experimentalForceLongPolling,h.experimentalAutoDetectLongPolling,r1(h.experimentalLongPollingOptions),h.useFetchStreams,h.isUsingEmulator)})(t._databaseId,t._app?.options.appId||"",t._persistenceKey,e);t._componentsProvider||e.localCache?._offlineComponentProvider&&e.localCache?._onlineComponentProvider&&(t._componentsProvider={_offline:e.localCache._offlineComponentProvider,_online:e.localCache._onlineComponentProvider}),t._firestoreClient=new _O(t._authCredentials,t._appCheckCredentials,t._queue,n,t._componentsProvider&&(function(a){const l=a?._online.build();return{_offline:a?._offline.build(l),_online:l}})(t._componentsProvider))}class Er{constructor(e){this._byteString=e}static fromBase64String(e){try{return new Er(wn.fromBase64String(e))}catch(n){throw new Te(ve.INVALID_ARGUMENT,"Failed to construct data from Base64 string: "+n)}}static fromUint8Array(e){return new Er(wn.fromUint8Array(e))}toBase64(){return this._byteString.toBase64()}toUint8Array(){return this._byteString.toUint8Array()}toString(){return"Bytes(base64: "+this.toBase64()+")"}isEqual(e){return this._byteString.isEqual(e._byteString)}toJSON(){return{type:Er._jsonSchemaVersion,bytes:this.toBase64()}}static fromJSON(e){if(hu(e,Er._jsonSchema))return Er.fromBase64String(e.bytes)}}Er._jsonSchemaVersion="firestore/bytes/1.0",Er._jsonSchema={type:nn("string",Er._jsonSchemaVersion),bytes:nn("string")};class uf{constructor(...e){for(let n=0;n<e.length;++n)if(e[n].length===0)throw new Te(ve.INVALID_ARGUMENT,"Invalid field name at argument $(i + 1). Field names must not be empty.");this._internalPath=new Sn(e)}isEqual(e){return this._internalPath.isEqual(e._internalPath)}}class df{constructor(e){this._methodName=e}}class mi{constructor(e,n){if(!isFinite(e)||e<-90||e>90)throw new Te(ve.INVALID_ARGUMENT,"Latitude must be a number between -90 and 90, but was: "+e);if(!isFinite(n)||n<-180||n>180)throw new Te(ve.INVALID_ARGUMENT,"Longitude must be a number between -180 and 180, but was: "+n);this._lat=e,this._long=n}get latitude(){return this._lat}get longitude(){return this._long}isEqual(e){return this._lat===e._lat&&this._long===e._long}_compareTo(e){return Ze(this._lat,e._lat)||Ze(this._long,e._long)}toJSON(){return{latitude:this._lat,longitude:this._long,type:mi._jsonSchemaVersion}}static fromJSON(e){if(hu(e,mi._jsonSchema))return new mi(e.latitude,e.longitude)}}mi._jsonSchemaVersion="firestore/geoPoint/1.0",mi._jsonSchema={type:nn("string",mi._jsonSchemaVersion),latitude:nn("number"),longitude:nn("number")};class pi{constructor(e){this._values=(e||[]).map((n=>n))}toArray(){return this._values.map((e=>e))}isEqual(e){return(function(i,a){if(i.length!==a.length)return!1;for(let l=0;l<i.length;++l)if(i[l]!==a[l])return!1;return!0})(this._values,e._values)}toJSON(){return{type:pi._jsonSchemaVersion,vectorValues:this._values}}static fromJSON(e){if(hu(e,pi._jsonSchema)){if(Array.isArray(e.vectorValues)&&e.vectorValues.every((n=>typeof n=="number")))return new pi(e.vectorValues);throw new Te(ve.INVALID_ARGUMENT,"Expected 'vectorValues' field to be a number array")}}}pi._jsonSchemaVersion="firestore/vectorValue/1.0",pi._jsonSchema={type:nn("string",pi._jsonSchemaVersion),vectorValues:nn("object")};const CO=/^__.*__$/;class RO{constructor(e,n,i){this.data=e,this.fieldMask=n,this.fieldTransforms=i}toMutation(e,n){return this.fieldMask!==null?new ra(e,this.data,this.fieldMask,n,this.fieldTransforms):new mu(e,this.data,n,this.fieldTransforms)}}class s1{constructor(e,n,i){this.data=e,this.fieldMask=n,this.fieldTransforms=i}toMutation(e,n){return new ra(e,this.data,this.fieldMask,n,this.fieldTransforms)}}function a1(t){switch(t){case 0:case 2:case 1:return!0;case 3:case 4:return!1;default:throw Pe(40011,{Ac:t})}}class hf{constructor(e,n,i,a,l,u){this.settings=e,this.databaseId=n,this.serializer=i,this.ignoreUndefinedProperties=a,l===void 0&&this.Rc(),this.fieldTransforms=l||[],this.fieldMask=u||[]}get path(){return this.settings.path}get Ac(){return this.settings.Ac}Vc(e){return new hf({...this.settings,...e},this.databaseId,this.serializer,this.ignoreUndefinedProperties,this.fieldTransforms,this.fieldMask)}mc(e){const n=this.path?.child(e),i=this.Vc({path:n,fc:!1});return i.gc(e),i}yc(e){const n=this.path?.child(e),i=this.Vc({path:n,fc:!1});return i.Rc(),i}wc(e){return this.Vc({path:void 0,fc:!0})}Sc(e){return Nh(e,this.settings.methodName,this.settings.bc||!1,this.path,this.settings.Dc)}contains(e){return this.fieldMask.find((n=>e.isPrefixOf(n)))!==void 0||this.fieldTransforms.find((n=>e.isPrefixOf(n.field)))!==void 0}Rc(){if(this.path)for(let e=0;e<this.path.length;e++)this.gc(this.path.get(e))}gc(e){if(e.length===0)throw this.Sc("Document fields must not be empty");if(a1(this.Ac)&&CO.test(e))throw this.Sc('Document fields cannot begin and end with "__"')}}class DO{constructor(e,n,i){this.databaseId=e,this.ignoreUndefinedProperties=n,this.serializer=i||sf(e)}Cc(e,n,i,a=!1){return new hf({Ac:e,methodName:n,Dc:i,path:Sn.emptyPath(),fc:!1,bc:a},this.databaseId,this.serializer,this.ignoreUndefinedProperties)}}function my(t){const e=t._freezeSettings(),n=sf(t._databaseId);return new DO(t._databaseId,!!e.ignoreUndefinedProperties,n)}function IO(t,e,n,i,a,l={}){const u=t.Cc(l.merge||l.mergeFields?2:0,e,n,a);gy("Data must be an object, but it was:",u,i);const h=o1(i,u);let m,g;if(l.merge)m=new tr(u.fieldMask),g=u.fieldTransforms;else if(l.mergeFields){const _=[];for(const v of l.mergeFields){const b=yg(e,v,n);if(!u.contains(b))throw new Te(ve.INVALID_ARGUMENT,`Field '${b}' is specified in your field mask but missing from your input data.`);c1(_,b)||_.push(b)}m=new tr(_),g=u.fieldTransforms.filter((v=>m.covers(v.field)))}else m=null,g=u.fieldTransforms;return new RO(new qn(h),m,g)}class _u extends df{_toFieldTransform(e){if(e.Ac!==2)throw e.Ac===1?e.Sc(`${this._methodName}() can only appear at the top level of your update data`):e.Sc(`${this._methodName}() cannot be used with set() unless you pass {merge:true}`);return e.fieldMask.push(e.path),null}isEqual(e){return e instanceof _u}}function jO(t,e,n){return new hf({Ac:3,Dc:e.settings.Dc,methodName:t._methodName,fc:n},e.databaseId,e.serializer,e.ignoreUndefinedProperties)}class py extends df{constructor(e,n){super(e),this.vc=n}_toFieldTransform(e){const n=jO(this,e,!0),i=this.vc.map((l=>Al(l,n))),a=new al(i);return new b2(e.path,a)}isEqual(e){return e instanceof py&&Ks(this.vc,e.vc)}}function OO(t,e,n,i){const a=t.Cc(1,e,n);gy("Data must be an object, but it was:",a,i);const l=[],u=qn.empty();na(i,((m,g)=>{const _=yy(e,m,n);g=mn(g);const v=a.yc(_);if(g instanceof _u)l.push(_);else{const b=Al(g,v);b!=null&&(l.push(_),u.set(_,b))}}));const h=new tr(l);return new s1(u,h,a.fieldTransforms)}function MO(t,e,n,i,a,l){const u=t.Cc(1,e,n),h=[yg(e,i,n)],m=[a];if(l.length%2!=0)throw new Te(ve.INVALID_ARGUMENT,`Function ${e}() needs to be called with an even number of arguments that alternate between field names and values.`);for(let b=0;b<l.length;b+=2)h.push(yg(e,l[b])),m.push(l[b+1]);const g=[],_=qn.empty();for(let b=h.length-1;b>=0;--b)if(!c1(g,h[b])){const w=h[b];let C=m[b];C=mn(C);const R=u.yc(w);if(C instanceof _u)g.push(w);else{const N=Al(C,R);N!=null&&(g.push(w),_.set(w,N))}}const v=new tr(g);return new s1(_,v,u.fieldTransforms)}function kO(t,e,n,i=!1){return Al(n,t.Cc(i?4:3,e))}function Al(t,e){if(l1(t=mn(t)))return gy("Unsupported field value:",e,t),o1(t,e);if(t instanceof df)return(function(i,a){if(!a1(a.Ac))throw a.Sc(`${i._methodName}() can only be used with update() and set()`);if(!a.path)throw a.Sc(`${i._methodName}() is not currently supported inside arrays`);const l=i._toFieldTransform(a);l&&a.fieldTransforms.push(l)})(t,e),null;if(t===void 0&&e.ignoreUndefinedProperties)return null;if(e.path&&e.fieldMask.push(e.path),t instanceof Array){if(e.settings.fc&&e.Ac!==4)throw e.Sc("Nested arrays are not supported");return(function(i,a){const l=[];let u=0;for(const h of i){let m=Al(h,a.wc(u));m==null&&(m={nullValue:"NULL_VALUE"}),l.push(m),u++}return{arrayValue:{values:l}}})(t,e)}return(function(i,a){if((i=mn(i))===null)return{nullValue:"NULL_VALUE"};if(typeof i=="number")return y2(a.serializer,i);if(typeof i=="boolean")return{booleanValue:i};if(typeof i=="string")return{stringValue:i};if(i instanceof Date){const l=Tt.fromDate(i);return{timestampValue:jh(a.serializer,l)}}if(i instanceof Tt){const l=new Tt(i.seconds,1e3*Math.floor(i.nanoseconds/1e3));return{timestampValue:jh(a.serializer,l)}}if(i instanceof mi)return{geoPointValue:{latitude:i.latitude,longitude:i.longitude}};if(i instanceof Er)return{bytesValue:ww(a.serializer,i._byteString)};if(i instanceof Ft){const l=a.databaseId,u=i.firestore._databaseId;if(!u.isEqual(l))throw a.Sc(`Document reference is for database ${u.projectId}/${u.database} but should be for database ${l.projectId}/${l.database}`);return{referenceValue:Zg(i.firestore._databaseId||a.databaseId,i._key.path)}}if(i instanceof pi)return(function(u,h){return{mapValue:{fields:{[ZS]:{stringValue:ew},[Ah]:{arrayValue:{values:u.toArray().map((g=>{if(typeof g!="number")throw h.Sc("VectorValues must only contain numeric values.");return Wg(h.serializer,g)}))}}}}}})(i,a);throw a.Sc(`Unsupported field value: ${Wh(i)}`)})(t,e)}function o1(t,e){const n={};return $S(t)?e.path&&e.path.length>0&&e.fieldMask.push(e.path):na(t,((i,a)=>{const l=Al(a,e.mc(i));l!=null&&(n[i]=l)})),{mapValue:{fields:n}}}function l1(t){return!(typeof t!="object"||t===null||t instanceof Array||t instanceof Date||t instanceof Tt||t instanceof mi||t instanceof Er||t instanceof Ft||t instanceof df||t instanceof pi)}function gy(t,e,n){if(!l1(n)||!HS(n)){const i=Wh(n);throw i==="an object"?e.Sc(t+" a custom object"):e.Sc(t+" "+i)}}function yg(t,e,n){if((e=mn(e))instanceof uf)return e._internalPath;if(typeof e=="string")return yy(t,e);throw Nh("Field path arguments must be of type string or ",t,!1,void 0,n)}const NO=new RegExp("[~\\*/\\[\\]]");function yy(t,e,n){if(e.search(NO)>=0)throw Nh(`Invalid field path (${e}). Paths must not contain '~', '*', '/', '[', or ']'`,t,!1,void 0,n);try{return new uf(...e.split("."))._internalPath}catch{throw Nh(`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`,t,!1,void 0,n)}}function Nh(t,e,n,i,a){const l=i&&!i.isEmpty(),u=a!==void 0;let h=`Function ${e}() called with invalid data`;n&&(h+=" (via `toFirestore()`)"),h+=". ";let m="";return(l||u)&&(m+=" (found",l&&(m+=` in field ${i}`),u&&(m+=` in document ${a}`),m+=")"),new Te(ve.INVALID_ARGUMENT,h+t+m)}function c1(t,e){return t.some((n=>n.isEqual(e)))}class u1{constructor(e,n,i,a,l){this._firestore=e,this._userDataWriter=n,this._key=i,this._document=a,this._converter=l}get id(){return this._key.path.lastSegment()}get ref(){return new Ft(this._firestore,this._converter,this._key)}exists(){return this._document!==null}data(){if(this._document){if(this._converter){const e=new PO(this._firestore,this._userDataWriter,this._key,this._document,null);return this._converter.fromFirestore(e)}return this._userDataWriter.convertValue(this._document.data.value)}}get(e){if(this._document){const n=this._document.data.field(_y("DocumentSnapshot.get",e));if(n!==null)return this._userDataWriter.convertValue(n)}}}class PO extends u1{data(){return super.data()}}function _y(t,e){return typeof e=="string"?yy(t,e):e instanceof uf?e._internalPath:e._delegate._internalPath}function LO(t){if(t.limitType==="L"&&t.explicitOrderBy.length===0)throw new Te(ve.UNIMPLEMENTED,"limitToLast() queries require specifying at least one orderBy() clause")}class vy{}class VO extends vy{}function zO(t,e,...n){let i=[];e instanceof vy&&i.push(e),i=i.concat(n),(function(l){const u=l.filter((m=>m instanceof by)).length,h=l.filter((m=>m instanceof ff)).length;if(u>1||u>0&&h>0)throw new Te(ve.INVALID_ARGUMENT,"InvalidQuery. When using composite filters, you cannot use more than one filter at the top level. Consider nesting the multiple filters within an `and(...)` statement. For example: change `query(query, where(...), or(...))` to `query(query, and(where(...), or(...)))`.")})(i);for(const a of i)t=a._apply(t);return t}class ff extends VO{constructor(e,n,i){super(),this._field=e,this._op=n,this._value=i,this.type="where"}static _create(e,n,i){return new ff(e,n,i)}_apply(e){const n=this._parse(e);return d1(e._query,n),new wl(e.firestore,e.converter,ag(e._query,n))}_parse(e){const n=my(e.firestore);return(function(l,u,h,m,g,_,v){let b;if(g.isKeyField()){if(_==="array-contains"||_==="array-contains-any")throw new Te(ve.INVALID_ARGUMENT,`Invalid Query. You can't perform '${_}' queries on documentId().`);if(_==="in"||_==="not-in"){$x(v,_);const C=[];for(const R of v)C.push(Qx(m,l,R));b={arrayValue:{values:C}}}else b=Qx(m,l,v)}else _!=="in"&&_!=="not-in"&&_!=="array-contains-any"||$x(v,_),b=kO(h,u,v,_==="in"||_==="not-in");return tn.create(g,_,b)})(e._query,"where",n,e.firestore._databaseId,this._field,this._op,this._value)}}function UO(t,e,n){const i=e,a=_y("where",t);return ff._create(a,i,n)}class by extends vy{constructor(e,n){super(),this.type=e,this._queryConstraints=n}static _create(e,n){return new by(e,n)}_parse(e){const n=this._queryConstraints.map((i=>i._parse(e))).filter((i=>i.getFilters().length>0));return n.length===1?n[0]:Br.create(n,this._getOperator())}_apply(e){const n=this._parse(e);return n.getFilters().length===0?e:((function(a,l){let u=a;const h=l.getFlattenedFilters();for(const m of h)d1(u,m),u=ag(u,m)})(e._query,n),new wl(e.firestore,e.converter,ag(e._query,n)))}_getQueryConstraints(){return this._queryConstraints}_getOperator(){return this.type==="and"?"and":"or"}}function Qx(t,e,n){if(typeof(n=mn(n))=="string"){if(n==="")throw new Te(ve.INVALID_ARGUMENT,"Invalid query. When querying with documentId(), you must provide a valid document ID, but it was an empty string.");if(!lw(e)&&n.indexOf("/")!==-1)throw new Te(ve.INVALID_ARGUMENT,`Invalid query. When querying a collection by documentId(), you must provide a plain document ID, but '${n}' contains a '/' character.`);const i=e.path.child(Et.fromString(n));if(!je.isDocumentKey(i))throw new Te(ve.INVALID_ARGUMENT,`Invalid query. When querying a collection group by documentId(), the value provided must result in a valid document path, but '${i}' is not because it has an odd number of segments (${i.length}).`);return cx(t,new je(i))}if(n instanceof Ft)return cx(t,n._key);throw new Te(ve.INVALID_ARGUMENT,`Invalid query. When querying with documentId(), you must provide a valid string or a DocumentReference, but it was: ${Wh(n)}.`)}function $x(t,e){if(!Array.isArray(t)||t.length===0)throw new Te(ve.INVALID_ARGUMENT,`Invalid Query. A non-empty array is required for '${e.toString()}' filters.`)}function d1(t,e){const n=(function(a,l){for(const u of a)for(const h of u.getFlattenedFilters())if(l.indexOf(h.op)>=0)return h.op;return null})(t.filters,(function(a){switch(a){case"!=":return["!=","not-in"];case"array-contains-any":case"in":return["not-in"];case"not-in":return["array-contains-any","in","not-in","!="];default:return[]}})(e.op));if(n!==null)throw n===e.op?new Te(ve.INVALID_ARGUMENT,`Invalid query. You cannot use more than one '${e.op.toString()}' filter.`):new Te(ve.INVALID_ARGUMENT,`Invalid query. You cannot use '${e.op.toString()}' filters with '${n.toString()}' filters.`)}class BO{convertValue(e,n="none"){switch(Js(e)){case 0:return null;case 1:return e.booleanValue;case 2:return Bt(e.integerValue||e.doubleValue);case 3:return this.convertTimestamp(e.timestampValue);case 4:return this.convertServerTimestamp(e,n);case 5:return e.stringValue;case 6:return this.convertBytes(Xs(e.bytesValue));case 7:return this.convertReference(e.referenceValue);case 8:return this.convertGeoPoint(e.geoPointValue);case 9:return this.convertArray(e.arrayValue,n);case 11:return this.convertObject(e.mapValue,n);case 10:return this.convertVectorValue(e.mapValue);default:throw Pe(62114,{value:e})}}convertObject(e,n){return this.convertObjectMap(e.fields,n)}convertObjectMap(e,n="none"){const i={};return na(e,((a,l)=>{i[a]=this.convertValue(l,n)})),i}convertVectorValue(e){const n=e.fields?.[Ah].arrayValue?.values?.map((i=>Bt(i.doubleValue)));return new pi(n)}convertGeoPoint(e){return new mi(Bt(e.latitude),Bt(e.longitude))}convertArray(e,n){return(e.values||[]).map((i=>this.convertValue(i,n)))}convertServerTimestamp(e,n){switch(n){case"previous":const i=Jh(e);return i==null?null:this.convertValue(i,n);case"estimate":return this.convertTimestamp(Jc(e));default:return null}}convertTimestamp(e){const n=Ys(e);return new Tt(n.seconds,n.nanos)}convertDocumentKey(e,n){const i=Et.fromString(e);ct(Iw(i),9688,{name:e});const a=new Zc(i.get(1),i.get(3)),l=new je(i.popFirst(5));return a.isEqual(n)||Ki(`Document ${l} contains a document reference within a different database (${a.projectId}/${a.database}) which is not supported. It will be treated as a reference in the current database (${n.projectId}/${n.database}) instead.`),l}}function FO(t,e,n){let i;return i=t?n&&(n.merge||n.mergeFields)?t.toFirestore(e,n):t.toFirestore(e):e,i}class Bc{constructor(e,n){this.hasPendingWrites=e,this.fromCache=n}isEqual(e){return this.hasPendingWrites===e.hasPendingWrites&&this.fromCache===e.fromCache}}class Pa extends u1{constructor(e,n,i,a,l,u){super(e,n,i,a,u),this._firestore=e,this._firestoreImpl=e,this.metadata=l}exists(){return super.exists()}data(e={}){if(this._document){if(this._converter){const n=new hh(this._firestore,this._userDataWriter,this._key,this._document,this.metadata,null);return this._converter.fromFirestore(n,e)}return this._userDataWriter.convertValue(this._document.data.value,e.serverTimestamps)}}get(e,n={}){if(this._document){const i=this._document.data.field(_y("DocumentSnapshot.get",e));if(i!==null)return this._userDataWriter.convertValue(i,n.serverTimestamps)}}toJSON(){if(this.metadata.hasPendingWrites)throw new Te(ve.FAILED_PRECONDITION,"DocumentSnapshot.toJSON() attempted to serialize a document with pending writes. Await waitForPendingWrites() before invoking toJSON().");const e=this._document,n={};return n.type=Pa._jsonSchemaVersion,n.bundle="",n.bundleSource="DocumentSnapshot",n.bundleName=this._key.toString(),!e||!e.isValidDocument()||!e.isFoundDocument()?n:(this._userDataWriter.convertObjectMap(e.data.value.mapValue.fields,"previous"),n.bundle=(this._firestore,this.ref.path,"NOT SUPPORTED"),n)}}Pa._jsonSchemaVersion="firestore/documentSnapshot/1.0",Pa._jsonSchema={type:nn("string",Pa._jsonSchemaVersion),bundleSource:nn("string","DocumentSnapshot"),bundleName:nn("string"),bundle:nn("string")};class hh extends Pa{data(e={}){return super.data(e)}}class Wo{constructor(e,n,i,a){this._firestore=e,this._userDataWriter=n,this._snapshot=a,this.metadata=new Bc(a.hasPendingWrites,a.fromCache),this.query=i}get docs(){const e=[];return this.forEach((n=>e.push(n))),e}get size(){return this._snapshot.docs.size}get empty(){return this.size===0}forEach(e,n){this._snapshot.docs.forEach((i=>{e.call(n,new hh(this._firestore,this._userDataWriter,i.key,i,new Bc(this._snapshot.mutatedKeys.has(i.key),this._snapshot.fromCache),this.query.converter))}))}docChanges(e={}){const n=!!e.includeMetadataChanges;if(n&&this._snapshot.excludesMetadataChanges)throw new Te(ve.INVALID_ARGUMENT,"To include metadata changes with your document changes, you must also pass { includeMetadataChanges:true } to onSnapshot().");return this._cachedChanges&&this._cachedChangesIncludeMetadataChanges===n||(this._cachedChanges=(function(a,l){if(a._snapshot.oldDocs.isEmpty()){let u=0;return a._snapshot.docChanges.map((h=>{const m=new hh(a._firestore,a._userDataWriter,h.doc.key,h.doc,new Bc(a._snapshot.mutatedKeys.has(h.doc.key),a._snapshot.fromCache),a.query.converter);return h.doc,{type:"added",doc:m,oldIndex:-1,newIndex:u++}}))}{let u=a._snapshot.oldDocs;return a._snapshot.docChanges.filter((h=>l||h.type!==3)).map((h=>{const m=new hh(a._firestore,a._userDataWriter,h.doc.key,h.doc,new Bc(a._snapshot.mutatedKeys.has(h.doc.key),a._snapshot.fromCache),a.query.converter);let g=-1,_=-1;return h.type!==0&&(g=u.indexOf(h.doc.key),u=u.delete(h.doc.key)),h.type!==1&&(u=u.add(h.doc),_=u.indexOf(h.doc.key)),{type:qO(h.type),doc:m,oldIndex:g,newIndex:_}}))}})(this,n),this._cachedChangesIncludeMetadataChanges=n),this._cachedChanges}toJSON(){if(this.metadata.hasPendingWrites)throw new Te(ve.FAILED_PRECONDITION,"QuerySnapshot.toJSON() attempted to serialize a document with pending writes. Await waitForPendingWrites() before invoking toJSON().");const e={};e.type=Wo._jsonSchemaVersion,e.bundleSource="QuerySnapshot",e.bundleName=Fg.newId(),this._firestore._databaseId.database,this._firestore._databaseId.projectId;const n=[],i=[],a=[];return this.docs.forEach((l=>{l._document!==null&&(n.push(l._document),i.push(this._userDataWriter.convertObjectMap(l._document.data.value.mapValue.fields,"previous")),a.push(l.ref.path))})),e.bundle=(this._firestore,this.query._query,e.bundleName,"NOT SUPPORTED"),e}}function qO(t){switch(t){case 0:return"added";case 2:case 3:return"modified";case 1:return"removed";default:return Pe(61501,{type:t})}}function GO(t){t=bi(t,Ft);const e=bi(t.firestore,Tl);return xO(fy(e),t._key).then((n=>WO(e,t,n)))}Wo._jsonSchemaVersion="firestore/querySnapshot/1.0",Wo._jsonSchema={type:nn("string",Wo._jsonSchemaVersion),bundleSource:nn("string","QuerySnapshot"),bundleName:nn("string"),bundle:nn("string")};class h1 extends BO{constructor(e){super(),this.firestore=e}convertBytes(e){return new Er(e)}convertReference(e){const n=this.convertDocumentKey(e,this.firestore._databaseId);return new Ft(this.firestore,null,n)}}function HO(t){t=bi(t,wl);const e=bi(t.firestore,Tl),n=fy(e),i=new h1(e);return LO(t._query),EO(n,t._query).then((a=>new Wo(e,i,t,a)))}function QO(t,e,n){t=bi(t,Ft);const i=bi(t.firestore,Tl),a=FO(t.converter,e,n);return xy(i,[IO(my(i),"setDoc",t._key,a,t.converter!==null,n).toMutation(t._key,Ur.none())])}function $O(t,e,n,...i){t=bi(t,Ft);const a=bi(t.firestore,Tl),l=my(a);let u;return u=typeof(e=mn(e))=="string"||e instanceof uf?MO(l,"updateDoc",t._key,e,n,i):OO(l,"updateDoc",t._key,e),xy(a,[u.toMutation(t._key,Ur.exists(!0))])}function KO(t){return xy(bi(t.firestore,Tl),[new Yg(t._key,Ur.none())])}function xy(t,e){return(function(i,a){const l=new Hi;return i.asyncQueue.enqueueAndForget((async()=>cO(await bO(i),a,l))),l.promise})(fy(t),e)}function WO(t,e,n){const i=n.docs.get(e._key),a=new h1(t);return new Pa(t,a,e._key,i,new Bc(n.hasPendingWrites,n.fromCache),e.converter)}function YO(){return new _u("deleteField")}function XO(...t){return new py("arrayUnion",t)}(function(e,n=!0){(function(a){bl=a})(vl),tl(new za("firestore",((i,{instanceIdentifier:a,options:l})=>{const u=i.getProvider("app").getImmediate(),h=new Tl(new Dj(i.getProvider("auth-internal")),new Oj(u,i.getProvider("app-check-internal")),(function(g,_){if(!Object.prototype.hasOwnProperty.apply(g.options,["projectId"]))throw new Te(ve.INVALID_ARGUMENT,'"projectId" not provided in firebase.initializeApp.');return new Zc(g.options.projectId,_)})(u,a),u);return l={useFetchStreams:n,...l},h._setSettings(l),h}),"PUBLIC").setMultipleInstances(!0)),Gs(Yb,Xb,e),Gs(Yb,Xb,"esm2020")})();function vu(){return TO(NS)}function bu(t,e,n,i=1,a){{let l=e;if(e.startsWith("budgets/"))l="budgets";else if(e.startsWith("months/")){const m=e.replace("months/","").split("_");if(m.length>=2){const g=m[m.length-1];l=`months/${m[m.length-2]}/${g}`}}console.log(`[Firebase] ${t}(${i}): ${l}${a===!1?" [NOT FOUND]":""}  ${n}`)}}async function ze(t,e,n){const i=cf(vu(),t,e),a=`${t}/${e}`,l=await GO(i),u=l.exists();return bu("READ",a,n,1,u),{exists:u,data:u?l.data():null,ref:i}}async function Sr(t,e,n){const i=vu(),a=wO(i,t);let l;if(n&&n.length>0){const m=n.map(g=>UO(g.field,g.op,g.value));l=zO(a,...m)}else l=a;const u=await HO(l);let h=t;if(n&&n.length>0){const m=n.map(g=>`${g.field} ${g.op} ${JSON.stringify(g.value)}`).join(", ");h+=` WHERE ${m}`}return bu("QUERY",h,e,u.docs.length),{docs:u.docs.map(m=>({id:m.id,data:m.data()}))}}async function xt(t,e,n,i,a){const l=cf(vu(),t,e),u=`${t}/${e}`;return bu("WRITE",u,i),QO(l,n,a??{})}async function Na(t,e,n,i){const a=cf(vu(),t,e),l=`${t}/${e}`;return bu("UPDATE",l,i),$O(a,n)}async function Ey(t,e,n){const i=cf(vu(),t,e),a=`${t}/${e}`;return bu("DELETE",a,n),KO(i)}function gi(t,e,n){const i=n.toString().padStart(2,"0");return`${t}_${e}_${i}`}function Sy(t,e){return e===1?{year:t-1,month:12}:{year:t,month:e-1}}function JO(t,e){return e===12?{year:t+1,month:1}:{year:t,month:e+1}}function fn(t,e){return`${t}${e.toString().padStart(2,"0")}`}function f1(){const t=new Date,e=t.getFullYear(),n=t.getMonth()+1,i=[];for(let a=3;a>0;a--){let l=e,u=n-a;for(;u<1;)u+=12,l-=1;i.push(fn(l,u))}i.push(fn(e,n));for(let a=1;a<=3;a++){let l=e,u=n+a;for(;u>12;)u-=12,l+=1;i.push(fn(l,u))}return i}function m1(t){const e=new Set(f1()),n={};for(const[i,a]of Object.entries(t))e.has(i)&&(n[i]=a);return n}function ZO(t,e){const n=xe.budget(t),i=vt.getQueryData(n);if(!i?.monthMap)return!1;for(const[a,l]of Object.entries(i.monthMap))if(a>e&&!l.needs_recalculation)return!1;return!0}function eM(t,e,n){const i=xe.budget(t),a=vt.getQueryData(i);a&&vt.setQueryData(i,{...a,isNeedsRecalculation:!0,monthMap:n,budget:{...a.budget,is_needs_recalculation:!0,month_map:n}})}async function tM(t,e,n){const i=fn(e,n);if(ZO(t,i))return console.log("[markMonthsNeedRecalculation] All future months already marked in cache, skipping write"),{markedCount:0,budgetUpdated:!1};const{exists:a,data:l}=await ze("budgets",t,"reading budget for month_map update");if(!a||!l)return console.warn(`[markMonthsNeedRecalculation] Budget ${t} not found`),{markedCount:0,budgetUpdated:!1};const h={...l.month_map||{}},m=f1();for(const v of m)h[v]||(h[v]={needs_recalculation:!1});let g=0;for(const v of m)v>i&&(h[v]?.needs_recalculation||(h[v]={needs_recalculation:!0},g++));if(g===0)return console.log("[markMonthsNeedRecalculation] No new months to mark, skipping write"),{markedCount:0,budgetUpdated:!1};const _=m1(h);return eM(t,i,_),await Na("budgets",t,{is_needs_recalculation:!0,month_map:_,updated_at:new Date().toISOString()},`marking budget and ${g} future months as needing recalculation`),{markedCount:g,budgetUpdated:!0}}async function nM(t,e,n,i=!1){const a=fn(e,n),{exists:l,data:u}=await ze("budgets",t,"reading budget for month_map update (add month)");if(!l||!u){console.warn(`[setMonthInBudgetMap] Budget ${t} not found`);return}const m={...u.month_map||{},[a]:{needs_recalculation:i}},g=m1(m),_=xe.budget(t),v=vt.getQueryData(_);v&&vt.setQueryData(_,{...v,monthMap:g,budget:{...v.budget,month_map:g}}),await Na("budgets",t,{month_map:g,updated_at:new Date().toISOString()},`adding month ${e}/${n} to budget month_map`)}const rM={categoryEndBalances:{},accountEndBalances:{},totalIncome:0};function iM(t,e){const n=sM(t.category_balances,e.categoryEndBalances),i=aM(t,e.accountEndBalances);return{...t,previous_month_income:e.totalIncome,category_balances:n,account_balances:i,updated_at:new Date().toISOString()}}function sM(t,e){const n=new Map;for(const a of t)n.set(a.category_id,a);const i=t.map(a=>{const l=e[a.category_id]??0;return{...a,start_balance:l,end_balance:l+a.allocated-a.spent}});for(const[a,l]of Object.entries(e))n.has(a)||i.push({category_id:a,start_balance:l,allocated:0,spent:0,end_balance:l});return i}function aM(t,e){const n=new Set;for(const a of t.income||[])n.add(a.account_id);for(const a of t.expenses||[])n.add(a.account_id);for(const a of Object.keys(e))n.add(a);for(const a of t.account_balances||[])n.add(a.account_id);const i=[];for(const a of n){const l=e[a]??0,u=(t.income||[]).filter(g=>g.account_id===a).reduce((g,_)=>g+_.amount,0),h=(t.expenses||[]).filter(g=>g.account_id===a).reduce((g,_)=>g+_.amount,0),m=u-h;i.push({account_id:a,start_balance:l,income:u,expenses:h,net_change:m,end_balance:l+m})}return i}function Kx(t){const e={},n={};for(const i of t.category_balances||[])e[i.category_id]=i.end_balance;for(const i of t.account_balances||[])n[i.account_id]=i.end_balance;return{categoryEndBalances:e,accountEndBalances:n,totalIncome:t.total_income}}async function p1(t,e,n){const i=gi(t,e.year,e.month);await xt("months",i,e,`writeMonthData: ${n}`)}async function g1(t,e,n){await tM(t,e,n)}async function y1(t){const{budgetId:e,month:n,description:i,cascadeRecalculation:a=!0}=t;await p1(e,n,i||`${n.year}/${n.month}`),vt.setQueryData(xe.month(e,n.year,n.month),{month:n}),a&&await g1(e,n.year,n.month)}function Ji(){const t=ln();return{writeData:ir({mutationFn:async({budgetId:n,month:i,description:a,cascadeRecalculation:l=!0})=>(await p1(n,i,a||`${i.year}/${i.month}`),{budgetId:n,year:i.year,month:i.month,cascadeRecalculation:l}),onMutate:async({budgetId:n,month:i})=>{const a=xe.month(n,i.year,i.month);await t.cancelQueries({queryKey:a});const l=t.getQueryData(a);return t.setQueryData(a,{month:i}),{oldMonthQueryData:l,monthKey:a}},onSuccess:async({budgetId:n,year:i,month:a,cascadeRecalculation:l})=>{l&&await g1(n,i,a)},onError:(n,i,a)=>{a?.oldMonthQueryData&&t.setQueryData(a.monthKey,a.oldMonthQueryData)}})}}function oM(t){const e={},n={};return t.category_balances&&t.category_balances.forEach(i=>{e[i.category_id]=i.end_balance}),t.account_balances&&t.account_balances.forEach(i=>{n[i.account_id]=i.end_balance}),{categoryEndBalances:e,accountEndBalances:n}}async function lM(t,e,n){const i=new Date,a=i.getFullYear(),l=i.getMonth()+1,u=(e-a)*12+(n-l);if(u>3){const N=`[createMonth] Refusing to create month ${e}/${n} - it's ${u} months in the future (max allowed: 3). This likely indicates a bug in month navigation.`;throw console.error(N),new Error(N)}const h=i.toISOString(),m=gi(t,e,n);let g=0,_={},v={};if(n>1||e>new Date().getFullYear()-10){const{year:N,month:B}=Sy(e,n),H=gi(t,N,B),{exists:F,data:ae}=await ze("months",H,"fetching previous month to create start balances for new month");if(F&&ae){const te={year_month_ordinal:ae.year_month_ordinal??fn(N,B),year:ae.year??N,month:ae.month??B,income:ae.income||[],total_income:ae.total_income??0,previous_month_income:ae.previous_month_income??0,expenses:ae.expenses||[],total_expenses:ae.total_expenses??0,account_balances:ae.account_balances||[],category_balances:ae.category_balances||[],are_allocations_finalized:ae.are_allocations_finalized??!1,created_at:ae.created_at,updated_at:ae.updated_at};g=te.total_income;const{categoryEndBalances:he,accountEndBalances:L}=oM(te);_=he,v=L}}const b=Object.entries(_).map(([N,B])=>({category_id:N,start_balance:B,allocated:0,spent:0,end_balance:B})),w=Object.entries(v).map(([N,B])=>({account_id:N,start_balance:B,income:0,expenses:0,net_change:0,end_balance:B})),C={budget_id:t,year_month_ordinal:fn(e,n),year:e,month:n,income:[],total_income:0,previous_month_income:g,expenses:[],total_expenses:0,account_balances:w,category_balances:b,are_allocations_finalized:!1,created_at:h,updated_at:h},R={budget_id:t,year_month_ordinal:fn(e,n),year:e,month:n,income:[],total_income:0,previous_month_income:g,expenses:[],total_expenses:0,account_balances:w,category_balances:b,are_allocations_finalized:!1,created_at:h,updated_at:h};return await xt("months",m,R,"creating new month document (first time viewing this month)"),vt.setQueryData(xe.month(t,e,n),{month:C}),await nM(t,e,n,!1),C}function cM(t,e,n,i){const a={};t.category_balances&&t.category_balances.forEach(u=>{a[u.category_id]=u});const l=t.expenses??[];return e.map(u=>{const m=a[u]?.start_balance??0,g=n[u]??0,_=l.filter(v=>v.category_id===u).reduce((v,b)=>v+b.amount,0);return{category_id:u,start_balance:m,allocated:g,spent:_,end_balance:m+g-_}})}function uM(){const{writeData:t}=Ji();return{saveDraftAllocations:async(n,i,a,l)=>{const u=await Zi(n,i,a,"save draft allocations"),h=u.category_balances.map(g=>({...g,allocated:l[g.category_id]??g.allocated})),m={...u,category_balances:h,updated_at:new Date().toISOString()};return await t.mutateAsync({budgetId:n,month:m,cascadeRecalculation:!1}),{updatedMonth:m}},isPending:t.isPending,isError:t.isError,error:t.error}}function dM(t){const e={};return Object.entries(t).forEach(([n,i])=>{e[n]={name:i.name,category_group_id:i.category_group_id??null,sort_order:i.sort_order,balance:i.balance??0},i.description!==void 0&&(e[n].description=i.description),i.default_monthly_amount!==void 0&&(e[n].default_monthly_amount=i.default_monthly_amount),i.default_monthly_type!==void 0&&(e[n].default_monthly_type=i.default_monthly_type)}),e}function hM(){const t=ln();return{updateCategories:ir({mutationFn:async({budgetId:n,categories:i})=>{const{exists:a,data:l}=await ze("budgets",n,"PRE-EDIT-READ");if(!a||!l)throw new Error("Budget not found");const u=dM(i);return await xt("budgets",n,{...l,categories:u},"saving updated categories (user edited category settings)"),i},onMutate:async({budgetId:n,categories:i})=>{await t.cancelQueries({queryKey:xe.budget(n)});const a=t.getQueryData(xe.budget(n));return a&&t.setQueryData(xe.budget(n),{...a,categories:i}),{previousData:a}},onSuccess:(n,{budgetId:i})=>{const a=t.getQueryData(xe.budget(i));a&&t.setQueryData(xe.budget(i),{...a,categories:n})},onError:(n,{budgetId:i},a)=>{a?.previousData&&t.setQueryData(xe.budget(i),a.previousData)}})}}function fM(){const t=ln();return{updateCategoryGroups:ir({mutationFn:async({budgetId:n,categoryGroups:i})=>{const{exists:a,data:l}=await ze("budgets",n,"PRE-EDIT-READ");if(!a||!l)throw new Error("Budget not found");return await xt("budgets",n,{...l,category_groups:i},"saving updated category groups (user edited group settings)"),i},onMutate:async({budgetId:n,categoryGroups:i})=>{await t.cancelQueries({queryKey:xe.budget(n)});const a=t.getQueryData(xe.budget(n));return a&&t.setQueryData(xe.budget(n),{...a,categoryGroups:i}),{previousData:a}},onSuccess:(n,{budgetId:i})=>{const a=t.getQueryData(xe.budget(i));a&&t.setQueryData(xe.budget(i),{...a,categoryGroups:n})},onError:(n,{budgetId:i},a)=>{a?.previousData&&t.setQueryData(xe.budget(i),a.previousData)}})}}async function _1(t,e){if(e.length===0)return;const n=e.filter(h=>h.delta!==0);if(n.length===0)return;const i=vt.getQueryData(xe.budget(t));if(!i)return;let a=0;const l={...i.categories};for(const{categoryId:h,delta:m}of n)l[h]&&(l[h]={...l[h],balance:l[h].balance+m},a+=m);const u=i.budget?{...i.budget,total_available:i.budget.total_available-a}:i.budget;vt.setQueryData(xe.budget(t),{...i,categories:l,budget:u})}function mM(){const{writeData:t}=Ji();return{finalizeAllocations:async n=>{const{budgetId:i,year:a,month:l,allocations:u}=n,h=await Zi(i,a,l,"finalize allocations"),m=h.category_balances?.map(w=>w.category_id)??Object.keys(u),g={};if(h.are_allocations_finalized&&h.category_balances)for(const w of h.category_balances)g[w.category_id]=w.allocated;const _=m.length>0?cM(h,m,u):h.category_balances,v={...h,category_balances:_,are_allocations_finalized:!0,updated_at:new Date().toISOString()};await t.mutateAsync({budgetId:i,month:v,description:"finalize allocations"});const b=m.map(w=>({categoryId:w,delta:(u[w]??0)-(g[w]??0)}));return await _1(i,b),{updatedMonth:v}},isPending:t.isPending,isError:t.isError,error:t.error}}function pM(){const{writeData:t}=Ji();return{deleteAllocations:async n=>{const{budgetId:i,year:a,month:l}=n,u=await Zi(i,a,l,"delete allocations"),h=[];if(u.are_allocations_finalized&&u.category_balances)for(const _ of u.category_balances)_.allocated>0&&h.push({categoryId:_.category_id,allocated:_.allocated});const m=u.category_balances.map(_=>({..._,allocated:0,end_balance:_.start_balance-_.spent})),g={...u,category_balances:m,are_allocations_finalized:!1,updated_at:new Date().toISOString()};if(await t.mutateAsync({budgetId:i,month:g,description:"delete allocations"}),h.length>0){const _=h.map(({categoryId:v,allocated:b})=>({categoryId:v,delta:-b}));await _1(i,_)}return{updatedMonth:g}},isPending:t.isPending,isError:t.isError,error:t.error}}async function mf(t,e,n){const i=e.trim();if(!i||n.includes(i))return null;const a=[...n,i].sort((l,u)=>l.toLowerCase().localeCompare(u.toLowerCase()));return await xt("payees",t,{budget_id:t,payees:a,updated_at:new Date().toISOString()},`adding new payee "${i}" to autocomplete list`),a}function Cl(t){const e=t.income||[],n=t.expenses||[],i=e.reduce((h,m)=>h+m.amount,0),a=n.reduce((h,m)=>h+m.amount,0),l=gM(t),u=yM(t);return{...t,total_income:i,total_expenses:a,account_balances:l,category_balances:u}}function gM(t){const e=t.income||[],n=t.expenses||[],i=t.account_balances||[],a=new Map;for(const h of i)a.set(h.account_id,h);const l=new Set;for(const h of e)l.add(h.account_id);for(const h of n)l.add(h.account_id);for(const h of i)l.add(h.account_id);const u=[];for(const h of l){const g=a.get(h)?.start_balance??0,_=e.filter(w=>w.account_id===h).reduce((w,C)=>w+C.amount,0),v=n.filter(w=>w.account_id===h).reduce((w,C)=>w+C.amount,0),b=_-v;u.push({account_id:h,start_balance:g,income:_,expenses:v,net_change:b,end_balance:g+b})}return u}function yM(t){const e=t.expenses||[],n=t.category_balances||[],i=new Map;for(const h of n)i.set(h.category_id,h);const a=new Map;for(const h of e){const m=a.get(h.category_id)||0;a.set(h.category_id,m+h.amount)}const l=new Set;for(const h of n)l.add(h.category_id);for(const h of e)l.add(h.category_id);const u=[];for(const h of l){const m=i.get(h),g=a.get(h)??0;m?u.push({...m,spent:g,end_balance:m.start_balance+m.allocated-g}):u.push({category_id:h,start_balance:0,allocated:0,spent:g,end_balance:-g})}return u}function _M(t,e){let n=0;for(const{accountId:i,delta:a}of e){const l=t.accounts[i];if(!l)continue;const u=l.account_group_id?t.accountGroups[l.account_group_id]:void 0,h=u?.on_budget!==void 0?u.on_budget:l.on_budget!==!1,m=u?.is_active!==void 0?u.is_active:l.is_active!==!1;h&&m&&(n+=a)}return n}async function ta(t,e){if(e.length===0)return;const n=e.filter(h=>h.delta!==0);if(n.length===0)return;const i=vt.getQueryData(xe.budget(t));if(!i)return;const a=_M(i,n),l={...i.accounts};for(const{accountId:h,delta:m}of n)l[h]&&(l[h]={...l[h],balance:l[h].balance+m});const u=i.budget?{...i.budget,total_available:i.budget.total_available+a}:i.budget;vt.setQueryData(xe.budget(t),{...i,accounts:l,budget:u})}function vM(){const t=ln(),{writeData:e}=Ji();return{addIncome:async(i,a,l,u,h,m,g,_)=>{const v=await Zi(i,a,l,"add income"),b={id:`income_${Date.now()}_${Math.random().toString(36).substr(2,9)}`,amount:u,account_id:h,date:m,created_at:new Date().toISOString()};g?.trim()&&(b.payee=g.trim()),_&&(b.description=_);const w=[...v.income||[],b],C=Cl({...v,income:w,updated_at:new Date().toISOString()});if(await e.mutateAsync({budgetId:i,month:C,description:"add income"}),await ta(i,[{accountId:h,delta:u}]),g?.trim()){const R=t.getQueryData(xe.payees(i))||[],N=await mf(i,g,R);N&&t.setQueryData(xe.payees(i),N)}return{updatedMonth:C,newIncome:b}},isPending:e.isPending,isError:e.isError,error:e.error}}function bM(){const t=ln(),{writeData:e}=Ji();return{updateIncome:async(i,a,l,u,h,m,g,_,v)=>{const b=await Zi(i,a,l,"update income"),w=(b.income||[]).find(F=>F.id===u),C=w?.amount??0,R=w?.account_id??m,N={id:u,amount:h,account_id:m,date:g,created_at:(b.income||[]).find(F=>F.id===u)?.created_at||new Date().toISOString()};_?.trim()&&(N.payee=_.trim()),v&&(N.description=v);const B=(b.income||[]).map(F=>F.id===u?N:F),H=Cl({...b,income:B,updated_at:new Date().toISOString()});if(await e.mutateAsync({budgetId:i,month:H,description:"update income"}),R===m?await ta(i,[{accountId:m,delta:h-C}]):await ta(i,[{accountId:R,delta:-C},{accountId:m,delta:h}]),_?.trim()){const F=t.getQueryData(xe.payees(i))||[],ae=await mf(i,_,F);ae&&t.setQueryData(xe.payees(i),ae)}return{updatedMonth:H}},isPending:e.isPending,isError:e.isError,error:e.error}}function xM(){const{writeData:t}=Ji();return{deleteIncome:async(n,i,a,l)=>{const u=await Zi(n,i,a,"delete income"),h=(u.income||[]).find(b=>b.id===l),m=h?.amount??0,g=h?.account_id,_=(u.income||[]).filter(b=>b.id!==l),v=Cl({...u,income:_,updated_at:new Date().toISOString()});return await t.mutateAsync({budgetId:n,month:v,description:"delete income"}),g&&m>0&&await ta(n,[{accountId:g,delta:-m}]),{updatedMonth:v}},isPending:t.isPending,isError:t.isError,error:t.error}}function EM(){const t=ln(),{writeData:e}=Ji();return{addExpense:async(i,a,l,u,h,m,g,_,v,b)=>{const w=await Zi(i,a,l,"add expense"),C={id:`expense_${Date.now()}_${Math.random().toString(36).substr(2,9)}`,amount:u,category_id:h,account_id:m,date:g,created_at:new Date().toISOString()};_?.trim()&&(C.payee=_.trim()),v&&(C.description=v),b!==void 0&&(C.cleared=b);const R=[...w.expenses||[],C],N=Cl({...w,expenses:R,updated_at:new Date().toISOString()});if(await e.mutateAsync({budgetId:i,month:N,description:"add expense"}),await ta(i,[{accountId:m,delta:-u}]),_?.trim()){const B=t.getQueryData(xe.payees(i))||[],H=await mf(i,_,B);H&&t.setQueryData(xe.payees(i),H)}return{updatedMonth:N,newExpense:C}},isPending:e.isPending,isError:e.isError,error:e.error}}function SM(){const t=ln(),{writeData:e}=Ji();return{updateExpense:async(i,a,l,u,h,m,g,_,v,b,w)=>{const C=await Zi(i,a,l,"update expense"),R=(C.expenses||[]).find(te=>te.id===u),N=R?.amount??0,B=R?.account_id??g,H={id:u,amount:h,category_id:m,account_id:g,date:_,created_at:C.expenses?.find(te=>te.id===u)?.created_at||new Date().toISOString()};v?.trim()&&(H.payee=v.trim()),b&&(H.description=b),w!==void 0&&(H.cleared=w);const F=(C.expenses||[]).map(te=>te.id===u?H:te),ae=Cl({...C,expenses:F,updated_at:new Date().toISOString()});if(await e.mutateAsync({budgetId:i,month:ae,description:"update expense"}),B===g?await ta(i,[{accountId:g,delta:N-h}]):await ta(i,[{accountId:B,delta:N},{accountId:g,delta:-h}]),v?.trim()){const te=t.getQueryData(xe.payees(i))||[],he=await mf(i,v,te);he&&t.setQueryData(xe.payees(i),he)}return{updatedMonth:ae}},isPending:e.isPending,isError:e.isError,error:e.error}}function wM(){const{writeData:t}=Ji();return{deleteExpense:async(n,i,a,l)=>{const u=await Zi(n,i,a,"delete expense"),h=(u.expenses||[]).find(b=>b.id===l),m=h?.amount??0,g=h?.account_id,_=(u.expenses||[]).filter(b=>b.id!==l),v=Cl({...u,expenses:_,updated_at:new Date().toISOString()});return await t.mutateAsync({budgetId:n,month:v,description:"delete expense"}),g&&m>0&&await ta(n,[{accountId:g,delta:m}]),{updatedMonth:v}},isPending:t.isPending,isError:t.isError,error:t.error}}function fh(t,e){return`${t}${e.toString().padStart(2,"0")}`}function TM(t){const e=parseInt(t.slice(0,4),10),n=parseInt(t.slice(4,6),10);return{year:e,month:n}}function AM(t={}){const e={};return Object.entries(t).forEach(([n,i])=>{const a=i;e[n]={needs_recalculation:a?.needs_recalculation??!1}}),e}function CM(t){return Object.entries(t).filter(([,e])=>e.needs_recalculation).map(([e])=>e).sort()}function RM(t){return Object.keys(t).sort()}async function DM(t,e){const{year:n,month:i}=TM(e),a=gi(t,n,i),{exists:l,data:u}=await ze("months",a,`fetching month ${n}/${i} for recalculation`);return!l||!u?null:{id:a,budget_id:t,year_month_ordinal:u.year_month_ordinal??fn(n,i),year:u.year??n,month:u.month??i,income:u.income||[],total_income:u.total_income??0,previous_month_income:u.previous_month_income??0,expenses:u.expenses||[],total_expenses:u.total_expenses??0,account_balances:u.account_balances||[],category_balances:u.category_balances||[],are_allocations_finalized:u.are_allocations_finalized??!1,created_at:u.created_at,updated_at:u.updated_at}}async function IM(t,e){const n=RM(e),i=[];for(const a of n){const l=await DM(t,a);l&&i.push(l)}return i}function jM(t,e){for(let n=0;n<t.length;n++){const i=fh(t[n].year,t[n].month);if(e[i]?.needs_recalculation)return n}return-1}async function v1(t,e={}){const n=new Date,i=fh(n.getFullYear(),n.getMonth()+1),a=e.triggeringMonthOrdinal||i;console.log(`[Recalculation] Starting for budget ${t}`,{triggeringMonth:a});const{exists:l,data:u}=await ze("budgets",t,"reading budget for recalculation (getting month_map)");if(!l||!u)return console.warn(`[Recalculation] Budget ${t} not found`),{monthsRecalculated:0,budgetUpdated:!1};const h=AM(u.month_map);if(CM(h).length===0&&!u.is_needs_recalculation)return console.log("[Recalculation] No months need recalculation"),{monthsRecalculated:0,budgetUpdated:!1};const g=await IM(t,h);if(g.length===0)return console.log("[Recalculation] No months found, nothing to recalculate"),await Wx(t,h),{monthsRecalculated:0,budgetUpdated:!0};const _=jM(g,h),v=_>0?_-1:-1,b=_>=0?_:0,w=g.length-1;let C=rM;if(v>=0&&(C=Kx(g[v])),_<0)return console.log("[Recalculation] No months marked as needing recalculation, but budget flag was set"),await Wx(t,h),{monthsRecalculated:0,budgetUpdated:!0};console.log(`[Recalculation] Recalculating months ${b} to ${w}`,{totalMonths:g.length,startingFrom:v>=0?fh(g[v].year,g[v].month):"beginning",firstStaleMonth:fh(g[_].year,g[_].month)});let R=0;for(let F=b;F<=w;F++){const ae=g[F],te=iM(ae,C);await y1({budgetId:t,month:te,description:`recalculating month ${ae.year}/${ae.month}`,cascadeRecalculation:!1}),C=Kx(te),R++,console.log(`[Recalculation] Completed ${ae.year}/${ae.month}`)}let N,B;return(R>0?w:v)>=0&&(N=C.accountEndBalances,B=C.categoryEndBalances),await OM(t,N||{},B||{},h),console.log("[Recalculation] Complete",{monthsRecalculated:R,budgetUpdated:!0}),{monthsRecalculated:R,budgetUpdated:!0,finalAccountBalances:N}}function b1(t){const e={};for(const n of Object.keys(t))e[n]={needs_recalculation:!1};return e}async function OM(t,e,n,i){const{exists:a,data:l}=await ze("budgets",t,"reading budget for balance update");if(!a||!l){console.warn(`[Recalculation] Budget ${t} not found when updating balances`);return}const u={...l.accounts};for(const[w,C]of Object.entries(e))u[w]&&(u[w]={...u[w],balance:C});const h={...l.categories};for(const[w,C]of Object.entries(n))h[w]&&(h[w]={...h[w],balance:C});const m=l.account_groups||{},g=Object.entries(u).reduce((w,[,C])=>{const R=C.account_group_id?m[C.account_group_id]:void 0,N=R?.on_budget!==void 0?R.on_budget:C.on_budget!==!1,B=R?.is_active!==void 0?R.is_active:C.is_active!==!1;return N&&B?w+(C.balance??0):w},0),_=Object.values(h).reduce((w,C)=>w+(C.balance??0),0),v=g-_,b=b1(i);await xt("budgets",t,{...l,accounts:u,categories:h,total_available:v,is_needs_recalculation:!1,month_map:b,updated_at:new Date().toISOString()},"saving recalculated balances and clearing month_map flags")}async function Wx(t,e){const{exists:n,data:i}=await ze("budgets",t,"reading budget to clear recalc flag");if(!n||!i)return;const a=i.accounts||{},l=i.categories||{},u=i.account_groups||{},h=Object.entries(a).reduce((v,[,b])=>{const w=b.account_group_id?u[b.account_group_id]:void 0,C=w?.on_budget!==void 0?w.on_budget:b.on_budget!==!1,R=w?.is_active!==void 0?w.is_active:b.is_active!==!1;return C&&R?v+(b.balance??0):v},0),m=Object.values(l).reduce((v,b)=>v+(b.balance??0),0),g=h-m,_=b1(e);await xt("budgets",t,{...i,total_available:g,is_needs_recalculation:!1,month_map:_,updated_at:new Date().toISOString()},"clearing budget recalc flag and month_map flags")}function Yx(t={}){const e={};return Object.entries(t).forEach(([n,i])=>{e[n]={nickname:i.nickname??"",description:i.description??"",balance:i.balance??0,account_group_id:i.account_group_id??null,sort_order:i.sort_order??0,is_income_account:i.is_income_account??!1,is_income_default:i.is_income_default??!1,is_outgo_account:i.is_outgo_account??!1,is_outgo_default:i.is_outgo_default??!1,on_budget:i.on_budget??!0,is_active:i.is_active??!0}}),e}function MM(t={}){const e={};return Object.entries(t).forEach(([n,i])=>{e[n]={name:i.name,sort_order:i.sort_order??0,expected_balance:i.expected_balance??"positive",on_budget:i.on_budget,is_active:i.is_active}}),e}function kM(t={}){const e={};return Object.entries(t).forEach(([n,i])=>{e[n]={name:i.name,description:i.description,category_group_id:i.category_group_id??null,sort_order:i.sort_order??0,default_monthly_amount:i.default_monthly_amount,default_monthly_type:i.default_monthly_type,balance:i.balance??0}}),e}function NM(t=[]){const e=t.map(n=>({id:n.id,name:n.name,sort_order:n.sort_order??0}));return e.sort((n,i)=>n.sort_order-i.sort_order),e}function Xx(t={}){const e={};return Object.entries(t).forEach(([n,i])=>{e[n]={needs_recalculation:i?.needs_recalculation??!1}}),e}async function PM(t){const{exists:e,data:n}=await ze("budgets",t,"loading budget data (cache miss or stale)");if(!e||!n)throw new Error(`Budget ${t} not found`);let i=Yx(n.accounts);const a=n.is_needs_recalculation??!1;if(a){console.log("[Budget] Balances are stale, triggering full recalculation...");const _=await v1(t),{data:v}=await ze("budgets",t,"reading budget after recalculation");v&&(i=Yx(v.accounts)),console.log("[Budget] Recalculation complete",{monthsRecalculated:_.monthsRecalculated})}const l=MM(n.account_groups),u=kM(n.categories),h=NM(n.category_groups);let m=n.total_available??0,g=Xx(n.month_map);if(a){const{data:_}=await ze("budgets",t,"reading budget total_available after recalculation");_?.total_available!==void 0&&(m=_.total_available),_?.month_map&&(g=Xx(_.month_map))}return{budget:{id:t,name:n.name,user_ids:n.user_ids||[],accepted_user_ids:n.accepted_user_ids||[],owner_id:n.owner_id||n.user_ids?.[0]||"",owner_email:n.owner_email||"",accounts:i,account_groups:l,categories:u,category_groups:h,total_available:m,is_needs_recalculation:!1,month_map:g},accounts:i,accountGroups:l,categories:u,categoryGroups:h,isNeedsRecalculation:!1,monthMap:g}}function LM(t,e){return yl({queryKey:t?xe.budget(t):["budget","none"],queryFn:()=>PM(t),enabled:!!t&&e?.enabled!==!1})}function VM(t,e,n,i){return{budget_id:e,year_month_ordinal:t.year_month_ordinal??fn(n,i),year:t.year??n,month:t.month??i,income:t.income||[],total_income:t.total_income??0,previous_month_income:t.previous_month_income??0,expenses:t.expenses||[],total_expenses:t.total_expenses??0,account_balances:t.account_balances||[],category_balances:t.category_balances||[],are_allocations_finalized:t.are_allocations_finalized??!1,created_at:t.created_at,updated_at:t.updated_at}}async function zM(t,e,n,i){const a=gi(t,e,n);return(await vt.fetchQuery({queryKey:xe.month(t,e,n),queryFn:async()=>{const{exists:u,data:h}=await ze("months",a,i?.description??`reading month ${e}/${n}`);return!u||!h?null:{month:VM(h,t,e,n)}},staleTime:bS}))?.month??null}async function Zi(t,e,n,i){const a=gi(t,e,n),l=i?`PRE-EDIT-READ: ${i}`:"PRE-EDIT-READ",{exists:u,data:h}=await ze("months",a,l);if(!u||!h)throw new Error(`Month data not found for ${e}/${n}`);return h}async function UM(t,e,n,i){const a=fn(e,n);return(await Sr("months","getFutureMonths: querying months after specified month",[{field:"budget_id",op:"==",value:t},{field:"year_month_ordinal",op:">",value:a}])).docs.map(h=>({id:h.id,...h.data})).sort((h,m)=>h.year!==m.year?h.year-m.year:h.month-m.month)}function BM(t,e,n,i){return{budget_id:e,year_month_ordinal:t.year_month_ordinal??fn(n,i),year:t.year??n,month:t.month??i,income:t.income||[],total_income:t.total_income??0,previous_month_income:t.previous_month_income??0,expenses:t.expenses||[],total_expenses:t.total_expenses??0,account_balances:t.account_balances||[],category_balances:t.category_balances||[],are_allocations_finalized:t.are_allocations_finalized??!1,created_at:t.created_at,updated_at:t.updated_at}}async function FM(t,e,n){const i=gi(t,e,n),{exists:a,data:l}=await ze("months",i,`loading month ${e}/${n}`);return!a||!l?null:BM(l,t,e,n)}async function qM(t,e,n){const i=await FM(t,e,n);return i||lM(t,e,n)}function GM(t,e,n,i){return yl({queryKey:t?xe.month(t,e,n):["month","none"],queryFn:async()=>({month:await qM(t,e,n)}),enabled:!!t&&i?.enabled!==!1})}async function HM(t){const{exists:e,data:n}=await ze("payees",t,"loading payees for autocomplete (cache miss or stale)");return e&&n?n.payees||[]:[]}function x1(t,e){return yl({queryKey:t?xe.payees(t):["payees","none"],queryFn:()=>HM(t),enabled:!!t&&e?.enabled!==!1})}async function QM(t,e){const{exists:n,data:i}=await ze("users",t,"loading user profile (cache miss or stale)");if(n&&i)return i;const a={uid:t,email:e,budget_ids:[],created_at:new Date().toISOString(),updated_at:new Date().toISOString()};return await xt("users",t,a,"creating new user document (first login)"),a}function $M(t,e,n){return yl({queryKey:t?xe.user(t):["user","none"],queryFn:()=>QM(t,e),enabled:!!t&&n?.enabled!==!1})}async function KM(t,e){const n=await Sr("budgets","loading budgets user has access to (cache miss or stale)",[{field:"user_ids",op:"array-contains",value:t}]),i=[],a=[];for(const l of n.docs){const u=l.data;u.accepted_user_ids?.includes(t)||e?.budget_ids?.includes(l.id)?i.push({id:l.id,name:u.name||"Unnamed Budget",ownerEmail:u.owner_email||null,isOwner:u.owner_id===t,isPending:!1}):a.push({budgetId:l.id,budgetName:u.name||"Unnamed Budget",ownerEmail:u.owner_email||null})}return{budgets:i,pendingInvites:a}}function WM(t,e,n){return yl({queryKey:t?xe.accessibleBudgets(t):["accessibleBudgets","none"],queryFn:async()=>t?KM(t,e):{budgets:[],pendingInvites:[]},enabled:!!t&&n?.enabled!==!1,staleTime:60*1e3})}function YM(t){if(Array.isArray(t))return t;if(t&&typeof t=="object"&&!Array.isArray(t)){const e=t;if(e._methodName==="arrayUnion"&&Array.isArray(e.vc))return console.warn("[fetchFeedback] Found corrupted arrayUnion in feedback document - extracting items from vc"),e.vc}return[]}async function XM(){const t=await Sr("feedback","admin loading all feedback (cache miss or stale)"),e=[];for(const n of t.docs){const i=YM(n.data.items),a=n.data.user_email||n.id;i.forEach(l=>{e.push({...l,doc_id:n.id,user_email:a})})}return{items:e}}function JM(t){return yl({queryKey:xe.feedback(),queryFn:XM,enabled:t?.enabled!==!1})}async function ZM(t,e){return vt.fetchQuery({queryKey:["budgetInvite",t,e],queryFn:async()=>{const{exists:n,data:i}=await ze("budgets",t,"checking if user has pending invite for budget");return!n||!i?null:{isInvited:i.user_ids?.includes(e)??!1,hasAccepted:i.accepted_user_ids?.includes(e)??!1,budgetName:i.name||"Unnamed Budget",ownerEmail:i.owner_email||null}},staleTime:60*1e3})}async function _g(t,e,n){const i=await zM(t,e,n,{description:`fetching month for balance calculation (walking ${e}/${n})`});return i?{year:i.year,month:i.month,category_balances:i.category_balances,are_allocations_finalized:i.are_allocations_finalized,expenses:i.expenses}:null}async function ek(t,e,n,i){const a={};e.forEach(b=>{a[b]=0});const l=await _g(t,n,i);if(l?.category_balances){for(const b of l.category_balances)e.includes(b.category_id)&&(a[b.category_id]=b.end_balance);return a}const u={};e.forEach(b=>{u[b]=0});const h=[];l&&h.push(l);let m=n,g=i,_=!1;const v=120;for(let b=0;b<v&&!_;b++){const w=Sy(m,g);m=w.year,g=w.month;const C=await _g(t,m,g);if(!C)_=!0;else if(C.category_balances){_=!0;for(const R of C.category_balances)e.includes(R.category_id)&&(u[R.category_id]=R.end_balance)}else h.push(C)}h.reverse(),Object.assign(a,u);for(const b of h){if(b.are_allocations_finalized&&b.category_balances)for(const w of b.category_balances)e.includes(w.category_id)&&(a[w.category_id]=(a[w.category_id]||0)+w.allocated);if(b.expenses)for(const w of b.expenses)e.includes(w.category_id)&&(a[w.category_id]=(a[w.category_id]||0)-w.amount)}return a}async function tk(t,e,n,i,a){const l={...n};let u=i,h=a;const m=24;for(let g=0;g<m;g++){const _=JO(u,h);u=_.year,h=_.month;const v=await _g(t,u,h);if(!v)break;if(v.are_allocations_finalized&&v.category_balances)for(const b of v.category_balances)e.includes(b.category_id)&&(l[b.category_id]=(l[b.category_id]||0)+b.allocated);if(v.expenses)for(const b of v.expenses)e.includes(b.category_id)&&(l[b.category_id]=(l[b.category_id]||0)-b.amount)}return l}async function Jx(t,e,n,i){const a=await ek(t,e,n,i),l=await tk(t,e,a,n,i);return{current:a,total:l}}function E1(){return{"dependent-sdk-initialized-before-auth":"Another Firebase SDK was initialized and is trying to use Auth before Auth is initialized. Please be sure to call `initializeAuth` or `getAuth` before starting any other Firebase SDK."}}const nk=E1,S1=new uu("auth","Firebase",E1());const Ph=new Vg("@firebase/auth");function rk(t,...e){Ph.logLevel<=Je.WARN&&Ph.warn(`Auth (${vl}): ${t}`,...e)}function mh(t,...e){Ph.logLevel<=Je.ERROR&&Ph.error(`Auth (${vl}): ${t}`,...e)}function Fr(t,...e){throw wy(t,...e)}function yi(t,...e){return wy(t,...e)}function w1(t,e,n){const i={...nk(),[e]:n};return new uu("auth","Firebase",i).create(e,{appName:t.name})}function $s(t){return w1(t,"operation-not-supported-in-this-environment","Operations that alter the current user are not supported in conjunction with FirebaseServerApp")}function wy(t,...e){if(typeof t!="string"){const n=e[0],i=[...e.slice(1)];return i[0]&&(i[0].appName=t.name),t._errorFactory.create(n,...i)}return S1.create(t,...e)}function Ne(t,e,...n){if(!t)throw wy(e,...n)}function Fi(t){const e="INTERNAL ASSERTION FAILED: "+t;throw mh(e),new Error(e)}function Yi(t,e){t||Fi(e)}function vg(){return typeof self<"u"&&self.location?.href||""}function ik(){return Zx()==="http:"||Zx()==="https:"}function Zx(){return typeof self<"u"&&self.location?.protocol||null}function sk(){return typeof navigator<"u"&&navigator&&"onLine"in navigator&&typeof navigator.onLine=="boolean"&&(ik()||rI()||"connection"in navigator)?navigator.onLine:!0}function ak(){if(typeof navigator>"u")return null;const t=navigator;return t.languages&&t.languages[0]||t.language||null}class xu{constructor(e,n){this.shortDelay=e,this.longDelay=n,Yi(n>e,"Short delay should be less than long delay!"),this.isMobile=eI()||iI()}get(){return sk()?this.isMobile?this.longDelay:this.shortDelay:Math.min(5e3,this.shortDelay)}}function Ty(t,e){Yi(t.emulator,"Emulator should always be set here");const{url:n}=t.emulator;return e?`${n}${e.startsWith("/")?e.slice(1):e}`:n}class T1{static initialize(e,n,i){this.fetchImpl=e,n&&(this.headersImpl=n),i&&(this.responseImpl=i)}static fetch(){if(this.fetchImpl)return this.fetchImpl;if(typeof self<"u"&&"fetch"in self)return self.fetch;if(typeof globalThis<"u"&&globalThis.fetch)return globalThis.fetch;if(typeof fetch<"u")return fetch;Fi("Could not find fetch implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static headers(){if(this.headersImpl)return this.headersImpl;if(typeof self<"u"&&"Headers"in self)return self.Headers;if(typeof globalThis<"u"&&globalThis.Headers)return globalThis.Headers;if(typeof Headers<"u")return Headers;Fi("Could not find Headers implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static response(){if(this.responseImpl)return this.responseImpl;if(typeof self<"u"&&"Response"in self)return self.Response;if(typeof globalThis<"u"&&globalThis.Response)return globalThis.Response;if(typeof Response<"u")return Response;Fi("Could not find Response implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}}const ok={CREDENTIAL_MISMATCH:"custom-token-mismatch",MISSING_CUSTOM_TOKEN:"internal-error",INVALID_IDENTIFIER:"invalid-email",MISSING_CONTINUE_URI:"internal-error",INVALID_PASSWORD:"wrong-password",MISSING_PASSWORD:"missing-password",INVALID_LOGIN_CREDENTIALS:"invalid-credential",EMAIL_EXISTS:"email-already-in-use",PASSWORD_LOGIN_DISABLED:"operation-not-allowed",INVALID_IDP_RESPONSE:"invalid-credential",INVALID_PENDING_TOKEN:"invalid-credential",FEDERATED_USER_ID_ALREADY_LINKED:"credential-already-in-use",MISSING_REQ_TYPE:"internal-error",EMAIL_NOT_FOUND:"user-not-found",RESET_PASSWORD_EXCEED_LIMIT:"too-many-requests",EXPIRED_OOB_CODE:"expired-action-code",INVALID_OOB_CODE:"invalid-action-code",MISSING_OOB_CODE:"internal-error",CREDENTIAL_TOO_OLD_LOGIN_AGAIN:"requires-recent-login",INVALID_ID_TOKEN:"invalid-user-token",TOKEN_EXPIRED:"user-token-expired",USER_NOT_FOUND:"user-token-expired",TOO_MANY_ATTEMPTS_TRY_LATER:"too-many-requests",PASSWORD_DOES_NOT_MEET_REQUIREMENTS:"password-does-not-meet-requirements",INVALID_CODE:"invalid-verification-code",INVALID_SESSION_INFO:"invalid-verification-id",INVALID_TEMPORARY_PROOF:"invalid-credential",MISSING_SESSION_INFO:"missing-verification-id",SESSION_EXPIRED:"code-expired",MISSING_ANDROID_PACKAGE_NAME:"missing-android-pkg-name",UNAUTHORIZED_DOMAIN:"unauthorized-continue-uri",INVALID_OAUTH_CLIENT_ID:"invalid-oauth-client-id",ADMIN_ONLY_OPERATION:"admin-restricted-operation",INVALID_MFA_PENDING_CREDENTIAL:"invalid-multi-factor-session",MFA_ENROLLMENT_NOT_FOUND:"multi-factor-info-not-found",MISSING_MFA_ENROLLMENT_ID:"missing-multi-factor-info",MISSING_MFA_PENDING_CREDENTIAL:"missing-multi-factor-session",SECOND_FACTOR_EXISTS:"second-factor-already-in-use",SECOND_FACTOR_LIMIT_EXCEEDED:"maximum-second-factor-count-exceeded",BLOCKING_FUNCTION_ERROR_RESPONSE:"internal-error",RECAPTCHA_NOT_ENABLED:"recaptcha-not-enabled",MISSING_RECAPTCHA_TOKEN:"missing-recaptcha-token",INVALID_RECAPTCHA_TOKEN:"invalid-recaptcha-token",INVALID_RECAPTCHA_ACTION:"invalid-recaptcha-action",MISSING_CLIENT_TYPE:"missing-client-type",MISSING_RECAPTCHA_VERSION:"missing-recaptcha-version",INVALID_RECAPTCHA_VERSION:"invalid-recaptcha-version",INVALID_REQ_TYPE:"invalid-req-type"};const lk=["/v1/accounts:signInWithCustomToken","/v1/accounts:signInWithEmailLink","/v1/accounts:signInWithIdp","/v1/accounts:signInWithPassword","/v1/accounts:signInWithPhoneNumber","/v1/token"],ck=new xu(3e4,6e4);function $a(t,e){return t.tenantId&&!e.tenantId?{...e,tenantId:t.tenantId}:e}async function ia(t,e,n,i,a={}){return A1(t,a,async()=>{let l={},u={};i&&(e==="GET"?u=i:l={body:JSON.stringify(i)});const h=du({key:t.config.apiKey,...u}).slice(1),m=await t._getAdditionalHeaders();m["Content-Type"]="application/json",t.languageCode&&(m["X-Firebase-Locale"]=t.languageCode);const g={method:e,headers:m,...l};return nI()||(g.referrerPolicy="no-referrer"),t.emulatorConfig&&_l(t.emulatorConfig.host)&&(g.credentials="include"),T1.fetch()(await C1(t,t.config.apiHost,n,h),g)})}async function A1(t,e,n){t._canInitEmulator=!1;const i={...ok,...e};try{const a=new dk(t),l=await Promise.race([n(),a.promise]);a.clearNetworkTimeout();const u=await l.json();if("needConfirmation"in u)throw ih(t,"account-exists-with-different-credential",u);if(l.ok&&!("errorMessage"in u))return u;{const h=l.ok?u.errorMessage:u.error.message,[m,g]=h.split(" : ");if(m==="FEDERATED_USER_ID_ALREADY_LINKED")throw ih(t,"credential-already-in-use",u);if(m==="EMAIL_EXISTS")throw ih(t,"email-already-in-use",u);if(m==="USER_DISABLED")throw ih(t,"user-disabled",u);const _=i[m]||m.toLowerCase().replace(/[_\s]+/g,"-");if(g)throw w1(t,_,g);Fr(t,_)}}catch(a){if(a instanceof Xi)throw a;Fr(t,"network-request-failed",{message:String(a)})}}async function pf(t,e,n,i,a={}){const l=await ia(t,e,n,i,a);return"mfaPendingCredential"in l&&Fr(t,"multi-factor-auth-required",{_serverResponse:l}),l}async function C1(t,e,n,i){const a=`${e}${n}?${i}`,l=t,u=l.config.emulator?Ty(t.config,a):`${t.config.apiScheme}://${a}`;return lk.includes(n)&&(await l._persistenceManagerAvailable,l._getPersistenceType()==="COOKIE")?l._getPersistence()._getFinalTarget(u).toString():u}function uk(t){switch(t){case"ENFORCE":return"ENFORCE";case"AUDIT":return"AUDIT";case"OFF":return"OFF";default:return"ENFORCEMENT_STATE_UNSPECIFIED"}}class dk{clearNetworkTimeout(){clearTimeout(this.timer)}constructor(e){this.auth=e,this.timer=null,this.promise=new Promise((n,i)=>{this.timer=setTimeout(()=>i(yi(this.auth,"network-request-failed")),ck.get())})}}function ih(t,e,n){const i={appName:t.name};n.email&&(i.email=n.email),n.phoneNumber&&(i.phoneNumber=n.phoneNumber);const a=yi(t,e,i);return a.customData._tokenResponse=n,a}function eE(t){return t!==void 0&&t.enterprise!==void 0}class hk{constructor(e){if(this.siteKey="",this.recaptchaEnforcementState=[],e.recaptchaKey===void 0)throw new Error("recaptchaKey undefined");this.siteKey=e.recaptchaKey.split("/")[3],this.recaptchaEnforcementState=e.recaptchaEnforcementState}getProviderEnforcementState(e){if(!this.recaptchaEnforcementState||this.recaptchaEnforcementState.length===0)return null;for(const n of this.recaptchaEnforcementState)if(n.provider&&n.provider===e)return uk(n.enforcementState);return null}isProviderEnabled(e){return this.getProviderEnforcementState(e)==="ENFORCE"||this.getProviderEnforcementState(e)==="AUDIT"}isAnyProviderEnabled(){return this.isProviderEnabled("EMAIL_PASSWORD_PROVIDER")||this.isProviderEnabled("PHONE_PROVIDER")}}async function fk(t,e){return ia(t,"GET","/v2/recaptchaConfig",$a(t,e))}async function mk(t,e){return ia(t,"POST","/v1/accounts:delete",e)}async function Lh(t,e){return ia(t,"POST","/v1/accounts:lookup",e)}function $c(t){if(t)try{const e=new Date(Number(t));if(!isNaN(e.getTime()))return e.toUTCString()}catch{}}async function pk(t,e=!1){const n=mn(t),i=await n.getIdToken(e),a=Ay(i);Ne(a&&a.exp&&a.auth_time&&a.iat,n.auth,"internal-error");const l=typeof a.firebase=="object"?a.firebase:void 0,u=l?.sign_in_provider;return{claims:a,token:i,authTime:$c(Np(a.auth_time)),issuedAtTime:$c(Np(a.iat)),expirationTime:$c(Np(a.exp)),signInProvider:u||null,signInSecondFactor:l?.sign_in_second_factor||null}}function Np(t){return Number(t)*1e3}function Ay(t){const[e,n,i]=t.split(".");if(e===void 0||n===void 0||i===void 0)return mh("JWT malformed, contained fewer than 3 sections"),null;try{const a=SS(n);return a?JSON.parse(a):(mh("Failed to decode base64 JWT payload"),null)}catch(a){return mh("Caught error parsing JWT payload as JSON",a?.toString()),null}}function tE(t){const e=Ay(t);return Ne(e,"internal-error"),Ne(typeof e.exp<"u","internal-error"),Ne(typeof e.iat<"u","internal-error"),Number(e.exp)-Number(e.iat)}async function nu(t,e,n=!1){if(n)return e;try{return await e}catch(i){throw i instanceof Xi&&gk(i)&&t.auth.currentUser===t&&await t.auth.signOut(),i}}function gk({code:t}){return t==="auth/user-disabled"||t==="auth/user-token-expired"}class yk{constructor(e){this.user=e,this.isRunning=!1,this.timerId=null,this.errorBackoff=3e4}_start(){this.isRunning||(this.isRunning=!0,this.schedule())}_stop(){this.isRunning&&(this.isRunning=!1,this.timerId!==null&&clearTimeout(this.timerId))}getInterval(e){if(e){const n=this.errorBackoff;return this.errorBackoff=Math.min(this.errorBackoff*2,96e4),n}else{this.errorBackoff=3e4;const i=(this.user.stsTokenManager.expirationTime??0)-Date.now()-3e5;return Math.max(0,i)}}schedule(e=!1){if(!this.isRunning)return;const n=this.getInterval(e);this.timerId=setTimeout(async()=>{await this.iteration()},n)}async iteration(){try{await this.user.getIdToken(!0)}catch(e){e?.code==="auth/network-request-failed"&&this.schedule(!0);return}this.schedule()}}class bg{constructor(e,n){this.createdAt=e,this.lastLoginAt=n,this._initializeTime()}_initializeTime(){this.lastSignInTime=$c(this.lastLoginAt),this.creationTime=$c(this.createdAt)}_copy(e){this.createdAt=e.createdAt,this.lastLoginAt=e.lastLoginAt,this._initializeTime()}toJSON(){return{createdAt:this.createdAt,lastLoginAt:this.lastLoginAt}}}async function Vh(t){const e=t.auth,n=await t.getIdToken(),i=await nu(t,Lh(e,{idToken:n}));Ne(i?.users.length,e,"internal-error");const a=i.users[0];t._notifyReloadListener(a);const l=a.providerUserInfo?.length?R1(a.providerUserInfo):[],u=vk(t.providerData,l),h=t.isAnonymous,m=!(t.email&&a.passwordHash)&&!u?.length,g=h?m:!1,_={uid:a.localId,displayName:a.displayName||null,photoURL:a.photoUrl||null,email:a.email||null,emailVerified:a.emailVerified||!1,phoneNumber:a.phoneNumber||null,tenantId:a.tenantId||null,providerData:u,metadata:new bg(a.createdAt,a.lastLoginAt),isAnonymous:g};Object.assign(t,_)}async function _k(t){const e=mn(t);await Vh(e),await e.auth._persistUserIfCurrent(e),e.auth._notifyListenersIfCurrent(e)}function vk(t,e){return[...t.filter(i=>!e.some(a=>a.providerId===i.providerId)),...e]}function R1(t){return t.map(({providerId:e,...n})=>({providerId:e,uid:n.rawId||"",displayName:n.displayName||null,email:n.email||null,phoneNumber:n.phoneNumber||null,photoURL:n.photoUrl||null}))}async function bk(t,e){const n=await A1(t,{},async()=>{const i=du({grant_type:"refresh_token",refresh_token:e}).slice(1),{tokenApiHost:a,apiKey:l}=t.config,u=await C1(t,a,"/v1/token",`key=${l}`),h=await t._getAdditionalHeaders();h["Content-Type"]="application/x-www-form-urlencoded";const m={method:"POST",headers:h,body:i};return t.emulatorConfig&&_l(t.emulatorConfig.host)&&(m.credentials="include"),T1.fetch()(u,m)});return{accessToken:n.access_token,expiresIn:n.expires_in,refreshToken:n.refresh_token}}async function xk(t,e){return ia(t,"POST","/v2/accounts:revokeToken",$a(t,e))}class Yo{constructor(){this.refreshToken=null,this.accessToken=null,this.expirationTime=null}get isExpired(){return!this.expirationTime||Date.now()>this.expirationTime-3e4}updateFromServerResponse(e){Ne(e.idToken,"internal-error"),Ne(typeof e.idToken<"u","internal-error"),Ne(typeof e.refreshToken<"u","internal-error");const n="expiresIn"in e&&typeof e.expiresIn<"u"?Number(e.expiresIn):tE(e.idToken);this.updateTokensAndExpiration(e.idToken,e.refreshToken,n)}updateFromIdToken(e){Ne(e.length!==0,"internal-error");const n=tE(e);this.updateTokensAndExpiration(e,null,n)}async getToken(e,n=!1){return!n&&this.accessToken&&!this.isExpired?this.accessToken:(Ne(this.refreshToken,e,"user-token-expired"),this.refreshToken?(await this.refresh(e,this.refreshToken),this.accessToken):null)}clearRefreshToken(){this.refreshToken=null}async refresh(e,n){const{accessToken:i,refreshToken:a,expiresIn:l}=await bk(e,n);this.updateTokensAndExpiration(i,a,Number(l))}updateTokensAndExpiration(e,n,i){this.refreshToken=n||null,this.accessToken=e||null,this.expirationTime=Date.now()+i*1e3}static fromJSON(e,n){const{refreshToken:i,accessToken:a,expirationTime:l}=n,u=new Yo;return i&&(Ne(typeof i=="string","internal-error",{appName:e}),u.refreshToken=i),a&&(Ne(typeof a=="string","internal-error",{appName:e}),u.accessToken=a),l&&(Ne(typeof l=="number","internal-error",{appName:e}),u.expirationTime=l),u}toJSON(){return{refreshToken:this.refreshToken,accessToken:this.accessToken,expirationTime:this.expirationTime}}_assign(e){this.accessToken=e.accessToken,this.refreshToken=e.refreshToken,this.expirationTime=e.expirationTime}_clone(){return Object.assign(new Yo,this.toJSON())}_performRefresh(){return Fi("not implemented")}}function Ms(t,e){Ne(typeof t=="string"||typeof t>"u","internal-error",{appName:e})}class zr{constructor({uid:e,auth:n,stsTokenManager:i,...a}){this.providerId="firebase",this.proactiveRefresh=new yk(this),this.reloadUserInfo=null,this.reloadListener=null,this.uid=e,this.auth=n,this.stsTokenManager=i,this.accessToken=i.accessToken,this.displayName=a.displayName||null,this.email=a.email||null,this.emailVerified=a.emailVerified||!1,this.phoneNumber=a.phoneNumber||null,this.photoURL=a.photoURL||null,this.isAnonymous=a.isAnonymous||!1,this.tenantId=a.tenantId||null,this.providerData=a.providerData?[...a.providerData]:[],this.metadata=new bg(a.createdAt||void 0,a.lastLoginAt||void 0)}async getIdToken(e){const n=await nu(this,this.stsTokenManager.getToken(this.auth,e));return Ne(n,this.auth,"internal-error"),this.accessToken!==n&&(this.accessToken=n,await this.auth._persistUserIfCurrent(this),this.auth._notifyListenersIfCurrent(this)),n}getIdTokenResult(e){return pk(this,e)}reload(){return _k(this)}_assign(e){this!==e&&(Ne(this.uid===e.uid,this.auth,"internal-error"),this.displayName=e.displayName,this.photoURL=e.photoURL,this.email=e.email,this.emailVerified=e.emailVerified,this.phoneNumber=e.phoneNumber,this.isAnonymous=e.isAnonymous,this.tenantId=e.tenantId,this.providerData=e.providerData.map(n=>({...n})),this.metadata._copy(e.metadata),this.stsTokenManager._assign(e.stsTokenManager))}_clone(e){const n=new zr({...this,auth:e,stsTokenManager:this.stsTokenManager._clone()});return n.metadata._copy(this.metadata),n}_onReload(e){Ne(!this.reloadListener,this.auth,"internal-error"),this.reloadListener=e,this.reloadUserInfo&&(this._notifyReloadListener(this.reloadUserInfo),this.reloadUserInfo=null)}_notifyReloadListener(e){this.reloadListener?this.reloadListener(e):this.reloadUserInfo=e}_startProactiveRefresh(){this.proactiveRefresh._start()}_stopProactiveRefresh(){this.proactiveRefresh._stop()}async _updateTokensIfNecessary(e,n=!1){let i=!1;e.idToken&&e.idToken!==this.stsTokenManager.accessToken&&(this.stsTokenManager.updateFromServerResponse(e),i=!0),n&&await Vh(this),await this.auth._persistUserIfCurrent(this),i&&this.auth._notifyListenersIfCurrent(this)}async delete(){if(Vr(this.auth.app))return Promise.reject($s(this.auth));const e=await this.getIdToken();return await nu(this,mk(this.auth,{idToken:e})),this.stsTokenManager.clearRefreshToken(),this.auth.signOut()}toJSON(){return{uid:this.uid,email:this.email||void 0,emailVerified:this.emailVerified,displayName:this.displayName||void 0,isAnonymous:this.isAnonymous,photoURL:this.photoURL||void 0,phoneNumber:this.phoneNumber||void 0,tenantId:this.tenantId||void 0,providerData:this.providerData.map(e=>({...e})),stsTokenManager:this.stsTokenManager.toJSON(),_redirectEventId:this._redirectEventId,...this.metadata.toJSON(),apiKey:this.auth.config.apiKey,appName:this.auth.name}}get refreshToken(){return this.stsTokenManager.refreshToken||""}static _fromJSON(e,n){const i=n.displayName??void 0,a=n.email??void 0,l=n.phoneNumber??void 0,u=n.photoURL??void 0,h=n.tenantId??void 0,m=n._redirectEventId??void 0,g=n.createdAt??void 0,_=n.lastLoginAt??void 0,{uid:v,emailVerified:b,isAnonymous:w,providerData:C,stsTokenManager:R}=n;Ne(v&&R,e,"internal-error");const N=Yo.fromJSON(this.name,R);Ne(typeof v=="string",e,"internal-error"),Ms(i,e.name),Ms(a,e.name),Ne(typeof b=="boolean",e,"internal-error"),Ne(typeof w=="boolean",e,"internal-error"),Ms(l,e.name),Ms(u,e.name),Ms(h,e.name),Ms(m,e.name),Ms(g,e.name),Ms(_,e.name);const B=new zr({uid:v,auth:e,email:a,emailVerified:b,displayName:i,isAnonymous:w,photoURL:u,phoneNumber:l,tenantId:h,stsTokenManager:N,createdAt:g,lastLoginAt:_});return C&&Array.isArray(C)&&(B.providerData=C.map(H=>({...H}))),m&&(B._redirectEventId=m),B}static async _fromIdTokenResponse(e,n,i=!1){const a=new Yo;a.updateFromServerResponse(n);const l=new zr({uid:n.localId,auth:e,stsTokenManager:a,isAnonymous:i});return await Vh(l),l}static async _fromGetAccountInfoResponse(e,n,i){const a=n.users[0];Ne(a.localId!==void 0,"internal-error");const l=a.providerUserInfo!==void 0?R1(a.providerUserInfo):[],u=!(a.email&&a.passwordHash)&&!l?.length,h=new Yo;h.updateFromIdToken(i);const m=new zr({uid:a.localId,auth:e,stsTokenManager:h,isAnonymous:u}),g={uid:a.localId,displayName:a.displayName||null,photoURL:a.photoUrl||null,email:a.email||null,emailVerified:a.emailVerified||!1,phoneNumber:a.phoneNumber||null,tenantId:a.tenantId||null,providerData:l,metadata:new bg(a.createdAt,a.lastLoginAt),isAnonymous:!(a.email&&a.passwordHash)&&!l?.length};return Object.assign(m,g),m}}const nE=new Map;function qi(t){Yi(t instanceof Function,"Expected a class definition");let e=nE.get(t);return e?(Yi(e instanceof t,"Instance stored in cache mismatched with class"),e):(e=new t,nE.set(t,e),e)}class D1{constructor(){this.type="NONE",this.storage={}}async _isAvailable(){return!0}async _set(e,n){this.storage[e]=n}async _get(e){const n=this.storage[e];return n===void 0?null:n}async _remove(e){delete this.storage[e]}_addListener(e,n){}_removeListener(e,n){}}D1.type="NONE";const rE=D1;function ph(t,e,n){return`firebase:${t}:${e}:${n}`}class Xo{constructor(e,n,i){this.persistence=e,this.auth=n,this.userKey=i;const{config:a,name:l}=this.auth;this.fullUserKey=ph(this.userKey,a.apiKey,l),this.fullPersistenceKey=ph("persistence",a.apiKey,l),this.boundEventHandler=n._onStorageEvent.bind(n),this.persistence._addListener(this.fullUserKey,this.boundEventHandler)}setCurrentUser(e){return this.persistence._set(this.fullUserKey,e.toJSON())}async getCurrentUser(){const e=await this.persistence._get(this.fullUserKey);if(!e)return null;if(typeof e=="string"){const n=await Lh(this.auth,{idToken:e}).catch(()=>{});return n?zr._fromGetAccountInfoResponse(this.auth,n,e):null}return zr._fromJSON(this.auth,e)}removeCurrentUser(){return this.persistence._remove(this.fullUserKey)}savePersistenceForRedirect(){return this.persistence._set(this.fullPersistenceKey,this.persistence.type)}async setPersistence(e){if(this.persistence===e)return;const n=await this.getCurrentUser();if(await this.removeCurrentUser(),this.persistence=e,n)return this.setCurrentUser(n)}delete(){this.persistence._removeListener(this.fullUserKey,this.boundEventHandler)}static async create(e,n,i="authUser"){if(!n.length)return new Xo(qi(rE),e,i);const a=(await Promise.all(n.map(async g=>{if(await g._isAvailable())return g}))).filter(g=>g);let l=a[0]||qi(rE);const u=ph(i,e.config.apiKey,e.name);let h=null;for(const g of n)try{const _=await g._get(u);if(_){let v;if(typeof _=="string"){const b=await Lh(e,{idToken:_}).catch(()=>{});if(!b)break;v=await zr._fromGetAccountInfoResponse(e,b,_)}else v=zr._fromJSON(e,_);g!==l&&(h=v),l=g;break}}catch{}const m=a.filter(g=>g._shouldAllowMigration);return!l._shouldAllowMigration||!m.length?new Xo(l,e,i):(l=m[0],h&&await l._set(u,h.toJSON()),await Promise.all(n.map(async g=>{if(g!==l)try{await g._remove(u)}catch{}})),new Xo(l,e,i))}}function iE(t){const e=t.toLowerCase();if(e.includes("opera/")||e.includes("opr/")||e.includes("opios/"))return"Opera";if(M1(e))return"IEMobile";if(e.includes("msie")||e.includes("trident/"))return"IE";if(e.includes("edge/"))return"Edge";if(I1(e))return"Firefox";if(e.includes("silk/"))return"Silk";if(N1(e))return"Blackberry";if(P1(e))return"Webos";if(j1(e))return"Safari";if((e.includes("chrome/")||O1(e))&&!e.includes("edge/"))return"Chrome";if(k1(e))return"Android";{const n=/([a-zA-Z\d\.]+)\/[a-zA-Z\d\.]*$/,i=t.match(n);if(i?.length===2)return i[1]}return"Other"}function I1(t=In()){return/firefox\//i.test(t)}function j1(t=In()){const e=t.toLowerCase();return e.includes("safari/")&&!e.includes("chrome/")&&!e.includes("crios/")&&!e.includes("android")}function O1(t=In()){return/crios\//i.test(t)}function M1(t=In()){return/iemobile/i.test(t)}function k1(t=In()){return/android/i.test(t)}function N1(t=In()){return/blackberry/i.test(t)}function P1(t=In()){return/webos/i.test(t)}function Cy(t=In()){return/iphone|ipad|ipod/i.test(t)||/macintosh/i.test(t)&&/mobile/i.test(t)}function Ek(t=In()){return Cy(t)&&!!window.navigator?.standalone}function Sk(){return sI()&&document.documentMode===10}function L1(t=In()){return Cy(t)||k1(t)||P1(t)||N1(t)||/windows phone/i.test(t)||M1(t)}function V1(t,e=[]){let n;switch(t){case"Browser":n=iE(In());break;case"Worker":n=`${iE(In())}-${t}`;break;default:n=t}const i=e.length?e.join(","):"FirebaseCore-web";return`${n}/JsCore/${vl}/${i}`}class wk{constructor(e){this.auth=e,this.queue=[]}pushCallback(e,n){const i=l=>new Promise((u,h)=>{try{const m=e(l);u(m)}catch(m){h(m)}});i.onAbort=n,this.queue.push(i);const a=this.queue.length-1;return()=>{this.queue[a]=()=>Promise.resolve()}}async runMiddleware(e){if(this.auth.currentUser===e)return;const n=[];try{for(const i of this.queue)await i(e),i.onAbort&&n.push(i.onAbort)}catch(i){n.reverse();for(const a of n)try{a()}catch{}throw this.auth._errorFactory.create("login-blocked",{originalMessage:i?.message})}}}async function Tk(t,e={}){return ia(t,"GET","/v2/passwordPolicy",$a(t,e))}const Ak=6;class Ck{constructor(e){const n=e.customStrengthOptions;this.customStrengthOptions={},this.customStrengthOptions.minPasswordLength=n.minPasswordLength??Ak,n.maxPasswordLength&&(this.customStrengthOptions.maxPasswordLength=n.maxPasswordLength),n.containsLowercaseCharacter!==void 0&&(this.customStrengthOptions.containsLowercaseLetter=n.containsLowercaseCharacter),n.containsUppercaseCharacter!==void 0&&(this.customStrengthOptions.containsUppercaseLetter=n.containsUppercaseCharacter),n.containsNumericCharacter!==void 0&&(this.customStrengthOptions.containsNumericCharacter=n.containsNumericCharacter),n.containsNonAlphanumericCharacter!==void 0&&(this.customStrengthOptions.containsNonAlphanumericCharacter=n.containsNonAlphanumericCharacter),this.enforcementState=e.enforcementState,this.enforcementState==="ENFORCEMENT_STATE_UNSPECIFIED"&&(this.enforcementState="OFF"),this.allowedNonAlphanumericCharacters=e.allowedNonAlphanumericCharacters?.join("")??"",this.forceUpgradeOnSignin=e.forceUpgradeOnSignin??!1,this.schemaVersion=e.schemaVersion}validatePassword(e){const n={isValid:!0,passwordPolicy:this};return this.validatePasswordLengthOptions(e,n),this.validatePasswordCharacterOptions(e,n),n.isValid&&(n.isValid=n.meetsMinPasswordLength??!0),n.isValid&&(n.isValid=n.meetsMaxPasswordLength??!0),n.isValid&&(n.isValid=n.containsLowercaseLetter??!0),n.isValid&&(n.isValid=n.containsUppercaseLetter??!0),n.isValid&&(n.isValid=n.containsNumericCharacter??!0),n.isValid&&(n.isValid=n.containsNonAlphanumericCharacter??!0),n}validatePasswordLengthOptions(e,n){const i=this.customStrengthOptions.minPasswordLength,a=this.customStrengthOptions.maxPasswordLength;i&&(n.meetsMinPasswordLength=e.length>=i),a&&(n.meetsMaxPasswordLength=e.length<=a)}validatePasswordCharacterOptions(e,n){this.updatePasswordCharacterOptionsStatuses(n,!1,!1,!1,!1);let i;for(let a=0;a<e.length;a++)i=e.charAt(a),this.updatePasswordCharacterOptionsStatuses(n,i>="a"&&i<="z",i>="A"&&i<="Z",i>="0"&&i<="9",this.allowedNonAlphanumericCharacters.includes(i))}updatePasswordCharacterOptionsStatuses(e,n,i,a,l){this.customStrengthOptions.containsLowercaseLetter&&(e.containsLowercaseLetter||(e.containsLowercaseLetter=n)),this.customStrengthOptions.containsUppercaseLetter&&(e.containsUppercaseLetter||(e.containsUppercaseLetter=i)),this.customStrengthOptions.containsNumericCharacter&&(e.containsNumericCharacter||(e.containsNumericCharacter=a)),this.customStrengthOptions.containsNonAlphanumericCharacter&&(e.containsNonAlphanumericCharacter||(e.containsNonAlphanumericCharacter=l))}}class Rk{constructor(e,n,i,a){this.app=e,this.heartbeatServiceProvider=n,this.appCheckServiceProvider=i,this.config=a,this.currentUser=null,this.emulatorConfig=null,this.operations=Promise.resolve(),this.authStateSubscription=new sE(this),this.idTokenSubscription=new sE(this),this.beforeStateQueue=new wk(this),this.redirectUser=null,this.isProactiveRefreshEnabled=!1,this.EXPECTED_PASSWORD_POLICY_SCHEMA_VERSION=1,this._canInitEmulator=!0,this._isInitialized=!1,this._deleted=!1,this._initializationPromise=null,this._popupRedirectResolver=null,this._errorFactory=S1,this._agentRecaptchaConfig=null,this._tenantRecaptchaConfigs={},this._projectPasswordPolicy=null,this._tenantPasswordPolicies={},this._resolvePersistenceManagerAvailable=void 0,this.lastNotifiedUid=void 0,this.languageCode=null,this.tenantId=null,this.settings={appVerificationDisabledForTesting:!1},this.frameworks=[],this.name=e.name,this.clientVersion=a.sdkClientVersion,this._persistenceManagerAvailable=new Promise(l=>this._resolvePersistenceManagerAvailable=l)}_initializeWithPersistence(e,n){return n&&(this._popupRedirectResolver=qi(n)),this._initializationPromise=this.queue(async()=>{if(!this._deleted&&(this.persistenceManager=await Xo.create(this,e),this._resolvePersistenceManagerAvailable?.(),!this._deleted)){if(this._popupRedirectResolver?._shouldInitProactively)try{await this._popupRedirectResolver._initialize(this)}catch{}await this.initializeCurrentUser(n),this.lastNotifiedUid=this.currentUser?.uid||null,!this._deleted&&(this._isInitialized=!0)}}),this._initializationPromise}async _onStorageEvent(){if(this._deleted)return;const e=await this.assertedPersistence.getCurrentUser();if(!(!this.currentUser&&!e)){if(this.currentUser&&e&&this.currentUser.uid===e.uid){this._currentUser._assign(e),await this.currentUser.getIdToken();return}await this._updateCurrentUser(e,!0)}}async initializeCurrentUserFromIdToken(e){try{const n=await Lh(this,{idToken:e}),i=await zr._fromGetAccountInfoResponse(this,n,e);await this.directlySetCurrentUser(i)}catch(n){console.warn("FirebaseServerApp could not login user with provided authIdToken: ",n),await this.directlySetCurrentUser(null)}}async initializeCurrentUser(e){if(Vr(this.app)){const l=this.app.settings.authIdToken;return l?new Promise(u=>{setTimeout(()=>this.initializeCurrentUserFromIdToken(l).then(u,u))}):this.directlySetCurrentUser(null)}const n=await this.assertedPersistence.getCurrentUser();let i=n,a=!1;if(e&&this.config.authDomain){await this.getOrInitRedirectPersistenceManager();const l=this.redirectUser?._redirectEventId,u=i?._redirectEventId,h=await this.tryRedirectSignIn(e);(!l||l===u)&&h?.user&&(i=h.user,a=!0)}if(!i)return this.directlySetCurrentUser(null);if(!i._redirectEventId){if(a)try{await this.beforeStateQueue.runMiddleware(i)}catch(l){i=n,this._popupRedirectResolver._overrideRedirectResult(this,()=>Promise.reject(l))}return i?this.reloadAndSetCurrentUserOrClear(i):this.directlySetCurrentUser(null)}return Ne(this._popupRedirectResolver,this,"argument-error"),await this.getOrInitRedirectPersistenceManager(),this.redirectUser&&this.redirectUser._redirectEventId===i._redirectEventId?this.directlySetCurrentUser(i):this.reloadAndSetCurrentUserOrClear(i)}async tryRedirectSignIn(e){let n=null;try{n=await this._popupRedirectResolver._completeRedirectFn(this,e,!0)}catch{await this._setRedirectUser(null)}return n}async reloadAndSetCurrentUserOrClear(e){try{await Vh(e)}catch(n){if(n?.code!=="auth/network-request-failed")return this.directlySetCurrentUser(null)}return this.directlySetCurrentUser(e)}useDeviceLanguage(){this.languageCode=ak()}async _delete(){this._deleted=!0}async updateCurrentUser(e){if(Vr(this.app))return Promise.reject($s(this));const n=e?mn(e):null;return n&&Ne(n.auth.config.apiKey===this.config.apiKey,this,"invalid-user-token"),this._updateCurrentUser(n&&n._clone(this))}async _updateCurrentUser(e,n=!1){if(!this._deleted)return e&&Ne(this.tenantId===e.tenantId,this,"tenant-id-mismatch"),n||await this.beforeStateQueue.runMiddleware(e),this.queue(async()=>{await this.directlySetCurrentUser(e),this.notifyAuthListeners()})}async signOut(){return Vr(this.app)?Promise.reject($s(this)):(await this.beforeStateQueue.runMiddleware(null),(this.redirectPersistenceManager||this._popupRedirectResolver)&&await this._setRedirectUser(null),this._updateCurrentUser(null,!0))}setPersistence(e){return Vr(this.app)?Promise.reject($s(this)):this.queue(async()=>{await this.assertedPersistence.setPersistence(qi(e))})}_getRecaptchaConfig(){return this.tenantId==null?this._agentRecaptchaConfig:this._tenantRecaptchaConfigs[this.tenantId]}async validatePassword(e){this._getPasswordPolicyInternal()||await this._updatePasswordPolicy();const n=this._getPasswordPolicyInternal();return n.schemaVersion!==this.EXPECTED_PASSWORD_POLICY_SCHEMA_VERSION?Promise.reject(this._errorFactory.create("unsupported-password-policy-schema-version",{})):n.validatePassword(e)}_getPasswordPolicyInternal(){return this.tenantId===null?this._projectPasswordPolicy:this._tenantPasswordPolicies[this.tenantId]}async _updatePasswordPolicy(){const e=await Tk(this),n=new Ck(e);this.tenantId===null?this._projectPasswordPolicy=n:this._tenantPasswordPolicies[this.tenantId]=n}_getPersistenceType(){return this.assertedPersistence.persistence.type}_getPersistence(){return this.assertedPersistence.persistence}_updateErrorMap(e){this._errorFactory=new uu("auth","Firebase",e())}onAuthStateChanged(e,n,i){return this.registerStateListener(this.authStateSubscription,e,n,i)}beforeAuthStateChanged(e,n){return this.beforeStateQueue.pushCallback(e,n)}onIdTokenChanged(e,n,i){return this.registerStateListener(this.idTokenSubscription,e,n,i)}authStateReady(){return new Promise((e,n)=>{if(this.currentUser)e();else{const i=this.onAuthStateChanged(()=>{i(),e()},n)}})}async revokeAccessToken(e){if(this.currentUser){const n=await this.currentUser.getIdToken(),i={providerId:"apple.com",tokenType:"ACCESS_TOKEN",token:e,idToken:n};this.tenantId!=null&&(i.tenantId=this.tenantId),await xk(this,i)}}toJSON(){return{apiKey:this.config.apiKey,authDomain:this.config.authDomain,appName:this.name,currentUser:this._currentUser?.toJSON()}}async _setRedirectUser(e,n){const i=await this.getOrInitRedirectPersistenceManager(n);return e===null?i.removeCurrentUser():i.setCurrentUser(e)}async getOrInitRedirectPersistenceManager(e){if(!this.redirectPersistenceManager){const n=e&&qi(e)||this._popupRedirectResolver;Ne(n,this,"argument-error"),this.redirectPersistenceManager=await Xo.create(this,[qi(n._redirectPersistence)],"redirectUser"),this.redirectUser=await this.redirectPersistenceManager.getCurrentUser()}return this.redirectPersistenceManager}async _redirectUserForId(e){return this._isInitialized&&await this.queue(async()=>{}),this._currentUser?._redirectEventId===e?this._currentUser:this.redirectUser?._redirectEventId===e?this.redirectUser:null}async _persistUserIfCurrent(e){if(e===this.currentUser)return this.queue(async()=>this.directlySetCurrentUser(e))}_notifyListenersIfCurrent(e){e===this.currentUser&&this.notifyAuthListeners()}_key(){return`${this.config.authDomain}:${this.config.apiKey}:${this.name}`}_startProactiveRefresh(){this.isProactiveRefreshEnabled=!0,this.currentUser&&this._currentUser._startProactiveRefresh()}_stopProactiveRefresh(){this.isProactiveRefreshEnabled=!1,this.currentUser&&this._currentUser._stopProactiveRefresh()}get _currentUser(){return this.currentUser}notifyAuthListeners(){if(!this._isInitialized)return;this.idTokenSubscription.next(this.currentUser);const e=this.currentUser?.uid??null;this.lastNotifiedUid!==e&&(this.lastNotifiedUid=e,this.authStateSubscription.next(this.currentUser))}registerStateListener(e,n,i,a){if(this._deleted)return()=>{};const l=typeof n=="function"?n:n.next.bind(n);let u=!1;const h=this._isInitialized?Promise.resolve():this._initializationPromise;if(Ne(h,this,"internal-error"),h.then(()=>{u||l(this.currentUser)}),typeof n=="function"){const m=e.addObserver(n,i,a);return()=>{u=!0,m()}}else{const m=e.addObserver(n);return()=>{u=!0,m()}}}async directlySetCurrentUser(e){this.currentUser&&this.currentUser!==e&&this._currentUser._stopProactiveRefresh(),e&&this.isProactiveRefreshEnabled&&e._startProactiveRefresh(),this.currentUser=e,e?await this.assertedPersistence.setCurrentUser(e):await this.assertedPersistence.removeCurrentUser()}queue(e){return this.operations=this.operations.then(e,e),this.operations}get assertedPersistence(){return Ne(this.persistenceManager,this,"internal-error"),this.persistenceManager}_logFramework(e){!e||this.frameworks.includes(e)||(this.frameworks.push(e),this.frameworks.sort(),this.clientVersion=V1(this.config.clientPlatform,this._getFrameworks()))}_getFrameworks(){return this.frameworks}async _getAdditionalHeaders(){const e={"X-Client-Version":this.clientVersion};this.app.options.appId&&(e["X-Firebase-gmpid"]=this.app.options.appId);const n=await this.heartbeatServiceProvider.getImmediate({optional:!0})?.getHeartbeatsHeader();n&&(e["X-Firebase-Client"]=n);const i=await this._getAppCheckToken();return i&&(e["X-Firebase-AppCheck"]=i),e}async _getAppCheckToken(){if(Vr(this.app)&&this.app.settings.appCheckToken)return this.app.settings.appCheckToken;const e=await this.appCheckServiceProvider.getImmediate({optional:!0})?.getToken();return e?.error&&rk(`Error while retrieving App Check token: ${e.error}`),e?.token}}function Rl(t){return mn(t)}class sE{constructor(e){this.auth=e,this.observer=null,this.addObserver=fI(n=>this.observer=n)}get next(){return Ne(this.observer,this.auth,"internal-error"),this.observer.next.bind(this.observer)}}let gf={async loadJS(){throw new Error("Unable to load external scripts")},recaptchaV2Script:"",recaptchaEnterpriseScript:"",gapiScript:""};function Dk(t){gf=t}function z1(t){return gf.loadJS(t)}function Ik(){return gf.recaptchaEnterpriseScript}function jk(){return gf.gapiScript}function Ok(t){return`__${t}${Math.floor(Math.random()*1e6)}`}class Mk{constructor(){this.enterprise=new kk}ready(e){e()}execute(e,n){return Promise.resolve("token")}render(e,n){return""}}class kk{ready(e){e()}execute(e,n){return Promise.resolve("token")}render(e,n){return""}}const Nk="recaptcha-enterprise",U1="NO_RECAPTCHA";class Pk{constructor(e){this.type=Nk,this.auth=Rl(e)}async verify(e="verify",n=!1){async function i(l){if(!n){if(l.tenantId==null&&l._agentRecaptchaConfig!=null)return l._agentRecaptchaConfig.siteKey;if(l.tenantId!=null&&l._tenantRecaptchaConfigs[l.tenantId]!==void 0)return l._tenantRecaptchaConfigs[l.tenantId].siteKey}return new Promise(async(u,h)=>{fk(l,{clientType:"CLIENT_TYPE_WEB",version:"RECAPTCHA_ENTERPRISE"}).then(m=>{if(m.recaptchaKey===void 0)h(new Error("recaptcha Enterprise site key undefined"));else{const g=new hk(m);return l.tenantId==null?l._agentRecaptchaConfig=g:l._tenantRecaptchaConfigs[l.tenantId]=g,u(g.siteKey)}}).catch(m=>{h(m)})})}function a(l,u,h){const m=window.grecaptcha;eE(m)?m.enterprise.ready(()=>{m.enterprise.execute(l,{action:e}).then(g=>{u(g)}).catch(()=>{u(U1)})}):h(Error("No reCAPTCHA enterprise script loaded."))}return this.auth.settings.appVerificationDisabledForTesting?new Mk().execute("siteKey",{action:"verify"}):new Promise((l,u)=>{i(this.auth).then(h=>{if(!n&&eE(window.grecaptcha))a(h,l,u);else{if(typeof window>"u"){u(new Error("RecaptchaVerifier is only supported in browser"));return}let m=Ik();m.length!==0&&(m+=h),z1(m).then(()=>{a(h,l,u)}).catch(g=>{u(g)})}}).catch(h=>{u(h)})})}}async function aE(t,e,n,i=!1,a=!1){const l=new Pk(t);let u;if(a)u=U1;else try{u=await l.verify(n)}catch{u=await l.verify(n,!0)}const h={...e};if(n==="mfaSmsEnrollment"||n==="mfaSmsSignIn"){if("phoneEnrollmentInfo"in h){const m=h.phoneEnrollmentInfo.phoneNumber,g=h.phoneEnrollmentInfo.recaptchaToken;Object.assign(h,{phoneEnrollmentInfo:{phoneNumber:m,recaptchaToken:g,captchaResponse:u,clientType:"CLIENT_TYPE_WEB",recaptchaVersion:"RECAPTCHA_ENTERPRISE"}})}else if("phoneSignInInfo"in h){const m=h.phoneSignInInfo.recaptchaToken;Object.assign(h,{phoneSignInInfo:{recaptchaToken:m,captchaResponse:u,clientType:"CLIENT_TYPE_WEB",recaptchaVersion:"RECAPTCHA_ENTERPRISE"}})}return h}return i?Object.assign(h,{captchaResp:u}):Object.assign(h,{captchaResponse:u}),Object.assign(h,{clientType:"CLIENT_TYPE_WEB"}),Object.assign(h,{recaptchaVersion:"RECAPTCHA_ENTERPRISE"}),h}async function oE(t,e,n,i,a){if(t._getRecaptchaConfig()?.isProviderEnabled("EMAIL_PASSWORD_PROVIDER")){const l=await aE(t,e,n,n==="getOobCode");return i(t,l)}else return i(t,e).catch(async l=>{if(l.code==="auth/missing-recaptcha-token"){console.log(`${n} is protected by reCAPTCHA Enterprise for this project. Automatically triggering the reCAPTCHA flow and restarting the flow.`);const u=await aE(t,e,n,n==="getOobCode");return i(t,u)}else return Promise.reject(l)})}function Lk(t,e){const n=Ug(t,"auth");if(n.isInitialized()){const a=n.getImmediate(),l=n.getOptions();if(Ks(l,e??{}))return a;Fr(a,"already-initialized")}return n.initialize({options:e})}function Vk(t,e){const n=e?.persistence||[],i=(Array.isArray(n)?n:[n]).map(qi);e?.errorMap&&t._updateErrorMap(e.errorMap),t._initializeWithPersistence(i,e?.popupRedirectResolver)}function zk(t,e,n){const i=Rl(t);Ne(/^https?:\/\//.test(e),i,"invalid-emulator-scheme");const a=!1,l=B1(e),{host:u,port:h}=Uk(e),m=h===null?"":`:${h}`,g={url:`${l}//${u}${m}/`},_=Object.freeze({host:u,port:h,protocol:l.replace(":",""),options:Object.freeze({disableWarnings:a})});if(!i._canInitEmulator){Ne(i.config.emulator&&i.emulatorConfig,i,"emulator-config-failed"),Ne(Ks(g,i.config.emulator)&&Ks(_,i.emulatorConfig),i,"emulator-config-failed");return}i.config.emulator=g,i.emulatorConfig=_,i.settings.appVerificationDisabledForTesting=!0,_l(u)?(CS(`${l}//${u}${m}`),RS("Auth",!0)):Bk()}function B1(t){const e=t.indexOf(":");return e<0?"":t.substr(0,e+1)}function Uk(t){const e=B1(t),n=/(\/\/)?([^?#/]+)/.exec(t.substr(e.length));if(!n)return{host:"",port:null};const i=n[2].split("@").pop()||"",a=/^(\[[^\]]+\])(:|$)/.exec(i);if(a){const l=a[1];return{host:l,port:lE(i.substr(l.length+1))}}else{const[l,u]=i.split(":");return{host:l,port:lE(u)}}}function lE(t){if(!t)return null;const e=Number(t);return isNaN(e)?null:e}function Bk(){function t(){const e=document.createElement("p"),n=e.style;e.innerText="Running in emulator mode. Do not use with production credentials.",n.position="fixed",n.width="100%",n.backgroundColor="#ffffff",n.border=".1em solid #000000",n.color="#b50000",n.bottom="0px",n.left="0px",n.margin="0px",n.zIndex="10000",n.textAlign="center",e.classList.add("firebase-emulator-warning"),document.body.appendChild(e)}typeof console<"u"&&typeof console.info=="function"&&console.info("WARNING: You are using the Auth Emulator, which is intended for local testing only.  Do not use with production credentials."),typeof window<"u"&&typeof document<"u"&&(document.readyState==="loading"?window.addEventListener("DOMContentLoaded",t):t())}class Ry{constructor(e,n){this.providerId=e,this.signInMethod=n}toJSON(){return Fi("not implemented")}_getIdTokenResponse(e){return Fi("not implemented")}_linkToIdToken(e,n){return Fi("not implemented")}_getReauthenticationResolver(e){return Fi("not implemented")}}async function Fk(t,e){return ia(t,"POST","/v1/accounts:signUp",e)}async function qk(t,e){return pf(t,"POST","/v1/accounts:signInWithPassword",$a(t,e))}async function Gk(t,e){return pf(t,"POST","/v1/accounts:signInWithEmailLink",$a(t,e))}async function Hk(t,e){return pf(t,"POST","/v1/accounts:signInWithEmailLink",$a(t,e))}class ru extends Ry{constructor(e,n,i,a=null){super("password",i),this._email=e,this._password=n,this._tenantId=a}static _fromEmailAndPassword(e,n){return new ru(e,n,"password")}static _fromEmailAndCode(e,n,i=null){return new ru(e,n,"emailLink",i)}toJSON(){return{email:this._email,password:this._password,signInMethod:this.signInMethod,tenantId:this._tenantId}}static fromJSON(e){const n=typeof e=="string"?JSON.parse(e):e;if(n?.email&&n?.password){if(n.signInMethod==="password")return this._fromEmailAndPassword(n.email,n.password);if(n.signInMethod==="emailLink")return this._fromEmailAndCode(n.email,n.password,n.tenantId)}return null}async _getIdTokenResponse(e){switch(this.signInMethod){case"password":const n={returnSecureToken:!0,email:this._email,password:this._password,clientType:"CLIENT_TYPE_WEB"};return oE(e,n,"signInWithPassword",qk);case"emailLink":return Gk(e,{email:this._email,oobCode:this._password});default:Fr(e,"internal-error")}}async _linkToIdToken(e,n){switch(this.signInMethod){case"password":const i={idToken:n,returnSecureToken:!0,email:this._email,password:this._password,clientType:"CLIENT_TYPE_WEB"};return oE(e,i,"signUpPassword",Fk);case"emailLink":return Hk(e,{idToken:n,email:this._email,oobCode:this._password});default:Fr(e,"internal-error")}}_getReauthenticationResolver(e){return this._getIdTokenResponse(e)}}async function Jo(t,e){return pf(t,"POST","/v1/accounts:signInWithIdp",$a(t,e))}const Qk="http://localhost";class Fa extends Ry{constructor(){super(...arguments),this.pendingToken=null}static _fromParams(e){const n=new Fa(e.providerId,e.signInMethod);return e.idToken||e.accessToken?(e.idToken&&(n.idToken=e.idToken),e.accessToken&&(n.accessToken=e.accessToken),e.nonce&&!e.pendingToken&&(n.nonce=e.nonce),e.pendingToken&&(n.pendingToken=e.pendingToken)):e.oauthToken&&e.oauthTokenSecret?(n.accessToken=e.oauthToken,n.secret=e.oauthTokenSecret):Fr("argument-error"),n}toJSON(){return{idToken:this.idToken,accessToken:this.accessToken,secret:this.secret,nonce:this.nonce,pendingToken:this.pendingToken,providerId:this.providerId,signInMethod:this.signInMethod}}static fromJSON(e){const n=typeof e=="string"?JSON.parse(e):e,{providerId:i,signInMethod:a,...l}=n;if(!i||!a)return null;const u=new Fa(i,a);return u.idToken=l.idToken||void 0,u.accessToken=l.accessToken||void 0,u.secret=l.secret,u.nonce=l.nonce,u.pendingToken=l.pendingToken||null,u}_getIdTokenResponse(e){const n=this.buildRequest();return Jo(e,n)}_linkToIdToken(e,n){const i=this.buildRequest();return i.idToken=n,Jo(e,i)}_getReauthenticationResolver(e){const n=this.buildRequest();return n.autoCreate=!1,Jo(e,n)}buildRequest(){const e={requestUri:Qk,returnSecureToken:!0};if(this.pendingToken)e.pendingToken=this.pendingToken;else{const n={};this.idToken&&(n.id_token=this.idToken),this.accessToken&&(n.access_token=this.accessToken),this.secret&&(n.oauth_token_secret=this.secret),n.providerId=this.providerId,this.nonce&&!this.pendingToken&&(n.nonce=this.nonce),e.postBody=du(n)}return e}}function $k(t){switch(t){case"recoverEmail":return"RECOVER_EMAIL";case"resetPassword":return"PASSWORD_RESET";case"signIn":return"EMAIL_SIGNIN";case"verifyEmail":return"VERIFY_EMAIL";case"verifyAndChangeEmail":return"VERIFY_AND_CHANGE_EMAIL";case"revertSecondFactorAddition":return"REVERT_SECOND_FACTOR_ADDITION";default:return null}}function Kk(t){const e=Pc(Lc(t)).link,n=e?Pc(Lc(e)).deep_link_id:null,i=Pc(Lc(t)).deep_link_id;return(i?Pc(Lc(i)).link:null)||i||n||e||t}class Dy{constructor(e){const n=Pc(Lc(e)),i=n.apiKey??null,a=n.oobCode??null,l=$k(n.mode??null);Ne(i&&a&&l,"argument-error"),this.apiKey=i,this.operation=l,this.code=a,this.continueUrl=n.continueUrl??null,this.languageCode=n.lang??null,this.tenantId=n.tenantId??null}static parseLink(e){const n=Kk(e);try{return new Dy(n)}catch{return null}}}class Dl{constructor(){this.providerId=Dl.PROVIDER_ID}static credential(e,n){return ru._fromEmailAndPassword(e,n)}static credentialWithLink(e,n){const i=Dy.parseLink(n);return Ne(i,"argument-error"),ru._fromEmailAndCode(e,i.code,i.tenantId)}}Dl.PROVIDER_ID="password";Dl.EMAIL_PASSWORD_SIGN_IN_METHOD="password";Dl.EMAIL_LINK_SIGN_IN_METHOD="emailLink";class F1{constructor(e){this.providerId=e,this.defaultLanguageCode=null,this.customParameters={}}setDefaultLanguage(e){this.defaultLanguageCode=e}setCustomParameters(e){return this.customParameters=e,this}getCustomParameters(){return this.customParameters}}class Eu extends F1{constructor(){super(...arguments),this.scopes=[]}addScope(e){return this.scopes.includes(e)||this.scopes.push(e),this}getScopes(){return[...this.scopes]}}class Ps extends Eu{constructor(){super("facebook.com")}static credential(e){return Fa._fromParams({providerId:Ps.PROVIDER_ID,signInMethod:Ps.FACEBOOK_SIGN_IN_METHOD,accessToken:e})}static credentialFromResult(e){return Ps.credentialFromTaggedObject(e)}static credentialFromError(e){return Ps.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e||!("oauthAccessToken"in e)||!e.oauthAccessToken)return null;try{return Ps.credential(e.oauthAccessToken)}catch{return null}}}Ps.FACEBOOK_SIGN_IN_METHOD="facebook.com";Ps.PROVIDER_ID="facebook.com";class Ls extends Eu{constructor(){super("google.com"),this.addScope("profile")}static credential(e,n){return Fa._fromParams({providerId:Ls.PROVIDER_ID,signInMethod:Ls.GOOGLE_SIGN_IN_METHOD,idToken:e,accessToken:n})}static credentialFromResult(e){return Ls.credentialFromTaggedObject(e)}static credentialFromError(e){return Ls.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e)return null;const{oauthIdToken:n,oauthAccessToken:i}=e;if(!n&&!i)return null;try{return Ls.credential(n,i)}catch{return null}}}Ls.GOOGLE_SIGN_IN_METHOD="google.com";Ls.PROVIDER_ID="google.com";class Vs extends Eu{constructor(){super("github.com")}static credential(e){return Fa._fromParams({providerId:Vs.PROVIDER_ID,signInMethod:Vs.GITHUB_SIGN_IN_METHOD,accessToken:e})}static credentialFromResult(e){return Vs.credentialFromTaggedObject(e)}static credentialFromError(e){return Vs.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e||!("oauthAccessToken"in e)||!e.oauthAccessToken)return null;try{return Vs.credential(e.oauthAccessToken)}catch{return null}}}Vs.GITHUB_SIGN_IN_METHOD="github.com";Vs.PROVIDER_ID="github.com";class zs extends Eu{constructor(){super("twitter.com")}static credential(e,n){return Fa._fromParams({providerId:zs.PROVIDER_ID,signInMethod:zs.TWITTER_SIGN_IN_METHOD,oauthToken:e,oauthTokenSecret:n})}static credentialFromResult(e){return zs.credentialFromTaggedObject(e)}static credentialFromError(e){return zs.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e)return null;const{oauthAccessToken:n,oauthTokenSecret:i}=e;if(!n||!i)return null;try{return zs.credential(n,i)}catch{return null}}}zs.TWITTER_SIGN_IN_METHOD="twitter.com";zs.PROVIDER_ID="twitter.com";class cl{constructor(e){this.user=e.user,this.providerId=e.providerId,this._tokenResponse=e._tokenResponse,this.operationType=e.operationType}static async _fromIdTokenResponse(e,n,i,a=!1){const l=await zr._fromIdTokenResponse(e,i,a),u=cE(i);return new cl({user:l,providerId:u,_tokenResponse:i,operationType:n})}static async _forOperation(e,n,i){await e._updateTokensIfNecessary(i,!0);const a=cE(i);return new cl({user:e,providerId:a,_tokenResponse:i,operationType:n})}}function cE(t){return t.providerId?t.providerId:"phoneNumber"in t?"phone":null}class zh extends Xi{constructor(e,n,i,a){super(n.code,n.message),this.operationType=i,this.user=a,Object.setPrototypeOf(this,zh.prototype),this.customData={appName:e.name,tenantId:e.tenantId??void 0,_serverResponse:n.customData._serverResponse,operationType:i}}static _fromErrorAndOperation(e,n,i,a){return new zh(e,n,i,a)}}function q1(t,e,n,i){return(e==="reauthenticate"?n._getReauthenticationResolver(t):n._getIdTokenResponse(t)).catch(l=>{throw l.code==="auth/multi-factor-auth-required"?zh._fromErrorAndOperation(t,l,e,i):l})}async function Wk(t,e,n=!1){const i=await nu(t,e._linkToIdToken(t.auth,await t.getIdToken()),n);return cl._forOperation(t,"link",i)}async function Yk(t,e,n=!1){const{auth:i}=t;if(Vr(i.app))return Promise.reject($s(i));const a="reauthenticate";try{const l=await nu(t,q1(i,a,e,t),n);Ne(l.idToken,i,"internal-error");const u=Ay(l.idToken);Ne(u,i,"internal-error");const{sub:h}=u;return Ne(t.uid===h,i,"user-mismatch"),cl._forOperation(t,a,l)}catch(l){throw l?.code==="auth/user-not-found"&&Fr(i,"user-mismatch"),l}}async function G1(t,e,n=!1){if(Vr(t.app))return Promise.reject($s(t));const i="signIn",a=await q1(t,i,e),l=await cl._fromIdTokenResponse(t,i,a);return n||await t._updateCurrentUser(l.user),l}async function Xk(t,e){return G1(Rl(t),e)}async function Jk(t){const e=Rl(t);e._getPasswordPolicyInternal()&&await e._updatePasswordPolicy()}function Zk(t,e,n){return Vr(t.app)?Promise.reject($s(t)):Xk(mn(t),Dl.credential(e,n)).catch(async i=>{throw i.code==="auth/password-does-not-meet-requirements"&&Jk(t),i})}function eN(t,e,n,i){return mn(t).onIdTokenChanged(e,n,i)}function tN(t,e,n){return mn(t).beforeAuthStateChanged(e,n)}function nN(t,e,n,i){return mn(t).onAuthStateChanged(e,n,i)}function rN(t){return mn(t).signOut()}const Uh="__sak";class H1{constructor(e,n){this.storageRetriever=e,this.type=n}_isAvailable(){try{return this.storage?(this.storage.setItem(Uh,"1"),this.storage.removeItem(Uh),Promise.resolve(!0)):Promise.resolve(!1)}catch{return Promise.resolve(!1)}}_set(e,n){return this.storage.setItem(e,JSON.stringify(n)),Promise.resolve()}_get(e){const n=this.storage.getItem(e);return Promise.resolve(n?JSON.parse(n):null)}_remove(e){return this.storage.removeItem(e),Promise.resolve()}get storage(){return this.storageRetriever()}}const iN=1e3,sN=10;class Q1 extends H1{constructor(){super(()=>window.localStorage,"LOCAL"),this.boundEventHandler=(e,n)=>this.onStorageEvent(e,n),this.listeners={},this.localCache={},this.pollTimer=null,this.fallbackToPolling=L1(),this._shouldAllowMigration=!0}forAllChangedKeys(e){for(const n of Object.keys(this.listeners)){const i=this.storage.getItem(n),a=this.localCache[n];i!==a&&e(n,a,i)}}onStorageEvent(e,n=!1){if(!e.key){this.forAllChangedKeys((u,h,m)=>{this.notifyListeners(u,m)});return}const i=e.key;n?this.detachListener():this.stopPolling();const a=()=>{const u=this.storage.getItem(i);!n&&this.localCache[i]===u||this.notifyListeners(i,u)},l=this.storage.getItem(i);Sk()&&l!==e.newValue&&e.newValue!==e.oldValue?setTimeout(a,sN):a()}notifyListeners(e,n){this.localCache[e]=n;const i=this.listeners[e];if(i)for(const a of Array.from(i))a(n&&JSON.parse(n))}startPolling(){this.stopPolling(),this.pollTimer=setInterval(()=>{this.forAllChangedKeys((e,n,i)=>{this.onStorageEvent(new StorageEvent("storage",{key:e,oldValue:n,newValue:i}),!0)})},iN)}stopPolling(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}attachListener(){window.addEventListener("storage",this.boundEventHandler)}detachListener(){window.removeEventListener("storage",this.boundEventHandler)}_addListener(e,n){Object.keys(this.listeners).length===0&&(this.fallbackToPolling?this.startPolling():this.attachListener()),this.listeners[e]||(this.listeners[e]=new Set,this.localCache[e]=this.storage.getItem(e)),this.listeners[e].add(n)}_removeListener(e,n){this.listeners[e]&&(this.listeners[e].delete(n),this.listeners[e].size===0&&delete this.listeners[e]),Object.keys(this.listeners).length===0&&(this.detachListener(),this.stopPolling())}async _set(e,n){await super._set(e,n),this.localCache[e]=JSON.stringify(n)}async _get(e){const n=await super._get(e);return this.localCache[e]=JSON.stringify(n),n}async _remove(e){await super._remove(e),delete this.localCache[e]}}Q1.type="LOCAL";const aN=Q1;class $1 extends H1{constructor(){super(()=>window.sessionStorage,"SESSION")}_addListener(e,n){}_removeListener(e,n){}}$1.type="SESSION";const K1=$1;function oN(t){return Promise.all(t.map(async e=>{try{return{fulfilled:!0,value:await e}}catch(n){return{fulfilled:!1,reason:n}}}))}class yf{constructor(e){this.eventTarget=e,this.handlersMap={},this.boundEventHandler=this.handleEvent.bind(this)}static _getInstance(e){const n=this.receivers.find(a=>a.isListeningto(e));if(n)return n;const i=new yf(e);return this.receivers.push(i),i}isListeningto(e){return this.eventTarget===e}async handleEvent(e){const n=e,{eventId:i,eventType:a,data:l}=n.data,u=this.handlersMap[a];if(!u?.size)return;n.ports[0].postMessage({status:"ack",eventId:i,eventType:a});const h=Array.from(u).map(async g=>g(n.origin,l)),m=await oN(h);n.ports[0].postMessage({status:"done",eventId:i,eventType:a,response:m})}_subscribe(e,n){Object.keys(this.handlersMap).length===0&&this.eventTarget.addEventListener("message",this.boundEventHandler),this.handlersMap[e]||(this.handlersMap[e]=new Set),this.handlersMap[e].add(n)}_unsubscribe(e,n){this.handlersMap[e]&&n&&this.handlersMap[e].delete(n),(!n||this.handlersMap[e].size===0)&&delete this.handlersMap[e],Object.keys(this.handlersMap).length===0&&this.eventTarget.removeEventListener("message",this.boundEventHandler)}}yf.receivers=[];function Iy(t="",e=10){let n="";for(let i=0;i<e;i++)n+=Math.floor(Math.random()*10);return t+n}class lN{constructor(e){this.target=e,this.handlers=new Set}removeMessageHandler(e){e.messageChannel&&(e.messageChannel.port1.removeEventListener("message",e.onMessage),e.messageChannel.port1.close()),this.handlers.delete(e)}async _send(e,n,i=50){const a=typeof MessageChannel<"u"?new MessageChannel:null;if(!a)throw new Error("connection_unavailable");let l,u;return new Promise((h,m)=>{const g=Iy("",20);a.port1.start();const _=setTimeout(()=>{m(new Error("unsupported_event"))},i);u={messageChannel:a,onMessage(v){const b=v;if(b.data.eventId===g)switch(b.data.status){case"ack":clearTimeout(_),l=setTimeout(()=>{m(new Error("timeout"))},3e3);break;case"done":clearTimeout(l),h(b.data.response);break;default:clearTimeout(_),clearTimeout(l),m(new Error("invalid_response"));break}}},this.handlers.add(u),a.port1.addEventListener("message",u.onMessage),this.target.postMessage({eventType:e,eventId:g,data:n},[a.port2])}).finally(()=>{u&&this.removeMessageHandler(u)})}}function _i(){return window}function cN(t){_i().location.href=t}function W1(){return typeof _i().WorkerGlobalScope<"u"&&typeof _i().importScripts=="function"}async function uN(){if(!navigator?.serviceWorker)return null;try{return(await navigator.serviceWorker.ready).active}catch{return null}}function dN(){return navigator?.serviceWorker?.controller||null}function hN(){return W1()?self:null}const Y1="firebaseLocalStorageDb",fN=1,Bh="firebaseLocalStorage",X1="fbase_key";class Su{constructor(e){this.request=e}toPromise(){return new Promise((e,n)=>{this.request.addEventListener("success",()=>{e(this.request.result)}),this.request.addEventListener("error",()=>{n(this.request.error)})})}}function _f(t,e){return t.transaction([Bh],e?"readwrite":"readonly").objectStore(Bh)}function mN(){const t=indexedDB.deleteDatabase(Y1);return new Su(t).toPromise()}function xg(){const t=indexedDB.open(Y1,fN);return new Promise((e,n)=>{t.addEventListener("error",()=>{n(t.error)}),t.addEventListener("upgradeneeded",()=>{const i=t.result;try{i.createObjectStore(Bh,{keyPath:X1})}catch(a){n(a)}}),t.addEventListener("success",async()=>{const i=t.result;i.objectStoreNames.contains(Bh)?e(i):(i.close(),await mN(),e(await xg()))})})}async function uE(t,e,n){const i=_f(t,!0).put({[X1]:e,value:n});return new Su(i).toPromise()}async function pN(t,e){const n=_f(t,!1).get(e),i=await new Su(n).toPromise();return i===void 0?null:i.value}function dE(t,e){const n=_f(t,!0).delete(e);return new Su(n).toPromise()}const gN=800,yN=3;class J1{constructor(){this.type="LOCAL",this._shouldAllowMigration=!0,this.listeners={},this.localCache={},this.pollTimer=null,this.pendingWrites=0,this.receiver=null,this.sender=null,this.serviceWorkerReceiverAvailable=!1,this.activeServiceWorker=null,this._workerInitializationPromise=this.initializeServiceWorkerMessaging().then(()=>{},()=>{})}async _openDb(){return this.db?this.db:(this.db=await xg(),this.db)}async _withRetries(e){let n=0;for(;;)try{const i=await this._openDb();return await e(i)}catch(i){if(n++>yN)throw i;this.db&&(this.db.close(),this.db=void 0)}}async initializeServiceWorkerMessaging(){return W1()?this.initializeReceiver():this.initializeSender()}async initializeReceiver(){this.receiver=yf._getInstance(hN()),this.receiver._subscribe("keyChanged",async(e,n)=>({keyProcessed:(await this._poll()).includes(n.key)})),this.receiver._subscribe("ping",async(e,n)=>["keyChanged"])}async initializeSender(){if(this.activeServiceWorker=await uN(),!this.activeServiceWorker)return;this.sender=new lN(this.activeServiceWorker);const e=await this.sender._send("ping",{},800);e&&e[0]?.fulfilled&&e[0]?.value.includes("keyChanged")&&(this.serviceWorkerReceiverAvailable=!0)}async notifyServiceWorker(e){if(!(!this.sender||!this.activeServiceWorker||dN()!==this.activeServiceWorker))try{await this.sender._send("keyChanged",{key:e},this.serviceWorkerReceiverAvailable?800:50)}catch{}}async _isAvailable(){try{if(!indexedDB)return!1;const e=await xg();return await uE(e,Uh,"1"),await dE(e,Uh),!0}catch{}return!1}async _withPendingWrite(e){this.pendingWrites++;try{await e()}finally{this.pendingWrites--}}async _set(e,n){return this._withPendingWrite(async()=>(await this._withRetries(i=>uE(i,e,n)),this.localCache[e]=n,this.notifyServiceWorker(e)))}async _get(e){const n=await this._withRetries(i=>pN(i,e));return this.localCache[e]=n,n}async _remove(e){return this._withPendingWrite(async()=>(await this._withRetries(n=>dE(n,e)),delete this.localCache[e],this.notifyServiceWorker(e)))}async _poll(){const e=await this._withRetries(a=>{const l=_f(a,!1).getAll();return new Su(l).toPromise()});if(!e)return[];if(this.pendingWrites!==0)return[];const n=[],i=new Set;if(e.length!==0)for(const{fbase_key:a,value:l}of e)i.add(a),JSON.stringify(this.localCache[a])!==JSON.stringify(l)&&(this.notifyListeners(a,l),n.push(a));for(const a of Object.keys(this.localCache))this.localCache[a]&&!i.has(a)&&(this.notifyListeners(a,null),n.push(a));return n}notifyListeners(e,n){this.localCache[e]=n;const i=this.listeners[e];if(i)for(const a of Array.from(i))a(n)}startPolling(){this.stopPolling(),this.pollTimer=setInterval(async()=>this._poll(),gN)}stopPolling(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}_addListener(e,n){Object.keys(this.listeners).length===0&&this.startPolling(),this.listeners[e]||(this.listeners[e]=new Set,this._get(e)),this.listeners[e].add(n)}_removeListener(e,n){this.listeners[e]&&(this.listeners[e].delete(n),this.listeners[e].size===0&&delete this.listeners[e]),Object.keys(this.listeners).length===0&&this.stopPolling()}}J1.type="LOCAL";const _N=J1;new xu(3e4,6e4);function vN(t,e){return e?qi(e):(Ne(t._popupRedirectResolver,t,"argument-error"),t._popupRedirectResolver)}class jy extends Ry{constructor(e){super("custom","custom"),this.params=e}_getIdTokenResponse(e){return Jo(e,this._buildIdpRequest())}_linkToIdToken(e,n){return Jo(e,this._buildIdpRequest(n))}_getReauthenticationResolver(e){return Jo(e,this._buildIdpRequest())}_buildIdpRequest(e){const n={requestUri:this.params.requestUri,sessionId:this.params.sessionId,postBody:this.params.postBody,tenantId:this.params.tenantId,pendingToken:this.params.pendingToken,returnSecureToken:!0,returnIdpCredential:!0};return e&&(n.idToken=e),n}}function bN(t){return G1(t.auth,new jy(t),t.bypassAuthState)}function xN(t){const{auth:e,user:n}=t;return Ne(n,e,"internal-error"),Yk(n,new jy(t),t.bypassAuthState)}async function EN(t){const{auth:e,user:n}=t;return Ne(n,e,"internal-error"),Wk(n,new jy(t),t.bypassAuthState)}class Z1{constructor(e,n,i,a,l=!1){this.auth=e,this.resolver=i,this.user=a,this.bypassAuthState=l,this.pendingPromise=null,this.eventManager=null,this.filter=Array.isArray(n)?n:[n]}execute(){return new Promise(async(e,n)=>{this.pendingPromise={resolve:e,reject:n};try{this.eventManager=await this.resolver._initialize(this.auth),await this.onExecution(),this.eventManager.registerConsumer(this)}catch(i){this.reject(i)}})}async onAuthEvent(e){const{urlResponse:n,sessionId:i,postBody:a,tenantId:l,error:u,type:h}=e;if(u){this.reject(u);return}const m={auth:this.auth,requestUri:n,sessionId:i,tenantId:l||void 0,postBody:a||void 0,user:this.user,bypassAuthState:this.bypassAuthState};try{this.resolve(await this.getIdpTask(h)(m))}catch(g){this.reject(g)}}onError(e){this.reject(e)}getIdpTask(e){switch(e){case"signInViaPopup":case"signInViaRedirect":return bN;case"linkViaPopup":case"linkViaRedirect":return EN;case"reauthViaPopup":case"reauthViaRedirect":return xN;default:Fr(this.auth,"internal-error")}}resolve(e){Yi(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.resolve(e),this.unregisterAndCleanUp()}reject(e){Yi(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.reject(e),this.unregisterAndCleanUp()}unregisterAndCleanUp(){this.eventManager&&this.eventManager.unregisterConsumer(this),this.pendingPromise=null,this.cleanUp()}}const SN=new xu(2e3,1e4);class $o extends Z1{constructor(e,n,i,a,l){super(e,n,a,l),this.provider=i,this.authWindow=null,this.pollId=null,$o.currentPopupAction&&$o.currentPopupAction.cancel(),$o.currentPopupAction=this}async executeNotNull(){const e=await this.execute();return Ne(e,this.auth,"internal-error"),e}async onExecution(){Yi(this.filter.length===1,"Popup operations only handle one event");const e=Iy();this.authWindow=await this.resolver._openPopup(this.auth,this.provider,this.filter[0],e),this.authWindow.associatedEvent=e,this.resolver._originValidation(this.auth).catch(n=>{this.reject(n)}),this.resolver._isIframeWebStorageSupported(this.auth,n=>{n||this.reject(yi(this.auth,"web-storage-unsupported"))}),this.pollUserCancellation()}get eventId(){return this.authWindow?.associatedEvent||null}cancel(){this.reject(yi(this.auth,"cancelled-popup-request"))}cleanUp(){this.authWindow&&this.authWindow.close(),this.pollId&&window.clearTimeout(this.pollId),this.authWindow=null,this.pollId=null,$o.currentPopupAction=null}pollUserCancellation(){const e=()=>{if(this.authWindow?.window?.closed){this.pollId=window.setTimeout(()=>{this.pollId=null,this.reject(yi(this.auth,"popup-closed-by-user"))},8e3);return}this.pollId=window.setTimeout(e,SN.get())};e()}}$o.currentPopupAction=null;const wN="pendingRedirect",gh=new Map;class TN extends Z1{constructor(e,n,i=!1){super(e,["signInViaRedirect","linkViaRedirect","reauthViaRedirect","unknown"],n,void 0,i),this.eventId=null}async execute(){let e=gh.get(this.auth._key());if(!e){try{const i=await AN(this.resolver,this.auth)?await super.execute():null;e=()=>Promise.resolve(i)}catch(n){e=()=>Promise.reject(n)}gh.set(this.auth._key(),e)}return this.bypassAuthState||gh.set(this.auth._key(),()=>Promise.resolve(null)),e()}async onAuthEvent(e){if(e.type==="signInViaRedirect")return super.onAuthEvent(e);if(e.type==="unknown"){this.resolve(null);return}if(e.eventId){const n=await this.auth._redirectUserForId(e.eventId);if(n)return this.user=n,super.onAuthEvent(e);this.resolve(null)}}async onExecution(){}cleanUp(){}}async function AN(t,e){const n=DN(e),i=RN(t);if(!await i._isAvailable())return!1;const a=await i._get(n)==="true";return await i._remove(n),a}function CN(t,e){gh.set(t._key(),e)}function RN(t){return qi(t._redirectPersistence)}function DN(t){return ph(wN,t.config.apiKey,t.name)}async function IN(t,e,n=!1){if(Vr(t.app))return Promise.reject($s(t));const i=Rl(t),a=vN(i,e),u=await new TN(i,a,n).execute();return u&&!n&&(delete u.user._redirectEventId,await i._persistUserIfCurrent(u.user),await i._setRedirectUser(null,e)),u}const jN=600*1e3;class ON{constructor(e){this.auth=e,this.cachedEventUids=new Set,this.consumers=new Set,this.queuedRedirectEvent=null,this.hasHandledPotentialRedirect=!1,this.lastProcessedEventTime=Date.now()}registerConsumer(e){this.consumers.add(e),this.queuedRedirectEvent&&this.isEventForConsumer(this.queuedRedirectEvent,e)&&(this.sendToConsumer(this.queuedRedirectEvent,e),this.saveEventToCache(this.queuedRedirectEvent),this.queuedRedirectEvent=null)}unregisterConsumer(e){this.consumers.delete(e)}onEvent(e){if(this.hasEventBeenHandled(e))return!1;let n=!1;return this.consumers.forEach(i=>{this.isEventForConsumer(e,i)&&(n=!0,this.sendToConsumer(e,i),this.saveEventToCache(e))}),this.hasHandledPotentialRedirect||!MN(e)||(this.hasHandledPotentialRedirect=!0,n||(this.queuedRedirectEvent=e,n=!0)),n}sendToConsumer(e,n){if(e.error&&!eT(e)){const i=e.error.code?.split("auth/")[1]||"internal-error";n.onError(yi(this.auth,i))}else n.onAuthEvent(e)}isEventForConsumer(e,n){const i=n.eventId===null||!!e.eventId&&e.eventId===n.eventId;return n.filter.includes(e.type)&&i}hasEventBeenHandled(e){return Date.now()-this.lastProcessedEventTime>=jN&&this.cachedEventUids.clear(),this.cachedEventUids.has(hE(e))}saveEventToCache(e){this.cachedEventUids.add(hE(e)),this.lastProcessedEventTime=Date.now()}}function hE(t){return[t.type,t.eventId,t.sessionId,t.tenantId].filter(e=>e).join("-")}function eT({type:t,error:e}){return t==="unknown"&&e?.code==="auth/no-auth-event"}function MN(t){switch(t.type){case"signInViaRedirect":case"linkViaRedirect":case"reauthViaRedirect":return!0;case"unknown":return eT(t);default:return!1}}async function kN(t,e={}){return ia(t,"GET","/v1/projects",e)}const NN=/^\d{1,3}\.\d{1,3}\.\d{1,3}\.\d{1,3}$/,PN=/^https?/;async function LN(t){if(t.config.emulator)return;const{authorizedDomains:e}=await kN(t);for(const n of e)try{if(VN(n))return}catch{}Fr(t,"unauthorized-domain")}function VN(t){const e=vg(),{protocol:n,hostname:i}=new URL(e);if(t.startsWith("chrome-extension://")){const u=new URL(t);return u.hostname===""&&i===""?n==="chrome-extension:"&&t.replace("chrome-extension://","")===e.replace("chrome-extension://",""):n==="chrome-extension:"&&u.hostname===i}if(!PN.test(n))return!1;if(NN.test(t))return i===t;const a=t.replace(/\./g,"\\.");return new RegExp("^(.+\\."+a+"|"+a+")$","i").test(i)}const zN=new xu(3e4,6e4);function fE(){const t=_i().___jsl;if(t?.H){for(const e of Object.keys(t.H))if(t.H[e].r=t.H[e].r||[],t.H[e].L=t.H[e].L||[],t.H[e].r=[...t.H[e].L],t.CP)for(let n=0;n<t.CP.length;n++)t.CP[n]=null}}function UN(t){return new Promise((e,n)=>{function i(){fE(),gapi.load("gapi.iframes",{callback:()=>{e(gapi.iframes.getContext())},ontimeout:()=>{fE(),n(yi(t,"network-request-failed"))},timeout:zN.get()})}if(_i().gapi?.iframes?.Iframe)e(gapi.iframes.getContext());else if(_i().gapi?.load)i();else{const a=Ok("iframefcb");return _i()[a]=()=>{gapi.load?i():n(yi(t,"network-request-failed"))},z1(`${jk()}?onload=${a}`).catch(l=>n(l))}}).catch(e=>{throw yh=null,e})}let yh=null;function BN(t){return yh=yh||UN(t),yh}const FN=new xu(5e3,15e3),qN="__/auth/iframe",GN="emulator/auth/iframe",HN={style:{position:"absolute",top:"-100px",width:"1px",height:"1px"},"aria-hidden":"true",tabindex:"-1"},QN=new Map([["identitytoolkit.googleapis.com","p"],["staging-identitytoolkit.sandbox.googleapis.com","s"],["test-identitytoolkit.sandbox.googleapis.com","t"]]);function $N(t){const e=t.config;Ne(e.authDomain,t,"auth-domain-config-required");const n=e.emulator?Ty(e,GN):`https://${t.config.authDomain}/${qN}`,i={apiKey:e.apiKey,appName:t.name,v:vl},a=QN.get(t.config.apiHost);a&&(i.eid=a);const l=t._getFrameworks();return l.length&&(i.fw=l.join(",")),`${n}?${du(i).slice(1)}`}async function KN(t){const e=await BN(t),n=_i().gapi;return Ne(n,t,"internal-error"),e.open({where:document.body,url:$N(t),messageHandlersFilter:n.iframes.CROSS_ORIGIN_IFRAMES_FILTER,attributes:HN,dontclear:!0},i=>new Promise(async(a,l)=>{await i.restyle({setHideOnLeave:!1});const u=yi(t,"network-request-failed"),h=_i().setTimeout(()=>{l(u)},FN.get());function m(){_i().clearTimeout(h),a(i)}i.ping(m).then(m,()=>{l(u)})}))}const WN={location:"yes",resizable:"yes",statusbar:"yes",toolbar:"no"},YN=500,XN=600,JN="_blank",ZN="http://localhost";class mE{constructor(e){this.window=e,this.associatedEvent=null}close(){if(this.window)try{this.window.close()}catch{}}}function e4(t,e,n,i=YN,a=XN){const l=Math.max((window.screen.availHeight-a)/2,0).toString(),u=Math.max((window.screen.availWidth-i)/2,0).toString();let h="";const m={...WN,width:i.toString(),height:a.toString(),top:l,left:u},g=In().toLowerCase();n&&(h=O1(g)?JN:n),I1(g)&&(e=e||ZN,m.scrollbars="yes");const _=Object.entries(m).reduce((b,[w,C])=>`${b}${w}=${C},`,"");if(Ek(g)&&h!=="_self")return t4(e||"",h),new mE(null);const v=window.open(e||"",h,_);Ne(v,t,"popup-blocked");try{v.focus()}catch{}return new mE(v)}function t4(t,e){const n=document.createElement("a");n.href=t,n.target=e;const i=document.createEvent("MouseEvent");i.initMouseEvent("click",!0,!0,window,1,0,0,0,0,!1,!1,!1,!1,1,null),n.dispatchEvent(i)}const n4="__/auth/handler",r4="emulator/auth/handler",i4=encodeURIComponent("fac");async function pE(t,e,n,i,a,l){Ne(t.config.authDomain,t,"auth-domain-config-required"),Ne(t.config.apiKey,t,"invalid-api-key");const u={apiKey:t.config.apiKey,appName:t.name,authType:n,redirectUrl:i,v:vl,eventId:a};if(e instanceof F1){e.setDefaultLanguage(t.languageCode),u.providerId=e.providerId||"",hI(e.getCustomParameters())||(u.customParameters=JSON.stringify(e.getCustomParameters()));for(const[_,v]of Object.entries({}))u[_]=v}if(e instanceof Eu){const _=e.getScopes().filter(v=>v!=="");_.length>0&&(u.scopes=_.join(","))}t.tenantId&&(u.tid=t.tenantId);const h=u;for(const _ of Object.keys(h))h[_]===void 0&&delete h[_];const m=await t._getAppCheckToken(),g=m?`#${i4}=${encodeURIComponent(m)}`:"";return`${s4(t)}?${du(h).slice(1)}${g}`}function s4({config:t}){return t.emulator?Ty(t,r4):`https://${t.authDomain}/${n4}`}const Pp="webStorageSupport";class a4{constructor(){this.eventManagers={},this.iframes={},this.originValidationPromises={},this._redirectPersistence=K1,this._completeRedirectFn=IN,this._overrideRedirectResult=CN}async _openPopup(e,n,i,a){Yi(this.eventManagers[e._key()]?.manager,"_initialize() not called before _openPopup()");const l=await pE(e,n,i,vg(),a);return e4(e,l,Iy())}async _openRedirect(e,n,i,a){await this._originValidation(e);const l=await pE(e,n,i,vg(),a);return cN(l),new Promise(()=>{})}_initialize(e){const n=e._key();if(this.eventManagers[n]){const{manager:a,promise:l}=this.eventManagers[n];return a?Promise.resolve(a):(Yi(l,"If manager is not set, promise should be"),l)}const i=this.initAndGetManager(e);return this.eventManagers[n]={promise:i},i.catch(()=>{delete this.eventManagers[n]}),i}async initAndGetManager(e){const n=await KN(e),i=new ON(e);return n.register("authEvent",a=>(Ne(a?.authEvent,e,"invalid-auth-event"),{status:i.onEvent(a.authEvent)?"ACK":"ERROR"}),gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER),this.eventManagers[e._key()]={manager:i},this.iframes[e._key()]=n,i}_isIframeWebStorageSupported(e,n){this.iframes[e._key()].send(Pp,{type:Pp},a=>{const l=a?.[0]?.[Pp];l!==void 0&&n(!!l),Fr(e,"internal-error")},gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER)}_originValidation(e){const n=e._key();return this.originValidationPromises[n]||(this.originValidationPromises[n]=LN(e)),this.originValidationPromises[n]}get _shouldInitProactively(){return L1()||j1()||Cy()}}const o4=a4;var gE="@firebase/auth",yE="1.12.0";class l4{constructor(e){this.auth=e,this.internalListeners=new Map}getUid(){return this.assertAuthConfigured(),this.auth.currentUser?.uid||null}async getToken(e){return this.assertAuthConfigured(),await this.auth._initializationPromise,this.auth.currentUser?{accessToken:await this.auth.currentUser.getIdToken(e)}:null}addAuthTokenListener(e){if(this.assertAuthConfigured(),this.internalListeners.has(e))return;const n=this.auth.onIdTokenChanged(i=>{e(i?.stsTokenManager.accessToken||null)});this.internalListeners.set(e,n),this.updateProactiveRefresh()}removeAuthTokenListener(e){this.assertAuthConfigured();const n=this.internalListeners.get(e);n&&(this.internalListeners.delete(e),n(),this.updateProactiveRefresh())}assertAuthConfigured(){Ne(this.auth._initializationPromise,"dependent-sdk-initialized-before-auth")}updateProactiveRefresh(){this.internalListeners.size>0?this.auth._startProactiveRefresh():this.auth._stopProactiveRefresh()}}function c4(t){switch(t){case"Node":return"node";case"ReactNative":return"rn";case"Worker":return"webworker";case"Cordova":return"cordova";case"WebExtension":return"web-extension";default:return}}function u4(t){tl(new za("auth",(e,{options:n})=>{const i=e.getProvider("app").getImmediate(),a=e.getProvider("heartbeat"),l=e.getProvider("app-check-internal"),{apiKey:u,authDomain:h}=i.options;Ne(u&&!u.includes(":"),"invalid-api-key",{appName:i.name});const m={apiKey:u,authDomain:h,clientPlatform:t,apiHost:"identitytoolkit.googleapis.com",tokenApiHost:"securetoken.googleapis.com",apiScheme:"https",sdkClientVersion:V1(t)},g=new Rk(i,a,l,m);return Vk(g,n),g},"PUBLIC").setInstantiationMode("EXPLICIT").setInstanceCreatedCallback((e,n,i)=>{e.getProvider("auth-internal").initialize()})),tl(new za("auth-internal",e=>{const n=Rl(e.getProvider("auth").getImmediate());return(i=>new l4(i))(n)},"PRIVATE").setInstantiationMode("EXPLICIT")),Gs(gE,yE,c4(t)),Gs(gE,yE,"esm2020")}const d4=300,h4=AS("authIdTokenMaxAge")||d4;let _E=null;const f4=t=>async e=>{const n=e&&await e.getIdTokenResult(),i=n&&(new Date().getTime()-Date.parse(n.issuedAtTime))/1e3;if(i&&i>h4)return;const a=n?.token;_E!==a&&(_E=a,await fetch(t,{method:a?"POST":"DELETE",headers:a?{Authorization:`Bearer ${a}`}:{}}))};function m4(t=OS()){const e=Ug(t,"auth");if(e.isInitialized())return e.getImmediate();const n=Lk(t,{popupRedirectResolver:o4,persistence:[_N,aN,K1]}),i=AS("authTokenSyncURL");if(i&&typeof isSecureContext=="boolean"&&isSecureContext){const l=new URL(i,location.origin);if(location.origin===l.origin){const u=f4(l.toString());tN(n,u,()=>u(n.currentUser)),eN(n,h=>u(h))}}const a=wS("auth");return a&&zk(n,`http://${a}`),n}function p4(){return document.getElementsByTagName("head")?.[0]??document}Dk({loadJS(t){return new Promise((e,n)=>{const i=document.createElement("script");i.setAttribute("src",t),i.onload=e,i.onerror=a=>{const l=yi("internal-error");l.customData=a,n(l)},i.type="text/javascript",i.charset="UTF-8",p4().appendChild(i)})},gapiScript:"https://apis.google.com/js/api.js",recaptchaV2Script:"https://www.google.com/recaptcha/api.js",recaptchaEnterpriseScript:"https://www.google.com/recaptcha/enterprise.js?render="});u4("Browser");function Ka(){const t=m4(NS);async function e(){return!1}async function n(h,m){return Zk(t,h,m)}function i(){return rN(t)}function a(h){nN(t,m=>{h(m)})}function l(){return t.currentUser}return{set_user_listener:a,delete_firebase_user:e,login_firebase_user:n,logout_firebase_user:i,get_current_firebase_user:l}}const g4={currentUserId:null,selectedBudgetId:null,currentYear:new Date().getFullYear(),currentMonthNumber:new Date().getMonth()+1,lastActiveTab:"balances",lastSettingsTab:"categories",lastAdminTab:"budget",lastBalancesView:"categories",setSelectedBudgetId:()=>{},setCurrentYear:()=>{},setCurrentMonthNumber:()=>{},setLastActiveTab:()=>{},setLastSettingsTab:()=>{},setLastAdminTab:()=>{},setLastBalancesView:()=>{},isInitialized:!1,needsFirstBudget:!1,goToPreviousMonth:()=>{},goToNextMonth:()=>{},pendingInvites:[],hasPendingInvites:!1,accessibleBudgets:[],isAdmin:!1,isTest:!1,loadAccessibleBudgets:async()=>{},switchToBudget:()=>{},checkBudgetInvite:async()=>null,clearCache:()=>{}},tT=A.createContext(g4);function y4({children:t}){const n=Ka().get_current_firebase_user(),[i,a]=A.useState(null),[l,u]=A.useState(new Date().getFullYear()),[h,m]=A.useState(new Date().getMonth()+1),[g,_]=A.useState("balances"),[v,b]=A.useState("categories"),[w,C]=A.useState("budget"),[R,N]=A.useState("categories"),[B,H]=A.useState(!1),[F,ae]=A.useState(!1),te=$M(n?.uid||null,n?.email||null),he=te.data&&te.data.budget_ids.length===0,L=WM(n?.uid||null,te.data||null,{enabled:!!n?.uid&&!!te.data&&he}),I=te.data?.permission_flags?.is_admin===!0,D=te.data?.permission_flags?.is_test===!0,k=L.data?.pendingInvites||[],O=L.data?.budgets||[],j=k.length>0;A.useEffect(()=>{if(!n||B||te.isLoading)return;const X=te.data;if(!(!X&&!te.isError))if(X&&X.budget_ids.length>0)a(X.budget_ids[0]),ae(!1),H(!0);else{if(L.isLoading)return;const P=L.data;P?.pendingInvites&&P.pendingInvites.length>0?ae(!1):ae(!0),H(!0)}},[n,B,te.data,te.isLoading,te.isError,L.data,L.isLoading]);const T=A.useCallback(()=>{h===1?(u(X=>X-1),m(12)):m(X=>X-1)},[h]),Z=A.useCallback(()=>{h===12?(u(X=>X+1),m(1)):m(X=>X+1)},[h]),U=A.useCallback(async()=>{await L.refetch()},[L]),z=A.useCallback(X=>{a(X)},[]),q=A.useCallback(async X=>{if(!n)return null;try{const P=await ZM(X,n.uid);return P&&P.isInvited&&!P.hasAccepted?{budgetId:X,budgetName:P.budgetName,ownerEmail:P.ownerEmail}:null}catch(P){return console.error("[BudgetContext] Error checking budget invite:",P),null}},[n]),K=A.useCallback(()=>{localStorage.removeItem("BUDGET_APP_QUERY_CACHE")},[]),ee={currentUserId:n?.uid||null,selectedBudgetId:i,currentYear:l,currentMonthNumber:h,lastActiveTab:g,lastSettingsTab:v,lastAdminTab:w,lastBalancesView:R,setSelectedBudgetId:a,setCurrentYear:u,setCurrentMonthNumber:m,setLastActiveTab:_,setLastSettingsTab:b,setLastAdminTab:C,setLastBalancesView:N,isInitialized:B,needsFirstBudget:F,goToPreviousMonth:T,goToNextMonth:Z,pendingInvites:k,hasPendingInvites:j,accessibleBudgets:O,isAdmin:I,isTest:D,loadAccessibleBudgets:U,switchToBudget:z,checkBudgetInvite:q,clearCache:K};return d.jsx(tT.Provider,{value:ee,children:t})}function Tn(){const t=A.useContext(tT);if(!t)throw new Error("useBudget must be used within a BudgetProvider");return t}const Lr={mobile:640,tablet:768,wide:1200},_4=Lr.mobile,Zo=["January","February","March","April","May","June","July","August","September","October","November","December"],de={primary:"#646cff",primaryLight:"#a5b4fc",error:"#f87171",errorBg:"rgba(220, 38, 38, 0.1)",errorBorder:"rgba(220, 38, 38, 0.3)",success:"#4ade80",danger:"#f87171",warning:"#facc15"},Gn={maxWidth:"var(--page-max-width, 85rem)",margin:"0 auto",padding:"var(--page-padding, 2rem)"},wu={background:"color-mix(in srgb, currentColor 8%, transparent)",padding:"1rem 1.25rem",borderRadius:"8px",display:"flex",justifyContent:"space-between",alignItems:"center",gap:"1rem"},v4={...wu,padding:"0.6rem 0.875rem",gap:"0.5rem"},b4={background:"color-mix(in srgb, currentColor 5%, transparent)",padding:"1rem 1.5rem",borderRadius:"8px",marginBottom:"1.5rem"},x4={background:"color-mix(in srgb, currentColor 8%, transparent)",padding:"1.25rem",borderRadius:"8px",display:"flex",flexDirection:"column",gap:"1rem"},E4={display:"flex",flexDirection:"column",gap:"0.5rem"},S4={fontSize:"0.9rem",fontWeight:500},Wa={padding:"0.6rem 0.8rem",borderRadius:"6px",border:"1px solid color-mix(in srgb, currentColor 20%, transparent)",background:"color-mix(in srgb, currentColor 5%, transparent)",fontSize:"1rem",color:"inherit",width:"100%",boxSizing:"border-box"},w4={...Wa,cursor:"pointer"},Oy={padding:"0.6rem 1.25rem",borderRadius:"6px",cursor:"pointer",fontWeight:500,fontSize:"0.9rem",transition:"opacity 0.15s"},nT={...Oy,background:de.primary,color:"white",border:"none"},T4={...nT,padding:"0.75rem 1.5rem",borderRadius:"8px"},A4={...Oy,background:"transparent",border:"1px solid color-mix(in srgb, currentColor 30%, transparent)"},C4={...Oy,background:"transparent",border:`1px solid ${de.errorBorder}`,color:de.error},R4={background:"transparent",border:"1px solid color-mix(in srgb, currentColor 25%, transparent)",padding:"0.35rem 0.75rem",borderRadius:"6px",cursor:"pointer",fontSize:"0.8rem",opacity:.8,transition:"opacity 0.15s"},D4={display:"flex",gap:"0.5rem"},I4={display:"flex",gap:"0.25rem"},rT={background:"transparent",border:"1px solid color-mix(in srgb, currentColor 20%, transparent)",padding:"0.35rem",borderRadius:"6px",cursor:"pointer",fontSize:"0.9rem",lineHeight:1,display:"flex",alignItems:"center",justifyContent:"center",minWidth:"2rem",minHeight:"2rem",transition:"opacity 0.15s, border-color 0.15s"},j4={...rT,borderColor:de.errorBorder,color:de.error},ul={background:"transparent",border:"1px solid color-mix(in srgb, currentColor 15%, transparent)",padding:"0.25rem 0.35rem",borderRadius:"4px",cursor:"pointer",fontSize:"0.75rem",lineHeight:1,display:"flex",alignItems:"center",justifyContent:"center",opacity:.6,transition:"opacity 0.15s, background 0.15s"},My={display:"flex",flexDirection:"column",gap:"2px"},O4={display:"flex",gap:"0.75rem",marginTop:"0.5rem"},iT={opacity:.4,cursor:"grab"},sT={position:"absolute",top:"-4px",left:0,right:0,height:"3px",background:de.primary,borderRadius:"2px",transition:"opacity 0.15s"},M4={position:"relative",height:"2rem",marginTop:"-0.25rem"},k4={position:"absolute",top:"50%",left:0,right:0,height:"3px",background:de.primary,borderRadius:"2px",transition:"opacity 0.15s"},N4={position:"absolute",top:"50%",left:"50%",transform:"translate(-50%, -50%)",fontSize:"0.75rem",opacity:.7,background:"var(--background, #1a1a1a)",padding:"0 0.5rem",whiteSpace:"nowrap"},P4={background:de.errorBg,border:`1px solid ${de.errorBorder}`,color:de.error,padding:"0.75rem 1rem",borderRadius:"8px",marginBottom:"1rem",display:"flex",justifyContent:"space-between",alignItems:"center",gap:"1rem"},L4={background:"transparent",border:"none",color:de.error,cursor:"pointer",fontSize:"1.2rem",padding:"0 0.25rem",lineHeight:1},iu={opacity:.7,marginBottom:"1.5rem"},Il={margin:0,fontSize:"0.85rem",textTransform:"uppercase",letterSpacing:"0.5px",opacity:.6},ky={fontWeight:500,fontSize:"1.1rem"},dl={display:"flex",flexDirection:"column",gap:"0.5rem",marginBottom:"1.5rem"};function V4(){return d.jsxs("div",{style:Gn,children:[d.jsx("nav",{style:{marginBottom:"1rem",display:"flex",alignItems:"center"},children:d.jsx(Dt,{to:"/",style:{display:"flex",alignItems:"center"},title:"Tarron Lane Home",children:d.jsx("img",{src:"/t-icon.svg",alt:"Tarron Lane Home",style:{width:"2rem",height:"2rem"}})})}),d.jsx("h1",{children:"Tarron Lane Homepage"}),d.jsx("nav",{children:d.jsxs("ul",{children:[d.jsx("li",{children:d.jsx(Dt,{to:"/sql-test",children:"SQL Test"})}),d.jsx("li",{children:d.jsx(Dt,{to:"/budget",children:"Budget"})}),d.jsx("li",{children:d.jsx(Dt,{to:"/account",children:"Account"})})]})})]})}function el({children:t}){return d.jsx("div",{style:Gn,children:t})}function jl({message:t,children:e,onDismiss:n,style:i}){return d.jsxs("div",{style:{...P4,...i},children:[d.jsx("span",{children:e??t}),n&&d.jsx("button",{onClick:n,style:L4,children:""})]})}const z4={primary:nT,"primary-large":T4,secondary:A4,danger:C4,small:R4};function Oe({variant:t="primary",isLoading:e,loadingText:n="Saving...",children:i,disabled:a,style:l,actionName:u,onClick:h,...m}){const g=z4[t],_=a||e;function v(b){h?.(b)}return d.jsx("button",{disabled:_,style:{...g,cursor:_?"not-allowed":"pointer",opacity:_?.7:1,...l},onClick:v,...m,children:e?n:i})}function Eg(t,e){const n=t.toLowerCase(),i=e.toLowerCase();if(i.includes(n)){const h=i.indexOf(n);return{match:!0,score:h===0||/\s/.test(i[h-1])?100:90}}let a=0,l=0,u=0;for(let h=0;h<i.length&&a<n.length;h++)i[h]===n[a]?(a++,u++,l+=u*2):u=0;return a===n.length?{match:!0,score:l}:{match:!1,score:0}}function vE({id:t,value:e,onChange:n,payees:i,placeholder:a="Enter payee name"}){const[l,u]=A.useState(!1),[h,m]=A.useState(-1),g=A.useRef(null),_=A.useRef(null),v=e.trim()?i.map(C=>({payee:C,...Eg(e,C)})).filter(C=>C.match).sort((C,R)=>R.score-C.score).slice(0,8).map(C=>C.payee):[];A.useEffect(()=>{function C(R){g.current&&!g.current.contains(R.target)&&u(!1)}return document.addEventListener("mousedown",C),()=>document.removeEventListener("mousedown",C)},[]);function b(C){!l||v.length===0||(C.key==="ArrowDown"?(C.preventDefault(),m(R=>Math.min(R+1,v.length-1))):C.key==="ArrowUp"?(C.preventDefault(),m(R=>Math.max(R-1,-1))):C.key==="Enter"&&h>=0?(C.preventDefault(),n(v[h]),u(!1),m(-1)):C.key==="Escape"&&(u(!1),m(-1)))}function w(C){n(C),u(!1),m(-1),_.current?.focus()}return d.jsxs("div",{ref:g,style:{position:"relative"},children:[d.jsx("input",{ref:_,id:t,type:"text",value:e,onChange:C=>{n(C.target.value),u(!0),m(-1)},onFocus:()=>u(!0),onKeyDown:b,placeholder:a,autoComplete:"off",style:Wa}),l&&v.length>0&&d.jsx("div",{style:{position:"absolute",top:"100%",left:0,right:0,marginTop:"4px",background:"var(--background, #1a1a1a)",border:"1px solid color-mix(in srgb, currentColor 20%, transparent)",borderRadius:"6px",boxShadow:"0 4px 12px rgba(0, 0, 0, 0.3)",zIndex:1e3,maxHeight:"200px",overflowY:"auto"},children:v.map((C,R)=>d.jsx("div",{onClick:()=>w(C),style:{padding:"0.6rem 0.8rem",cursor:"pointer",background:R===h?`color-mix(in srgb, ${de.primary} 20%, transparent)`:"transparent",borderBottom:R<v.length-1?"1px solid color-mix(in srgb, currentColor 10%, transparent)":"none",transition:"background 0.1s"},onMouseEnter:()=>m(R),children:C},C))})]})}function U4({id:t,value:e,onChange:n,categories:i,categoryGroups:a,placeholder:l="Search categories...",required:u}){const h=Object.fromEntries(a.map(j=>[j.id,j.name])),m=Object.entries(i).map(([j,T])=>({id:j,name:T.name,groupId:T.category_group_id,groupName:T.category_group_id&&h[T.category_group_id]||null,sortOrder:T.sort_order})),_=(e?i[e]:null)?.name||"",[v,b]=A.useState(_),[w,C]=A.useState(!1),[R,N]=A.useState(-1),B=A.useRef(null),H=A.useRef(null);A.useEffect(()=>{const j=e?i[e]:null;b(j?.name||"")},[e,i]);const F=v.trim()?m.map(j=>({...j,...Eg(v,j.name),groupMatch:j.groupName?Eg(v,j.groupName):{match:!1,score:0}})).filter(j=>j.match||j.groupMatch.match).sort((j,T)=>{const Z=Math.max(j.score,j.groupMatch.score*.5),U=Math.max(T.score,T.groupMatch.score*.5);if(U!==Z)return U-Z;if(j.groupId!==T.groupId){if(!j.groupId)return 1;if(!T.groupId)return-1;const z=(j.groupName||"").localeCompare(T.groupName||"");return z!==0?z:j.groupId.localeCompare(T.groupId)}return j.sortOrder-T.sortOrder}).slice(0,10):[...m].sort((j,T)=>{if(j.groupId!==T.groupId){if(!j.groupId)return 1;if(!T.groupId)return-1;const Z=(j.groupName||"").localeCompare(T.groupName||"");return Z!==0?Z:j.groupId.localeCompare(T.groupId)}return j.sortOrder-T.sortOrder}).slice(0,10);A.useEffect(()=>{function j(T){if(B.current&&!B.current.contains(T.target)){C(!1);const Z=e?i[e]:null;b(Z?.name||"")}}return document.addEventListener("mousedown",j),()=>document.removeEventListener("mousedown",j)},[e,i]);function ae(j){if(j.key==="ArrowDown")j.preventDefault(),w?N(T=>Math.min(T+1,F.length-1)):(C(!0),N(0));else if(j.key==="ArrowUp")j.preventDefault(),N(T=>Math.max(T-1,0));else if(j.key==="Enter")j.preventDefault(),w&&R>=0&&F[R]&&te(F[R]);else if(j.key==="Escape"){C(!1),N(-1);const T=e?i[e]:null;b(T?.name||"")}else if(j.key==="Tab"&&w&&F.length>0){const T=R>=0?R:0;te(F[T])}}function te(j){n(j.id),b(j.name),C(!1),N(-1),H.current?.focus()}function he(j){const T=j.target.value;b(T),C(!0),N(-1),T!==_&&n("")}function L(){C(!0),F.length>0&&N(0)}const I=[];let D="__initial__";F.forEach(j=>{j.groupId!==D&&(D=j.groupId,I.push({groupId:j.groupId,groupName:j.groupName,items:[]})),I[I.length-1].items.push(j)});let k=-1;const O=()=>++k;return d.jsxs("div",{ref:B,style:{position:"relative"},children:[d.jsx("input",{ref:H,id:t,type:"text",value:v,onChange:he,onFocus:L,onKeyDown:ae,placeholder:l,autoComplete:"off",required:u,style:{...Wa,borderColor:u&&!e?de.error:void 0}}),w&&F.length>0&&d.jsx("div",{style:{position:"absolute",top:"100%",left:0,right:0,marginTop:"4px",background:"var(--background, #1a1a1a)",border:"1px solid color-mix(in srgb, currentColor 20%, transparent)",borderRadius:"6px",boxShadow:"0 4px 12px rgba(0, 0, 0, 0.3)",zIndex:1e3,maxHeight:"250px",overflowY:"auto"},children:I.map((j,T)=>d.jsxs("div",{children:[j.groupName&&d.jsx("div",{style:{padding:"0.4rem 0.8rem",fontSize:"0.75rem",textTransform:"uppercase",letterSpacing:"0.5px",opacity:.6,background:"color-mix(in srgb, currentColor 5%, transparent)",borderBottom:"1px solid color-mix(in srgb, currentColor 10%, transparent)"},children:j.groupName}),j.items.map(Z=>{const U=O();return d.jsx("div",{onClick:()=>te(Z),style:{padding:"0.6rem 0.8rem",paddingLeft:j.groupName?"1.2rem":"0.8rem",cursor:"pointer",background:U===R?`color-mix(in srgb, ${de.primary} 20%, transparent)`:"transparent",borderBottom:"1px solid color-mix(in srgb, currentColor 10%, transparent)",transition:"background 0.1s"},onMouseEnter:()=>N(U),children:Z.name},Z.id)})]},`group-${T}`))}),w&&F.length===0&&v.trim()&&d.jsx("div",{style:{position:"absolute",top:"100%",left:0,right:0,marginTop:"4px",background:"var(--background, #1a1a1a)",border:"1px solid color-mix(in srgb, currentColor 20%, transparent)",borderRadius:"6px",boxShadow:"0 4px 12px rgba(0, 0, 0, 0.3)",zIndex:1e3,padding:"0.6rem 0.8rem",opacity:.6,fontStyle:"italic"},children:"No matching categories"})]})}function qa({children:t,onSubmit:e,actionName:n}){function i(a){e(a)}return d.jsx("form",{onSubmit:i,style:x4,children:t})}function en({label:t,htmlFor:e,children:n,hint:i,style:a}){return d.jsxs("div",{style:{...E4,...a},children:[d.jsx("label",{htmlFor:e,style:S4,children:t}),n,i&&d.jsx("p",{style:{margin:"0.25rem 0 0 0",fontSize:"0.85rem",opacity:.6},children:i})]})}function Ga(t){return d.jsx("input",{style:Wa,...t})}function B4(t){if(!t)return"";try{return new Date(t+"T00:00:00").toLocaleDateString("en-US",{month:"short",day:"numeric"})}catch{return t}}function bE({value:t,onChange:e,style:n,...i}){const a=A.useRef(null),l=B4(t);function u(){a.current?.showPicker?.()}return d.jsxs("div",{style:{position:"relative"},children:[d.jsx("input",{ref:a,type:"date",value:t||"",onChange:e,style:{position:"absolute",top:0,left:0,width:"100%",height:"100%",opacity:0,pointerEvents:"none"},...i}),d.jsx("div",{onClick:u,style:{...Wa,cursor:"pointer",display:"flex",alignItems:"center",fontSize:"0.85rem",fontFamily:"monospace",color:t?"inherit":"color-mix(in srgb, currentColor 50%, transparent)",...n},children:l||"Select date"})]})}function su({children:t,...e}){return d.jsx("select",{style:w4,...e,children:t})}function Ny({minHeight:t="6rem",style:e,...n}){return d.jsx("textarea",{style:{...Wa,width:"100%",minHeight:t,resize:"vertical",fontFamily:"inherit",boxSizing:"border-box",...e},...n})}function Ya({children:t}){return d.jsx("div",{style:O4,children:t})}function Lp(t){const n=t.replace(/[^\d.]/g,"").split("."),i=n[0]||"",a=n[1],l=i.replace(/\B(?=(\d{3})+(?!\d))/g,",");return a!==void 0?`$${l}.${a.slice(0,2)}`:l?`$${l}`:""}function F4(t){return t.replace(/[$,]/g,"")}function Sg({id:t,value:e,onChange:n,placeholder:i="$0.00",required:a,autoFocus:l}){const[u,h]=A.useState(()=>Lp(e)),m=A.useRef(null);A.useEffect(()=>{const _=Lp(e);F4(u)!==e&&h(_)},[e]);function g(_){const v=_.target.value;if(!v||v==="$"){h(""),n("");return}const w=v.replace(/[^\d.]/g,"").split(".");let C=w[0];w.length>1&&(C+="."+w.slice(1).join("").slice(0,2));const R=Lp(C);h(R),n(C)}return d.jsx("input",{ref:m,id:t,type:"text",inputMode:"decimal",value:u,onChange:g,placeholder:i,required:a,autoFocus:l,style:Wa})}function es(t=_4){const[e,n]=A.useState(()=>typeof window>"u"?!1:window.innerWidth<t);return A.useEffect(()=>{function i(){n(window.innerWidth<t)}return window.addEventListener("resize",i),i(),()=>window.removeEventListener("resize",i)},[t]),e}function vf({children:t,isDragging:e,isDragOver:n,onDragStart:i,onDragOver:a,onDragLeave:l,onDragEnd:u,onDrop:h,onEdit:m,onDelete:g,onMoveUp:_,onMoveDown:v,canMoveUp:b=!0,canMoveDown:w=!0,itemName:C}){const R=es(),N=_||v;return d.jsxs("div",{onDragOver:B=>{B.stopPropagation(),a(B)},onDragLeave:B=>{B.stopPropagation(),l()},onDrop:B=>{B.stopPropagation(),h(B)},style:{position:"relative"},children:[d.jsx("div",{style:{...sT,opacity:n?1:0,boxShadow:n?"0 0 8px rgba(100, 108, 255, 0.6)":"none"}}),d.jsxs("div",{style:{...R?v4:wu,opacity:e?.5:1},children:[d.jsxs("div",{style:{flex:1,display:"flex",alignItems:"center",gap:R?"0.5rem":"0.75rem",minWidth:0},children:[d.jsx("span",{draggable:!0,onDragStart:B=>{i(B)},onDragEnd:()=>{u()},style:{...iT,fontSize:R?"0.9rem":void 0,cursor:"grab",padding:"0.25rem",margin:"-0.25rem",borderRadius:"4px",userSelect:"none"},title:"Drag to reorder",children:""}),d.jsx("div",{style:{flex:1,minWidth:0,overflow:"hidden",textOverflow:"ellipsis"},children:t})]}),d.jsxs("div",{style:R?I4:D4,children:[R?d.jsxs(d.Fragment,{children:[d.jsx("button",{onClick:()=>{m()},style:rT,title:"Edit","aria-label":"Edit",children:""}),d.jsx("button",{onClick:()=>{g()},style:j4,title:"Delete","aria-label":"Delete",children:""})]}):d.jsxs(d.Fragment,{children:[d.jsx(Oe,{variant:"secondary",actionName:`Edit ${C||"Item"}`,onClick:m,children:"Edit"}),d.jsx(Oe,{variant:"danger",actionName:`Delete ${C||"Item"}`,onClick:g,children:"Delete"})]}),N&&d.jsxs("div",{style:My,children:[d.jsx("button",{onClick:B=>{B.stopPropagation(),_?.()},disabled:!b,style:{...ul,opacity:b?.6:.2,cursor:b?"pointer":"default"},title:"Move up","aria-label":"Move up",children:""}),d.jsx("button",{onClick:B=>{B.stopPropagation(),v?.()},disabled:!w,style:{...ul,opacity:w?.6:.2,cursor:w?"pointer":"default"},title:"Move down","aria-label":"Move down",children:""})]})]})]})]})}function Py({isActive:t,onDragOver:e,onDragLeave:n,onDrop:i,label:a="Move to end"}){return d.jsxs("div",{onDragOver:e,onDragLeave:n,onDrop:i,style:M4,children:[d.jsx("div",{style:{...k4,opacity:t?1:.3,boxShadow:t?"0 0 8px rgba(100, 108, 255, 0.6)":"none"}}),t&&d.jsx("span",{style:N4,children:a})]})}function Nc({children:t,style:e}){return d.jsx("div",{style:{...b4,...e},children:t})}function q4({items:t}){const e=es(),n=a=>e?[1,3,4,2][a]:a+1,i=a=>{if(e)switch(a){case 0:return{borderRight:!0,borderBottom:!0};case 3:return{borderRight:!1,borderBottom:!0};case 1:return{borderRight:!0,borderBottom:!1};case 2:return{borderRight:!1,borderBottom:!1};default:return{borderRight:!1,borderBottom:!1}}else return{borderRight:a<3,borderBottom:!1}};return d.jsx("div",{style:{display:"grid",gridTemplateColumns:e?"1fr 1fr":"repeat(4, 1fr)",background:"color-mix(in srgb, currentColor 5%, transparent)",borderRadius:"8px",marginBottom:"1.5rem",overflow:"hidden"},children:t.map((a,l)=>{const u=i(l);return d.jsxs("div",{style:{padding:"0.75rem 1rem",borderRight:u.borderRight?"1px solid color-mix(in srgb, currentColor 10%, transparent)":"none",borderBottom:u.borderBottom?"1px solid color-mix(in srgb, currentColor 10%, transparent)":"none",textAlign:"center",order:n(l)},children:[d.jsx("p",{style:{margin:0,fontSize:"0.75rem",opacity:.6,textTransform:"uppercase",letterSpacing:"0.05em"},children:a.label}),d.jsx("div",{style:{margin:"0.25rem 0 0 0",fontSize:"1.1rem",fontWeight:600},children:a.value}),a.subtitle&&d.jsx("p",{style:{margin:"0.1rem 0 0 0",fontSize:"0.65rem",opacity:.5},children:a.subtitle}),a.action&&d.jsx("div",{style:{marginTop:"0.25rem"},children:a.action})]},l)})})}function Re(t){return`$${t.toLocaleString("en-US",{minimumFractionDigits:2,maximumFractionDigits:2})}`}function Pt(t){return t>=0?de.success:de.danger}function aT(){const t=ln();return{submitFeedback:ir({mutationFn:async({userId:n,userEmail:i,text:a,feedbackType:l,currentPath:u})=>{const h=i||n,m={id:`feedback_${Date.now()}_${Math.random().toString(36).substr(2,9)}`,text:`${a}

(Submitted from: ${u})`,created_at:new Date().toISOString(),is_done:!1,completed_at:null,sort_order:Date.now(),feedback_type:l},{exists:g}=await ze("feedback",h,"checking if user has existing feedback document");return g?await xt("feedback",h,{items:XO(m),user_email:i,updated_at:new Date().toISOString()},"adding new feedback item to existing document",{merge:!0}):await xt("feedback",h,{items:[m],user_email:i,created_at:new Date().toISOString(),updated_at:new Date().toISOString()},"creating new feedback document for user"),{feedbackItem:m,docId:h}},onMutate:async({userId:n,userEmail:i,text:a,feedbackType:l,currentPath:u})=>{await t.cancelQueries({queryKey:xe.feedback()});const h=t.getQueryData(xe.feedback()),m=i||n,g={id:`feedback_optimistic_${Date.now()}`,text:`${a}

(Submitted from: ${u})`,created_at:new Date().toISOString(),is_done:!1,completed_at:null,sort_order:Date.now(),feedback_type:l,doc_id:m,user_email:i};return t.setQueryData(xe.feedback(),_=>_?{items:[..._.items,g]}:{items:[g]}),{previousData:h,optimisticItemId:g.id}},onSuccess:(n,i,a)=>{t.setQueryData(xe.feedback(),l=>l&&{items:l.items.map(u=>u.id===a?.optimisticItemId?{...n.feedbackItem,doc_id:n.docId,user_email:i.userEmail}:u)})},onError:(n,i,a)=>{a?.previousData&&t.setQueryData(xe.feedback(),a.previousData)}})}}function G4(){const t=ln();return{toggleFeedback:ir({mutationFn:async({item:n})=>{const{exists:i,data:a}=await ze("feedback",n.doc_id,"PRE-EDIT-READ");if(!i||!a)throw new Error(`Feedback document not found: ${n.doc_id}`);const l=!n.is_done,u=l?new Date().toISOString():null,h=a.items||[];let m=!1;const g=h.map(_=>_.id===n.id?(m=!0,{..._,is_done:l,completed_at:u}):_);if(!m)throw console.error("[toggleFeedback] Item not found in document",{searchingFor:n.id,inDocument:n.doc_id,availableIds:h.map(_=>_.id)}),new Error(`Feedback item not found in document. Item ID: ${n.id}, Doc ID: ${n.doc_id}`);return await xt("feedback",n.doc_id,{...a,items:g,updated_at:new Date().toISOString()},`marking feedback item as ${l?"done":"not done"}`),{itemId:n.id,isDone:l,completedAt:u}},onMutate:async({item:n})=>{await t.cancelQueries({queryKey:xe.feedback()});const i=t.getQueryData(xe.feedback()),a=!n.is_done,l=a?new Date().toISOString():null;return t.setQueryData(xe.feedback(),u=>u&&{items:u.items.map(h=>h.id===n.id?{...h,is_done:a,completed_at:l}:h)}),{previousData:i}},onError:(n,i,a)=>{a?.previousData&&t.setQueryData(xe.feedback(),a.previousData)}})}}function H4(){const t=ln();return{updateSortOrder:ir({mutationFn:async({docId:n,items:i})=>{const{exists:a,data:l}=await ze("feedback",n,"PRE-EDIT-READ");if(!a||!l)throw new Error("Feedback document not found");return await xt("feedback",n,{...l,items:i,updated_at:new Date().toISOString()},"saving reordered feedback items"),{docId:n,items:i}},onMutate:async({docId:n,items:i})=>{await t.cancelQueries({queryKey:xe.feedback()});const a=t.getQueryData(xe.feedback());return t.setQueryData(xe.feedback(),l=>{if(!l)return l;const u=new Map;return i.forEach(h=>{u.set(h.id,h.sort_order)}),{items:l.items.map(h=>h.doc_id===n&&u.has(h.id)?{...h,sort_order:u.get(h.id)}:h)}}),{previousData:a}},onError:(n,i,a)=>{a?.previousData&&t.setQueryData(xe.feedback(),a.previousData)}})}}function hl({isOpen:t,onClose:e,title:n,children:i,width:a="28rem"}){if(!t)return null;function l(){e()}return d.jsx("div",{style:{position:"fixed",inset:0,background:"rgba(0, 0, 0, 0.6)",display:"flex",alignItems:"center",justifyContent:"center",zIndex:1001,padding:"1rem"},onClick:l,children:d.jsxs("div",{style:{background:"#1a1a1a",color:"rgba(255, 255, 255, 0.87)",borderRadius:"12px",padding:"1.5rem",width:a,maxWidth:"calc(100vw - 2rem)",flexShrink:0,boxSizing:"border-box",boxShadow:"0 8px 32px rgba(0, 0, 0, 0.5)"},onClick:u=>u.stopPropagation(),children:[d.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:"1rem"},children:[d.jsx("h2",{style:{margin:0,fontSize:"1.25rem"},children:n}),d.jsx("button",{onClick:l,style:{background:"transparent",border:"none",color:"inherit",cursor:"pointer",fontSize:"1.5rem",opacity:.6,lineHeight:1},children:""})]}),i]})})}const Q4=2e3,$4={critical_bug:{label:"Critical Bug",color:"#ff4757",bgColor:"rgba(255, 71, 87, 0.15)"},bug:{label:"Bug",color:"#ffa502",bgColor:"rgba(255, 165, 2, 0.15)"},new_feature:{label:"New Feature",color:"#2ed573",bgColor:"rgba(46, 213, 115, 0.15)"},core_feature:{label:"Core Feature",color:"#1e90ff",bgColor:"rgba(30, 144, 255, 0.15)"},qol:{label:"QOL",color:"#a55eea",bgColor:"rgba(165, 94, 234, 0.15)"}};function K4(){const[t,e]=A.useState(!1),[n,i]=A.useState(""),[a,l]=A.useState("bug"),[u,h]=A.useState(!1),m=A.useContext(cu),_=Ka().get_current_firebase_user(),v=kn(),{submitFeedback:b}=aT();if(A.useEffect(()=>{if(u){const R=setTimeout(()=>h(!1),Q4);return()=>clearTimeout(R)}},[u]),v.pathname.includes("/admin/feedback")||!m.is_logged_in)return null;function C(R){R.preventDefault(),!(!n.trim()||!m.username||!_)&&(b.mutate({userId:_.uid,userEmail:m.username,text:n.trim(),feedbackType:a,currentPath:v.pathname}),i(""),l("bug"),e(!1),h(!0))}return d.jsxs(d.Fragment,{children:[u&&d.jsxs("div",{style:{position:"fixed",bottom:"5rem",right:"1.5rem",background:"rgba(46, 213, 115, 0.95)",color:"white",padding:"0.75rem 1rem",borderRadius:"0.5rem",fontSize:"0.9rem",fontWeight:500,boxShadow:"0 4px 12px rgba(0, 0, 0, 0.3)",zIndex:1001,display:"flex",alignItems:"center",gap:"0.5rem",animation:"fadeInUp 0.2s ease-out"},children:[d.jsx("span",{children:""}),d.jsx("span",{children:"Feedback submitted!"})]}),d.jsx("button",{onClick:()=>{e(!0)},style:{position:"fixed",bottom:"1.5rem",right:"1.5rem",width:"3rem",height:"3rem",borderRadius:"50%",background:de.primary,color:"white",border:"none",cursor:"pointer",display:"flex",alignItems:"center",justifyContent:"center",fontSize:"1.25rem",boxShadow:"0 4px 12px rgba(0, 0, 0, 0.3)",transition:"transform 0.15s, box-shadow 0.15s",zIndex:1e3},title:"Send Feedback",onMouseEnter:R=>{R.currentTarget.style.transform="scale(1.1)",R.currentTarget.style.boxShadow="0 6px 16px rgba(0, 0, 0, 0.4)"},onMouseLeave:R=>{R.currentTarget.style.transform="scale(1)",R.currentTarget.style.boxShadow="0 4px 12px rgba(0, 0, 0, 0.3)"},children:""}),d.jsx(hl,{isOpen:t,onClose:()=>{e(!1),l("bug")},title:"Send Feedback",children:d.jsxs("form",{onSubmit:C,children:[d.jsx("div",{style:{display:"flex",gap:"0.5rem",marginBottom:"0.75rem",paddingBottom:"1rem",flexWrap:"wrap"},children:["critical_bug","bug","new_feature","core_feature","qol"].map(R=>{const N=$4[R],B=a===R;return d.jsxs("button",{type:"button",onClick:()=>{N.label,l(R)},style:{flex:1,padding:"0.6rem 0.5rem",border:`2px solid ${N.color}`,borderRadius:"0.5rem",background:B?N.bgColor:"transparent",color:B?N.color:"rgba(255,255,255,0.5)",cursor:"pointer",fontWeight:B?600:400,fontSize:"0.8rem",transition:"all 0.15s ease",opacity:B?1:.5,boxShadow:B?`0 0 12px ${N.bgColor}`:"none",position:"relative"},children:[N.label,B&&d.jsx("span",{style:{position:"absolute",bottom:"-14px",left:"10%",right:"10%",height:"3px",background:"white",borderRadius:"2px"}})]},R)})}),d.jsx(Ny,{value:n,onChange:R=>i(R.target.value),placeholder:"Share your feedback, bug reports, or feature requests...",minHeight:"8rem",autoFocus:!0,required:!0}),d.jsxs(Ya,{children:[d.jsx(Oe,{type:"button",variant:"secondary",actionName:"Cancel Feedback",onClick:()=>{e(!1),l("bug")},children:"Cancel"}),d.jsx(Oe,{type:"submit",actionName:"Submit Feedback",disabled:!n.trim(),children:"Submit"})]})]})})]})}function Ns({children:t,labelStyle:e,...n}){return d.jsxs("label",{style:{display:"flex",alignItems:"flex-start",gap:"0.75rem",flex:1,cursor:"pointer",...e},children:[d.jsx("input",{type:"checkbox",style:{width:"1.25rem",height:"1.25rem",marginTop:"0.1rem",cursor:"pointer",accentColor:de.primary},...n}),t]})}function W4({title:t,count:e,children:n,defaultExpanded:i=!1}){const[a,l]=A.useState(i);return d.jsxs("div",{style:{marginTop:"2rem"},children:[d.jsxs("button",{onClick:()=>l(!a),style:{background:"transparent",border:"none",color:"inherit",cursor:"pointer",display:"flex",alignItems:"center",gap:"0.5rem",padding:"0.5rem 0",fontSize:"0.9rem",opacity:.7},children:[d.jsx("span",{style:{transition:"transform 0.2s",transform:a?"rotate(90deg)":"rotate(0deg)"},children:""}),t,e!==void 0&&` (${e})`]}),a&&n]})}const Y4=t=>{switch(t){case 2:return 220;case 3:return 320;case 4:return 420;case 5:return 520;case 6:return 620;default:return t*100+20}},X4=t=>t<=4?2:t<=6?3:Math.ceil(t/2);function Ly(t){const{tabs:e,activeTab:n}=t,i=e.filter(v=>!v.hidden),a=i.length,l=Y4(a),u=X4(a),h=Math.floor(100/u),m=`tab-nav-${a}`,g=v=>({flex:"1 1 0",padding:"0.6rem 0.5rem",border:"none",borderRadius:0,background:"transparent",cursor:"pointer",fontWeight:v?600:400,fontSize:"0.9rem",color:"inherit",opacity:v?1:.5,transition:"all 0.15s",textDecoration:"none",display:"inline-flex",alignItems:"center",justifyContent:"center",gap:"0.25rem",position:"relative",boxSizing:"border-box",outline:"none"}),_=(v,b)=>d.jsxs(d.Fragment,{children:[d.jsx("span",{children:v.label}),v.checkmark&&d.jsx("span",{style:{color:de.success,fontWeight:600},children:""}),b&&d.jsx("span",{style:{position:"absolute",bottom:"-1px",left:"15%",right:"15%",height:"3px",background:"white",borderRadius:"2px"}})]});return d.jsxs(d.Fragment,{children:[d.jsx("style",{children:`
        .${m} {
          display: flex;
          flex-wrap: wrap;
          margin-bottom: 1.5rem;
          border-bottom: 1px solid color-mix(in srgb, currentColor 15%, transparent);
        }
        .${m} > button,
        .${m} > a {
          border: none !important;
          border-radius: 0 !important;
          outline: none !important;
        }
        .${m} > button:hover,
        .${m} > button:focus,
        .${m} > a:hover,
        .${m} > a:focus {
          border: none !important;
          border-color: transparent !important;
        }
        @media (max-width: ${l}px) {
          .${m} > * {
            flex: 1 1 ${h}% !important;
            min-width: ${h}% !important;
          }
        }
      `}),d.jsx("div",{className:m,children:i.map(v=>{const b=n===v.id;return t.mode==="link"?d.jsx(Dt,{to:`${t.linkPrefix}/${v.id}`,onClick:()=>(`${v.label}`,void 0),style:g(b),children:_(v,b)},v.id):d.jsx("button",{onClick:()=>{`${v.label}`,t.onTabChange(v.id)},style:g(b),children:_(v,b)},v.id)})})]})}function Vy({items:t}){const[e,n]=A.useState(!1),i=A.useRef(null),l=kn().pathname;A.useEffect(()=>{function h(m){i.current&&!i.current.contains(m.target)&&n(!1)}if(e)return document.addEventListener("mousedown",h),()=>document.removeEventListener("mousedown",h)},[e]),A.useEffect(()=>{function h(m){m.key==="Escape"&&n(!1)}if(e)return document.addEventListener("keydown",h),()=>document.removeEventListener("keydown",h)},[e]);const u=t.filter(h=>h.hidden?!1:h.to?h.to==="/budget"?!(l==="/budget"||/^\/budget\/\d{4}\/\d{1,2}\/\w+$/.test(l)):h.to==="/account"||h.to==="/"?l!==h.to:!l.startsWith(h.to):!0);return d.jsxs("div",{ref:i,style:{position:"relative"},children:[d.jsx("button",{onClick:()=>{n(!e)},style:{display:"flex",alignItems:"center",justifyContent:"center",width:"2.5rem",height:"2.5rem",borderRadius:"8px",background:e?"color-mix(in srgb, currentColor 15%, transparent)":"color-mix(in srgb, currentColor 8%, transparent)",border:"none",cursor:"pointer",fontSize:"1.25rem",color:"inherit",transition:"background 0.15s",lineHeight:1},title:"Menu","aria-expanded":e,"aria-haspopup":"true",children:""}),e&&d.jsx("div",{style:{position:"absolute",top:"100%",right:0,marginTop:"0.5rem",minWidth:"180px",background:"#1a1a2e",border:"1px solid color-mix(in srgb, currentColor 20%, transparent)",borderRadius:"8px",boxShadow:"0 4px 20px rgba(0, 0, 0, 0.3)",zIndex:1e3,overflow:"hidden"},children:u.map((h,m)=>{if(h.divider)return d.jsx("div",{style:{height:"1px",background:"color-mix(in srgb, currentColor 15%, transparent)",margin:"0.25rem 0"}},m);const g=d.jsxs(d.Fragment,{children:[h.icon&&d.jsx("span",{style:{width:"1.5rem",textAlign:"center"},children:h.icon}),d.jsx("span",{children:h.label})]}),_={display:"flex",alignItems:"center",gap:"0.75rem",padding:"0.75rem 1rem",fontSize:"0.95rem",color:"inherit",textDecoration:"none",cursor:"pointer",transition:"background 0.15s",background:"transparent",border:"none",width:"100%",textAlign:"left"},v={background:"color-mix(in srgb, currentColor 10%, transparent)"};return h.to?d.jsx(Dt,{to:h.to,style:_,onMouseEnter:b=>Object.assign(b.currentTarget.style,v),onMouseLeave:b=>b.currentTarget.style.background="transparent",onClick:()=>{`${h.label}`,n(!1)},children:g},m):d.jsx("button",{onClick:()=>{`${h.label}`,h.onClick?.(),n(!1)},style:_,onMouseEnter:b=>Object.assign(b.currentTarget.style,v),onMouseLeave:b=>b.currentTarget.style.background="transparent",children:g},m)})})]})}function vi({title:t,showBackArrow:e=!1,hideMenu:n=!1}){const{isAdmin:i}=Tn(),a=[{label:"Budget",icon:"",to:"/budget"},{label:"Budget Settings",icon:"",to:"/budget/settings"},{label:"Analytics",icon:"",to:"/budget/analytics"},...i?[{label:"Admin",icon:"",to:"/budget/admin"}]:[],{label:"Switch Budgets",icon:"",to:"/budget/my-budgets"},{divider:!0,label:""},{label:"Exit Budget App",icon:"",to:"/"}];return d.jsxs("nav",{style:{marginBottom:"1rem",display:"grid",gridTemplateColumns:"1fr auto 1fr",alignItems:"center"},children:[d.jsx("div",{children:e?d.jsx(Dt,{to:"/",onClick:()=>void 0,style:{opacity:.6,fontSize:"1.5rem",textDecoration:"none"},title:"Back to Home",children:""}):d.jsx(Dt,{to:"/budget",onClick:()=>void 0,title:"Budget Home",children:d.jsx("img",{src:"/budget-icon.svg",alt:"Budget",style:{width:"1.5rem",height:"1.5rem"}})})}),d.jsx("span",{style:{fontWeight:600,fontSize:"1.1rem",textAlign:"center"},children:t}),d.jsx("div",{style:{display:"flex",justifyContent:"flex-end"},children:!n&&d.jsx(Vy,{items:a})})]})}function J4({children:t,style:e}){return d.jsx("div",{style:{width:"100%",maxWidth:"var(--content-max-width, 900px)",marginLeft:"auto",marginRight:"auto",...e},children:t})}function oT({label:t,value:e,action:n,inlineAction:i,compact:a}){const l=es();return a?d.jsxs("div",{style:{marginBottom:"1rem",paddingBottom:"0.75rem",borderBottom:"1px solid color-mix(in srgb, currentColor 15%, transparent)"},children:[d.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center"},children:[d.jsxs("span",{style:{display:"flex",alignItems:"baseline",gap:"0.5rem",flexWrap:"wrap"},children:[d.jsx("h3",{style:{margin:0,fontSize:"1.1rem"},children:t}),d.jsx("span",{style:{fontSize:"1.1rem",fontWeight:600},children:e})]}),n]}),i]}):d.jsxs("div",{style:{display:"flex",flexDirection:l?"column":"row",justifyContent:"space-between",alignItems:l?"stretch":"center",gap:l?"0.75rem":"1rem",marginBottom:"1rem",paddingBottom:"0.75rem",borderBottom:"1px solid color-mix(in srgb, currentColor 15%, transparent)"},children:[d.jsxs("div",{children:[d.jsx("h3",{style:{margin:0,fontSize:"1.1rem"},children:t}),d.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"0.5rem",margin:"0.25rem 0 0 0"},children:[d.jsx("span",{style:{fontSize:"1.25rem",fontWeight:600},children:e}),i]})]}),n]})}function Z4({isVisible:t,message:e="Loading..."}){return t?d.jsxs("div",{style:{position:"fixed",top:0,left:0,right:0,bottom:0,background:"rgba(0, 0, 0, 0.7)",display:"flex",flexDirection:"column",alignItems:"center",justifyContent:"center",zIndex:9999,gap:"1rem"},children:[d.jsx("div",{style:{width:"3rem",height:"3rem",border:"3px solid rgba(255, 255, 255, 0.2)",borderTopColor:de.primary,borderRadius:"50%",animation:"loadingOverlaySpin 0.8s linear infinite"}}),d.jsx("p",{style:{color:"white",fontSize:"1.1rem",fontWeight:500},children:e}),d.jsx("style",{children:`
        @keyframes loadingOverlaySpin {
          to { transform: rotate(360deg); }
        }
      `})]}):null}function wg(t){return new Date(t).toLocaleDateString("en-US",{month:"short",day:"numeric",year:"numeric",hour:"numeric",minute:"2-digit"})}function eP(){return d.jsxs("div",{style:Gn,children:[d.jsxs("nav",{style:{marginBottom:"1rem",display:"grid",gridTemplateColumns:"1fr auto 1fr",alignItems:"center"},children:[d.jsx("div",{style:{display:"flex",alignItems:"center"},children:d.jsx(Dt,{to:"/",style:{opacity:.6,fontSize:"1.5rem",textDecoration:"none",padding:"0.25rem 0.5rem"},title:"Back to Home",children:""})}),d.jsxs(Dt,{to:"/",style:{display:"flex",alignItems:"center",gap:"0.5rem",textDecoration:"none",color:"inherit"},title:"Tarron Lane Home",children:[d.jsx("img",{src:"/t-icon.svg",alt:"Tarron Lane",style:{width:"1.5rem",height:"1.5rem"}}),d.jsx("span",{style:{fontWeight:600,fontSize:"1.1rem"},children:"SQL Test"})]}),d.jsx("div",{style:{display:"flex",justifyContent:"flex-end"},children:d.jsx(Vy,{items:[{label:"Budget",icon:"",to:"/budget"},{label:"Account",icon:"",to:"/account"}]})})]}),d.jsx("h1",{children:"SQL Test"}),d.jsx("h2",{children:"Setup"}),d.jsxs("h3",{children:["1. Open up your preferred web browser to ",d.jsx("a",{href:"https://www.programiz.com/sql/online-compiler/",target:"_blank",rel:"noopener noreferrer",children:"https://www.programiz.com/sql/online-compiler/"})]}),d.jsxs("ul",{children:[d.jsx("li",{children:"This is a basic online sql query editor"}),d.jsxs("li",{children:["It will include three tables: ",d.jsx("b",{children:'"Customer"'}),", ",d.jsx("b",{children:'"Orders"'}),", and ",d.jsx("b",{children:'"Shippings"'})]})]}),d.jsx("h3",{children:"2. Run the below query block inside the online editor to make some updates to the schema."}),d.jsx("pre",{style:{backgroundColor:"#1a1a1a",padding:"1rem",borderRadius:"8px",overflow:"auto"},children:d.jsx("code",{children:`ALTER TABLE shippings
ADD order_id INT;

UPDATE shippings
SET order_id = CASE
  WHEN shipping_id = 1 THEN 5
    WHEN shipping_id = 2 THEN 1
    WHEN shipping_id = 3 THEN 3
    WHEN shipping_id = 4 THEN 6
    WHEN shipping_id = 5 THEN 4
END
WHERE shipping_id IN (1,2,3,4,5);

INSERT INTO shippings (shipping_id, status, customer, order_id)
VALUES (6, "Cancelled", 4, 2);

INSERT INTO orders (order_id, item, amount, customer_id)
VALUES (6, "Monitor", 800, 5);`})}),d.jsx("h2",{children:"SQL Problems"}),d.jsx("p",{children:"Write queries in the online editor to answer these questions."}),d.jsx("h3",{children:"Question #1"}),d.jsx("p",{children:'Calculate the total number of orders, the total $ amount, and the total items "delivered" by Country. Show the following columns: country, order count, total $ amount, and total delivered. Order by total $ amount largest to smallest.'}),d.jsx("h3",{children:"Question #2"}),d.jsx("p",{children:"Find the customers who have placed orders with the HIGHEST total amount for each country. One record per country. Display the customer's first name, last name, country, and the corresponding highest total order amount. Also include the shipping status of the associated order."})]})}function tP(){const t=A.useContext(cu),e=Ka(),[n,i]=A.useState(!1),a=kn(),l=ou(),u=a.state?.from||"/";A.useEffect(()=>{t.is_logged_in&&u!=="/"&&l(u,{replace:!0})},[t.is_logged_in,u,l]);function h(){i(!0),e.logout_firebase_user().then(function(){i(!1)})}return d.jsxs("div",{style:Gn,children:[d.jsxs("nav",{style:{marginBottom:"1rem",display:"grid",gridTemplateColumns:"1fr auto 1fr",alignItems:"center"},children:[d.jsx("div",{style:{display:"flex",alignItems:"center"},children:d.jsx(Dt,{to:"/",style:{opacity:.6,fontSize:"1.5rem",textDecoration:"none",padding:"0.25rem 0.5rem"},title:"Back to Home",children:""})}),d.jsxs(Dt,{to:"/",style:{display:"flex",alignItems:"center",gap:"0.5rem",textDecoration:"none",color:"inherit"},title:"Tarron Lane Home",children:[d.jsx("img",{src:"/t-icon.svg",alt:"Tarron Lane",style:{width:"1.5rem",height:"1.5rem"}}),d.jsx("span",{style:{fontWeight:600,fontSize:"1.1rem"},children:"Account"})]}),d.jsx("div",{style:{display:"flex",justifyContent:"flex-end"},children:d.jsx(Vy,{items:[{label:"Budget",icon:"",to:"/budget"},{label:"Account",icon:"",to:"/account"}]})})]}),d.jsx("h1",{children:"Account"}),t.is_logged_in?n?d.jsx("p",{children:"Logging Out..."}):d.jsxs(d.Fragment,{children:[d.jsxs("p",{children:["You are logged in as ",t.username]}),d.jsx("button",{onClick:h,style:{marginTop:"1rem"},children:"Logout"})]}):d.jsx(nP,{})]})}function nP(){const t=Ka(),[e,n]=A.useState(""),[i,a]=A.useState(""),[l,u]=A.useState(!1),[h,m]=A.useState("");function g(b){n(b.target.value)}function _(b){a(b.target.value)}function v(b){b.preventDefault(),u(!0),m(""),t.login_firebase_user(e,i).then(function(){}).catch(function(){m("Incorrect login credentials")}).finally(function(){u(!1)})}return d.jsxs("form",{onSubmit:v,children:[d.jsxs("div",{children:[d.jsx("label",{htmlFor:"username",children:"Email: "}),d.jsx("input",{id:"username",type:"email",value:e,onChange:g})]}),d.jsxs("div",{children:[d.jsx("label",{htmlFor:"password",children:"Password: "}),d.jsx("input",{id:"password",type:"password",value:i,onChange:_})]}),l?d.jsx("p",{children:"Logging in..."}):d.jsx("button",{children:"Login"}),h&&d.jsx("p",{style:{color:"red"},children:h})]})}function rP(){const[t,e]=A.useState(()=>typeof window>"u"?1200:window.innerWidth);return A.useEffect(()=>{function n(){e(window.innerWidth)}return window.addEventListener("resize",n),n(),()=>window.removeEventListener("resize",n)},[]),{width:t,isWide:t>=Lr.wide,isMedium:t>=Lr.tablet&&t<Lr.wide,isNarrowMedium:t>=Lr.mobile&&t<Lr.tablet,isMobile:t<Lr.mobile}}function iP(){const t=ln();return{updateAccounts:ir({mutationFn:async({budgetId:n,accounts:i})=>{const{exists:a,data:l}=await ze("budgets",n,"PRE-EDIT-READ");if(!a||!l)throw new Error("Budget not found");return await xt("budgets",n,{...l,accounts:i},"saving updated accounts (user edited account settings)"),i},onMutate:async({budgetId:n,accounts:i})=>{await t.cancelQueries({queryKey:xe.budget(n)});const a=t.getQueryData(xe.budget(n));return a&&t.setQueryData(xe.budget(n),{...a,accounts:i}),{previousData:a}},onSuccess:(n,{budgetId:i})=>{const a=t.getQueryData(xe.budget(i));a&&t.setQueryData(xe.budget(i),{...a,accounts:n})},onError:(n,{budgetId:i},a)=>{a?.previousData&&t.setQueryData(xe.budget(i),a.previousData)}})}}function sP(t){const e={};return Object.entries(t).forEach(([n,i])=>{e[n]={name:i.name,sort_order:i.sort_order},i.expected_balance!==void 0&&(e[n].expected_balance=i.expected_balance),i.on_budget!==void 0&&(e[n].on_budget=i.on_budget),i.is_active!==void 0&&(e[n].is_active=i.is_active)}),e}function aP(){const t=ln();return{updateAccountGroups:ir({mutationFn:async({budgetId:n,accountGroups:i})=>{const{exists:a,data:l}=await ze("budgets",n,"PRE-EDIT-READ");if(!a||!l)throw new Error("Budget not found");const u=sP(i);return await xt("budgets",n,{...l,account_groups:u},"saving updated account groups (user edited group settings)"),i},onMutate:async({budgetId:n,accountGroups:i})=>{await t.cancelQueries({queryKey:xe.budget(n)});const a=t.getQueryData(xe.budget(n));return a&&t.setQueryData(xe.budget(n),{...a,accountGroups:i}),{previousData:a}},onSuccess:(n,{budgetId:i})=>{const a=t.getQueryData(xe.budget(i));a&&t.setQueryData(xe.budget(i),{...a,accountGroups:n})},onError:(n,{budgetId:i},a)=>{a?.previousData&&t.setQueryData(xe.budget(i),a.previousData)}})}}function oP(){const t=ln();return{renameBudget:ir({mutationFn:async({budgetId:n,newName:i})=>{const{exists:a,data:l}=await ze("budgets",n,"PRE-EDIT-READ");if(!a||!l)throw new Error("Budget not found");return await xt("budgets",n,{...l,name:i.trim()},`renaming budget to "${i.trim()}"`),i.trim()},onMutate:async({budgetId:n,newName:i})=>{await t.cancelQueries({queryKey:xe.budget(n)});const a=t.getQueryData(xe.budget(n));return a&&t.setQueryData(xe.budget(n),{...a,budget:{...a.budget,name:i.trim()}}),{previousData:a}},onSuccess:(n,{budgetId:i})=>{const a=t.getQueryData(xe.budget(i));a&&t.setQueryData(xe.budget(i),{...a,budget:{...a.budget,name:n}})},onError:(n,{budgetId:i},a)=>{a?.previousData&&t.setQueryData(xe.budget(i),a.previousData)}})}}function lP(){const t=ln();return{createBudget:ir({mutationFn:async({name:n,userId:i,userEmail:a})=>{const l=`budget_${Date.now()}_${Math.random().toString(36).substr(2,9)}`,u=new Date().toISOString(),h={name:n.trim()||"My Budget",user_ids:[i],accepted_user_ids:[i],owner_id:i,owner_email:a,accounts:{},account_groups:{},categories:{},category_groups:[],created_at:u,updated_at:u};await xt("budgets",l,h,"creating new budget document");const{exists:m,data:g}=await ze("users",i,"reading user document to add new budget to their list");return m&&g?await xt("users",i,{...g,budget_ids:[l,...g.budget_ids],updated_at:u},"adding new budget to user's budget list"):await xt("users",i,{uid:i,email:a,budget_ids:[l],created_at:u,updated_at:u},"creating new user document with first budget"),{budgetId:l,budget:{id:l,...h}}},onSuccess:(n,{userId:i})=>{t.invalidateQueries({queryKey:xe.user(i)}),t.invalidateQueries({queryKey:xe.accessibleBudgets(i)})}})}}function cP(){const t=ln();return{acceptInvite:ir({mutationFn:async({budgetId:n,userId:i})=>{const a=new Date().toISOString(),{exists:l,data:u}=await ze("budgets",n,"verifying user was invited to this budget");if(!l||!u)throw new Error("Budget not found");if(!u.user_ids?.includes(i))throw new Error("You have not been invited to this budget");const{data:h}=await ze("users",i,"PRE-EDIT-READ");if(h?.budget_ids?.includes(n))throw new Error("You have already accepted this invite");return await xt("users",i,{...h||{uid:i,email:null},budget_ids:[n,...h?.budget_ids||[]],updated_at:a},"adding accepted budget to user's budget list"),await xt("budgets",n,{...u,accepted_user_ids:[...u.accepted_user_ids||[],i]},"marking user as accepted in budget's accepted_user_ids"),{budgetId:n}},onSuccess:(n,{userId:i})=>{t.invalidateQueries({queryKey:xe.user(i)}),t.invalidateQueries({queryKey:xe.accessibleBudgets(i)}),t.invalidateQueries({queryKey:xe.budget(n.budgetId)})}})}}function uP(){const t=ln();return{inviteUser:ir({mutationFn:async({budgetId:n,userId:i})=>{const{exists:a,data:l}=await ze("budgets",n,"PRE-EDIT-READ");if(!a||!l)throw new Error("Budget not found");if(l.user_ids?.includes(i))throw new Error("User is already invited");return await xt("budgets",n,{...l,user_ids:[...l.user_ids||[],i]},"adding user to budget's invited users list"),{budgetId:n}},onMutate:async({budgetId:n,userId:i})=>{await t.cancelQueries({queryKey:xe.budget(n)});const a=t.getQueryData(xe.budget(n));return a&&t.setQueryData(xe.budget(n),{...a,budget:{...a.budget,user_ids:[...a.budget.user_ids,i]}}),{previousData:a}},onSuccess:(n,{budgetId:i})=>{const a=t.getQueryData(xe.budget(i));a&&t.setQueryData(xe.budget(i),a)},onError:(n,{budgetId:i},a)=>{a?.previousData&&t.setQueryData(xe.budget(i),a.previousData)}})}}function dP(){const t=ln();return{revokeUser:ir({mutationFn:async({budgetId:n,userId:i})=>{const{exists:a,data:l}=await ze("budgets",n,"PRE-EDIT-READ");if(!a||!l)throw new Error("Budget not found");return await xt("budgets",n,{...l,user_ids:(l.user_ids||[]).filter(u=>u!==i),accepted_user_ids:(l.accepted_user_ids||[]).filter(u=>u!==i)},"removing user from budget's access lists"),{budgetId:n}},onMutate:async({budgetId:n,userId:i})=>{await t.cancelQueries({queryKey:xe.budget(n)});const a=t.getQueryData(xe.budget(n));return a&&t.setQueryData(xe.budget(n),{...a,budget:{...a.budget,user_ids:a.budget.user_ids.filter(l=>l!==i),accepted_user_ids:a.budget.accepted_user_ids.filter(l=>l!==i)}}),{previousData:a}},onSuccess:(n,{budgetId:i})=>{const a=t.getQueryData(xe.budget(i));a&&t.setQueryData(xe.budget(i),a)},onError:(n,{budgetId:i},a)=>{a?.previousData&&t.setQueryData(xe.budget(i),a.previousData)}})}}function Hn(t,e){const n=LM(t),{updateAccounts:i}=iP(),{updateAccountGroups:a}=aP(),{updateCategories:l}=hM(),{updateCategoryGroups:u}=fM(),{renameBudget:h}=oP(),{createBudget:m}=lP(),{acceptInvite:g}=cP(),{inviteUser:_}=uP(),{revokeUser:v}=dP(),b=n.data,w=b?.budget||null,C=A.useMemo(()=>b?.accounts||{},[b?.accounts]),R=A.useMemo(()=>b?.accountGroups||{},[b?.accountGroups]),N=A.useMemo(()=>b?.categories||{},[b?.categories]),B=A.useMemo(()=>b?.categoryGroups||[],[b?.categoryGroups]),H=w?.owner_id===e,F=A.useMemo(()=>w?.user_ids||[],[w?.user_ids]),ae=A.useMemo(()=>w?.accepted_user_ids||[],[w?.accepted_user_ids]),te=w?.total_available??0,he=A.useMemo(()=>b?.monthMap||{},[b?.monthMap]),L=A.useCallback(async Q=>{if(!t)throw new Error("No budget selected");await i.mutateAsync({budgetId:t,accounts:Q})},[t,i]),I=A.useCallback(async Q=>{if(!t)throw new Error("No budget selected");await a.mutateAsync({budgetId:t,accountGroups:Q})},[t,a]),D=A.useCallback(async Q=>{if(!t)throw new Error("No budget selected");await l.mutateAsync({budgetId:t,categories:Q})},[t,l]),k=A.useCallback(async Q=>{if(!t)throw new Error("No budget selected");await u.mutateAsync({budgetId:t,categoryGroups:Q})},[t,u]),O=A.useCallback(async(Q,fe)=>{if(!t)throw new Error("No budget selected");await Promise.all([i.mutateAsync({budgetId:t,accounts:Q}),a.mutateAsync({budgetId:t,accountGroups:fe})])},[t,i,a]),j=A.useCallback(async(Q,fe)=>{if(!t)throw new Error("No budget selected");await Promise.all([l.mutateAsync({budgetId:t,categories:Q}),u.mutateAsync({budgetId:t,categoryGroups:fe})])},[t,l,u]),T=A.useCallback(async Q=>{if(!t)throw new Error("No budget selected");await h.mutateAsync({budgetId:t,newName:Q})},[t,h]),Z=A.useCallback(async Q=>{if(!e)throw new Error("Not authenticated");return await m.mutateAsync({name:Q.trim()||"My Budget",userId:e,userEmail:null})},[e,m]),U=A.useCallback(async Q=>{if(!t)throw new Error("No budget selected");await _.mutateAsync({budgetId:t,userId:Q})},[t,_]),z=A.useCallback(async Q=>{if(!t)throw new Error("No budget selected");await v.mutateAsync({budgetId:t,userId:Q})},[t,v]),q=A.useCallback(async Q=>{if(!e)throw new Error("Not authenticated");await g.mutateAsync({budgetId:Q,userId:e})},[e,g]),K=A.useCallback(Q=>{if(!t)return;const fe=vt.getQueryData(xe.budget(t));fe&&vt.setQueryData(xe.budget(t),{...fe,accounts:Q})},[t]),ee=A.useCallback(Q=>{if(!t)return;const fe=vt.getQueryData(xe.budget(t));fe&&vt.setQueryData(xe.budget(t),{...fe,accountGroups:Q})},[t]),X=A.useCallback(Q=>{if(!t)return;const fe=vt.getQueryData(xe.budget(t));fe&&vt.setQueryData(xe.budget(t),{...fe,categories:Q})},[t]),P=A.useCallback(Q=>{if(!t)return;const fe=vt.getQueryData(xe.budget(t));fe&&vt.setQueryData(xe.budget(t),{...fe,categoryGroups:Q})},[t]),W=A.useCallback(async()=>{t&&await vt.invalidateQueries({queryKey:xe.budget(t)})},[t]),Y=A.useCallback(()=>Object.entries(C).filter(([,Q])=>{const fe=Q.account_group_id?R[Q.account_group_id]:void 0,ce=fe?.on_budget!==void 0?fe.on_budget:Q.on_budget!==!1,me=fe?.is_active!==void 0?fe.is_active:Q.is_active!==!1;return ce&&me}).reduce((Q,[,fe])=>Q+fe.balance,0),[C,R]);return{isLoading:n.isLoading,isFetching:n.isFetching,error:n.error,budget:w,accounts:C,accountGroups:R,categories:N,categoryGroups:B,isOwner:H,budgetUserIds:F,acceptedUserIds:ae,totalAvailable:te,monthMap:he,saveAccounts:L,saveAccountGroups:I,saveCategories:D,saveCategoryGroups:k,saveAccountsAndGroups:O,saveCategoriesAndGroups:j,renameBudget:T,createBudget:Z,inviteUser:U,revokeUser:z,acceptInvite:q,setAccountsOptimistic:K,setAccountGroupsOptimistic:ee,setCategoriesOptimistic:X,setCategoryGroupsOptimistic:P,refreshBudget:W,getOnBudgetTotal:Y}}function Ol(t,e,n){const i=GM(t,e,n,{enabled:!!t}),{addIncome:a}=vM(),{updateIncome:l}=bM(),{deleteIncome:u}=xM(),{addExpense:h}=EM(),{updateExpense:m}=SM(),{deleteExpense:g}=wM(),_=i.data?.month||null,v=_?.income||[],b=_?.expenses||[],w=_?.category_balances||[],C=_?.total_income||0,R=_?.total_expenses||0,N=_?.are_allocations_finalized||!1,B=_?.previous_month_income??0,H=A.useCallback(async(D,k,O,j,T)=>{if(!t)throw new Error("No budget selected");const[Z,U]=O.split("-").map(Number);await a(t,Z,U,D,k,O,j,T)},[t,a]),F=A.useCallback(async(D,k,O,j,T,Z)=>{if(!t)throw new Error("No budget selected");await l(t,e,n,D,k,O,j,T,Z)},[t,e,n,l]),ae=A.useCallback(async D=>{if(!t)throw new Error("No budget selected");await u(t,e,n,D)},[t,e,n,u]),te=A.useCallback(async(D,k,O,j,T,Z,U)=>{if(!t)throw new Error("No budget selected");const[z,q]=j.split("-").map(Number);await h(t,z,q,D,k,O,j,T,Z,U)},[t,h]),he=A.useCallback(async(D,k,O,j,T,Z,U,z)=>{if(!t)throw new Error("No budget selected");await m(t,e,n,D,k,O,j,T,Z,U,z)},[t,e,n,m]),L=A.useCallback(async D=>{if(!t)throw new Error("No budget selected");await g(t,e,n,D)},[t,e,n,g]),I=A.useCallback(async()=>{t&&await vt.invalidateQueries({queryKey:xe.month(t,e,n)})},[t,e,n]);return{isLoading:i.isLoading,isFetching:i.isFetching,error:i.error,month:_,income:v,expenses:b,categoryBalances:w,totalIncome:C,totalExpenses:R,areAllocationsFinalized:N,previousMonthIncome:B,addIncome:H,updateIncome:F,deleteIncome:ae,addExpense:te,updateExpense:he,deleteExpense:L,refreshMonth:I}}function hP(){const{selectedBudgetId:t,currentUserId:e}=Tn(),{budget:n,accounts:i,accountGroups:a,saveAccounts:l,saveAccountGroups:u,saveAccountsAndGroups:h,setAccountsOptimistic:m,setAccountGroupsOptimistic:g}=Hn(t,e),[_,v]=A.useState(null),b=A.useMemo(()=>Object.entries(i).reduce((I,[D,k])=>{const O=k.account_group_id||"ungrouped";return I[O]||(I[O]=[]),I[O].push({...k,id:D}),I},{}),[i]),w=A.useMemo(()=>Object.entries(a).sort(([,I],[,D])=>I.sort_order-D.sort_order).map(([I,D])=>({...D,id:I})),[a]),C=A.useCallback((I,D)=>{if(!n)return;const k=Object.values(i).filter(U=>D==="ungrouped"?!U.account_group_id:U.account_group_id===D),O=k.length>0?Math.max(...k.map(U=>U.sort_order)):-1,j=`account_${Date.now()}_${Math.random().toString(36).substr(2,9)}`,T={nickname:I.nickname,description:"",balance:0,account_group_id:D==="ungrouped"?null:D,sort_order:O+1,is_income_account:I.is_income_account??!1,is_income_default:I.is_income_default??!1,is_outgo_account:I.is_outgo_account??!1,is_outgo_default:I.is_outgo_default??!1,on_budget:I.on_budget!==!1,is_active:I.is_active!==!1},Z={...i};I.is_income_default&&Object.keys(Z).forEach(U=>{Z[U]={...Z[U],is_income_default:!1}}),I.is_outgo_default&&Object.keys(Z).forEach(U=>{Z[U]={...Z[U],is_outgo_default:!1}}),Z[j]=T,m(Z),l(Z).catch(U=>{console.error("[useAccountHandlers] Error creating account:",U),v(U instanceof Error?U.message:"Failed to create account.")})},[n,i,m,l]),R=A.useCallback((I,D)=>{if(!n)return;const k=i[I];if(!k)return;const O=k.account_group_id||"ungrouped",j=D.account_group_id;let T=k.sort_order;if(O!==(j||"ungrouped")){const U=Object.values(i).filter(z=>(z.account_group_id||"ungrouped")===(j||"ungrouped"));T=U.length>0?Math.max(...U.map(z=>z.sort_order))+1:0}const Z={};Object.entries(i).forEach(([U,z])=>{U===I?Z[U]={...z,nickname:D.nickname,account_group_id:j,sort_order:T,is_income_account:D.is_income_account??!1,is_income_default:D.is_income_default??!1,is_outgo_account:D.is_outgo_account??!1,is_outgo_default:D.is_outgo_default??!1,on_budget:D.on_budget!==!1,is_active:D.is_active!==!1}:(Z[U]={...z},D.is_income_default&&!k.is_income_default&&(Z[U].is_income_default=!1),D.is_outgo_default&&!k.is_outgo_default&&(Z[U].is_outgo_default=!1))}),m(Z),l(Z).catch(U=>{console.error("[useAccountHandlers] Error saving account:",U),v(U instanceof Error?U.message:"Failed to save account.")})},[n,i,m,l]),N=A.useCallback(I=>{if(!confirm("Are you sure you want to delete this account?")||!n)return;const{[I]:D,...k}=i;m(k),l(k).catch(O=>{console.error("[useAccountHandlers] Error deleting account:",O),v(O instanceof Error?O.message:"Failed to delete account.")})},[n,i,m,l]),B=A.useCallback(async(I,D)=>{const k=i[I];if(!k)return;const O=k.account_group_id||"ungrouped",j=Object.entries(i).filter(([,K])=>(K.account_group_id||"ungrouped")===O).sort(([,K],[,ee])=>K.sort_order-ee.sort_order),T=j.findIndex(([K])=>K===I),Z=D==="up"?T-1:T+1;if(Z<0||Z>=j.length)return;const[U,z]=j[Z],q={};if(Object.entries(i).forEach(([K,ee])=>{K===I?q[K]={...ee,sort_order:z.sort_order}:K===U?q[K]={...ee,sort_order:k.sort_order}:q[K]={...ee}}),m(q),!!n)try{await l(q)}catch(K){m(i),v(K instanceof Error?K.message:"Failed to move account")}},[n,i,m,l]),H=A.useCallback(I=>{if(!n)return;const D=Object.values(a).map(Z=>Z.sort_order),k=D.length>0?Math.max(...D):-1,O=`account_group_${Date.now()}_${Math.random().toString(36).substr(2,9)}`,j={name:I.name,sort_order:k+1,expected_balance:I.expected_balance,on_budget:I.on_budget,is_active:I.is_active},T={...a,[O]:j};g(T),u(T).catch(Z=>{console.error("[useAccountHandlers] Error creating group:",Z),v(Z instanceof Error?Z.message:"Failed to create account type.")})},[n,a,g,u]),F=A.useCallback((I,D)=>{if(!n)return;const k={...a,[I]:{...a[I],name:D.name,expected_balance:D.expected_balance,on_budget:D.on_budget,is_active:D.is_active}};g(k),u(k).catch(O=>{console.error("[useAccountHandlers] Error updating group:",O),v(O instanceof Error?O.message:"Failed to update account type.")})},[n,a,g,u]),ae=A.useCallback(I=>{if(!confirm("Are you sure you want to delete this account type? Accounts in this type will move to Ungrouped.")||!n)return;const D={};Object.entries(i).forEach(([j,T])=>{D[j]=T.account_group_id===I?{...T,account_group_id:null}:T});const{[I]:k,...O}=a;m(D),g(O),h(D,O).catch(j=>{console.error("[useAccountHandlers] Error deleting group:",j),v(j instanceof Error?j.message:"Failed to delete account type.")})},[n,i,a,m,g,h]),te=A.useCallback(async(I,D)=>{const k=Object.entries(a).sort(([,U],[,z])=>U.sort_order-z.sort_order),O=k.findIndex(([U])=>U===I),j=D==="up"?O-1:O+1;if(j<0||j>=k.length)return;const[T]=k.splice(O,1);k.splice(j,0,T);const Z={};if(k.forEach(([U,z],q)=>{Z[U]={...z,sort_order:q}}),g(Z),!!n)try{await u(Z)}catch(U){g(a),v(U instanceof Error?U.message:"Failed to move account type")}},[n,a,g,u]),he=A.useCallback(async(I,D,k)=>{const O=i[I];if(!O)return;const j=k==="ungrouped"?null:k,T=Object.entries(i).filter(([,z])=>(z.account_group_id||"ungrouped")===k),Z={};Object.entries(i).forEach(([z,q])=>{z!==I&&(Z[z]={...q})});let U;if(D==="__group_end__"||T.length===0||!T.find(([z])=>z===D))U=(T.length>0?Math.max(...T.filter(([q])=>q!==I).map(([,q])=>q.sort_order)):-1)+1;else{const z=T.find(([q])=>q===D);if(z){const[,q]=z;U=q.sort_order,Object.entries(Z).forEach(([K,ee])=>{(ee.account_group_id||"ungrouped")===k&&ee.sort_order>=U&&(Z[K]={...ee,sort_order:ee.sort_order+1})})}else U=0}if(Z[I]={...O,account_group_id:j,sort_order:U},m(Z),!!n)try{await l(Z)}catch(z){v(z instanceof Error?z.message:"Failed to save changes")}},[n,i,m,l]),L=A.useCallback(async(I,D)=>{if(I===D)return;const k=Object.entries(a).sort(([,U],[,z])=>U.sort_order-z.sort_order),O=k.findIndex(([U])=>U===I),j=[...k],[T]=j.splice(O,1);if(D==="__end__")j.push(T);else{const U=j.findIndex(([z])=>z===D);j.splice(U,0,T)}const Z={};if(j.forEach(([U,z],q)=>{Z[U]={...z,sort_order:q}}),g(Z),!!n)try{await u(Z)}catch(U){v(U instanceof Error?U.message:"Failed to save new order")}},[n,a,g,u]);return{accounts:i,accountGroups:a,accountsByGroup:b,sortedGroups:w,currentBudget:n,error:_,setError:v,handleCreateAccount:C,handleUpdateAccount:R,handleDeleteAccount:N,handleMoveAccount:B,handleCreateGroup:H,handleUpdateGroup:F,handleDeleteGroup:ae,handleMoveGroup:te,reorderAccountsInGroup:he,reorderGroups:L}}function xE(t,e){if(!t)return{};const n={};return Object.entries(e).forEach(([i,a])=>{if(a.default_monthly_type==="percentage")return;const l=t.category_balances?.find(u=>u.category_id===i);l&&l.allocated>0?n[i]=l.allocated.toString():a.default_monthly_amount!==void 0&&a.default_monthly_amount>0?n[i]=a.default_monthly_amount.toString():n[i]=""}),n}function fP(){const{selectedBudgetId:t,currentUserId:e,currentYear:n,currentMonthNumber:i}=Tn(),{categories:a,getOnBudgetTotal:l,totalAvailable:u}=Hn(t,e),{month:h,isLoading:m,previousMonthIncome:g,areAllocationsFinalized:_}=Ol(t,n,i),v=A.useMemo(()=>h?.income?h.income.reduce((ce,me)=>ce+me.amount,0):0,[h]),{saveDraftAllocations:b}=uM(),{finalizeAllocations:w}=mM(),{deleteAllocations:C}=pM(),R=A.useMemo(()=>xE(h,a),[h,a]),[N,B]=A.useState(R),[H,F]=A.useState(!1),[ae,te]=A.useState(!1),[he,L]=A.useState(!1),[I,D]=A.useState(!1),[k,O]=A.useState(null),j=A.useRef(null);A.useMemo(()=>Object.values(a).reduce((ce,me)=>ce+(me.balance??0),0),[a]),A.useEffect(()=>{if(!h)return;const ce=`${h.year}-${h.month}`;j.current!==ce&&(D(!1),B(xE(h,a)),j.current=ce)},[h,a]);const T=A.useCallback((ce,me)=>{if(me.default_monthly_type==="percentage"&&me.default_monthly_amount!==void 0)return me.default_monthly_amount/100*g;const ge=N[ce],Ee=parseFloat(ge||"0");return isNaN(Ee)?0:Ee},[N,g]),Z=A.useMemo(()=>Object.entries(a).reduce((ce,[me,ge])=>ce+T(me,ge),0),[a,T]),U=l(),z=_?(h?.category_balances||[]).reduce((ce,me)=>ce+me.allocated,0):0,q=u,K=A.useMemo(()=>q-Z+z,[q,Z,z]),ee=A.useCallback((ce,me)=>{B(ge=>({...ge,[ce]:me}))},[]),X=A.useCallback(()=>{if(!h)return;const ce={};Object.entries(a).forEach(([me,ge])=>{if(ge.default_monthly_type==="percentage")return;const Ee=h.category_balances?.find(re=>re.category_id===me);Ee&&Ee.allocated>0?ce[me]=Ee.allocated.toString():ge.default_monthly_amount!==void 0&&ge.default_monthly_amount>0?ce[me]=ge.default_monthly_amount.toString():ce[me]=""}),B(ce),D(!1)},[h,a]),P=A.useCallback(()=>{const ce={};return Object.entries(a).forEach(([me,ge])=>{const Ee=T(me,ge);Ee>0&&(ce[me]=Ee)}),ce},[a,T]),W=A.useCallback(async()=>{if(t){O(null),F(!0);try{await b(t,n,i,P()),D(!1)}catch(ce){O(ce instanceof Error?ce.message:"Failed to save allocations")}finally{F(!1)}}},[t,n,i,b,P]),Y=A.useCallback(async()=>{if(t){O(null),te(!0);try{await w({budgetId:t,year:n,month:i,allocations:P()}),D(!1)}catch(ce){O(ce instanceof Error?ce.message:"Failed to finalize allocations")}finally{te(!1)}}},[t,n,i,w,P]),Q=A.useCallback(async()=>{if(t){O(null),L(!0);try{await C({budgetId:t,year:n,month:i});const ce={};Object.entries(a).forEach(([me,ge])=>{ge.default_monthly_type!=="percentage"&&(ge.default_monthly_amount!==void 0&&ge.default_monthly_amount>0?ce[me]=ge.default_monthly_amount.toString():ce[me]="")}),B(ce),D(!1)}catch(ce){O(ce instanceof Error?ce.message:"Failed to delete allocations")}finally{L(!1)}}},[t,n,i,C,a]),fe=Z-z;return{localAllocations:N,isSavingAllocations:H,isFinalizingAllocations:ae,isDeletingAllocations:he,isEditingAppliedAllocations:I,error:k,monthLoading:m,onBudgetTotal:U,availableNow:q,currentDraftTotal:Z,draftChangeAmount:fe,availableAfterApply:K,previousMonthIncome:g,currentMonthIncome:v,allocationsFinalized:_,getAllocationAmount:T,handleAllocationChange:ee,resetAllocationsToSaved:X,handleSaveAllocations:W,handleFinalizeAllocations:Y,handleDeleteAllocations:Q,setIsEditingAppliedAllocations:D,setError:O}}function mP({budgetId:t,categories:e,currentYear:n,currentMonth:i,updateCategoriesWithBalances:a}){const l=A.useMemo(()=>{const b={};return Object.entries(e).forEach(([w,C])=>{b[w]={current:C.balance??0,total:C.balance??0}}),b},[e]),[u,h]=A.useState(!1),[m,g]=A.useState(null),_=A.useCallback(async()=>{if(!t||Object.keys(e).length===0)return null;const b=Object.keys(e),{total:w}=await Jx(t,b,n,i),C={};Object.entries(e).forEach(([N,B])=>{const H=B.balance,F=w[N]??0;Math.abs(H-F)>.01&&(C[N]={stored:H,calculated:F})});const R=Object.keys(C).length>0?C:null;return g(R),R},[t,e,n,i]),v=A.useCallback(async()=>{if(!(!t||Object.keys(e).length===0)){h(!0);try{const b=Object.keys(e),{total:w}=await Jx(t,b,n,i),C={};Object.entries(e).forEach(([R,N])=>{C[R]={...N,balance:w[R]??0}}),await a(C),g(null)}finally{h(!1)}}},[t,e,a,n,i]);return{categoryBalances:l,loadingBalances:u,categoryBalanceMismatch:m,checkCategoryBalanceMismatch:_,recalculateAndSaveCategoryBalances:v}}function pP({categories:t,categoryGroups:e,currentBudget:n,setCategoriesOptimistic:i,setCategoryGroupsOptimistic:a,saveCategories:l,saveCategoryGroups:u,setError:h}){const[m,g]=A.useState(null),[_,v]=A.useState(null),[b,w]=A.useState(null),[C,R]=A.useState(null);function N(k,O){g("category"),v(O),k.dataTransfer.effectAllowed="move"}function B(k,O,j){k.preventDefault(),m==="category"&&(O!==_&&w(O),R(j))}function H(k,O){k.preventDefault(),m==="category"?(R(O),w(null)):m==="group"&&O!==_&&w(O)}function F(){w(null)}function ae(){R(null)}function te(){g(null),v(null),w(null),R(null)}async function he(k,O,j){if(k.preventDefault(),k.stopPropagation(),!_||m!=="category"){te();return}const T=t[_];if(!T)return;const Z=j==="ungrouped"?null:j,U=Object.entries(t).filter(([,K])=>(K.category_group_id||"ungrouped")===j),z={};Object.entries(t).forEach(([K,ee])=>{K!==_&&(z[K]=ee)});let q;if(O==="__group_end__"||U.length===0||!U.find(([K])=>K===O))q=(U.length>0?Math.max(...U.filter(([ee])=>ee!==_).map(([,ee])=>ee.sort_order)):-1)+1;else{const K=U.find(([ee])=>ee===O);K?(q=K[1].sort_order,Object.entries(z).forEach(([ee,X])=>{(X.category_group_id||"ungrouped")===j&&X.sort_order>=q&&(z[ee]={...X,sort_order:X.sort_order+1})})):q=0}if(z[_]={...T,category_group_id:Z,sort_order:q},i(z),te(),!!n)try{await l(z)}catch(K){h(K instanceof Error?K.message:"Failed to save changes")}}async function L(k,O){k.preventDefault(),m==="category"?await he(k,"__group_end__",O):m==="group"&&await D(k,O)}function I(k,O){k.stopPropagation(),g("group"),v(O),k.dataTransfer.effectAllowed="move"}async function D(k,O){if(k.preventDefault(),!_||m!=="group"||_===O){te();return}const j=e.findIndex(z=>z.id===_),T=[...e],[Z]=T.splice(j,1);if(O==="__end__")T.push(Z);else{const z=T.findIndex(q=>q.id===O);T.splice(z,0,Z)}const U=T.map((z,q)=>({...z,sort_order:q}));if(a(U),te(),!!n)try{await u(U)}catch(z){h(z instanceof Error?z.message:"Failed to save new order")}}return{dragType:m,draggedId:_,dragOverId:b,dragOverGroupId:C,setDragOverId:w,setDragOverGroupId:R,handleCategoryDragStart:N,handleCategoryDragOver:B,handleDragOverGroup:H,handleDragLeave:F,handleDragLeaveGroup:ae,handleDragEnd:te,handleCategoryDrop:he,handleDropOnGroup:L,handleGroupDragStart:I,handleGroupDrop:D}}function gP(){const{selectedBudgetId:t,currentUserId:e,currentYear:n,currentMonthNumber:i}=Tn(),{budget:a,categories:l,categoryGroups:u,isLoading:h,saveCategories:m,saveCategoryGroups:g,saveCategoriesAndGroups:_,setCategoriesOptimistic:v,setCategoryGroupsOptimistic:b,getOnBudgetTotal:w}=Hn(t,e),[C,R]=A.useState(null),{categoryBalances:N,loadingBalances:B,categoryBalanceMismatch:H,checkCategoryBalanceMismatch:F,recalculateAndSaveCategoryBalances:ae}=mP({budgetId:t,categories:l,currentYear:n,currentMonth:i,updateCategoriesWithBalances:m}),te=pP({categories:l,categoryGroups:u,currentBudget:a,setCategoriesOptimistic:v,setCategoryGroupsOptimistic:b,saveCategories:m,saveCategoryGroups:g,setError:R});async function he(z,q){if(!a)return;const K=q==="ungrouped"?null:q,ee=Object.values(l).filter(Q=>q==="ungrouped"?!Q.category_group_id:Q.category_group_id===q),X=ee.length>0?Math.max(...ee.map(Q=>Q.sort_order)):-1,P=`category_${Date.now()}_${Math.random().toString(36).substr(2,9)}`,W={name:z.name,description:z.description??"",category_group_id:K,sort_order:X+1,default_monthly_amount:z.default_monthly_amount??0,default_monthly_type:z.default_monthly_type??"fixed",balance:0},Y={...l,[P]:W};v(Y);try{await m(Y)}catch(Q){v(l),R(Q instanceof Error?Q.message:"Failed to create category")}}async function L(z,q){if(a)try{const K=l[z];if(!K)return;const ee=K.category_group_id||"ungrouped",X=q.category_group_id;let P=K.sort_order;if(ee!==(X||"ungrouped")){const Y=Object.values(l).filter(Q=>(Q.category_group_id||"ungrouped")===(X||"ungrouped")).filter((Q,fe,ce)=>l[z]!==ce[fe]);P=Y.length>0?Math.max(...Y.map(Q=>Q.sort_order))+1:0}const W={...l,[z]:{...K,name:q.name,description:q.description??"",category_group_id:X,sort_order:P,default_monthly_amount:q.default_monthly_amount??0,default_monthly_type:q.default_monthly_type??"fixed"}};v(W),await m(W)}catch(K){R(K instanceof Error?K.message:"Failed to update category")}}async function I(z){if(confirm("Are you sure you want to delete this category?")&&a)try{const{[z]:q,...K}=l;v(K),await m(K)}catch(q){R(q instanceof Error?q.message:"Failed to delete category")}}async function D(z,q){const K=l[z];if(!K)return;const ee=K.category_group_id||"ungrouped",X=Object.entries(l).filter(([,ce])=>(ce.category_group_id||"ungrouped")===ee).sort((ce,me)=>ce[1].sort_order-me[1].sort_order),P=X.findIndex(([ce])=>ce===z),W=q==="up"?P-1:P+1;if(W<0||W>=X.length)return;const[Y,Q]=X[W],fe={};if(Object.entries(l).forEach(([ce,me])=>{ce===z?fe[ce]={...me,sort_order:Q.sort_order}:ce===Y?fe[ce]={...me,sort_order:K.sort_order}:fe[ce]=me}),v(fe),!!a)try{await m(fe)}catch(ce){v(l),R(ce instanceof Error?ce.message:"Failed to move category")}}async function k(z){if(a)try{const q=u.length>0?Math.max(...u.map(X=>X.sort_order)):-1,K={id:`category_group_${Date.now()}_${Math.random().toString(36).substr(2,9)}`,name:z.name,sort_order:q+1},ee=[...u,K];b(ee),await g(ee)}catch(q){R(q instanceof Error?q.message:"Failed to create group")}}async function O(z,q){if(a)try{const K=u.map(ee=>ee.id===z?{...ee,name:q.name}:ee);b(K),await g(K)}catch(K){R(K instanceof Error?K.message:"Failed to update group")}}async function j(z){if(confirm("Are you sure you want to delete this group? Categories in this group will move to Uncategorized.")&&a)try{const q={};Object.entries(l).forEach(([ee,X])=>{q[ee]=X.category_group_id===z?{...X,category_group_id:null}:X});const K=u.filter(ee=>ee.id!==z);v(q),b(K),await _(q,K)}catch(q){R(q instanceof Error?q.message:"Failed to delete group")}}async function T(z,q){const K=[...u].sort((Y,Q)=>Y.sort_order-Q.sort_order),ee=K.findIndex(Y=>Y.id===z),X=q==="up"?ee-1:ee+1;if(X<0||X>=K.length)return;const[P]=K.splice(ee,1);K.splice(X,0,P);const W=K.map((Y,Q)=>({...Y,sort_order:Q}));if(b(W),!!a)try{await g(W)}catch(Y){b(u),R(Y instanceof Error?Y.message:"Failed to move group")}}const Z=Object.entries(l).reduce((z,[q,K])=>{const ee=K.category_group_id||"ungrouped";return z[ee]||(z[ee]=[]),z[ee].push([q,K]),z},{}),U=[...u].sort((z,q)=>z.sort_order-q.sort_order);return{currentBudget:a,categories:l,categoryGroups:u,categoriesByGroup:Z,sortedGroups:U,categoryBalances:N,isLoading:h,loadingBalances:B,error:C,setError:R,getOnBudgetTotal:w,categoryBalanceMismatch:H,checkCategoryBalanceMismatch:F,recalculateAndSaveCategoryBalances:ae,handleCreateCategory:he,handleUpdateCategory:L,handleDeleteCategory:I,handleMoveCategory:D,handleCreateGroup:k,handleUpdateGroup:O,handleDeleteGroup:j,handleMoveGroup:T,dragType:te.dragType,draggedId:te.draggedId,dragOverId:te.dragOverId,dragOverGroupId:te.dragOverGroupId,setDragOverId:te.setDragOverId,setDragOverGroupId:te.setDragOverGroupId,handleCategoryDragStart:te.handleCategoryDragStart,handleCategoryDragOver:te.handleCategoryDragOver,handleDragOverGroup:te.handleDragOverGroup,handleDragLeave:te.handleDragLeave,handleDragLeaveGroup:te.handleDragLeaveGroup,handleDragEnd:te.handleDragEnd,handleCategoryDrop:te.handleCategoryDrop,handleDropOnGroup:te.handleDropOnGroup,handleGroupDragStart:te.handleGroupDragStart,handleGroupDrop:te.handleGroupDrop}}function EE(t){return{nickname:t.nickname??"",description:t.description??"",balance:t.balance??0,account_group_id:t.account_group_id??null,sort_order:t.sort_order??0,is_income_account:t.is_income_account??!1,is_income_default:t.is_income_default??!1,is_outgo_account:t.is_outgo_account??!1,is_outgo_default:t.is_outgo_default??!1,on_budget:t.on_budget??!0,is_active:t.is_active??!0}}function SE(t){return{name:t.name??"",description:t.description??"",category_group_id:t.category_group_id??null,sort_order:t.sort_order??0,default_monthly_amount:t.default_monthly_amount??0,default_monthly_type:t.default_monthly_type??"fixed",balance:t.balance??0}}function wE(t){return{name:t.name??"",sort_order:t.sort_order??0,...t.expected_balance!==void 0&&{expected_balance:t.expected_balance},...t.on_budget!==void 0&&{on_budget:t.on_budget},...t.is_active!==void 0&&{is_active:t.is_active}}}function yP(t,e){const n=e.match(/_(\d{4})(\d{2})$/),i=n?parseInt(n[1]):new Date().getFullYear(),a=n?parseInt(n[2]):new Date().getMonth()+1,l=`${i}${String(a).padStart(2,"0")}`;return{budget_id:t.budget_id??"",year_month_ordinal:t.year_month_ordinal??l,year:t.year??i,month:t.month??a,income:Array.isArray(t.income)?t.income:[],total_income:t.total_income??0,previous_month_income:t.previous_month_income??0,expenses:Array.isArray(t.expenses)?t.expenses:[],total_expenses:t.total_expenses??0,account_balances:Array.isArray(t.account_balances)?t.account_balances:[],category_balances:Array.isArray(t.category_balances)?t.category_balances:[],are_allocations_finalized:t.are_allocations_finalized??!1,created_at:t.created_at??new Date().toISOString(),updated_at:t.updated_at??new Date().toISOString()}}function TE(t){return t.nickname===void 0||t.description===void 0||t.balance===void 0||t.sort_order===void 0||t.is_income_account===void 0||t.is_income_default===void 0||t.is_outgo_account===void 0||t.is_outgo_default===void 0||t.on_budget===void 0||t.is_active===void 0}function AE(t){return t.name===void 0||t.description===void 0||t.sort_order===void 0||t.default_monthly_amount===void 0||t.default_monthly_type===void 0||t.balance===void 0}function CE(t){return t.name===void 0||t.sort_order===void 0}function RE(t){return t.budget_id===void 0||t.year_month_ordinal===void 0||t.year===void 0||t.month===void 0||!Array.isArray(t.income)||t.total_income===void 0||t.previous_month_income===void 0||!Array.isArray(t.expenses)||t.total_expenses===void 0||!Array.isArray(t.account_balances)||!Array.isArray(t.category_balances)||t.are_allocations_finalized===void 0||t.created_at===void 0||t.updated_at===void 0}function DE(){const t=new Date,e=t.getFullYear();let i=t.getMonth()+1+2,a=e;return i>12&&(i-=12,a+=1),{year:a,month:i}}function IE(t,e,n){return t>n.year||t===n.year&&e>n.month}function _P(){const t=new Date,e=t.getFullYear(),n=t.getMonth()+1,i=[];for(let a=3;a>0;a--){let l=e,u=n-a;for(;u<1;)u+=12,l-=1;i.push(fn(l,u))}i.push(fn(e,n));for(let a=1;a<=3;a++){let l=e,u=n+a;for(;u>12;)u-=12,l+=1;i.push(fn(l,u))}return i}async function vP(t){const e={},n=_P(),i=await Sr("months",`database cleanup: querying months for budget ${t}`,[{field:"budget_id",op:"==",value:t}]),a=new Set;for(const l of i.docs){const u=l.data;if(u.year&&u.month){const h=fn(u.year,u.month);a.add(h)}}for(const l of n)a.has(l)&&(e[l]={needs_recalculation:!1});return e}function bP({currentUser:t,onComplete:e}){const[n,i]=A.useState(!1),[a,l]=A.useState(!1),[u,h]=A.useState(null),[m,g]=A.useState(null);async function _(){if(t){i(!0);try{const C=await Sr("budgets","database cleanup: scanning all budgets");let R=0,N=0,B=0,H=0,F=0,ae=0,te=0,he=0;for(const j of C.docs){const T=j.data;if(Array.isArray(T.accounts)||Array.isArray(T.categories)||Array.isArray(T.account_groups)){R++;continue}T.month_map===void 0&&he++;const Z=T.accounts;if(Z&&typeof Z=="object"){let q=!1;for(const K of Object.values(Z))TE(K)&&(F++,q=!0);q&&N++}const U=T.categories;if(U&&typeof U=="object"){let q=!1;for(const K of Object.values(U))AE(K)&&(ae++,q=!0);q&&B++}const z=T.account_groups;if(z&&typeof z=="object"){let q=!1;for(const K of Object.values(z))CE(K)&&(te++,q=!0);q&&H++}}const L=await Sr("months","database cleanup: scanning all months"),I=DE(),D=[];let k=0,O=0;for(const j of L.docs){const T=j.data,Z=T.year,U=T.month;Z&&U&&IE(Z,U,I)&&D.push({docId:j.id,budgetId:T.budget_id,year:Z,month:U}),RE(T)&&k++,T.is_needs_recalculation!==void 0&&O++}D.sort((j,T)=>j.year!==T.year?j.year-T.year:j.month-T.month),h({totalBudgets:C.docs.length,budgetsWithArrays:R,budgetsWithMissingAccountDefaults:N,budgetsWithMissingCategoryDefaults:B,budgetsWithMissingGroupDefaults:H,accountsNeedingDefaults:F,categoriesNeedingDefaults:ae,groupsNeedingDefaults:te,budgetsNeedingMonthMap:he,totalMonths:L.docs.length,futureMonthsToDelete:D,monthsWithSchemaIssues:k,monthsWithOldRecalcField:O})}catch(C){console.error("Failed to scan database:",C)}finally{i(!1)}}}async function v(){if(!t)return;l(!0),g(null);const C=[];let R=0,N=0,B=0,H=0,F=0,ae=0,te=0,he=0,L=0;try{const I=await Sr("budgets","database cleanup: reading all budgets to fix");for(const O of I.docs)try{const{exists:j,data:T}=await ze("budgets",O.id,"database cleanup: reading budget for update");if(!j||!T)continue;let Z=!1;const U={...T};if(Array.isArray(T.accounts)){const z=T.accounts,q={};for(const K of z){const ee=K.id||`account_${Date.now()}_${Math.random().toString(36).substr(2,9)}`;q[ee]=EE(K),N++}U.accounts=q,Z=!0,F++}if(Array.isArray(T.categories)){const z=T.categories,q={};for(const K of z){const ee=K.id||`category_${Date.now()}_${Math.random().toString(36).substr(2,9)}`;q[ee]=SE(K),B++}U.categories=q,Z=!0,F++}if(Array.isArray(T.account_groups)){const z=T.account_groups,q={};for(const K of z){const ee=K.id||`group_${Date.now()}_${Math.random().toString(36).substr(2,9)}`;q[ee]=wE(K),H++}U.account_groups=q,Z=!0,F++}if(!Array.isArray(T.accounts)&&T.accounts&&typeof T.accounts=="object"){const z=T.accounts,q={};for(const[K,ee]of Object.entries(z))TE(ee)?(q[K]=EE(ee),N++,Z=!0):q[K]=ee;Z&&(U.accounts=q)}if(!Array.isArray(T.categories)&&T.categories&&typeof T.categories=="object"){const z=T.categories,q={};let K=!1;for(const[ee,X]of Object.entries(z))AE(X)?(q[ee]=SE(X),B++,K=!0):q[ee]=X;K&&(U.categories=q,Z=!0)}if(!Array.isArray(T.account_groups)&&T.account_groups&&typeof T.account_groups=="object"){const z=T.account_groups,q={};let K=!1;for(const[ee,X]of Object.entries(z))CE(X)?(q[ee]=wE(X),H++,K=!0):q[ee]=X;K&&(U.account_groups=q,Z=!0)}if(T.month_map===void 0){const z=await vP(O.id);U.month_map=z,Z=!0,ae++,console.log(`[DatabaseCleanup] Added month_map to budget ${O.id} with ${Object.keys(z).length} months`)}delete U.category_balances,delete U.allocations,delete U.allocations_finalized,delete U.is_needs_recalculation,Z&&(await xt("budgets",O.id,U,"database cleanup: saving fixed budget"),R++)}catch(j){C.push(`Budget ${O.id}: ${j instanceof Error?j.message:"Unknown error"}`)}const D=await Sr("months","database cleanup: reading all months"),k=DE();for(const O of D.docs)try{const j=O.data,T=j.year,Z=j.month;if(T&&Z&&IE(T,Z,k)){await Ey("months",O.id,`database cleanup: deleting future month ${T}-${Z}`),te++;continue}if(RE(j)){const U=yP(j,O.id);await xt("months",O.id,U,"database cleanup: saving fixed month"),he++}j.is_needs_recalculation!==void 0&&(await Na("months",O.id,{is_needs_recalculation:YO(),updated_at:new Date().toISOString()},`database cleanup: removing is_needs_recalculation from month ${T}/${Z}`),L++,console.log(`[DatabaseCleanup] Removed is_needs_recalculation from month ${T}/${Z}`))}catch(j){C.push(`Month ${O.id}: ${j instanceof Error?j.message:"Unknown error"}`)}g({budgetsProcessed:R,accountsFixed:N,categoriesFixed:B,groupsFixed:H,arraysConverted:F,monthMapsAdded:ae,futureMonthsDeleted:te,monthsFixed:he,oldRecalcFieldsRemoved:L,errors:C}),e?.()}catch(I){g({budgetsProcessed:0,accountsFixed:0,categoriesFixed:0,groupsFixed:0,arraysConverted:0,monthMapsAdded:0,futureMonthsDeleted:0,monthsFixed:0,oldRecalcFieldsRemoved:0,errors:[I instanceof Error?I.message:"Unknown error"]})}finally{l(!1)}}const b=u!==null&&(u.budgetsWithArrays>0||u.accountsNeedingDefaults>0||u.categoriesNeedingDefaults>0||u.groupsNeedingDefaults>0||u.budgetsNeedingMonthMap>0||u.futureMonthsToDelete.length>0||u.monthsWithSchemaIssues>0||u.monthsWithOldRecalcField>0),w=u!==null?u.budgetsWithArrays+u.accountsNeedingDefaults+u.categoriesNeedingDefaults+u.groupsNeedingDefaults+u.budgetsNeedingMonthMap+u.futureMonthsToDelete.length+u.monthsWithSchemaIssues+u.monthsWithOldRecalcField:0;return{status:u,isScanning:n,scanStatus:_,hasIssues:b,totalIssues:w,isRunning:a,result:m,runCleanup:v}}function Vp(t){return t.includes("@")?!1:!!(/_[a-z0-9]+_(com|org|net|edu|io|co|uk|gov|mil|biz|info)$/i.test(t)&&(t.match(/_/g)||[]).length>=2||/_[a-z0-9]+\.(com|org|net|edu|io|co|uk|gov|mil|biz|info)$/i.test(t)&&(t.match(/_/g)||[]).length>=1)}function xP(t){let e=t;const n=/^(.+)_(gmail|yahoo|hotmail|outlook|icloud|aol|proton|protonmail)\.(.+)$/i,i=e.match(n);return i?`${i[1]}@${i[2]}.${i[3]}`:(e=e.replace(/_com$/,".com").replace(/_net$/,".net").replace(/_org$/,".org").replace(/_edu$/,".edu").replace(/_io$/,".io"),e=e.replace(/_gmail_/,"@gmail.").replace(/_yahoo_/,"@yahoo.").replace(/_hotmail_/,"@hotmail.").replace(/_outlook_/,"@outlook.").replace(/_icloud_/,"@icloud."),e)}function _h(t){if(t===null||typeof t!="object"||Array.isArray(t))return!1;const e=t;return e._methodName==="arrayUnion"&&Array.isArray(e.vc)}function lT(t){return t.vc||[]}function jE(t){return Array.isArray(t.items)?t.items:_h(t.items)?lT(t.items):[]}function EP({currentUser:t}){const[e,n]=A.useState(!1),[i,a]=A.useState(!1),[l,u]=A.useState(null),[h,m]=A.useState(null);async function g(){if(!t)return;n(!0);const v={documentsFound:0,sanitizedDocuments:[],corruptedDocuments:[],isHealthy:!0};try{const b=await Sr("feedback","feedback migration: scanning for issues");v.documentsFound=b.docs.length;for(const w of b.docs)Vp(w.id)&&v.sanitizedDocuments.push(w.id),_h(w.data.items)&&v.corruptedDocuments.push(w.id);v.isHealthy=v.sanitizedDocuments.length===0&&v.corruptedDocuments.length===0,u(v)}catch(b){console.error("Failed to scan feedback:",b)}finally{n(!1)}}async function _(){if(!t)return;a(!0);const v=h?{...h,mergedItems:0,deletedDocuments:0,fixedDocuments:0,errors:[]}:{documentsFound:0,sanitizedDocuments:[],corruptedDocuments:[],mergedItems:0,deletedDocuments:0,fixedDocuments:0,errors:[]};try{const b=await Sr("feedback","feedback migration: listing all documents");v.documentsFound=b.docs.length,v.sanitizedDocuments=[],v.corruptedDocuments=[];for(const w of b.docs){const C=Vp(w.id);if(_h(w.data.items)&&!C){v.corruptedDocuments.push(w.id);const N=lT(w.data.items);try{await xt("feedback",w.id,{items:N,user_email:w.data.user_email||w.id,created_at:w.data.created_at||new Date().toISOString(),updated_at:new Date().toISOString()},`feedback migration: fixing corrupted arrayUnion in ${w.id}`),v.fixedDocuments++}catch(B){v.errors.push(`Failed to fix ${w.id}: ${B instanceof Error?B.message:"Unknown error"}`)}}}for(const w of b.docs)if(Vp(w.id)){v.sanitizedDocuments.push(w.id);const C=w.id,R=xP(C),N=jE(w.data),{exists:B,data:H}=await ze("feedback",R,`feedback migration: checking if ${R} exists`);if(B&&H){const F=jE(H),ae=new Set(F.map(he=>he.id)),te=N.filter(he=>!ae.has(he.id));if(te.length>0||_h(H.items)){const he=[...F,...te];await xt("feedback",R,{...H,items:he,updated_at:new Date().toISOString()},`feedback migration: merging ${te.length} items from ${C}`),v.mergedItems+=te.length}}else N.length>0&&(await xt("feedback",R,{items:N,user_email:R,created_at:w.data.created_at||new Date().toISOString(),updated_at:new Date().toISOString()},`feedback migration: creating ${R} from ${C}`),v.mergedItems+=N.length);try{await Ey("feedback",C,`feedback migration: deleting sanitized document ${C}`),v.deletedDocuments++}catch(F){v.errors.push(`Failed to delete ${C}: ${F instanceof Error?F.message:"Unknown error"}`)}}m(v)}catch(b){v.errors.push(b instanceof Error?b.message:"Migration failed"),m(v)}finally{a(!1)}}return{status:l,isScanning:e,scanStatus:g,isMigratingFeedback:i,feedbackMigrationResult:h,migrateFeedbackDocuments:_}}function SP({currentUser:t,onComplete:e}){const[n,i]=A.useState(!1),[a,l]=A.useState(!1),[u,h]=A.useState(null),[m,g]=A.useState(null);async function _(){if(t){i(!0);try{const b=await Sr("months","delete all months: scanning for all months"),w=[],C=new Set;for(const R of b.docs){const{budget_id:N,year:B,month:H}=R.data;C.add(N),w.push({docId:R.id,budgetId:N,year:B,month:H})}w.sort((R,N)=>R.budgetId!==N.budgetId?R.budgetId.localeCompare(N.budgetId):R.year!==N.year?R.year-N.year:R.month-N.month),h({monthsToDelete:w,monthsCount:w.length,budgetCount:C.size})}catch(b){console.error("Failed to scan months:",b)}finally{i(!1)}}}async function v(){if(!t||!u||u.monthsToDelete.length===0)return;l(!0),g(null);let b=0;const w=[];for(const C of u.monthsToDelete)try{await Ey("months",C.docId,`delete all months: deleting month ${C.year}-${C.month} for budget ${C.budgetId}`),b++}catch(R){w.push(`Failed to delete ${C.docId}: ${R instanceof Error?R.message:"Unknown error"}`)}g({deleted:b,errors:w}),l(!1),w.length===0&&(h({monthsToDelete:[],monthsCount:0,budgetCount:0}),e?.())}return{status:u,isScanning:n,scanStatus:_,isDeleting:a,deleteResult:m,deleteAllMonths:v}}function wP({onCreateNew:t}){const[e,n]=A.useState(""),[i,a]=A.useState(!1),[l,u]=A.useState(null);async function h(m){m.preventDefault(),a(!0),u(null);try{await t(e.trim()||void 0)}catch(g){u(g instanceof Error?g.message:"Failed to create budget"),a(!1)}}return d.jsxs("div",{style:{maxWidth:"500px",margin:"0 auto"},children:[d.jsx("h1",{style:{marginBottom:"0.5rem"},children:"Welcome!"}),d.jsx("p",{style:{opacity:.7,marginBottom:"2rem"},children:"You don't have any budgets yet. Create your first budget to get started."}),l&&d.jsxs("div",{style:{background:"rgba(220, 38, 38, 0.1)",border:"1px solid rgba(220, 38, 38, 0.3)",color:"#f87171",padding:"0.75rem 1rem",borderRadius:"8px",marginBottom:"1.5rem",display:"flex",justifyContent:"space-between",alignItems:"center"},children:[d.jsx("span",{children:l}),d.jsx("button",{onClick:()=>u(null),style:{background:"transparent",border:"none",color:"#f87171",cursor:"pointer",fontSize:"1.2rem",padding:"0 0.25rem",lineHeight:1},children:""})]}),d.jsxs("div",{style:{background:"color-mix(in srgb, #646cff 8%, transparent)",border:"1px solid color-mix(in srgb, #646cff 25%, transparent)",padding:"2rem",borderRadius:"12px"},children:[d.jsxs("h2",{style:{margin:"0 0 1rem 0",fontSize:"1.1rem",display:"flex",alignItems:"center",gap:"0.5rem"},children:[d.jsx("span",{children:""})," Create Your Budget"]}),d.jsxs("form",{onSubmit:h,children:[d.jsxs("div",{style:{marginBottom:"1.5rem"},children:[d.jsx("label",{style:{display:"block",marginBottom:"0.5rem",fontSize:"0.9rem",opacity:.8},children:"Budget Name"}),d.jsx("input",{type:"text",value:e,onChange:m=>n(m.target.value),placeholder:"My Budget",autoFocus:!0,style:{width:"100%",padding:"0.75rem 1rem",borderRadius:"8px",border:"1px solid color-mix(in srgb, currentColor 25%, transparent)",background:"color-mix(in srgb, currentColor 5%, transparent)",fontSize:"1rem",color:"inherit",boxSizing:"border-box"}}),d.jsx("p",{style:{margin:"0.5rem 0 0 0",fontSize:"0.8rem",opacity:.5},children:"You can always rename this later"})]}),d.jsx("button",{type:"submit",disabled:i,style:{width:"100%",background:de.primary,color:"white",border:"none",padding:"0.75rem 1.5rem",borderRadius:"8px",cursor:i?"not-allowed":"pointer",fontWeight:600,opacity:i?.7:1,fontSize:"1rem"},children:i?"Creating...":"Create Budget"})]})]}),d.jsx("p",{style:{marginTop:"1.5rem",textAlign:"center",fontSize:"0.85rem",opacity:.6},children:"If someone has invited you to their budget, you can accept the invitation from the budget settings page after creating your account."})]})}function TP({invites:t,onAccept:e,onCreateNew:n}){const[i,a]=A.useState(null),[l,u]=A.useState(!1),[h,m]=A.useState(""),[g,_]=A.useState(!1),[v,b]=A.useState(null);async function w(R){a(R),b(null);try{await e(R)}catch(N){b(N instanceof Error?N.message:"Failed to accept invitation"),a(null)}}async function C(R){R.preventDefault(),_(!0),b(null);try{await n(h.trim()||void 0)}catch(N){b(N instanceof Error?N.message:"Failed to create new budget"),_(!1)}}return d.jsxs("div",{children:[d.jsx("h1",{style:{marginBottom:"0.5rem"},children:"Welcome!"}),d.jsxs("p",{style:{opacity:.7,marginBottom:"2rem"},children:["You've been invited to join ",t.length===1?"a budget":"some budgets",". Choose one to get started!"]}),v&&d.jsxs("div",{style:{background:"rgba(220, 38, 38, 0.1)",border:"1px solid rgba(220, 38, 38, 0.3)",color:"#f87171",padding:"0.75rem 1rem",borderRadius:"8px",marginBottom:"1.5rem",display:"flex",justifyContent:"space-between",alignItems:"center"},children:[d.jsx("span",{children:v}),d.jsx("button",{onClick:()=>b(null),style:{background:"transparent",border:"none",color:"#f87171",cursor:"pointer",fontSize:"1.2rem",padding:"0 0.25rem",lineHeight:1},children:""})]}),d.jsxs("div",{style:{background:"color-mix(in srgb, #f59e0b 8%, transparent)",border:"1px solid color-mix(in srgb, #f59e0b 25%, transparent)",padding:"1.5rem",borderRadius:"12px",marginBottom:"1.5rem"},children:[d.jsxs("h2",{style:{margin:"0 0 1rem 0",fontSize:"1.1rem",display:"flex",alignItems:"center",gap:"0.5rem"},children:[d.jsx("span",{children:""})," Budget Invitations"]}),d.jsx("div",{style:{display:"flex",flexDirection:"column",gap:"0.75rem"},children:t.map(R=>d.jsxs("div",{style:{background:"color-mix(in srgb, currentColor 8%, transparent)",padding:"1rem 1.25rem",borderRadius:"8px",display:"flex",justifyContent:"space-between",alignItems:"center",gap:"1rem",flexWrap:"wrap"},children:[d.jsxs("div",{style:{flex:1,minWidth:"200px"},children:[d.jsx("p",{style:{margin:"0 0 0.25rem 0",fontWeight:600,fontSize:"1.05rem"},children:R.budgetName}),R.ownerEmail&&d.jsxs("p",{style:{margin:0,fontSize:"0.85rem",opacity:.6},children:["From: ",R.ownerEmail]})]}),d.jsx("button",{onClick:()=>w(R.budgetId),disabled:i!==null||g,style:{background:"#22c55e",color:"white",border:"none",padding:"0.6rem 1.5rem",borderRadius:"8px",cursor:i!==null||g?"not-allowed":"pointer",fontWeight:500,opacity:i!==null||g?.7:1,fontSize:"0.9rem"},children:i===R.budgetId?"Joining...":"Accept & Join"})]},R.budgetId))})]}),d.jsx("div",{style:{background:"color-mix(in srgb, currentColor 5%, transparent)",border:"1px dashed color-mix(in srgb, currentColor 20%, transparent)",padding:"1.5rem",borderRadius:"12px"},children:l?d.jsxs("form",{onSubmit:C,children:[d.jsx("h3",{style:{margin:"0 0 1rem 0",fontSize:"1rem"},children:"Create Your Budget"}),d.jsxs("div",{style:{marginBottom:"1rem"},children:[d.jsx("label",{style:{display:"block",marginBottom:"0.5rem",fontSize:"0.9rem",opacity:.8},children:"Budget Name"}),d.jsx("input",{type:"text",value:h,onChange:R=>m(R.target.value),placeholder:"My Budget",autoFocus:!0,style:{width:"100%",padding:"0.6rem 0.8rem",borderRadius:"6px",border:"1px solid color-mix(in srgb, currentColor 25%, transparent)",background:"color-mix(in srgb, currentColor 5%, transparent)",fontSize:"0.95rem",color:"inherit",boxSizing:"border-box"}})]}),d.jsxs("div",{style:{display:"flex",gap:"0.75rem"},children:[d.jsx("button",{type:"submit",disabled:g||i!==null,style:{background:de.primary,color:"white",border:"none",padding:"0.6rem 1.25rem",borderRadius:"6px",cursor:g||i!==null?"not-allowed":"pointer",fontWeight:500,opacity:g||i!==null?.7:1,fontSize:"0.9rem"},children:g?"Creating...":"Create Budget"}),d.jsx("button",{type:"button",onClick:()=>{u(!1),m("")},disabled:g,style:{background:"transparent",color:"inherit",border:"1px solid color-mix(in srgb, currentColor 30%, transparent)",padding:"0.6rem 1.25rem",borderRadius:"6px",cursor:g?"not-allowed":"pointer",fontWeight:500,opacity:g?.7:.8,fontSize:"0.9rem"},children:"Cancel"})]})]}):d.jsxs("div",{style:{textAlign:"center"},children:[d.jsx("p",{style:{margin:"0 0 1rem 0",opacity:.7},children:"Or start fresh with your own budget"}),d.jsx("button",{onClick:()=>u(!0),disabled:i!==null,style:{background:de.primary,color:"white",border:"none",padding:"0.6rem 1.5rem",borderRadius:"8px",cursor:i!==null?"not-allowed":"pointer",fontWeight:500,opacity:i!==null?.7:1,fontSize:"0.9rem"},children:"Create New Budget"})]})})]})}function AP({activeTab:t,setActiveTab:e,allocationsFinalized:n}){const i=A.useMemo(()=>[{id:"income",label:"Income"},{id:"balances",label:"Balances",checkmark:n},{id:"spend",label:"Spend"}],[n]);return d.jsx(Ly,{mode:"button",tabs:i,activeTab:t,onTabChange:a=>e(a)})}function CP({isOpen:t,onClose:e,onProceed:n,results:i}){const a=!i||i.status==="confirming",l=i&&!["confirming","done","error"].includes(i.status),u=a||i?.status==="done"||i?.status==="error";function h(){u&&e()}return d.jsx(hl,{isOpen:t,onClose:h,title:"Recalculate Balances",width:"540px",children:d.jsxs("div",{style:{padding:"0.5rem 0"},children:[a&&d.jsxs(d.Fragment,{children:[d.jsxs("p",{style:{margin:"0 0 1rem 0",fontSize:"0.95rem",lineHeight:1.5},children:["This will recalculate category balances and account balances from the ",d.jsx("strong",{children:"current month forward"}),"."]}),d.jsx("p",{style:{margin:"0 0 1.5rem 0",fontSize:"0.9rem",opacity:.7},children:"Use this if your data seems out of sync or after fixing bugs. Past months will not be modified."}),d.jsxs("div",{style:{display:"flex",flexDirection:"column",gap:"0.75rem",marginBottom:"1.5rem"},children:[d.jsx(Uo,{status:"waiting",label:"Find all months to process"}),d.jsx(Uo,{status:"waiting",label:"Process months"}),d.jsx(Uo,{status:"waiting",label:"Update budget totals"})]}),d.jsxs("div",{style:{display:"flex",gap:"0.75rem",justifyContent:"flex-end"},children:[d.jsx(Oe,{variant:"secondary",actionName:"Cancel Recalculation",onClick:e,children:"Cancel"}),d.jsx(Oe,{actionName:"Proceed with Recalculation",onClick:n,children:"Proceed"})]})]}),!a&&d.jsxs(d.Fragment,{children:[d.jsx("p",{style:{margin:"0 0 1.5rem 0",fontSize:"0.9rem",opacity:.7},children:"Recalculating category balances and account balances..."}),d.jsxs("div",{style:{display:"flex",flexDirection:"column",gap:"0.75rem"},children:[d.jsx(Uo,{status:i?.status==="pending"?"waiting":"complete",label:"Find all months to process",detail:i&&i.status!=="pending"?`Found ${i.monthsFound||0} month${i.monthsFound!==1?"s":""}`:void 0}),d.jsx(Uo,{status:OE(i?.status,["pending","finding_months"],"processing_months"),label:"Process months",detail:i?.status==="processing_months"?`Processing: ${i.currentMonthLabel} (${(i.currentMonthIndex||0)+1}/${i.monthsFound||0})`:i?.monthsProcessed!==void 0?`Processed ${i.monthsProcessed} month${i.monthsProcessed!==1?"s":""}`:void 0}),d.jsx(Uo,{status:i?.status==="error"?"error":OE(i?.status,["pending","finding_months","processing_months"],"updating_budget"),label:"Update budget totals",detail:i?.status==="error"?i.error:void 0,isError:i?.status==="error"})]}),i?.status==="done"&&d.jsxs("div",{style:{marginTop:"1.5rem",padding:"1rem",background:`color-mix(in srgb, ${de.success} 10%, transparent)`,border:`1px solid ${de.success}`,borderRadius:"8px",textAlign:"center"},children:[d.jsx("p",{style:{margin:0,fontWeight:600,color:de.success},children:" Recalculation complete!"}),d.jsxs("p",{style:{margin:"0.5rem 0 0 0",fontSize:"0.9rem",opacity:.8},children:[i.monthsProcessed," month",i.monthsProcessed!==1?"s":""," processed",d.jsx("br",{}),"Total Income: ",Re(i.totalIncomeRecalculated||0),d.jsx("br",{}),"Total Expenses: ",Re(i.totalExpensesRecalculated||0)]})]}),(i?.status==="done"||i?.status==="error")&&d.jsx("div",{style:{marginTop:"1.5rem",display:"flex",justifyContent:"center"},children:d.jsx(Oe,{actionName:"Close Recalculation Modal",onClick:e,children:"Done"})}),l&&d.jsx("p",{style:{marginTop:"1.5rem",textAlign:"center",fontSize:"0.85rem",opacity:.6},children:"Please wait, do not close this window..."})]})]})})}function OE(t,e,n){return!t||e.includes(t)?t===n?"active":"waiting":t===n?"active":"complete"}function Uo({status:t,label:e,detail:n,isError:i}){const a=t==="waiting"?"":t==="active"?"":t==="error"?"":"";return d.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"0.75rem"},children:[d.jsx("span",{style:{fontSize:"1.1rem",width:"1.5rem",textAlign:"center"},children:a}),d.jsxs("div",{style:{flex:1},children:[d.jsx("p",{style:{margin:0,fontWeight:500},children:e}),n&&d.jsx("p",{style:{margin:"0.25rem 0 0 0",fontSize:"0.85rem",opacity:i?1:.6,color:i?de.error:"inherit"},children:n})]})]})}function zy({isDisabled:t,onCloseMenu:e}){const{selectedBudgetId:n,currentUserId:i,currentYear:a,currentMonthNumber:l}=Tn(),{categories:u,accounts:h,saveCategories:m,saveAccounts:g}=Hn(n,i),[_,v]=A.useState(!1),[b,w]=A.useState(!1),[C,R]=A.useState(null);function N(){w(!0),R({status:"confirming"})}async function B(){if(n){v(!0),R({status:"pending"});try{R({status:"finding_months"});const F=new Date,ae=a||F.getFullYear(),te=l||F.getMonth()+1,{year:he,month:L}=Sy(ae,te),I={year:he,month:L},D=await UM(n,he,L),k=Object.keys(u);R({status:"finding_months",monthsFound:D.length}),await new Promise(Y=>setTimeout(Y,100));const O={};let j=null;const T=gi(n,I.year,I.month),{exists:Z,data:U}=await ze("months",T,"recalculate: reading previous month for starting balances");if(Z&&U&&(j=U,U.category_balances))for(const Y of U.category_balances)O[Y.category_id]=Y.end_balance??0;k.forEach(Y=>{O[Y]===void 0&&(O[Y]=0)});let z=0,q=0;for(let Y=0;Y<D.length;Y++){const Q=D[Y],fe=`${Zo[Q.month-1]} ${Q.year}`;R({status:"processing_months",monthsFound:D.length,currentMonthIndex:Y,currentMonthLabel:fe});const ce=gi(n,Q.year,Q.month),{exists:me,data:ge}=await ze("months",ce,`recalculate: reading full month data for ${fe}`);if(!me||!ge){console.warn(`Month ${fe} not found, skipping`);continue}const Ee=ge.income||[],re=ge.expenses||[],ke=ge.are_allocations_finalized||!1,Ve=Ee.reduce((we,Le)=>we+Le.amount,0),jt=re.reduce((we,Le)=>we+Le.amount,0);z+=Ve,q+=jt;const Ot={};if(ge.category_balances)for(const we of ge.category_balances)Ot[we.category_id]={allocated:we.allocated??0};const Mt=k.map(we=>{const Le=O[we]??0;let He=0;ke&&Ot[we]&&(He=Ot[we].allocated);let $e=0;re.length>0&&($e=re.filter(rt=>rt.category_id===we).reduce((rt,qt)=>rt+qt.amount,0));const at=Le+He-$e;return{category_id:we,start_balance:Le,allocated:He,spent:$e,end_balance:at}});Mt.forEach(we=>{O[we.category_id]=we.end_balance});const ar=(Y===0?j:D[Y-1])?.total_income??0,ut=Object.keys(h).map(we=>{const Le=Ee.filter(rt=>rt.account_id===we).reduce((rt,qt)=>rt+qt.amount,0),He=re.filter(rt=>rt.account_id===we).reduce((rt,qt)=>rt+qt.amount,0),$e=Le-He;let at=0;if(ge.account_balances){const rt=ge.account_balances.find(qt=>qt.account_id===we);rt&&(at=rt.start_balance??0)}return{account_id:we,start_balance:at,income:Le,expenses:He,net_change:$e,end_balance:at+$e}}),dt={budget_id:n,year_month_ordinal:fn(Q.year,Q.month),year:Q.year,month:Q.month,income:Ee,total_income:Ve,previous_month_income:ar,expenses:re,total_expenses:jt,account_balances:ut,category_balances:Mt,are_allocations_finalized:ke,created_at:ge.created_at||new Date().toISOString(),updated_at:new Date().toISOString()};await y1({budgetId:n,month:dt,description:"recalculate all months"}),await new Promise(we=>setTimeout(we,50))}const K={};Object.keys(h).forEach(Y=>{K[Y]=0});const ee=await Sr("months","recalculate: querying all months for account balances",[{field:"budget_id",op:"==",value:n}]);for(const Y of ee.docs){const Q=gi(n,Y.data.year,Y.data.month),{exists:fe,data:ce}=await ze("months",Q,`recalculate: reading month ${Y.data.year}/${Y.data.month} for account balances`);if(!fe||!ce)continue;const me=ce.income||[],ge=ce.expenses||[];for(const Ee of me)Ee.account_id&&K[Ee.account_id]!==void 0&&(K[Ee.account_id]+=Ee.amount);for(const Ee of ge)Ee.account_id&&K[Ee.account_id]!==void 0&&(K[Ee.account_id]-=Ee.amount)}const X={};Object.entries(h).forEach(([Y,Q])=>{X[Y]={...Q,balance:K[Y]??0}}),await g(X),R({status:"updating_budget",monthsFound:D.length,monthsProcessed:D.length,totalIncomeRecalculated:z,totalExpensesRecalculated:q});const P={...O},W={};Object.entries(u).forEach(([Y,Q])=>{W[Y]={...Q,balance:P[Y]??0}}),await m(W);for(const Y of D)vt.invalidateQueries({queryKey:xe.month(n,Y.year,Y.month)});R({status:"done",monthsFound:D.length,monthsProcessed:D.length,totalIncomeRecalculated:z,totalExpensesRecalculated:q})}catch(F){console.error("Recalculate error:",F),R({status:"error",error:F instanceof Error?F.message:"Failed to recalculate"})}finally{v(!1)}}}function H(){w(!1),R(null),e?.()}return d.jsxs(d.Fragment,{children:[d.jsxs("button",{onClick:N,disabled:t||_,style:{background:"color-mix(in srgb, currentColor 10%, transparent)",border:"none",borderRadius:"8px",padding:"0.5rem",cursor:t||_?"not-allowed":"pointer",opacity:t||_?.5:1,fontSize:"1rem",display:"flex",alignItems:"center",justifyContent:"center"},title:"Recalculate balances from this month forward",children:[_?"":""," Recalculate"]}),d.jsx(CP,{isOpen:b,onClose:H,onProceed:B,results:C})]})}function ME(){const t=new Date;let e=t.getFullYear(),n=t.getMonth()+1+3;for(;n>12;)n-=12,e+=1;return{year:e,month:n}}function RP({isLoading:t,onPreviousMonth:e,onNextMonth:n}){const{currentYear:i,currentMonthNumber:a,isAdmin:l,selectedBudgetId:u,currentUserId:h,setCurrentYear:m,setCurrentMonthNumber:g}=Tn(),{budget:_}=Hn(u,h),{month:v}=Ol(u,i,a),[b,w]=A.useState(!1),[C,R]=A.useState(!1),[N,B]=A.useState(i),[H,F]=A.useState(a),ae=A.useRef(null);A.useEffect(()=>{if(!b)return;function L(I){ae.current&&!ae.current.contains(I.target)&&(w(!1),R(!1))}return document.addEventListener("mousedown",L),()=>document.removeEventListener("mousedown",L)},[b]),A.useEffect(()=>{C&&(B(i),F(a))},[C,i,a]);function te(){const L=ME();let I=N,D=H;(I-new Date().getFullYear())*12+(D-(new Date().getMonth()+1))>3&&(I=L.year,D=L.month,console.log(`[MonthNavigation] Clamping to max allowed month: ${I}/${D}`)),m(I),g(D),R(!1),w(!1)}function he(){if(!v||!_)return;const L={...v,_meta:{downloaded_at:new Date().toISOString(),budget_id:_.id,budget_name:_.name}},I=new Blob([JSON.stringify(L,null,2)],{type:"application/json"}),D=URL.createObjectURL(I),k=document.createElement("a");k.href=D,k.download=`month_${i}_${String(a).padStart(2,"0")}.json`,document.body.appendChild(k),k.click(),document.body.removeChild(k),URL.revokeObjectURL(D),w(!1)}return d.jsxs("div",{style:{display:"flex",alignItems:"center",justifyContent:"center",gap:"1rem",marginBottom:"1.5rem",padding:"1rem",background:"color-mix(in srgb, currentColor 5%, transparent)",borderRadius:"12px"},children:[d.jsx("button",{onClick:()=>{e()},disabled:t,style:{background:"color-mix(in srgb, currentColor 10%, transparent)",border:"none",borderRadius:"8px",padding:"0.75rem 1rem",cursor:t?"not-allowed":"pointer",fontSize:"1.25rem",opacity:t?.5:1,transition:"opacity 0.15s, background 0.15s"},title:"Previous month",children:""}),d.jsxs("div",{ref:ae,style:{textAlign:"center",minWidth:"180px",position:"relative"},children:[d.jsxs("div",{style:{display:"flex",alignItems:"flex-start",justifyContent:"center",gap:"0.25rem"},children:[d.jsxs("h2",{style:{margin:0,fontSize:"1.5rem"},children:[Zo[a-1]," ",i]}),d.jsx("button",{onClick:()=>w(!b),style:{background:"transparent",border:"none",cursor:"pointer",fontSize:"0.5rem",opacity:.4,padding:"0.15rem",borderRadius:"4px",transition:"opacity 0.15s, transform 0.15s",transform:b?"rotate(180deg)":"rotate(0deg)",marginTop:"0.25rem"},title:"Month options",children:""})]}),t&&d.jsxs(d.Fragment,{children:[d.jsx("style",{children:"@keyframes spin { to { transform: rotate(360deg); } }"}),d.jsxs("div",{style:{display:"flex",alignItems:"center",justifyContent:"center",gap:"0.4rem",marginTop:"0.35rem"},children:[d.jsx("span",{style:{display:"inline-block",width:"14px",height:"14px",border:"2px solid color-mix(in srgb, currentColor 20%, transparent)",borderTopColor:de.primary,borderRadius:"50%",animation:"spin 0.8s linear infinite"}}),d.jsx("span",{style:{fontSize:"0.8rem",opacity:.6},children:"Loading..."})]})]}),b&&d.jsxs("div",{style:{position:"absolute",top:"100%",left:"50%",transform:"translateX(-50%)",marginTop:"0.5rem",background:"var(--background, #242424)",border:"1px solid color-mix(in srgb, currentColor 20%, transparent)",borderRadius:"8px",padding:"0.25rem",zIndex:10,minWidth:"160px",boxShadow:"0 4px 12px rgba(0,0,0,0.3)"},children:[d.jsx(zy,{isDisabled:t,onCloseMenu:()=>w(!1)}),d.jsx("button",{onClick:()=>R(!C),style:{display:"flex",alignItems:"center",gap:"0.5rem",width:"100%",background:"transparent",border:"none",borderRadius:"6px",padding:"0.5rem 0.75rem",cursor:"pointer",fontSize:"0.85rem",color:"inherit",textAlign:"left",transition:"background 0.15s"},title:"Jump to a specific month",children:" Go to Month"}),C&&d.jsxs("div",{style:{padding:"0.75rem",borderTop:"1px solid color-mix(in srgb, currentColor 15%, transparent)",marginTop:"0.25rem"},children:[d.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"0.5rem",marginBottom:"0.5rem"},children:[d.jsx("button",{onClick:()=>B(L=>L-1),style:{background:"color-mix(in srgb, currentColor 10%, transparent)",border:"none",borderRadius:"4px",padding:"0.25rem 0.5rem",cursor:"pointer",fontSize:"0.8rem"},children:""}),d.jsx("span",{style:{flex:1,textAlign:"center",fontSize:"0.9rem",fontWeight:500},children:N}),d.jsx("button",{onClick:()=>B(L=>L+1),style:{background:"color-mix(in srgb, currentColor 10%, transparent)",border:"none",borderRadius:"4px",padding:"0.25rem 0.5rem",cursor:"pointer",fontSize:"0.8rem"},children:""})]}),d.jsx("div",{style:{display:"grid",gridTemplateColumns:"repeat(3, 1fr)",gap:"0.25rem",marginBottom:"0.5rem"},children:Zo.map((L,I)=>{const D=I+1,k=D===H,O=N===i&&D===a,j=ME(),T=N>j.year||N===j.year&&D>j.month;return d.jsx("button",{onClick:()=>F(D),disabled:T,style:{background:k?de.primary:"color-mix(in srgb, currentColor 8%, transparent)",border:O?`1px solid ${de.primary}`:"1px solid transparent",borderRadius:"4px",padding:"0.35rem 0.25rem",cursor:T?"not-allowed":"pointer",fontSize:"0.7rem",color:k?"#fff":"inherit",opacity:T?.3:1,transition:"background 0.15s"},title:T?"Cannot navigate more than 3 months in the future":L,children:L.slice(0,3)},D)})}),d.jsxs("button",{onClick:te,style:{width:"100%",background:de.primary,border:"none",borderRadius:"6px",padding:"0.5rem",cursor:"pointer",fontSize:"0.85rem",color:"#fff",fontWeight:500},children:["Go to ",Zo[H-1]," ",N]})]}),l&&v&&d.jsx("button",{onClick:()=>{he()},style:{display:"flex",alignItems:"center",gap:"0.5rem",width:"100%",background:"transparent",border:"none",borderRadius:"6px",padding:"0.5rem 0.75rem",cursor:"pointer",fontSize:"0.85rem",color:"inherit",textAlign:"left",transition:"background 0.15s"},title:"Download month document as JSON (for debugging)",children:" Download JSON"})]})]}),d.jsx("button",{onClick:()=>{n()},disabled:t,style:{background:"color-mix(in srgb, currentColor 10%, transparent)",border:"none",borderRadius:"8px",padding:"0.75rem 1rem",cursor:t?"not-allowed":"pointer",fontSize:"1.25rem",opacity:t?.5:1,transition:"opacity 0.15s, background 0.15s"},title:"Next month",children:""})]})}const DP={background:de.primary,border:"none",cursor:"pointer",fontSize:"0.9rem",padding:"0.35rem 0.5rem",borderRadius:"4px",color:"white"},IP={background:"transparent",border:"1px solid color-mix(in srgb, currentColor 30%, transparent)",cursor:"pointer",fontSize:"0.9rem",padding:"0.35rem 0.5rem",borderRadius:"4px"},jP={background:"transparent",border:`1px solid ${de.errorBorder}`,color:de.error,cursor:"pointer",fontSize:"0.9rem",padding:"0.35rem 0.5rem",borderRadius:"4px"};function cT({accounts:t,accountGroups:e,categories:n,categoryGroups:i,payees:a,initialData:l,defaultAccountId:u,defaultDate:h,config:m,onSubmit:g,onCancel:_,onDelete:v,extraContent:b}){const{isWide:w}=rP(),{showCategory:C=!1,showCleared:R=!1,accountLabel:N="Account",payeePlaceholder:B="Payee name",descriptionPlaceholder:H="Optional note",submitLabel:F}=m,ae=new Date().toISOString().split("T")[0],[te,he]=A.useState(l?.date||h||ae),[L,I]=A.useState(l?.payee||""),[D,k]=A.useState(l?.categoryId||""),[O,j]=A.useState(l?.accountId||u||(t[0]?t[0][0]:"")),[T,Z]=A.useState(l?.amount?.toString()||""),[U,z]=A.useState(l?.description||""),[q,K]=A.useState(l?.cleared||!1),ee={},X=[];t.forEach(([re,ke])=>{ke.account_group_id?(ee[ke.account_group_id]||(ee[ke.account_group_id]=[]),ee[ke.account_group_id].push([re,ke])):X.push([re,ke])});function P(re){re.preventDefault();const ke=parseFloat(T);isNaN(ke)||ke<=0||C&&!D||!O||!te||g({date:te,payee:L.trim()||void 0,categoryId:C?D:void 0,accountId:O,amount:ke,description:U.trim()||void 0,cleared:R?q:void 0})}const W=d.jsxs(su,{id:"txn-account",value:O,onChange:re=>j(re.target.value),required:!0,style:{fontSize:"0.85rem",padding:"0.5rem"},children:[Object.entries(e).map(([re,ke])=>{const Ve=ee[re];return Ve?.length?d.jsx("optgroup",{label:ke.name,children:Ve.map(([jt,Ot])=>d.jsx("option",{value:jt,children:Ot.nickname},jt))},re):null}),X.length>0&&d.jsx("optgroup",{label:"Other",children:X.map(([re,ke])=>d.jsx("option",{value:re,children:ke.nickname},re))})]}),Y=C&&n&&i?d.jsx(en,{label:"Category",htmlFor:"txn-category",children:d.jsx(U4,{id:"txn-category",value:D,onChange:k,categories:n,categoryGroups:i,placeholder:"Search...",required:!0})}):null,Q=R?d.jsxs("div",{style:{display:"flex",flexDirection:"column",alignItems:"center",gap:"0.25rem",paddingBottom:"0.35rem"},children:[d.jsx("label",{htmlFor:"txn-cleared",style:{fontSize:"0.75rem",opacity:.7,fontWeight:500},children:"Clr"}),d.jsx(Ns,{id:"txn-cleared",checked:q,onChange:re=>K(re.target.checked)})]}):null,fe=d.jsxs("div",{style:{display:"flex",flexDirection:"column",alignItems:"center",gap:"0.25rem",paddingBottom:"0.1rem"},children:[d.jsx("span",{style:{fontSize:"0.75rem",opacity:.7,fontWeight:500},children:""}),d.jsxs("div",{style:{display:"flex",gap:"0.25rem"},children:[d.jsx("button",{type:"submit",title:F,style:DP,children:""}),d.jsx("button",{type:"button",onClick:()=>{_()},title:"Cancel",style:IP,children:""}),v&&d.jsx("button",{type:"button",onClick:()=>{v()},title:"Delete",style:jP,children:""})]})]}),ce=d.jsxs(Ya,{children:[d.jsx(Oe,{type:"submit",actionName:F,children:F}),d.jsx(Oe,{type:"button",variant:"secondary",actionName:"Cancel Transaction Form",onClick:_,children:"Cancel"}),v&&d.jsx(Oe,{type:"button",variant:"danger",actionName:"Delete Transaction",onClick:v,children:" Delete"})]}),me=C&&n&&i,ge={fontSize:"0.85rem",padding:"0.5rem"};if(!w)return d.jsxs(qa,{actionName:F,onSubmit:P,children:[d.jsxs("div",{style:{display:"flex",flexDirection:"column",gap:"1rem"},children:[d.jsxs("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr",gap:"1rem"},children:[d.jsx(en,{label:"Date",htmlFor:"txn-date",children:d.jsx(bE,{id:"txn-date",value:te,onChange:re=>he(re.target.value),required:!0})}),d.jsx(en,{label:"Amount",htmlFor:"txn-amount",children:d.jsx(Sg,{id:"txn-amount",value:T,onChange:Z,placeholder:"$0.00",required:!0,autoFocus:!0})})]}),d.jsx(en,{label:"Payee",htmlFor:"txn-payee",children:d.jsx(vE,{id:"txn-payee",value:L,onChange:I,payees:a,placeholder:B})}),Y,d.jsx(en,{label:N,htmlFor:"txn-account",children:W}),d.jsx(en,{label:"Description (optional)",htmlFor:"txn-description",children:d.jsx(Ga,{id:"txn-description",value:U,onChange:re=>z(re.target.value),placeholder:H})}),R&&d.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"0.5rem"},children:[d.jsx(Ns,{id:"txn-cleared-stacked",checked:q,onChange:re=>K(re.target.checked)}),d.jsx("label",{htmlFor:"txn-cleared-stacked",style:{fontSize:"0.9rem",cursor:"pointer"},children:"Cleared (appeared in bank account)"})]}),b]}),ce]});const Ee=me?R?"6rem minmax(8rem, 1fr) minmax(8rem, 1fr) minmax(8rem, 1fr) 6rem minmax(10rem, 2fr) auto auto":"6rem minmax(8rem, 1fr) minmax(8rem, 1fr) minmax(8rem, 1fr) 6rem minmax(10rem, 2fr) auto":R?"6rem minmax(10rem, 1fr) minmax(10rem, 1fr) 6rem minmax(12rem, 2fr) auto auto":"6rem minmax(10rem, 1fr) minmax(10rem, 1fr) 6rem minmax(12rem, 2fr) auto";return d.jsxs(qa,{actionName:F,onSubmit:P,children:[d.jsxs("div",{style:{display:"grid",gridTemplateColumns:Ee,gap:"1rem",alignItems:"end"},children:[d.jsx(en,{label:"Date",htmlFor:"txn-date",children:d.jsx(bE,{id:"txn-date",value:te,onChange:re=>he(re.target.value),required:!0,style:ge})}),d.jsx(en,{label:"Payee",htmlFor:"txn-payee",children:d.jsx(vE,{id:"txn-payee",value:L,onChange:I,payees:a,placeholder:B})}),Y,d.jsx(en,{label:N,htmlFor:"txn-account",children:W}),d.jsx(en,{label:"Amount",htmlFor:"txn-amount",children:d.jsx(Sg,{id:"txn-amount",value:T,onChange:Z,placeholder:"$0.00",required:!0,autoFocus:!0})}),d.jsx(en,{label:"Description",htmlFor:"txn-description",children:d.jsx(Ga,{id:"txn-description",value:U,onChange:re=>z(re.target.value),placeholder:H,style:ge})}),Q,fe]}),b]})}function kE({accounts:t,accountGroups:e,payees:n,initialData:i,defaultAccountId:a,defaultDate:l,onSubmit:u,onCancel:h,onDelete:m,submitLabel:g}){function _(v){u(v.amount,v.accountId,v.date,v.payee,v.description)}return d.jsx(cT,{accounts:t,accountGroups:e,payees:n,initialData:i?{date:i.date,payee:i.payee,accountId:i.account_id,amount:i.amount,description:i.description}:void 0,defaultAccountId:a,defaultDate:l,config:{showCategory:!1,showCleared:!1,accountLabel:"Deposit To",payeePlaceholder:"e.g., Employer, Client name",descriptionPlaceholder:"e.g., January paycheck",submitLabel:g},onSubmit:_,onCancel:h,onDelete:m})}function uT(){const[t,e]=A.useState(()=>typeof window>"u"?!0:window.innerWidth>=Lr.wide);return A.useEffect(()=>{function n(){e(window.innerWidth>=Lr.wide)}return window.addEventListener("resize",n),n(),()=>window.removeEventListener("resize",n)},[]),t}function OP({income:t,accountName:e,accountGroupName:n,onEdit:i,onDelete:a,isMobile:l}){const u=uT(),h=t.date?new Date(t.date+"T00:00:00").toLocaleDateString("en-US",{month:"short",day:"numeric"}):"",m=n?`${n} / ${e}`:e;return l?d.jsxs("div",{onClick:i,style:{display:"grid",gridTemplateColumns:"1fr auto",gap:"0.5rem",padding:"0.75rem 1rem",borderBottom:"1px solid color-mix(in srgb, currentColor 10%, transparent)",cursor:"pointer",transition:"background 0.15s"},children:[d.jsxs("div",{style:{display:"flex",flexDirection:"column",gap:"0.25rem"},children:[d.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"0.5rem"},children:[d.jsx("span",{style:{fontSize:"0.75rem",opacity:.5,fontFamily:"monospace",minWidth:"3rem"},children:h}),d.jsx("span",{style:{fontWeight:500,fontSize:"0.9rem"},children:t.payee||""})]}),d.jsxs("span",{style:{fontSize:"0.75rem",opacity:.6},children:[" ",m]})]}),d.jsx("div",{style:{display:"flex",alignItems:"center"},children:d.jsxs("span",{style:{fontWeight:600,color:de.success,fontFamily:"monospace"},children:["+",Re(t.amount)]})})]}):u?d.jsxs("div",{style:{display:"grid",gridTemplateColumns:"4.5rem 10rem 16rem 7rem 1fr 3rem",gap:"1rem",padding:"0.625rem 1rem",alignItems:"center",borderBottom:"1px solid color-mix(in srgb, currentColor 8%, transparent)",transition:"background 0.15s"},onMouseEnter:g=>g.currentTarget.style.background="color-mix(in srgb, currentColor 5%, transparent)",onMouseLeave:g=>g.currentTarget.style.background="transparent",children:[d.jsx("span",{style:{fontSize:"0.85rem",opacity:.6,fontFamily:"monospace"},children:h}),d.jsx("span",{style:{fontWeight:500,fontSize:"0.9rem",overflow:"hidden",textOverflow:"ellipsis",whiteSpace:"nowrap"},children:t.payee||""}),d.jsx("span",{style:{fontSize:"0.85rem",opacity:.7,overflow:"hidden",textOverflow:"ellipsis",whiteSpace:"nowrap"},children:m}),d.jsxs("span",{style:{fontWeight:600,color:de.success,fontFamily:"monospace",textAlign:"right"},children:["+",Re(t.amount)]}),d.jsx("span",{style:{fontSize:"0.8rem",opacity:.6,overflow:"hidden",textOverflow:"ellipsis",whiteSpace:"nowrap",minWidth:0},children:t.description||""}),d.jsxs("div",{style:{display:"flex",gap:"0.25rem",justifyContent:"flex-end"},children:[d.jsx("button",{onClick:i,style:{background:"transparent",border:"none",cursor:"pointer",opacity:.5,fontSize:"0.85rem",padding:"0.25rem",transition:"opacity 0.15s"},onMouseEnter:g=>g.currentTarget.style.opacity="1",onMouseLeave:g=>g.currentTarget.style.opacity="0.5",title:"Edit",children:""}),d.jsx("button",{onClick:a,style:{background:"transparent",border:"none",cursor:"pointer",opacity:.5,fontSize:"0.85rem",padding:"0.25rem",transition:"opacity 0.15s"},onMouseEnter:g=>g.currentTarget.style.opacity="1",onMouseLeave:g=>g.currentTarget.style.opacity="0.5",title:"Delete",children:""})]})]}):d.jsxs("div",{style:{display:"grid",gridTemplateColumns:"5rem 1fr 7rem 6rem 4rem",gap:"0.5rem",padding:"0.625rem 1rem",alignItems:"center",borderBottom:"1px solid color-mix(in srgb, currentColor 8%, transparent)",transition:"background 0.15s"},onMouseEnter:g=>g.currentTarget.style.background="color-mix(in srgb, currentColor 5%, transparent)",onMouseLeave:g=>g.currentTarget.style.background="transparent",children:[d.jsx("span",{style:{fontSize:"0.85rem",opacity:.6,fontFamily:"monospace"},children:h}),d.jsxs("div",{style:{display:"flex",flexDirection:"column",minWidth:0},children:[d.jsx("span",{style:{fontWeight:500,fontSize:"0.9rem",overflow:"hidden",textOverflow:"ellipsis",whiteSpace:"nowrap"},children:t.payee||""}),t.description&&d.jsx("span",{style:{fontSize:"0.75rem",opacity:.5,overflow:"hidden",textOverflow:"ellipsis",whiteSpace:"nowrap"},children:t.description})]}),d.jsx("span",{style:{fontSize:"0.8rem",opacity:.7,overflow:"hidden",textOverflow:"ellipsis",whiteSpace:"nowrap"},children:e}),d.jsxs("span",{style:{fontWeight:600,color:de.success,fontFamily:"monospace",textAlign:"right",fontSize:"0.9rem"},children:["+",Re(t.amount)]}),d.jsxs("div",{style:{display:"flex",gap:"0.25rem",justifyContent:"flex-end"},children:[d.jsx("button",{onClick:i,style:{background:"transparent",border:"none",cursor:"pointer",opacity:.5,fontSize:"0.85rem",padding:"0.25rem",transition:"opacity 0.15s"},onMouseEnter:g=>g.currentTarget.style.opacity="1",onMouseLeave:g=>g.currentTarget.style.opacity="0.5",title:"Edit",children:""}),d.jsx("button",{onClick:a,style:{background:"transparent",border:"none",cursor:"pointer",opacity:.5,fontSize:"0.85rem",padding:"0.25rem",transition:"opacity 0.15s"},onMouseEnter:g=>g.currentTarget.style.opacity="1",onMouseLeave:g=>g.currentTarget.style.opacity="0.5",title:"Delete",children:""})]})]})}function MP(){return uT()?d.jsxs("div",{style:{display:"grid",gridTemplateColumns:"4.5rem 10rem 16rem 7rem 1fr 3rem",gap:"1rem",padding:"0.5rem 1rem",borderBottom:"1px solid color-mix(in srgb, currentColor 15%, transparent)",fontSize:"0.75rem",textTransform:"uppercase",letterSpacing:"0.5px",opacity:.5,fontWeight:600},children:[d.jsx("span",{children:"Date"}),d.jsx("span",{children:"Payee"}),d.jsx("span",{children:"Account"}),d.jsx("span",{style:{textAlign:"right"},children:"Amount"}),d.jsx("span",{children:"Description"}),d.jsx("span",{})]}):d.jsxs("div",{style:{display:"grid",gridTemplateColumns:"5rem 1fr 7rem 6rem 4rem",gap:"0.5rem",padding:"0.5rem 1rem",borderBottom:"1px solid color-mix(in srgb, currentColor 15%, transparent)",fontSize:"0.75rem",textTransform:"uppercase",letterSpacing:"0.5px",opacity:.5,fontWeight:600},children:[d.jsx("span",{children:"Date"}),d.jsx("span",{children:"Payee"}),d.jsx("span",{children:"Account"}),d.jsx("span",{style:{textAlign:"right"},children:"Amount"}),d.jsx("span",{})]})}function kP(){const{selectedBudgetId:t,currentUserId:e,currentYear:n,currentMonthNumber:i,setCurrentYear:a,setCurrentMonthNumber:l}=Tn(),{accounts:u,accountGroups:h}=Hn(t,e),{month:m,isLoading:g,addIncome:_,updateIncome:v,deleteIncome:b}=Ol(t,n,i),w=es(),[C,R]=A.useState(null),[N,B]=A.useState(!1),[H,F]=A.useState(null),ae=A.useRef({year:n,month:i});A.useEffect(()=>{const ee=ae.current;(ee.year!==n||ee.month!==i)&&(B(!1),F(null),ae.current={year:n,month:i})},[n,i]);const L=x1(t,{enabled:N||H!==null}).data||[];function I(ee){const X=ee.account_group_id?h[ee.account_group_id]:void 0;return X?.is_active!==void 0?X.is_active:ee.is_active!==!1}function D(ee){const X=ee.account_group_id?h[ee.account_group_id]:void 0;return X?.on_budget!==void 0?X.on_budget:ee.on_budget!==!1}const k=Object.entries(u).filter(([,ee])=>I(ee)&&D(ee)),O=k.filter(([,ee])=>ee.is_income_account),j=O.length>0?O:k,T=k.find(([,ee])=>ee.is_income_default),Z=T?T[0]:void 0,U=m?.income.reduce((ee,X)=>ee+X.amount,0)||0;function z(ee,X,P,W,Y){R(null),B(!1);const[Q,fe]=P.split("-").map(Number);_(ee,X,P,W,Y).then(()=>{(Q!==n||fe!==i)&&(a(Q),l(fe))}).catch(ce=>{R(ce instanceof Error?ce.message:"Failed to add income")})}function q(ee,X,P,W,Y,Q){R(null),F(null),v(ee,X,P,W,Y,Q).catch(fe=>{R(fe instanceof Error?fe.message:"Failed to update income")})}function K(ee){confirm("Are you sure you want to delete this income entry?")&&(R(null),b(ee).catch(X=>{R(X instanceof Error?X.message:"Failed to delete income")}))}return d.jsxs("div",{style:{background:"color-mix(in srgb, currentColor 5%, transparent)",borderRadius:"12px",padding:"1.5rem",marginBottom:"1.5rem",opacity:g?.5:1,transition:"opacity 0.15s ease-out",pointerEvents:g?"none":"auto"},children:[C&&d.jsx("div",{style:{background:`color-mix(in srgb, ${de.error} 15%, transparent)`,border:`1px solid ${de.error}`,borderRadius:"8px",padding:"0.75rem",marginBottom:"1rem",color:de.error},children:C}),d.jsx(oT,{label:"Total",value:d.jsx("span",{style:{color:Pt(U)},children:Re(U)}),action:!N&&d.jsx(Oe,{actionName:"Open Add Income Form",onClick:()=>B(!0),disabled:j.length===0,children:"+ Add Income"})}),j.length===0&&d.jsxs("p",{style:{opacity:.6,fontSize:"0.9rem",marginBottom:"1rem"},children:[Object.keys(u).length===0?"You need to create at least one account before adding income.":'No accounts are set up for income deposits. Edit an account and enable "Show in income deposit list".'," ",d.jsx(Dt,{to:"/budget/accounts",style:{color:de.primaryLight},children:"Manage accounts "})]}),N&&d.jsx("div",{style:{marginBottom:"1rem"},children:d.jsx(kE,{accounts:j,accountGroups:h,payees:L,defaultAccountId:Z,defaultDate:`${n}-${String(i).padStart(2,"0")}-01`,onSubmit:z,onCancel:()=>B(!1),submitLabel:"Add Income",isMobile:w})}),d.jsxs("div",{style:{background:"color-mix(in srgb, currentColor 3%, transparent)",borderRadius:"8px",overflow:"hidden",marginBottom:"1rem"},children:[!w&&m?.income&&m.income.length>0&&d.jsx(MP,{}),m?.income.slice().sort((ee,X)=>(ee.date||"").localeCompare(X.date||"")).map(ee=>H===ee.id?d.jsx("div",{style:{padding:"0.5rem"},children:d.jsx(kE,{accounts:j,accountGroups:h,payees:L,initialData:ee,onSubmit:(X,P,W,Y,Q)=>q(ee.id,X,P,W,Y,Q),onCancel:()=>F(null),onDelete:()=>K(ee.id),submitLabel:"Save",isMobile:w})},ee.id):d.jsx(OP,{income:ee,accountName:u[ee.account_id]?.nickname||"Unknown Account",accountGroupName:u[ee.account_id]?.account_group_id?h[u[ee.account_id].account_group_id]?.name:void 0,onEdit:()=>{ee.payee||`${ee.amount}`,F(ee.id)},onDelete:()=>K(ee.id),isMobile:w},ee.id)),(!m?.income||m.income.length===0)&&!N&&d.jsx("p",{style:{opacity:.5,fontSize:"0.9rem",textAlign:"center",padding:"1.5rem"},children:"No income recorded for this month"})]})]})}function NE({accounts:t,accountGroups:e,categories:n,categoryGroups:i,payees:a,initialData:l,defaultAccountId:u,defaultDate:h,onSubmit:m,onCancel:g,onDelete:_,submitLabel:v}){function b(w){m(w.amount,w.categoryId,w.accountId,w.date,w.payee,w.description,w.cleared)}return d.jsx(cT,{accounts:t,accountGroups:e,categories:n,categoryGroups:i,payees:a,initialData:l?{date:l.date,payee:l.payee,categoryId:l.category_id,accountId:l.account_id,amount:l.amount,description:l.description,cleared:l.cleared}:void 0,defaultAccountId:u,defaultDate:h,config:{showCategory:!0,showCleared:!0,accountLabel:"Pay From",payeePlaceholder:"e.g., Grocery Store",descriptionPlaceholder:"e.g., Weekly groceries",submitLabel:v},onSubmit:b,onCancel:g,onDelete:_})}function dT(){const[t,e]=A.useState(()=>typeof window>"u"?!0:window.innerWidth>=Lr.wide);return A.useEffect(()=>{function n(){e(window.innerWidth>=Lr.wide)}return window.addEventListener("resize",n),n(),()=>window.removeEventListener("resize",n)},[]),t}function NP({expense:t,categoryName:e,accountName:n,accountGroupName:i,onEdit:a,onDelete:l,isMobile:u}){const h=dT(),m=t.date?new Date(t.date+"T00:00:00").toLocaleDateString("en-US",{month:"short",day:"numeric"}):"",g=i?`${i} / ${n}`:n;return u?d.jsxs("div",{onClick:a,style:{display:"grid",gridTemplateColumns:"1fr auto",gap:"0.5rem",padding:"0.75rem 1rem",borderBottom:"1px solid color-mix(in srgb, currentColor 10%, transparent)",cursor:"pointer",transition:"background 0.15s"},children:[d.jsxs("div",{style:{display:"flex",flexDirection:"column",gap:"0.25rem"},children:[d.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"0.5rem"},children:[d.jsx("span",{style:{fontSize:"0.75rem",opacity:.5,fontFamily:"monospace",minWidth:"3rem"},children:m}),d.jsx("span",{style:{fontWeight:500,fontSize:"0.9rem"},children:t.payee||""}),t.cleared&&d.jsx("span",{style:{fontSize:"0.7rem",color:de.success},title:"Cleared",children:""})]}),d.jsxs("div",{style:{display:"flex",gap:"0.5rem",flexWrap:"wrap"},children:[d.jsx("span",{style:{fontSize:"0.7rem",background:`color-mix(in srgb, ${de.primary} 20%, transparent)`,color:de.primaryLight,padding:"0.1rem 0.4rem",borderRadius:"3px"},children:e}),d.jsxs("span",{style:{fontSize:"0.75rem",opacity:.6},children:[" ",g]})]})]}),d.jsx("div",{style:{display:"flex",alignItems:"center"},children:d.jsxs("span",{style:{fontWeight:600,color:de.error,fontFamily:"monospace"},children:["-",Re(t.amount)]})})]}):h?d.jsxs("div",{style:{display:"grid",gridTemplateColumns:"5rem 1fr 8rem 8rem 6rem 1fr 3rem 4rem",gap:"0.75rem",padding:"0.625rem 1rem",alignItems:"center",borderBottom:"1px solid color-mix(in srgb, currentColor 8%, transparent)",transition:"background 0.15s"},onMouseEnter:_=>_.currentTarget.style.background="color-mix(in srgb, currentColor 5%, transparent)",onMouseLeave:_=>_.currentTarget.style.background="transparent",children:[d.jsx("span",{style:{fontSize:"0.85rem",opacity:.6,fontFamily:"monospace"},children:m}),d.jsx("div",{style:{display:"flex",flexDirection:"column",minWidth:0},children:d.jsx("span",{style:{fontWeight:500,fontSize:"0.9rem",overflow:"hidden",textOverflow:"ellipsis",whiteSpace:"nowrap"},children:t.payee||""})}),d.jsx("span",{style:{fontSize:"0.8rem",background:`color-mix(in srgb, ${de.primary} 15%, transparent)`,color:de.primaryLight,padding:"0.2rem 0.5rem",borderRadius:"4px",overflow:"hidden",textOverflow:"ellipsis",whiteSpace:"nowrap",textAlign:"center"},children:e}),d.jsx("span",{style:{fontSize:"0.85rem",opacity:.7,overflow:"hidden",textOverflow:"ellipsis",whiteSpace:"nowrap"},children:g}),d.jsxs("span",{style:{fontWeight:600,color:de.error,fontFamily:"monospace",textAlign:"right"},children:["-",Re(t.amount)]}),d.jsx("span",{style:{fontSize:"0.8rem",opacity:.6,overflow:"hidden",textOverflow:"ellipsis",whiteSpace:"nowrap"},children:t.description||""}),d.jsx("span",{style:{textAlign:"center",color:t.cleared?de.success:"inherit",opacity:t.cleared?1:.3,fontSize:"1rem"},children:t.cleared?"":""}),d.jsxs("div",{style:{display:"flex",gap:"0.25rem",justifyContent:"flex-end"},children:[d.jsx("button",{onClick:a,style:{background:"transparent",border:"none",cursor:"pointer",opacity:.5,fontSize:"0.85rem",padding:"0.25rem",transition:"opacity 0.15s"},onMouseEnter:_=>_.currentTarget.style.opacity="1",onMouseLeave:_=>_.currentTarget.style.opacity="0.5",title:"Edit",children:""}),d.jsx("button",{onClick:l,style:{background:"transparent",border:"none",cursor:"pointer",opacity:.5,fontSize:"0.85rem",padding:"0.25rem",transition:"opacity 0.15s"},onMouseEnter:_=>_.currentTarget.style.opacity="1",onMouseLeave:_=>_.currentTarget.style.opacity="0.5",title:"Delete",children:""})]})]}):d.jsxs("div",{style:{display:"grid",gridTemplateColumns:"5rem 1fr 7rem 7rem 6rem 3rem 4rem",gap:"0.5rem",padding:"0.625rem 1rem",alignItems:"center",borderBottom:"1px solid color-mix(in srgb, currentColor 8%, transparent)",transition:"background 0.15s"},onMouseEnter:_=>_.currentTarget.style.background="color-mix(in srgb, currentColor 5%, transparent)",onMouseLeave:_=>_.currentTarget.style.background="transparent",children:[d.jsx("span",{style:{fontSize:"0.85rem",opacity:.6,fontFamily:"monospace"},children:m}),d.jsxs("div",{style:{display:"flex",flexDirection:"column",minWidth:0},children:[d.jsx("span",{style:{fontWeight:500,fontSize:"0.9rem",overflow:"hidden",textOverflow:"ellipsis",whiteSpace:"nowrap"},children:t.payee||""}),t.description&&d.jsx("span",{style:{fontSize:"0.75rem",opacity:.5,overflow:"hidden",textOverflow:"ellipsis",whiteSpace:"nowrap"},children:t.description})]}),d.jsx("span",{style:{fontSize:"0.75rem",background:`color-mix(in srgb, ${de.primary} 15%, transparent)`,color:de.primaryLight,padding:"0.15rem 0.4rem",borderRadius:"4px",overflow:"hidden",textOverflow:"ellipsis",whiteSpace:"nowrap",textAlign:"center"},children:e}),d.jsx("span",{style:{fontSize:"0.8rem",opacity:.7,overflow:"hidden",textOverflow:"ellipsis",whiteSpace:"nowrap"},children:n}),d.jsxs("span",{style:{fontWeight:600,color:de.error,fontFamily:"monospace",textAlign:"right",fontSize:"0.9rem"},children:["-",Re(t.amount)]}),d.jsx("span",{style:{textAlign:"center",color:t.cleared?de.success:"inherit",opacity:t.cleared?1:.3,fontSize:"0.9rem"},children:t.cleared?"":""}),d.jsxs("div",{style:{display:"flex",gap:"0.25rem",justifyContent:"flex-end"},children:[d.jsx("button",{onClick:a,style:{background:"transparent",border:"none",cursor:"pointer",opacity:.5,fontSize:"0.85rem",padding:"0.25rem",transition:"opacity 0.15s"},onMouseEnter:_=>_.currentTarget.style.opacity="1",onMouseLeave:_=>_.currentTarget.style.opacity="0.5",title:"Edit",children:""}),d.jsx("button",{onClick:l,style:{background:"transparent",border:"none",cursor:"pointer",opacity:.5,fontSize:"0.85rem",padding:"0.25rem",transition:"opacity 0.15s"},onMouseEnter:_=>_.currentTarget.style.opacity="1",onMouseLeave:_=>_.currentTarget.style.opacity="0.5",title:"Delete",children:""})]})]})}function PP(){return dT()?d.jsxs("div",{style:{display:"grid",gridTemplateColumns:"5rem 1fr 8rem 8rem 6rem 1fr 3rem 4rem",gap:"0.75rem",padding:"0.5rem 1rem",borderBottom:"1px solid color-mix(in srgb, currentColor 15%, transparent)",fontSize:"0.75rem",textTransform:"uppercase",letterSpacing:"0.5px",opacity:.5,fontWeight:600},children:[d.jsx("span",{children:"Date"}),d.jsx("span",{children:"Payee"}),d.jsx("span",{style:{textAlign:"center"},children:"Category"}),d.jsx("span",{children:"Account"}),d.jsx("span",{style:{textAlign:"right"},children:"Amount"}),d.jsx("span",{children:"Description"}),d.jsx("span",{style:{textAlign:"center"},children:"Clr"}),d.jsx("span",{})]}):d.jsxs("div",{style:{display:"grid",gridTemplateColumns:"5rem 1fr 7rem 7rem 6rem 3rem 4rem",gap:"0.5rem",padding:"0.5rem 1rem",borderBottom:"1px solid color-mix(in srgb, currentColor 15%, transparent)",fontSize:"0.75rem",textTransform:"uppercase",letterSpacing:"0.5px",opacity:.5,fontWeight:600},children:[d.jsx("span",{children:"Date"}),d.jsx("span",{children:"Payee"}),d.jsx("span",{style:{textAlign:"center"},children:"Category"}),d.jsx("span",{children:"Account"}),d.jsx("span",{style:{textAlign:"right"},children:"Amount"}),d.jsx("span",{style:{textAlign:"center"},children:"Clr"}),d.jsx("span",{})]})}function LP(){const{selectedBudgetId:t,currentUserId:e,currentYear:n,currentMonthNumber:i,setCurrentYear:a,setCurrentMonthNumber:l}=Tn(),{accounts:u,accountGroups:h,categories:m,categoryGroups:g}=Hn(t,e),{month:_,isLoading:v,addExpense:b,updateExpense:w,deleteExpense:C}=Ol(t,n,i),R=es(),[N,B]=A.useState(null),[H,F]=A.useState(!1),[ae,te]=A.useState(null),he=A.useRef({year:n,month:i});A.useEffect(()=>{const P=he.current;(P.year!==n||P.month!==i)&&(F(!1),te(null),he.current={year:n,month:i})},[n,i]);const D=x1(t,{enabled:H||ae!==null}).data||[];function k(P){const W=P.account_group_id?h[P.account_group_id]:void 0;return W?.is_active!==void 0?W.is_active:P.is_active!==!1}function O(P){const W=P.account_group_id?h[P.account_group_id]:void 0;return W?.on_budget!==void 0?W.on_budget:P.on_budget!==!1}const j=Object.entries(u).filter(([,P])=>k(P)&&O(P)),T=j.filter(([,P])=>P.is_outgo_account),Z=T.length>0?T:j,U=j.find(([,P])=>P.is_outgo_default),z=U?U[0]:void 0,q=_?.expenses?.reduce((P,W)=>P+W.amount,0)||0;function K(P,W,Y,Q,fe,ce,me){B(null),F(!1);const[ge,Ee]=Q.split("-").map(Number);b(P,W,Y,Q,fe,ce,me).then(()=>{(ge!==n||Ee!==i)&&(a(ge),l(Ee))}).catch(re=>{B(re instanceof Error?re.message:"Failed to add expense")})}function ee(P,W,Y,Q,fe,ce,me,ge){B(null),te(null),w(P,W,Y,Q,fe,ce,me,ge).catch(Ee=>{B(Ee instanceof Error?Ee.message:"Failed to update expense")})}function X(P){confirm("Are you sure you want to delete this expense?")&&(B(null),C(P).catch(W=>{B(W instanceof Error?W.message:"Failed to delete expense")}))}return d.jsxs("div",{style:{background:"color-mix(in srgb, currentColor 5%, transparent)",borderRadius:"12px",padding:"1.5rem",marginBottom:"1.5rem",opacity:v?.5:1,transition:"opacity 0.15s ease-out",pointerEvents:v?"none":"auto"},children:[N&&d.jsx("div",{style:{background:`color-mix(in srgb, ${de.error} 15%, transparent)`,border:`1px solid ${de.error}`,borderRadius:"8px",padding:"0.75rem",marginBottom:"1rem",color:de.error},children:N}),d.jsx(oT,{label:"Total Expenses",value:d.jsxs("span",{style:{color:q>0?de.error:"inherit"},children:[q>0?"-":"",Re(q)]}),action:!H&&d.jsx(Oe,{actionName:"Open Add Expense Form",onClick:()=>F(!0),disabled:Z.length===0||Object.keys(m).length===0,children:"+ Add Expense"})}),Z.length===0&&d.jsxs("p",{style:{opacity:.6,fontSize:"0.9rem",marginBottom:"1rem"},children:[Object.keys(u).length===0?"You need to create at least one account before adding expenses.":'No accounts are set up for expenses. Edit an account and enable "Show in expense list".'," ",d.jsx(Dt,{to:"/budget/accounts",style:{color:de.primaryLight},children:"Manage accounts "})]}),Object.keys(m).length===0&&d.jsxs("p",{style:{opacity:.6,fontSize:"0.9rem",marginBottom:"1rem"},children:["You need to create at least one category before adding expenses."," ",d.jsx(Dt,{to:"/budget/settings/categories",style:{color:de.primaryLight},children:"Create categories "})]}),H&&d.jsx("div",{style:{marginBottom:"1rem"},children:d.jsx(NE,{accounts:Z,accountGroups:h,categories:m,categoryGroups:g,payees:D,defaultAccountId:z,defaultDate:`${n}-${String(i).padStart(2,"0")}-01`,onSubmit:K,onCancel:()=>F(!1),submitLabel:"Add Expense",isMobile:R})}),d.jsxs("div",{style:{background:"color-mix(in srgb, currentColor 3%, transparent)",borderRadius:"8px",overflow:"hidden",marginBottom:"1rem"},children:[!R&&_?.expenses&&_.expenses.length>0&&d.jsx(PP,{}),_?.expenses?.slice().sort((P,W)=>(P.date||"").localeCompare(W.date||"")).map(P=>ae===P.id?d.jsx("div",{style:{padding:"0.5rem"},children:d.jsx(NE,{accounts:Z,accountGroups:h,categories:m,categoryGroups:g,payees:D,initialData:P,onSubmit:(W,Y,Q,fe,ce,me,ge)=>ee(P.id,W,Y,Q,fe,ce,me,ge),onCancel:()=>te(null),onDelete:()=>X(P.id),submitLabel:"Save",isMobile:R})},P.id):d.jsx(NP,{expense:P,categoryName:m[P.category_id]?.name||"Unknown Category",accountName:u[P.account_id]?.nickname||"Unknown Account",accountGroupName:u[P.account_id]?.account_group_id?h[u[P.account_id].account_group_id]?.name:void 0,onEdit:()=>{P.payee||`${P.amount}`,te(P.id)},onDelete:()=>X(P.id),isMobile:R},P.id)),(!_?.expenses||_.expenses.length===0)&&!H&&d.jsx("p",{style:{opacity:.5,fontSize:"0.9rem",textAlign:"center",padding:"1.5rem"},children:"No expenses recorded for this month"})]})]})}function VP({accounts:t,accountGroups:e,accountBalances:n,isMobile:i}){const a=A.useMemo(()=>Object.entries(e).map(([u,h])=>({id:u,...h})).sort((u,h)=>u.sort_order-h.sort_order),[e]),l=A.useMemo(()=>{const u={};return Object.entries(t).forEach(([h,m])=>{const g=m.account_group_id||"ungrouped";u[g]||(u[g]=[]),u[g].push([h,m])}),Object.keys(u).forEach(h=>{u[h].sort((m,g)=>m[1].sort_order-g[1].sort_order)}),u},[t]);return d.jsxs("div",{style:{display:"flex",flexDirection:"column",gap:"1rem"},children:[Object.keys(t).length===0&&d.jsxs("p",{style:{opacity:.6,textAlign:"center",padding:"2rem"},children:["No accounts yet."," ",d.jsx(Dt,{to:"/budget/settings/accounts",style:{color:de.primaryLight},children:"Add accounts "})]}),a.map(u=>{const h=l[u.id]||[];if(h.length===0)return null;const m=h.reduce((g,[_])=>{const v=n[_];return v?{start:g.start+v.start_balance,income:g.income+v.income,expenses:g.expenses+v.expenses,netChange:g.netChange+v.net_change,end:g.end+v.end_balance}:g},{start:0,income:0,expenses:0,netChange:0,end:0});return d.jsx(PE,{name:u.name,accounts:h,groupTotals:m,accountBalances:n,isMobile:i},u.id)}),l.ungrouped?.length>0&&(()=>{const u=l.ungrouped,h=u.reduce((m,[g])=>{const _=n[g];return _?{start:m.start+_.start_balance,income:m.income+_.income,expenses:m.expenses+_.expenses,netChange:m.netChange+_.net_change,end:m.end+_.end_balance}:m},{start:0,income:0,expenses:0,netChange:0,end:0});return d.jsx(PE,{name:"Ungrouped",accounts:u,groupTotals:h,accountBalances:n,isMobile:i,isUngrouped:!0},"ungrouped")})()]})}function PE({name:t,accounts:e,groupTotals:n,accountBalances:i,isMobile:a,isUngrouped:l}){return d.jsxs("div",{style:{background:"color-mix(in srgb, currentColor 5%, transparent)",borderRadius:"12px",padding:"1rem"},children:[d.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:"0.75rem",paddingBottom:"0.5rem",borderBottom:"1px solid color-mix(in srgb, currentColor 15%, transparent)"},children:[d.jsxs("h3",{style:{...Il,margin:0,opacity:l?.7:1},children:[t,d.jsxs("span",{style:{marginLeft:"0.5rem",opacity:.5,fontWeight:400,fontSize:"0.9rem"},children:["(",e.length,")"]})]}),d.jsxs("div",{style:{display:"flex",gap:"1rem",alignItems:"center"},children:[d.jsxs("span",{style:{fontSize:"0.8rem",color:n.netChange>=0?de.success:de.error},children:[n.netChange>=0?"+":"",Re(n.netChange)]}),d.jsx("span",{style:{fontWeight:600,color:Pt(n.end)},children:Re(n.end)})]})]}),!a&&d.jsxs("div",{style:{display:"grid",gridTemplateColumns:"2fr 1fr 1fr 1fr 1fr",gap:"0.5rem",padding:"0.5rem 0.75rem",fontSize:"0.75rem",fontWeight:600,opacity:.6,textTransform:"uppercase",letterSpacing:"0.05em"},children:[d.jsx("span",{children:"Account"}),d.jsx("span",{style:{textAlign:"right"},children:"Start"}),d.jsx("span",{style:{textAlign:"right"},children:"Net Change"}),d.jsx("span",{style:{textAlign:"right"},children:"End"}),d.jsx("span",{style:{textAlign:"right"}})]}),d.jsx("div",{style:{display:"flex",flexDirection:"column",gap:"0.25rem"},children:e.map(([u,h])=>{const m=i[u];return m?a?d.jsx(zP,{account:h,balance:m},u):d.jsx(UP,{account:h,balance:m},u):null})})]})}function zP({account:t,balance:e}){return d.jsxs("div",{style:{background:"color-mix(in srgb, currentColor 5%, transparent)",borderRadius:"8px",padding:"0.75rem"},children:[d.jsx("div",{style:{marginBottom:"0.5rem"},children:d.jsx("span",{style:{fontWeight:500},children:t.nickname})}),d.jsxs("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr 1fr",gap:"0.25rem",fontSize:"0.75rem"},children:[d.jsxs("div",{children:[d.jsx("span",{style:{opacity:.6,display:"block"},children:"Start"}),d.jsx("span",{children:Re(e.start_balance)})]}),d.jsxs("div",{children:[d.jsx("span",{style:{opacity:.6,display:"block"},children:"Net Change"}),d.jsxs("span",{style:{color:e.net_change>=0?de.success:de.error},children:[e.net_change>=0?"+":"",Re(e.net_change)]})]}),d.jsxs("div",{children:[d.jsx("span",{style:{opacity:.6,display:"block"},children:"End"}),d.jsx("span",{style:{color:Pt(e.end_balance)},children:Re(e.end_balance)})]})]}),(e.income>0||e.expenses>0)&&d.jsxs("div",{style:{marginTop:"0.5rem",paddingTop:"0.5rem",borderTop:"1px solid color-mix(in srgb, currentColor 10%, transparent)",display:"flex",gap:"1rem",fontSize:"0.7rem",opacity:.7},children:[e.income>0&&d.jsxs("span",{children:["+",Re(e.income)," income"]}),e.expenses>0&&d.jsxs("span",{children:["-",Re(e.expenses)," expenses"]})]})]})}function UP({account:t,balance:e}){return d.jsxs("div",{style:{display:"grid",gridTemplateColumns:"2fr 1fr 1fr 1fr 1fr",gap:"0.5rem",padding:"0.6rem 0.75rem",background:"color-mix(in srgb, currentColor 3%, transparent)",borderRadius:"6px",alignItems:"center"},children:[d.jsxs("div",{style:{minWidth:0,overflow:"hidden"},children:[d.jsx("span",{style:{fontWeight:500,display:"block",overflow:"hidden",textOverflow:"ellipsis",whiteSpace:"nowrap"},children:t.nickname}),(e.income>0||e.expenses>0)&&d.jsxs("span",{style:{fontSize:"0.7rem",opacity:.5},children:[e.income>0&&`+${Re(e.income)}`,e.income>0&&e.expenses>0&&" / ",e.expenses>0&&`-${Re(e.expenses)}`]})]}),d.jsx("span",{style:{textAlign:"right",fontSize:"0.9rem"},children:Re(e.start_balance)}),d.jsxs("span",{style:{textAlign:"right",fontSize:"0.9rem",color:e.net_change>=0?de.success:de.error},children:[e.net_change>=0?"+":"",Re(e.net_change)]}),d.jsx("span",{style:{textAlign:"right",fontSize:"0.9rem",fontWeight:600,color:Pt(e.end_balance)},children:Re(e.end_balance)}),d.jsx("span",{})]})}function LE({name:t,categories:e,groupEndBalance:n,groupAllocated:i,getCategoryBalance:a,localAllocations:l,previousMonthIncome:u,isDraftMode:h,onAllocationChange:m,isMobile:g,isUngrouped:_}){return d.jsxs("div",{style:{background:"color-mix(in srgb, currentColor 5%, transparent)",borderRadius:"12px",padding:"1rem"},children:[d.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:"0.75rem",paddingBottom:"0.5rem",borderBottom:"1px solid color-mix(in srgb, currentColor 15%, transparent)"},children:[d.jsxs("h3",{style:{...Il,margin:0,opacity:_?.7:1},children:[t,d.jsxs("span",{style:{marginLeft:"0.5rem",opacity:.5,fontWeight:400,fontSize:"0.9rem"},children:["(",e.length,")"]})]}),d.jsxs("div",{style:{display:"flex",gap:"1rem",alignItems:"center"},children:[d.jsxs("span",{style:{fontSize:"0.8rem",opacity:.6},children:["+",Re(i)]}),d.jsx("span",{style:{fontWeight:600,color:Pt(n)},children:Re(n)})]})]}),!g&&d.jsxs(d.Fragment,{children:[d.jsxs("div",{style:{display:"flex",padding:"0.5rem 0.75rem",fontSize:"0.75rem",fontWeight:600,opacity:.6,textTransform:"uppercase",letterSpacing:"0.05em"},children:[d.jsx("div",{style:{flex:2,minWidth:0},children:"Category"}),h?d.jsxs(d.Fragment,{children:[d.jsx("div",{style:{width:"120px",textAlign:"center"},children:"Allocated"}),d.jsx("div",{style:{flex:1,textAlign:"right"},children:"Start"})]}):d.jsxs(d.Fragment,{children:[d.jsx("div",{style:{flex:1,textAlign:"right"},children:"Start"}),d.jsx("div",{style:{flex:1,textAlign:"right"},children:"Allocated"})]}),d.jsx("div",{style:{flex:1,textAlign:"right"},children:"Spent"}),d.jsx("div",{style:{flex:1,textAlign:"right",paddingRight:"1rem",borderRight:"2px solid rgba(128, 128, 128, 0.4)"},children:"End"}),d.jsx("div",{style:{width:"120px",textAlign:"right"},children:h?"Proj. All-Time":"All-Time"})]}),d.jsx("div",{style:{display:"flex",flexDirection:"column"},children:e.map(([v,b],w)=>{const C=a(v);if(!C)return null;const R=b.balance??0,N=C.end_balance-C.start_balance,B=R+N;return d.jsx(FP,{category:b,balance:C,localAllocation:l[v]||"",previousMonthIncome:u,isDraftMode:h,onAllocationChange:H=>m(v,H),allTimeBalance:h?B:R,isEvenRow:w%2===0},v)})})]}),g&&d.jsx("div",{style:{display:"flex",flexDirection:"column",gap:h?"0.5rem":"0.25rem"},children:e.map(([v,b])=>{const w=a(v);if(!w)return null;const C=b.balance??0,R=w.end_balance-w.start_balance,N=C+R;return d.jsx(BP,{category:b,balance:w,localAllocation:l[v]||"",previousMonthIncome:u,isDraftMode:h,onAllocationChange:B=>m(v,B),projectedAllTime:N},v)})})]})}function BP({category:t,balance:e,localAllocation:n,previousMonthIncome:i,isDraftMode:a,onAllocationChange:l,projectedAllTime:u}){const h=t.default_monthly_type==="percentage"&&t.default_monthly_amount!==void 0&&t.default_monthly_amount>0,m=h?t.default_monthly_amount/100*i:0,g=h?m.toFixed(2):n,_=a&&!h,v=a?u:t.balance??0;return d.jsxs("div",{style:{background:"color-mix(in srgb, currentColor 5%, transparent)",borderRadius:"8px",padding:"0.75rem"},children:[d.jsx("div",{style:{marginBottom:"0.5rem"},children:d.jsx("span",{style:{fontWeight:500},children:t.name})}),d.jsxs("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr 1fr 1fr 1fr",gap:"0.25rem",fontSize:"0.75rem"},children:[d.jsxs("div",{children:[d.jsx("span",{style:{opacity:.6,display:"block"},children:"Start"}),d.jsx("span",{children:Re(e.start_balance)})]}),d.jsxs("div",{children:[d.jsx("span",{style:{opacity:.6,display:"block"},children:"Alloc"}),_?d.jsx("input",{type:"text",inputMode:"decimal",value:g?`$${g}`:"",onChange:b=>{const w=b.target.value.replace(/[^\d.]/g,"");l(w)},placeholder:"$0",style:{width:"100%",maxWidth:"80px",padding:"0.25rem 0.35rem",borderRadius:"4px",border:"1px solid color-mix(in srgb, currentColor 20%, transparent)",background:"color-mix(in srgb, currentColor 8%, transparent)",fontSize:"0.8rem",color:"inherit",boxSizing:"border-box"}}):d.jsxs("span",{style:{color:e.allocated>0?de.success:"inherit"},children:[e.allocated>0?"+":"",Re(e.allocated)]})]}),d.jsxs("div",{children:[d.jsx("span",{style:{opacity:.6,display:"block"},children:"Spent"}),d.jsxs("span",{style:{color:e.spent>0?de.error:"inherit"},children:[e.spent>0?"-":"",Re(e.spent)]})]}),d.jsxs("div",{children:[d.jsx("span",{style:{opacity:.6,display:"block"},children:"End"}),d.jsx("span",{style:{color:Pt(e.end_balance)},children:Re(e.end_balance)})]}),d.jsxs("div",{children:[d.jsx("span",{style:{opacity:.6,display:"block"},children:a?"Proj. All-Time":"All-Time"}),d.jsx("span",{style:{color:a?de.primary:Pt(v)},children:Re(v)})]})]}),a&&h&&d.jsx("div",{style:{marginTop:"0.5rem"},children:d.jsxs("span",{style:{fontSize:"0.8rem"},children:[d.jsxs("span",{style:{opacity:.6},children:[Re(i),"  "]}),d.jsxs("span",{style:{color:de.primary},children:[t.default_monthly_amount,"%"]}),d.jsx("span",{style:{opacity:.6},children:" = "}),d.jsx("span",{style:{color:de.primary},children:Re(m)})]})})]})}const ks={alignSelf:"stretch",display:"flex",alignItems:"center"};function FP({category:t,balance:e,localAllocation:n,previousMonthIncome:i,isDraftMode:a,onAllocationChange:l,allTimeBalance:u,isEvenRow:h}){const m=t.default_monthly_type==="percentage"&&t.default_monthly_amount!==void 0&&t.default_monthly_amount>0,g=m?t.default_monthly_amount/100*i:0,_=m?g.toFixed(2):n;return d.jsxs("div",{style:{display:"flex",alignItems:"stretch",padding:"0.6rem 0.75rem",background:h?"color-mix(in srgb, currentColor 3%, transparent)":"color-mix(in srgb, currentColor 6%, transparent)"},children:[d.jsx("div",{style:{...ks,flex:2,minWidth:0,overflow:"hidden"},children:d.jsx("span",{style:{fontWeight:500,display:"block",overflow:"hidden",textOverflow:"ellipsis",whiteSpace:"nowrap"},children:t.name})}),a?d.jsxs(d.Fragment,{children:[d.jsx("div",{style:{...ks,width:"120px",justifyContent:"center"},children:m?d.jsxs("span",{style:{fontSize:"0.8rem"},children:[d.jsxs("span",{style:{color:de.primary},children:[t.default_monthly_amount,"%"]}),d.jsx("span",{style:{opacity:.5},children:" = "}),d.jsx("span",{style:{color:de.primary},children:Re(g)})]}):d.jsx("input",{type:"text",inputMode:"decimal",value:_?`$${_}`:"",onChange:v=>{const b=v.target.value.replace(/[^\d.]/g,"");l(b)},placeholder:"$0.00",style:{width:"100%",padding:"0.3rem 0.5rem",borderRadius:"4px",border:"1px solid color-mix(in srgb, currentColor 20%, transparent)",background:"color-mix(in srgb, currentColor 5%, transparent)",fontSize:"0.9rem",color:"inherit",boxSizing:"border-box"}})}),d.jsx("div",{style:{...ks,flex:1,justifyContent:"flex-end",fontSize:"0.9rem"},children:Re(e.start_balance)})]}):d.jsxs(d.Fragment,{children:[d.jsx("div",{style:{...ks,flex:1,justifyContent:"flex-end",fontSize:"0.9rem"},children:Re(e.start_balance)}),d.jsxs("div",{style:{...ks,flex:1,justifyContent:"flex-end",fontSize:"0.9rem",color:e.allocated>0?de.success:"inherit"},children:[e.allocated>0?"+":"",Re(e.allocated)]})]}),d.jsxs("div",{style:{...ks,flex:1,justifyContent:"flex-end",fontSize:"0.9rem",color:e.spent>0?de.error:"inherit"},children:[e.spent>0?"-":"",Re(e.spent)]}),d.jsx("div",{style:{...ks,flex:1,justifyContent:"flex-end",fontSize:"0.9rem",fontWeight:600,color:Pt(e.end_balance),paddingRight:"1rem",marginTop:"-0.6rem",marginBottom:"-0.6rem",paddingTop:"0.6rem",paddingBottom:"0.6rem",borderRight:"2px solid rgba(128, 128, 128, 0.4)"},children:Re(e.end_balance)}),d.jsx("div",{style:{...ks,width:"120px",justifyContent:"flex-end",fontSize:"0.9rem",color:a?de.primary:Pt(u)},children:Re(u)})]})}const VE=["categories","accounts"];function qP(){const{selectedBudgetId:t,currentUserId:e,currentYear:n,currentMonthNumber:i,lastBalancesView:a,setLastBalancesView:l}=Tn(),{categories:u,categoryGroups:h,accounts:m,accountGroups:g,monthMap:_}=Hn(t,e),{month:v,isLoading:b}=Ol(t,n,i),w=es(),[C,R]=kR(),[N,B]=A.useState(!1),H=A.useRef(!1),F=fn(n,i),ae=_[F]?.needs_recalculation===!0;A.useEffect(()=>{if(!t||!v)return;if(!ae){H.current=!1;return}if(H.current||N)return;H.current=!0,B(!0);const we=`${n}${String(i).padStart(2,"0")}`;console.log(`[BalancesSection] Month needs recalculation, triggering from ${we}...`),v1(t,{triggeringMonthOrdinal:we}).then(()=>{vt.invalidateQueries({queryKey:xe.month(t,n,i)}),vt.invalidateQueries({queryKey:xe.budget(t)})}).catch(Le=>{console.error("[BalancesSection] Recalculation failed:",Le)}).finally(()=>{B(!1)})},[t,ae,v,n,i,N]);const te=()=>{const we=C.get("view");return we&&VE.includes(we)?we:a},[he,L]=A.useState(te),[I,D]=A.useState(!1),k=we=>{L(we),l(we),R({view:we},{replace:!0})};A.useEffect(()=>{const we=C.get("view");(!we||!VE.includes(we))&&R({view:a},{replace:!0})},[]);const{localAllocations:O,isSavingAllocations:j,isFinalizingAllocations:T,isDeletingAllocations:Z,isEditingAppliedAllocations:U,error:z,availableNow:q,draftChangeAmount:K,availableAfterApply:ee,previousMonthIncome:X,currentMonthIncome:P,allocationsFinalized:W,getAllocationAmount:Y,handleAllocationChange:Q,resetAllocationsToSaved:fe,handleSaveAllocations:ce,handleFinalizeAllocations:me,handleDeleteAllocations:ge,setIsEditingAppliedAllocations:Ee,setError:re}=fP(),ke=[...h].sort((we,Le)=>we.sort_order-Le.sort_order),Ve=A.useMemo(()=>{const we=Object.entries(u).reduce((Le,[He,$e])=>{const at=$e.category_group_id||"ungrouped";return Le[at]||(Le[at]=[]),Le[at].push([He,$e]),Le},{});return Object.keys(we).forEach(Le=>{we[Le].sort((He,$e)=>He[1].sort_order-$e[1].sort_order)}),we},[u]),jt=T||Z||N,Ot=N?"Recalculating balances...":T?"Applying allocations...":"Deleting allocations...",Mt=!W||U,sr=A.useMemo(()=>{const we={};v?.category_balances&&v.category_balances.forEach(He=>{we[He.category_id]=He});const Le={};return Object.entries(u).forEach(([He,$e])=>{const at=we[He],rt=at?.start_balance??0,qt=at?.spent??0;let pn=0;Mt?pn=Y(He,$e):W&&at&&(pn=at.allocated),Le[He]={category_id:He,start_balance:rt,allocated:pn,spent:qt,end_balance:rt+pn-qt}}),Le},[v,u,Mt,W,Y]),ar=we=>sr[we],qr=A.useMemo(()=>{const we={};v?.account_balances&&v.account_balances.forEach(He=>{we[He.account_id]=He});const Le={};return Object.entries(m).forEach(([He,$e])=>{const rt=we[He]?.start_balance??$e.balance;let qt=0;v?.income&&(qt=v.income.filter(or=>or.account_id===He).reduce((or,ts)=>or+ts.amount,0));let pn=0;v?.expenses&&(pn=v.expenses.filter(or=>or.account_id===He).reduce((or,ts)=>or+ts.amount,0));const Xa=qt-pn;Le[He]={account_id:He,start_balance:rt,income:qt,expenses:pn,net_change:Xa,end_balance:rt+Xa}}),Le},[v,m]),ut=A.useMemo(()=>Object.values(qr).reduce((we,Le)=>({start:we.start+Le.start_balance,income:we.income+Le.income,expenses:we.expenses+Le.expenses,netChange:we.netChange+Le.net_change,end:we.end+Le.end_balance}),{start:0,income:0,expenses:0,netChange:0,end:0}),[qr]),dt=A.useMemo(()=>Object.values(sr).reduce((we,Le)=>({start:we.start+Le.start_balance,allocated:we.allocated+Le.allocated,spent:we.spent+Le.spent,end:we.end+Le.end_balance}),{start:0,allocated:0,spent:0,end:0}),[sr]);return d.jsxs("div",{style:{opacity:b?.5:1,transition:"opacity 0.15s ease-out",pointerEvents:b?"none":"auto"},children:[d.jsx(Z4,{isVisible:jt,message:Ot}),z&&d.jsx(jl,{message:z,onDismiss:()=>re(null)}),he==="categories"&&Mt&&d.jsx("h3",{style:{margin:"0 0 0.75rem 0",fontSize:"1.1rem",fontWeight:600,color:de.primary},children:"Allocations Worksheet"}),d.jsx(q4,{items:he==="categories"?[{label:Mt?"Available Now":"Month Income",value:Mt?d.jsx("span",{style:{color:Pt(q)},children:Re(q)}):d.jsxs("span",{style:{color:de.success},children:["+",Re(P)]})},{label:Mt?"Draft Allocations":"Allocated",value:U?d.jsxs("span",{children:[d.jsxs("span",{style:{color:de.primary},children:["+",Re(dt.allocated)]}),K!==0&&d.jsxs("span",{style:{marginLeft:"0.35rem",fontSize:"0.85em",color:K>0?de.warning:de.success},children:["(",K>0?"+":"",Re(Math.abs(K)),")"]})]}):d.jsxs("span",{style:{color:Mt?de.primary:de.success},children:["+",Re(dt.allocated)]})},{label:"Spent",value:d.jsxs("span",{style:{color:de.error},children:["-",Re(dt.spent)]})},{label:Mt?"Available If Applied":"Net Change",value:Mt?d.jsx("span",{style:{color:Pt(ee)},children:Re(ee)}):d.jsx("span",{style:{color:Pt(dt.allocated-dt.spent)},children:Re(dt.allocated-dt.spent)})}]:[{label:"Start of Month",value:d.jsx("span",{style:{color:Pt(ut.start)},children:Re(ut.start)})},{label:"Income",value:d.jsxs("span",{style:{color:de.success},children:["+",Re(ut.income)]})},{label:"Expenses",value:d.jsxs("span",{style:{color:de.error},children:["-",Re(ut.expenses)]})},{label:"End of Month",value:d.jsx("span",{style:{color:Pt(ut.end)},children:Re(ut.end)})}]}),d.jsxs("div",{style:{display:"flex",gap:"0.5rem",marginBottom:"1.5rem",flexWrap:"wrap",alignItems:"center"},children:[d.jsx(Oe,{actionName:he==="categories"?"Switch to Account Balances":"Switch to Category Balances",onClick:()=>k(he==="categories"?"accounts":"categories"),variant:"secondary",style:{fontSize:"0.85rem"},children:he==="categories"?" Switch to Account Balances":" Switch to Category Balances"}),he==="categories"&&Mt&&!U&&d.jsxs(d.Fragment,{children:[d.jsx(Oe,{actionName:"Save Draft Allocations",onClick:ce,disabled:j||T||b,variant:"secondary",style:{fontSize:"0.85rem"},children:j?"...":" Save Draft"}),d.jsx(Oe,{actionName:"Apply Allocations",onClick:me,disabled:j||T||b,variant:"secondary",style:{fontSize:"0.85rem"},children:T?"...":" Apply Allocations"})]}),he==="categories"&&!Mt&&W&&d.jsx(Oe,{actionName:"Edit Allocations",onClick:()=>Ee(!0),variant:"secondary",style:{fontSize:"0.85rem"},children:" Edit Allocations"}),he==="categories"&&U&&d.jsxs(d.Fragment,{children:[d.jsx(Oe,{actionName:"Apply Allocations",onClick:me,disabled:j||T||b,variant:"secondary",style:{fontSize:"0.85rem"},children:T?"...":" Apply Allocations"}),d.jsx(Oe,{actionName:"Cancel Edit Allocations",onClick:fe,disabled:T||Z||b,variant:"secondary",style:{fontSize:"0.85rem"},children:" Cancel"}),d.jsx(Oe,{actionName:"Open Delete Allocations Modal",onClick:()=>D(!0),disabled:Z||b,variant:"secondary",style:{fontSize:"0.85rem",color:de.error},children:" Delete"})]})]}),he==="accounts"&&d.jsx(VP,{accounts:m,accountGroups:g,accountBalances:qr,isMobile:w}),he==="categories"&&d.jsx(d.Fragment,{children:d.jsxs("div",{style:{display:"flex",flexDirection:"column",gap:"1rem"},children:[Object.keys(u).length===0&&d.jsxs("p",{style:{opacity:.6,textAlign:"center",padding:"2rem"},children:["No categories yet."," ",d.jsx(Dt,{to:"/budget/settings/categories",style:{color:de.primaryLight},children:"Create categories "})]}),ke.map(we=>{const Le=Ve[we.id]||[];if(Le.length===0)return null;const He=Le.reduce(($e,[at])=>{const rt=ar(at);return rt?{start:$e.start+rt.start_balance,allocated:$e.allocated+rt.allocated,spent:$e.spent+rt.spent,end:$e.end+rt.end_balance}:$e},{start:0,allocated:0,spent:0,end:0});return d.jsx(LE,{name:we.name,categories:Le,groupEndBalance:He.end,groupAllocated:He.allocated,getCategoryBalance:ar,localAllocations:O,previousMonthIncome:X,isDraftMode:Mt,onAllocationChange:Q,isMobile:w},we.id)}),Ve.ungrouped?.length>0&&(()=>{const we=Ve.ungrouped,Le=we.reduce((He,[$e])=>{const at=ar($e);return at?{start:He.start+at.start_balance,allocated:He.allocated+at.allocated,spent:He.spent+at.spent,end:He.end+at.end_balance}:He},{start:0,allocated:0,spent:0,end:0});return d.jsx(LE,{name:"Uncategorized",categories:we,groupEndBalance:Le.end,groupAllocated:Le.allocated,getCategoryBalance:ar,localAllocations:O,previousMonthIncome:X,isDraftMode:Mt,onAllocationChange:Q,isMobile:w,isUngrouped:!0},"ungrouped")})()]})}),d.jsxs(hl,{isOpen:I,onClose:()=>D(!1),title:"Delete Allocations",children:[d.jsx("p",{style:{margin:"0 0 1.5rem 0"},children:"Are you sure you want to delete all allocations for this month? This will remove all allocated amounts and reset the month to unfinalized."}),d.jsxs("div",{style:{display:"flex",gap:"0.75rem",justifyContent:"flex-end"},children:[d.jsx(Oe,{actionName:"Cancel Delete Allocations",variant:"secondary",onClick:()=>D(!1),children:"Cancel"}),d.jsx(Oe,{actionName:"Confirm Delete Allocations",variant:"danger",onClick:()=>{D(!1),ge()},children:"Delete Allocations"})]})]})]})}const GP=["income","balances","spend"];function zE(t){const e=t.year?parseInt(t.year,10):null,n=t.month?parseInt(t.month,10):null,i=t.tab&&GP.includes(t.tab)?t.tab:null;return{year:e&&!isNaN(e)&&e>=2e3&&e<=2100?e:null,month:n&&!isNaN(n)&&n>=1&&n<=12?n:null,tab:i}}function UE(){const t=qC(),e=ou(),{currentUserId:n,selectedBudgetId:i,currentYear:a,currentMonthNumber:l,lastActiveTab:u,setCurrentYear:h,setCurrentMonthNumber:m,setLastActiveTab:g,goToPreviousMonth:_,goToNextMonth:v,hasPendingInvites:b,pendingInvites:w,needsFirstBudget:C}=Tn(),{budget:R,createBudget:N,acceptInvite:B}=Hn(i,n),{month:H,isLoading:F,error:ae}=Ol(i,a,l),[te,he]=A.useState(null),L=A.useRef(!1);A.useEffect(()=>{if(!ae)return;const U=ae.message||"";if(U.includes("months in the future")||U.includes("Refusing to create month")){console.log("[Budget] Month too far in future, navigating to max allowed month");const z=new Date;let q=z.getFullYear(),K=z.getMonth()+1+3;for(;K>12;)K-=12,q+=1;h(q),m(K),he(`Cannot navigate to ${a}/${l} - redirected to ${q}/${K}`)}},[ae,a,l,h,m]);const[I,D]=A.useState(()=>{const{tab:U}=zE(t);return U??u}),k=U=>{D(U),g(U)};A.useEffect(()=>{if(L.current)return;const{year:U,month:z}=zE(t);U&&h(U),z&&m(z),L.current=!0},[t,h,m]),A.useEffect(()=>{if(!L.current)return;const U=`/budget/${a}/${l}/${I}`,z=`/budget/${t.year}/${t.month}/${t.tab}`;U!==z&&e(U,{replace:!0})},[a,l,I,e,t]);async function O(U){try{await B(U)}catch(z){he(z instanceof Error?z.message:"Failed to accept invite")}}async function j(U){try{await N(U||"My Budget")}catch(z){he(z instanceof Error?z.message:"Failed to create budget")}}if(!R&&b)return d.jsxs(el,{children:[d.jsx(vi,{title:"Budget",showBackArrow:!0,hideMenu:!0}),d.jsx(TP,{invites:w,onAccept:O,onCreateNew:j})]});if(!R&&C)return d.jsxs(el,{children:[d.jsx(vi,{title:"Budget",showBackArrow:!0,hideMenu:!0}),d.jsx(wP,{onCreateNew:j})]});function T(){he(null),_()}function Z(){he(null),v()}return d.jsxs(el,{children:[d.jsx(vi,{title:R?.name||"Budget"}),d.jsxs(J4,{children:[te&&d.jsx(jl,{message:te,onDismiss:()=>he(null)}),d.jsx(RP,{isLoading:F,onPreviousMonth:T,onNextMonth:Z}),d.jsx(AP,{activeTab:I,setActiveTab:k,allocationsFinalized:H?.are_allocations_finalized}),I==="income"&&d.jsx(kP,{}),I==="balances"&&d.jsx(qP,{}),I==="spend"&&d.jsx(LP,{})]})]})}function HP(){return d.jsxs(el,{children:[d.jsx(vi,{title:"Analytics"}),d.jsxs("div",{style:{display:"flex",flexDirection:"column",alignItems:"center",justifyContent:"center",minHeight:"50vh",textAlign:"center",gap:"1.5rem"},children:[d.jsx("div",{style:{fontSize:"4rem",opacity:.8},children:""}),d.jsx("h1",{style:{margin:0,fontSize:"2rem",fontWeight:600},children:"Analytics"}),d.jsx("p",{style:{margin:0,fontSize:"1.25rem",opacity:.6,maxWidth:"400px"},children:"Coming Soon"}),d.jsx("p",{style:{margin:0,fontSize:"0.95rem",opacity:.5,maxWidth:"500px",lineHeight:1.6},children:"Track spending trends, category breakdowns, and insights about your budget over time."}),d.jsx(Dt,{to:"/budget",style:{marginTop:"1rem",padding:"0.75rem 1.5rem",background:de.primary,color:"white",borderRadius:"8px",textDecoration:"none",fontWeight:500,transition:"opacity 0.15s"},children:"Back to Budget"})]})]})}function Fh({initialData:t,onSubmit:e,onCancel:n,submitLabel:i,accountGroups:a,showGroupSelector:l=!1,showIncomeSettings:u=!1,hasExistingIncomeDefault:h=!1,hasExistingOutgoDefault:m=!1,currentGroupId:g}){const[_,v]=A.useState(t||{nickname:"",account_group_id:null,is_income_account:!1,is_income_default:!1,is_outgo_account:!1,is_outgo_default:!1,on_budget:!0,is_active:!0}),b=_.account_group_id||g,w=b?a.find(F=>F.id===b):null,C=w?.is_active!==void 0,R=w?.on_budget!==void 0;function N(F){F.preventDefault(),_.nickname.trim()&&e(_)}function B(F){v({..._,is_income_account:F,is_income_default:F?_.is_income_default:!1})}function H(F){v({..._,is_outgo_account:F,is_outgo_default:F?_.is_outgo_default:!1})}return d.jsxs(qa,{actionName:i==="Create Account"?"Create Account":"Update Account",onSubmit:N,children:[d.jsx(en,{label:"Account Nickname",htmlFor:"account-nickname",children:d.jsx(Ga,{id:"account-nickname",type:"text",value:_.nickname,onChange:F=>v({..._,nickname:F.target.value}),placeholder:"e.g., Main Checking, Savings",required:!0,autoFocus:!0})}),l&&d.jsx(en,{label:"Account Type",htmlFor:"account-group",children:d.jsxs(su,{id:"account-group",value:_.account_group_id||"ungrouped",onChange:F=>v({..._,account_group_id:F.target.value==="ungrouped"?null:F.target.value}),children:[d.jsx("option",{value:"ungrouped",children:"Ungrouped"}),a.map(F=>d.jsx("option",{value:F.id,children:F.name},F.id))]})}),u&&d.jsxs("div",{style:{padding:"0.75rem",background:"color-mix(in srgb, currentColor 5%, transparent)",borderRadius:"8px",display:"flex",flexDirection:"column",gap:"0.75rem"},children:[d.jsxs("div",{style:{display:"flex",flexDirection:"column",gap:"0.5rem"},children:[d.jsx("p",{style:{margin:0,fontSize:"0.85rem",opacity:.7},children:"Account Status"}),d.jsxs("div",{style:{display:"flex",flexDirection:"column",gap:"0.25rem"},children:[d.jsx(Ns,{id:"is-active",checked:C?w.is_active:_.is_active!==!1,onChange:F=>v({..._,is_active:F.target.checked}),disabled:C,children:d.jsx("span",{style:{opacity:C?.5:1},children:"Active account"})}),C&&d.jsxs("p",{style:{margin:0,fontSize:"0.7rem",opacity:.6,marginLeft:"2rem",color:de.warning},children:['Set by account type "',w.name,'"']})]}),d.jsxs("div",{style:{display:"flex",flexDirection:"column",gap:"0.25rem"},children:[d.jsx(Ns,{id:"on-budget",checked:R?w.on_budget:_.on_budget!==!1,onChange:F=>v({..._,on_budget:F.target.checked}),disabled:R,children:d.jsx("span",{style:{opacity:R?.5:1},children:"On budget (affects budget totals)"})}),R&&d.jsxs("p",{style:{margin:0,fontSize:"0.7rem",opacity:.6,marginLeft:"2rem",color:de.warning},children:['Set by account type "',w.name,'"']})]})]}),d.jsxs("div",{style:{display:"flex",flexDirection:"column",gap:"0.5rem"},children:[d.jsx("p",{style:{margin:0,fontSize:"0.85rem",opacity:.7},children:"Income Settings"}),d.jsx(Ns,{id:"is-income-account",checked:_.is_income_account||!1,onChange:F=>B(F.target.checked),children:"Show in income deposit list"}),_.is_income_account&&d.jsxs("div",{style:{display:"flex",flexDirection:"column",gap:"0.25rem",marginLeft:"2rem"},children:[d.jsx(Ns,{id:"is-income-default",checked:_.is_income_default||!1,onChange:F=>v({..._,is_income_default:F.target.checked}),disabled:h&&!t?.is_income_default,children:"Default account for new income"}),h&&!t?.is_income_default&&d.jsx("p",{style:{margin:0,fontSize:"0.75rem",opacity:.5},children:"Another account is already set as default"})]})]}),d.jsxs("div",{style:{display:"flex",flexDirection:"column",gap:"0.5rem"},children:[d.jsx("p",{style:{margin:0,fontSize:"0.85rem",opacity:.7},children:"Expense Settings"}),d.jsx(Ns,{id:"is-outgo-account",checked:_.is_outgo_account||!1,onChange:F=>H(F.target.checked),children:"Show in expense account list"}),_.is_outgo_account&&d.jsxs("div",{style:{display:"flex",flexDirection:"column",gap:"0.25rem",marginLeft:"2rem"},children:[d.jsx(Ns,{id:"is-outgo-default",checked:_.is_outgo_default||!1,onChange:F=>v({..._,is_outgo_default:F.target.checked}),disabled:m&&!t?.is_outgo_default,children:"Default account for new expenses"}),m&&!t?.is_outgo_default&&d.jsx("p",{style:{margin:0,fontSize:"0.75rem",opacity:.5},children:"Another account is already set as default"})]})]})]}),d.jsxs(Ya,{children:[d.jsx(Oe,{type:"submit",actionName:i,children:i}),d.jsx(Oe,{type:"button",variant:"secondary",actionName:"Cancel Account Form",onClick:n,children:"Cancel"})]})]})}function BE({label:t,value:e,onChange:n,trueLabel:i,falseLabel:a,undefinedLabel:l}){function u(){n(e===void 0?!0:e===!0?!1:void 0)}const h=e===!0?i:e===!1?a:l,m=e===!0?de.success:e===!1?de.warning:"inherit",g=e===!0?"":e===!1?"":"";return d.jsxs("button",{type:"button",onClick:u,style:{display:"flex",alignItems:"center",gap:"0.5rem",padding:"0.5rem 0.75rem",background:e!==void 0?`color-mix(in srgb, ${m} 15%, transparent)`:"color-mix(in srgb, currentColor 8%, transparent)",border:e!==void 0?`1px solid color-mix(in srgb, ${m} 40%, transparent)`:"1px solid color-mix(in srgb, currentColor 20%, transparent)",borderRadius:"6px",cursor:"pointer",fontSize:"0.85rem",color:"inherit",textAlign:"left",width:"100%"},children:[d.jsx("span",{style:{width:"1.25rem",height:"1.25rem",display:"flex",alignItems:"center",justifyContent:"center",borderRadius:"4px",background:e!==void 0?m:"color-mix(in srgb, currentColor 20%, transparent)",color:e!==void 0?"white":"inherit",fontWeight:600,fontSize:"0.75rem"},children:g}),d.jsxs("span",{style:{flex:1},children:[d.jsxs("span",{style:{opacity:.7},children:[t,":"]})," ",d.jsx("span",{style:{fontWeight:500,color:m},children:h})]}),d.jsx("span",{style:{fontSize:"0.7rem",opacity:.5},children:"click to cycle"})]})}function hT({initialData:t,onSubmit:e,onCancel:n,submitLabel:i}){const[a,l]=A.useState(t||{name:"",expected_balance:"positive"});function u(h){h.preventDefault(),a.name.trim()&&e(a)}return d.jsxs(qa,{actionName:i==="Create Account Type"?"Create Account Type":"Update Account Type",onSubmit:u,children:[d.jsx(en,{label:"Account Type Name",htmlFor:"group-name",children:d.jsx(Ga,{id:"group-name",type:"text",value:a.name,onChange:h=>l({...a,name:h.target.value}),placeholder:"e.g., Checking, Savings, Credit Cards, Investments",required:!0,autoFocus:!0})}),d.jsx(en,{label:"Expected Balance",htmlFor:"expected-balance",children:d.jsxs(su,{id:"expected-balance",value:a.expected_balance,onChange:h=>l({...a,expected_balance:h.target.value}),children:[d.jsx("option",{value:"positive",children:"Normally Positive (e.g., Checking, Savings)"}),d.jsx("option",{value:"negative",children:"Normally Negative (e.g., Credit Cards, Loans)"}),d.jsx("option",{value:"any",children:"Either (no warnings)"})]})}),d.jsxs("div",{style:{padding:"0.75rem",background:"color-mix(in srgb, currentColor 5%, transparent)",borderRadius:"8px",display:"flex",flexDirection:"column",gap:"0.5rem"},children:[d.jsxs("p",{style:{margin:0,fontSize:"0.85rem",opacity:.7},children:["Group-Level Overrides ",d.jsx("span",{style:{fontSize:"0.75rem",opacity:.6},children:"(applies to all accounts in this type)"})]}),d.jsx(BE,{label:"Active status",value:a.is_active,onChange:h=>l({...a,is_active:h}),trueLabel:"All active",falseLabel:"All inactive",undefinedLabel:"Per account"}),d.jsx(BE,{label:"Budget status",value:a.on_budget,onChange:h=>l({...a,on_budget:h}),trueLabel:"All on budget",falseLabel:"All off budget",undefinedLabel:"Per account"})]}),d.jsxs(Ya,{children:[d.jsx(Oe,{type:"submit",actionName:i,children:i}),d.jsx(Oe,{type:"button",variant:"secondary",actionName:"Cancel Account Type Form",onClick:n,children:"Cancel"})]})]})}function Bo({icon:t,label:e,variant:n,title:i}){const l={success:{background:`color-mix(in srgb, ${de.success} 20%, transparent)`,border:`1px solid color-mix(in srgb, ${de.success} 40%, transparent)`,color:de.success,opacity:1},warning:{background:`color-mix(in srgb, ${de.warning} 15%, transparent)`,border:`1px solid color-mix(in srgb, ${de.warning} 35%, transparent)`,color:de.warning,opacity:1},muted:{background:"color-mix(in srgb, currentColor 12%, transparent)",border:"1px solid color-mix(in srgb, currentColor 20%, transparent)",color:"inherit",opacity:.7},income:{background:`color-mix(in srgb, ${de.success} 10%, transparent)`,border:`1px solid color-mix(in srgb, ${de.success} 25%, transparent)`,color:de.success,opacity:.7},expense:{background:`color-mix(in srgb, ${de.warning} 10%, transparent)`,border:`1px solid color-mix(in srgb, ${de.warning} 25%, transparent)`,color:de.warning,opacity:.7}}[n];return d.jsxs("span",{title:i||e,style:{display:"inline-flex",alignItems:"center",gap:"0.25rem",background:l.background,border:l.border,padding:"0.15rem 0.4rem",borderRadius:"4px",fontSize:"0.7rem",fontWeight:500,textTransform:"uppercase",letterSpacing:"0.3px",color:l.color,opacity:l.opacity,whiteSpace:"nowrap"},children:[d.jsx("span",{style:{fontSize:"0.75rem"},children:t}),e]})}function fT({account:t,accountGroups:e}){const n=[],i=t.account_group_id?e.find(u=>u.id===t.account_group_id):null,a=i?.is_active!==void 0?i.is_active:t.is_active!==!1,l=i?.on_budget!==void 0?i.on_budget:t.on_budget!==!1;if(!a){const u=i?.is_active!==void 0;n.push(d.jsx(Bo,{icon:"",label:u?"Inactive (type)":"Inactive",variant:"warning",title:u?`Set by "${i.name}" account type`:"Account is inactive/archived"},"inactive"))}if(!l){const u=i?.on_budget!==void 0;n.push(d.jsx(Bo,{icon:"",label:u?"Off Budget (type)":"Off Budget",variant:"warning",title:u?`Set by "${i.name}" account type`:"Tracking only - not included in budget"},"off-budget"))}return t.is_income_default?n.push(d.jsx(Bo,{icon:"",label:"Income Default",variant:"success",title:"Default income deposit account"},"income-default")):t.is_income_account&&n.push(d.jsx(Bo,{icon:"",label:"Income",variant:"income",title:"Income deposit account"},"income")),t.is_outgo_default?n.push(d.jsx(Bo,{icon:"",label:"Expense Default",variant:"warning",title:"Default expense account"},"outgo-default")):t.is_outgo_account&&n.push(d.jsx(Bo,{icon:"",label:"Expense",variant:"expense",title:"Expense account"},"outgo")),n.length===0?null:d.jsx(d.Fragment,{children:n})}function QP({group:t}){const e=[];return t.is_active===!1?e.push(d.jsx("span",{style:{fontSize:"0.65rem",fontWeight:500,padding:"0.15rem 0.35rem",borderRadius:"4px",background:`color-mix(in srgb, ${de.warning} 20%, transparent)`,color:de.warning,whiteSpace:"nowrap"},title:"All accounts in this type are inactive",children:"All Inactive"},"inactive")):t.is_active===!0&&e.push(d.jsx("span",{style:{fontSize:"0.65rem",fontWeight:500,padding:"0.15rem 0.35rem",borderRadius:"4px",background:`color-mix(in srgb, ${de.success} 20%, transparent)`,color:de.success,whiteSpace:"nowrap"},title:"All accounts in this type are active",children:"All Active"},"active")),t.on_budget===!1?e.push(d.jsx("span",{style:{fontSize:"0.65rem",fontWeight:500,padding:"0.15rem 0.35rem",borderRadius:"4px",background:`color-mix(in srgb, ${de.warning} 20%, transparent)`,color:de.warning,whiteSpace:"nowrap"},title:"All accounts in this type are off budget",children:"All Off Budget"},"off-budget")):t.on_budget===!0&&e.push(d.jsx("span",{style:{fontSize:"0.65rem",fontWeight:500,padding:"0.15rem 0.35rem",borderRadius:"4px",background:`color-mix(in srgb, ${de.success} 20%, transparent)`,color:de.success,whiteSpace:"nowrap"},title:"All accounts in this type are on budget",children:"All On Budget"},"on-budget")),e.length===0?null:d.jsx(d.Fragment,{children:e})}function mT({isActive:t,onDragOver:e,onDragLeave:n,onDrop:i}){return d.jsxs("div",{onDragOver:e,onDragLeave:n,onDrop:i,style:{position:"relative",height:"2rem",marginTop:"-0.25rem"},children:[d.jsx("div",{style:{position:"absolute",top:"50%",left:0,right:0,height:"3px",background:de.primary,borderRadius:"2px",opacity:t?1:.3,transition:"opacity 0.15s",boxShadow:t?"0 0 8px rgba(100, 108, 255, 0.6)":"none"}}),t&&d.jsx("span",{style:{position:"absolute",top:"50%",left:"50%",transform:"translate(-50%, -50%)",fontSize:"0.75rem",opacity:.7,background:"var(--background, #1a1a1a)",padding:"0 0.5rem",whiteSpace:"nowrap"},children:"Move to end"})]})}function $P(t,e){return!e||e==="any"||t===0?!1:e==="positive"&&t<0||e==="negative"&&t>0}function KP(t,e){return!e||e==="any"||t===0?null:e==="positive"&&t<0?"Unexpected negative balance":e==="negative"&&t>0?"Unexpected positive balance (credit owed to you?)":null}function WP({group:t,groupIndex:e,totalGroups:n,accounts:i,allGroups:a,allAccounts:l,editingAccountId:u,editingGroupId:h,createForGroupId:m,setEditingAccountId:g,setEditingGroupId:_,setCreateForGroupId:v,dragType:b,draggedId:w,dragOverId:C,dragOverGroupId:R,setDragOverId:N,setDragOverGroupId:B,onAccountDragStart:H,onAccountDragOver:F,onAccountDrop:ae,onGroupDragStart:te,onGroupDragOver:he,onGroupDrop:L,onDragLeave:I,onDragLeaveGroup:D,onDragEnd:k,onDropOnGroup:O,onCreateAccount:j,onUpdateAccount:T,onDeleteAccount:Z,onMoveAccount:U,onUpdateGroup:z,onDeleteGroup:q,onMoveGroup:K}){const ee=es(),X=[...i].sort((re,ke)=>re.sort_order-ke.sort_order),P=b==="group"&&w===t.id,W=b==="group"&&C===t.id,Y=b==="account"&&R===t.id,fe=(w&&b==="account"?l[w]:null)&&Object.entries(l).find(([re])=>re===w)?.[1]&&Object.entries(l).find(([re])=>re===w)?.[1]?.account_group_id!==t.id,ce=b==="group"&&W&&w!==t.id,me=e>0,ge=e<n-1,Ee=X.reduce((re,ke)=>re+ke.balance,0);return d.jsxs("div",{children:[b==="group"&&!P&&d.jsxs("div",{onDragOver:re=>{re.preventDefault(),N(t.id)},onDragLeave:I,onDrop:re=>L(re,t.id),style:{position:"relative",height:ce?"2.5rem":"0.5rem",marginBottom:ce?"-0.5rem":"-0.25rem",transition:"height 0.15s"},children:[d.jsx("div",{style:{position:"absolute",top:"50%",left:0,right:0,height:"3px",background:de.primary,borderRadius:"2px",opacity:ce?1:0,transition:"opacity 0.15s",boxShadow:ce?"0 0 8px rgba(100, 108, 255, 0.6)":"none"}}),ce&&d.jsx("span",{style:{position:"absolute",top:"50%",left:"50%",transform:"translate(-50%, -50%)",fontSize:"0.75rem",opacity:.7,background:"var(--background, #1a1a1a)",padding:"0 0.5rem",whiteSpace:"nowrap"},children:"Drop here"})]}),d.jsx("div",{draggable:h!==t.id,onDragStart:re=>te(re,t.id),onDragOver:re=>he(re,t.id),onDragLeave:D,onDragEnd:k,onDrop:re=>O(re,t.id),style:{background:P?"color-mix(in srgb, currentColor 3%, transparent)":Y&&fe?`color-mix(in srgb, ${de.primary} 10%, transparent)`:"color-mix(in srgb, currentColor 5%, transparent)",borderRadius:"12px",padding:"1rem",opacity:P?.5:1,border:Y&&fe?`2px dashed ${de.primary}`:"2px solid transparent",cursor:h===t.id?"default":"grab",transition:"all 0.15s"},children:h===t.id?d.jsx(hT,{initialData:{name:t.name,expected_balance:t.expected_balance||"positive",on_budget:t.on_budget,is_active:t.is_active},onSubmit:re=>z(t.id,re),onCancel:()=>_(null),submitLabel:"Save"}):d.jsxs(d.Fragment,{children:[d.jsx(YP,{group:t,accountCount:X.length,groupTotal:Ee,canMoveUp:me,canMoveDown:ge,isMobile:ee,createForGroupId:m,onEdit:()=>_(t.id),onDelete:()=>q(t.id),onMoveUp:()=>K(t.id,"up"),onMoveDown:()=>K(t.id,"down"),onAddAccount:()=>v(t.id)}),ee&&d.jsx("div",{style:{marginBottom:"0.5rem"},children:d.jsx(Oe,{variant:"small",actionName:`Open Add Account Form (${t.name})`,onClick:()=>v(t.id),disabled:m!==null,children:"+ Account"})}),d.jsxs("div",{style:dl,children:[X.map((re,ke)=>u===re.id?d.jsx(Fh,{initialData:{nickname:re.nickname,account_group_id:re.account_group_id,is_income_account:re.is_income_account,is_income_default:re.is_income_default,is_outgo_account:re.is_outgo_account,is_outgo_default:re.is_outgo_default,on_budget:re.on_budget,is_active:re.is_active},onSubmit:Ve=>T(re.id,Ve),onCancel:()=>g(null),submitLabel:"Save",accountGroups:a,showGroupSelector:!0,showIncomeSettings:!0,currentGroupId:re.account_group_id,hasExistingIncomeDefault:Object.entries(l).some(([Ve,jt])=>jt.is_income_default&&Ve!==re.id),hasExistingOutgoDefault:Object.entries(l).some(([Ve,jt])=>jt.is_outgo_default&&Ve!==re.id)},re.id):d.jsx(vf,{isDragging:b==="account"&&w===re.id,isDragOver:C===re.id,onDragStart:Ve=>{Ve.stopPropagation(),H(Ve,re.id)},onDragOver:Ve=>F(Ve,re.id,t.id),onDragLeave:I,onDragEnd:k,onDrop:Ve=>ae(Ve,re.id,t.id),onEdit:()=>{re.nickname,g(re.id)},onDelete:()=>{re.nickname,Z(re.id)},onMoveUp:()=>U(re.id,"up"),onMoveDown:()=>U(re.id,"down"),canMoveUp:ke>0,canMoveDown:ke<X.length-1,children:d.jsxs("div",{children:[d.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"0.5rem",flexWrap:"wrap"},children:[d.jsx("span",{style:ky,children:re.nickname}),d.jsx(fT,{account:re,accountGroups:a})]}),d.jsxs("p",{style:{margin:"0.25rem 0 0 0",fontSize:"1.1rem",fontWeight:600,color:Pt(re.balance)},children:[Re(re.balance),$P(re.balance,t.expected_balance)&&d.jsx("span",{title:KP(re.balance,t.expected_balance)||"",style:{marginLeft:"0.5rem",fontSize:"0.85rem"},children:""})]})]})},re.id)),X.length===0&&!m&&d.jsx("p",{style:{opacity:.5,fontSize:"0.9rem",margin:"0.5rem 0"},children:"No accounts in this type"}),b==="account"&&X.length>0&&d.jsx(mT,{groupId:t.id,isActive:C===`__end__${t.id}`,onDragOver:re=>{re.preventDefault(),re.stopPropagation(),N(`__end__${t.id}`),B(t.id)},onDragLeave:re=>{re.stopPropagation(),N(null)},onDrop:re=>{re.stopPropagation(),ae(re,"__group_end__",t.id)}}),m===t.id&&d.jsx(Fh,{initialData:{nickname:"",account_group_id:t.id},onSubmit:re=>j(re,t.id),onCancel:()=>v(null),submitLabel:"Create",accountGroups:a,showIncomeSettings:!0,currentGroupId:t.id})]}),m!==t.id&&d.jsx("div",{style:{marginTop:"0.75rem",paddingTop:"0.5rem",borderTop:"1px solid color-mix(in srgb, currentColor 10%, transparent)"},children:d.jsx(Oe,{variant:"small",actionName:`Open Add Account Form (${t.name})`,onClick:()=>v(t.id),disabled:m!==null,children:"+ Add Account"})})]})})]})}function YP({group:t,accountCount:e,groupTotal:n,canMoveUp:i,canMoveDown:a,isMobile:l,createForGroupId:u,onEdit:h,onDelete:m,onMoveUp:g,onMoveDown:_,onAddAccount:v}){return d.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:l?"0.5rem":"0.75rem",paddingBottom:"0.5rem",borderBottom:"1px solid color-mix(in srgb, currentColor 15%, transparent)",gap:"0.5rem",flexWrap:l?"wrap":"nowrap"},children:[d.jsxs("h3",{style:{...Il,margin:0,display:"flex",alignItems:"center",gap:"0.5rem",flex:1,minWidth:0,flexWrap:"wrap"},children:[!l&&d.jsx("span",{style:{cursor:"grab",opacity:.4},children:""}),d.jsx("span",{style:{overflow:"hidden",textOverflow:"ellipsis",whiteSpace:"nowrap"},children:t.name}),d.jsxs("span",{style:{opacity:.5,fontWeight:400,fontSize:"0.9rem",flexShrink:0},children:["(",e,")"]}),d.jsx("span",{style:{marginLeft:"0.5rem",fontWeight:600,fontSize:"0.9rem",color:Pt(n),flexShrink:0},children:Re(n)}),d.jsx(QP,{group:t})]}),d.jsxs("div",{style:{display:"flex",gap:"0.5rem",flexShrink:0,alignItems:"center"},children:[!l&&d.jsx(Oe,{variant:"small",actionName:`Open Add Account Form (${t.name})`,onClick:v,disabled:u!==null,children:"+ Account"}),d.jsx("button",{onClick:()=>{t.name,h()},style:{background:"transparent",border:"none",cursor:"pointer",opacity:.6,fontSize:"0.9rem",padding:"0.25rem"},title:"Edit account type",children:""}),d.jsx("button",{onClick:()=>{t.name,m()},style:{background:"transparent",border:"none",cursor:"pointer",opacity:.6,fontSize:"0.9rem",padding:"0.25rem"},title:"Delete account type",children:""}),d.jsxs("div",{style:My,children:[d.jsx("button",{onClick:g,disabled:!i,style:{...ul,opacity:i?.6:.2,cursor:i?"pointer":"default"},title:"Move up","aria-label":"Move up",children:""}),d.jsx("button",{onClick:_,disabled:!a,style:{...ul,opacity:a?.6:.2,cursor:a?"pointer":"default"},title:"Move down","aria-label":"Move down",children:""})]})]})]})}function XP({accounts:t,allGroups:e,allAccounts:n,hasGroups:i,editingAccountId:a,createForGroupId:l,setEditingAccountId:u,setCreateForGroupId:h,dragType:m,draggedId:g,dragOverId:_,dragOverGroupId:v,setDragOverId:b,setDragOverGroupId:w,onAccountDragStart:C,onAccountDragOver:R,onAccountDrop:N,onDragOverGroup:B,onDropOnGroup:H,onDragLeave:F,onDragLeaveGroup:ae,onDragEnd:te,onCreateAccount:he,onUpdateAccount:L,onDeleteAccount:I,onMoveAccount:D}){const k=[...t].sort((U,z)=>U.sort_order-z.sort_order),O=m==="account"&&v==="ungrouped",T=(g&&m==="account"?n[g]:null)&&Object.entries(n).find(([U])=>U===g)?.[1]&&Object.entries(n).find(([U])=>U===g)?.[1]?.account_group_id!==null;if(k.length===0&&!l&&i&&m!=="account")return null;const Z=k.reduce((U,z)=>U+z.balance,0);return d.jsxs("div",{onDragOver:U=>B(U,"ungrouped"),onDragLeave:ae,onDrop:U=>H(U,"ungrouped"),style:{background:O&&T?`color-mix(in srgb, ${de.primary} 10%, transparent)`:"color-mix(in srgb, currentColor 5%, transparent)",borderRadius:"12px",padding:"1rem",border:O&&T?`2px dashed ${de.primary}`:"2px solid transparent",transition:"all 0.15s"},children:[d.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:"0.75rem",paddingBottom:"0.5rem",borderBottom:"1px solid color-mix(in srgb, currentColor 15%, transparent)"},children:[d.jsxs("h3",{style:{...Il,margin:0,opacity:.7,display:"flex",alignItems:"center",gap:"0.5rem"},children:["Ungrouped",d.jsxs("span",{style:{marginLeft:"0.5rem",opacity:.5,fontWeight:400,fontSize:"0.9rem"},children:["(",k.length,")"]}),k.length>0&&d.jsx("span",{style:{marginLeft:"0.5rem",fontWeight:600,fontSize:"0.9rem",color:Pt(Z)},children:Re(Z)})]}),d.jsx(Oe,{variant:"small",actionName:"Open Add Account Form (Ungrouped)",onClick:()=>h("ungrouped"),disabled:l!==null,children:"+ Account"})]}),d.jsxs("div",{style:dl,children:[k.map((U,z)=>a===U.id?d.jsx(Fh,{initialData:{nickname:U.nickname,account_group_id:U.account_group_id,is_income_account:U.is_income_account,is_income_default:U.is_income_default,is_outgo_account:U.is_outgo_account,is_outgo_default:U.is_outgo_default,on_budget:U.on_budget,is_active:U.is_active},onSubmit:q=>L(U.id,q),onCancel:()=>u(null),submitLabel:"Save",accountGroups:e,showGroupSelector:!0,showIncomeSettings:!0,currentGroupId:null,hasExistingIncomeDefault:Object.entries(n).some(([q,K])=>K.is_income_default&&q!==U.id),hasExistingOutgoDefault:Object.entries(n).some(([q,K])=>K.is_outgo_default&&q!==U.id)},U.id):d.jsx(vf,{isDragging:m==="account"&&g===U.id,isDragOver:_===U.id,onDragStart:q=>C(q,U.id),onDragOver:q=>R(q,U.id,"ungrouped"),onDragLeave:F,onDragEnd:te,onDrop:q=>N(q,U.id,"ungrouped"),onEdit:()=>{U.nickname,u(U.id)},onDelete:()=>{U.nickname,I(U.id)},onMoveUp:()=>D(U.id,"up"),onMoveDown:()=>D(U.id,"down"),canMoveUp:z>0,canMoveDown:z<k.length-1,children:d.jsxs("div",{children:[d.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"0.5rem",flexWrap:"wrap"},children:[d.jsx("span",{style:ky,children:U.nickname}),d.jsx(fT,{account:U,accountGroups:e})]}),d.jsx("p",{style:{margin:"0.25rem 0 0 0",fontSize:"1.1rem",fontWeight:600,color:Pt(U.balance)},children:Re(U.balance)})]})},U.id)),k.length===0&&m==="account"&&d.jsx("p",{style:{opacity:.5,fontSize:"0.9rem",margin:"0.5rem 0",textAlign:"center"},children:"Drop here to ungroup"}),m==="account"&&k.length>0&&d.jsx(mT,{groupId:"ungrouped",isActive:_==="__end__ungrouped",onDragOver:U=>{U.preventDefault(),U.stopPropagation(),b("__end__ungrouped"),w("ungrouped")},onDragLeave:U=>{U.stopPropagation(),b(null)},onDrop:U=>{U.stopPropagation(),N(U,"__group_end__","ungrouped")}}),l==="ungrouped"&&d.jsx(Fh,{initialData:{nickname:"",account_group_id:null},onSubmit:U=>he(U,"ungrouped"),onCancel:()=>h(null),submitLabel:"Create",accountGroups:e,showIncomeSettings:!0,currentGroupId:null})]}),l!=="ungrouped"&&d.jsx("div",{style:{marginTop:"0.75rem",paddingTop:"0.5rem",borderTop:"1px solid color-mix(in srgb, currentColor 10%, transparent)"},children:d.jsx(Oe,{variant:"small",actionName:"Open Add Account Form (Ungrouped)",onClick:()=>h("ungrouped"),disabled:l!==null,children:"+ Add Account"})})]})}function JP(){const{accounts:t,accountsByGroup:e,sortedGroups:n,currentBudget:i,error:a,setError:l,handleCreateAccount:u,handleUpdateAccount:h,handleDeleteAccount:m,handleMoveAccount:g,handleCreateGroup:_,handleUpdateGroup:v,handleDeleteGroup:b,handleMoveGroup:w,reorderAccountsInGroup:C,reorderGroups:R}=hP(),N=es(),[B,H]=A.useState(null),[F,ae]=A.useState(null),[te,he]=A.useState(null),[L,I]=A.useState(!1),[D,k]=A.useState(null),[O,j]=A.useState(null),[T,Z]=A.useState(null),[U,z]=A.useState(null);function q(ge,Ee){k("account"),j(Ee),ge.dataTransfer.effectAllowed="move"}function K(ge,Ee,re){ge.preventDefault(),D==="account"&&(Ee!==O&&Z(Ee),z(re))}function ee(ge,Ee){ge.preventDefault(),D==="account"?(z(Ee),Z(null)):D==="group"&&Ee!==O&&Z(Ee)}function X(){Z(null)}function P(){z(null)}function W(){k(null),j(null),Z(null),z(null)}async function Y(ge,Ee,re){if(ge.preventDefault(),ge.stopPropagation(),!O||D!=="account"){W();return}await C(O,Ee,re),W()}async function Q(ge,Ee){ge.preventDefault(),D==="account"?await Y(ge,"__group_end__",Ee):D==="group"&&await ce(ge,Ee)}function fe(ge,Ee){ge.stopPropagation(),k("group"),j(Ee),ge.dataTransfer.effectAllowed="move"}async function ce(ge,Ee){if(ge.preventDefault(),!O||D!=="group"||O===Ee){W();return}await R(O,Ee),W()}if(!i)return d.jsx("p",{children:"No budget found. Please log in."});const me=e.ungrouped||[];return d.jsxs("div",{children:[d.jsx("h2",{style:{marginTop:0},children:"Accounts"}),d.jsxs("p",{style:iu,children:["Organize your financial accounts by type.",d.jsx("br",{}),d.jsx("span",{style:{fontSize:"0.9rem"},children:N?"Use  buttons to reorder items, or drag to move between types.":"Drag accounts between types, or use  buttons to reorder."})]}),a&&d.jsx(jl,{message:a,onDismiss:()=>l(null)}),d.jsx("div",{style:{display:"flex",justifyContent:"flex-end",marginBottom:"1rem"},children:d.jsx(zy,{})}),d.jsxs("div",{style:{display:"flex",flexDirection:"column",gap:"1rem",marginBottom:"1.5rem"},children:[Object.keys(t).length===0&&n.length===0&&d.jsx("p",{style:{opacity:.7},children:"No accounts yet. Create an account type first, then add accounts!"}),n.map((ge,Ee)=>d.jsx(WP,{group:ge,groupIndex:Ee,totalGroups:n.length,accounts:e[ge.id]||[],allGroups:n,allAccounts:t,editingAccountId:B,editingGroupId:te,createForGroupId:F,setEditingAccountId:H,setEditingGroupId:he,setCreateForGroupId:ae,dragType:D,draggedId:O,dragOverId:T,dragOverGroupId:U,setDragOverId:Z,setDragOverGroupId:z,onAccountDragStart:q,onAccountDragOver:K,onAccountDrop:Y,onGroupDragStart:fe,onGroupDragOver:ee,onGroupDrop:ce,onDragLeave:X,onDragLeaveGroup:P,onDragEnd:W,onDropOnGroup:Q,onCreateAccount:u,onUpdateAccount:(re,ke)=>{h(re,ke),H(null)},onDeleteAccount:m,onMoveAccount:g,onUpdateGroup:(re,ke)=>{v(re,ke),he(null)},onDeleteGroup:b,onMoveGroup:w},ge.id)),D==="group"&&n.length>0&&d.jsx(Py,{isActive:T==="__end__",onDragOver:ge=>{ge.preventDefault(),Z("__end__")},onDragLeave:X,onDrop:ge=>ce(ge,"__end__"),label:"Move account type to end"}),d.jsx(XP,{accounts:me,allGroups:n,allAccounts:t,hasGroups:n.length>0,editingAccountId:B,createForGroupId:F,setEditingAccountId:H,setCreateForGroupId:ae,dragType:D,draggedId:O,dragOverId:T,dragOverGroupId:U,setDragOverId:Z,setDragOverGroupId:z,onAccountDragStart:q,onAccountDragOver:K,onAccountDrop:Y,onDragOverGroup:ee,onDropOnGroup:Q,onDragLeave:X,onDragLeaveGroup:P,onDragEnd:W,onCreateAccount:u,onUpdateAccount:(ge,Ee)=>{h(ge,Ee),H(null)},onDeleteAccount:m,onMoveAccount:g})]}),L?d.jsx(hT,{onSubmit:ge=>{_(ge),I(!1)},onCancel:()=>I(!1),submitLabel:"Create Account Type"}):d.jsx(Oe,{variant:"primary-large",actionName:"Open Add Account Type Form",onClick:()=>I(!0),children:"+ Add Account Type"})]})}function qh({initialData:t,onSubmit:e,onCancel:n,submitLabel:i,categoryGroups:a=[],showGroupSelector:l=!1}){const[u,h]=A.useState(t||{name:"",category_group_id:null}),[m,g]=A.useState(t?.default_monthly_amount?.toString()||""),[_,v]=A.useState(t?.default_monthly_type||"fixed"),[b,w]=A.useState(!1);function C(R){if(R.preventDefault(),!u.name.trim())return;w(!0);const N=parseFloat(m),B=!isNaN(N)&&N>0;e({...u,description:u.description?.trim()||void 0,default_monthly_amount:B?N:void 0,default_monthly_type:B?_:void 0})}return d.jsxs(qa,{actionName:i==="Create"?"Create Category":"Update Category",onSubmit:C,children:[d.jsx(en,{label:"Category Name",htmlFor:"category-name",children:d.jsx(Ga,{id:"category-name",type:"text",value:u.name,onChange:R=>h({...u,name:R.target.value}),placeholder:"e.g., Groceries, Rent, Gas",required:!0,autoFocus:!0})}),d.jsx(en,{label:"Description (optional)",htmlFor:"category-description",children:d.jsx(Ny,{id:"category-description",value:u.description||"",onChange:R=>h({...u,description:R.target.value}),placeholder:"What is this category used for?",minHeight:"3rem"})}),l&&d.jsx(en,{label:"Category Group",htmlFor:"category-group",children:d.jsxs(su,{id:"category-group",value:u.category_group_id||"ungrouped",onChange:R=>h({...u,category_group_id:R.target.value==="ungrouped"?null:R.target.value}),children:[d.jsx("option",{value:"ungrouped",children:"Uncategorized"}),a.map(R=>d.jsx("option",{value:R.id,children:R.name},R.id))]})}),d.jsxs(en,{label:"Default Monthly Allocation (optional)",htmlFor:"default-amount",children:[d.jsxs("div",{style:{display:"flex",gap:"0.5rem",alignItems:"center"},children:[d.jsxs(su,{id:"default-type",value:_,onChange:R=>v(R.target.value),style:{width:"auto",flex:"0 0 auto"},children:[d.jsx("option",{value:"fixed",children:"Fixed $"}),d.jsx("option",{value:"percentage",children:"% of Prev Income"})]}),_==="fixed"?d.jsx(Sg,{id:"default-amount",value:m,onChange:g,placeholder:"$0.00"}):d.jsx(Ga,{id:"default-amount",type:"number",value:m,onChange:R=>g(R.target.value),placeholder:"0",min:"0",max:"100",step:"0.1",style:{width:"80px"}}),_==="percentage"&&d.jsx("span",{style:{opacity:.6},children:"%"})]}),d.jsx("p",{style:{margin:"0.25rem 0 0 0",fontSize:"0.75rem",opacity:.6},children:_==="fixed"?"Suggested fixed amount to allocate each month":"Percentage of previous month's total income"})]}),d.jsxs(Ya,{children:[d.jsx(Oe,{type:"submit",actionName:i==="Create"?"Create Category":"Save Category",isLoading:b,children:i}),d.jsx(Oe,{type:"button",variant:"secondary",actionName:"Cancel Category Form",onClick:n,children:"Cancel"})]})]})}function pT({initialData:t,onSubmit:e,onCancel:n,submitLabel:i}){const[a,l]=A.useState(t||{name:""}),[u,h]=A.useState(!1);function m(g){g.preventDefault(),a.name.trim()&&(h(!0),e(a))}return d.jsxs(qa,{actionName:i==="Create Group"?"Create Category Group":"Update Category Group",onSubmit:m,children:[d.jsx(en,{label:"Group Name",htmlFor:"group-name",children:d.jsx(Ga,{id:"group-name",type:"text",value:a.name,onChange:g=>l({...a,name:g.target.value}),placeholder:"e.g., Housing, Transportation, Food",required:!0,autoFocus:!0})}),d.jsxs(Ya,{children:[d.jsx(Oe,{type:"submit",actionName:i==="Create Group"?"Create Category Group":"Save Category Group",isLoading:u,children:i}),d.jsx(Oe,{type:"button",variant:"secondary",actionName:"Cancel Category Group Form",onClick:n,children:"Cancel"})]})]})}function gT({isActive:t,onDragOver:e,onDragLeave:n,onDrop:i}){return d.jsxs("div",{onDragOver:e,onDragLeave:n,onDrop:i,style:{position:"relative",height:"2rem",marginTop:"-0.25rem"},children:[d.jsx("div",{style:{position:"absolute",top:"50%",left:0,right:0,height:"3px",background:de.primary,borderRadius:"2px",opacity:t?1:.3,transition:"opacity 0.15s",boxShadow:t?"0 0 8px rgba(100, 108, 255, 0.6)":"none"}}),t&&d.jsx("span",{style:{position:"absolute",top:"50%",left:"50%",transform:"translate(-50%, -50%)",fontSize:"0.75rem",opacity:.7,background:"var(--background, #1a1a1a)",padding:"0 0.5rem",whiteSpace:"nowrap"},children:"Move to end"})]})}function ZP({group:t,groupIndex:e,groupCategories:n,sortedGroups:i,categoryGroups:a,categoryBalances:l,loadingBalances:u,dragType:h,draggedId:m,dragOverId:g,dragOverGroupId:_,editingCategoryId:v,setEditingCategoryId:b,createForGroupId:w,setCreateForGroupId:C,editingGroupId:R,setEditingGroupId:N,handleCreateCategory:B,handleUpdateCategory:H,handleDeleteCategory:F,handleMoveCategory:ae,handleUpdateGroup:te,handleDeleteGroup:he,handleMoveGroup:L,handleCategoryDragStart:I,handleCategoryDragOver:D,handleDragOverGroup:k,handleDragLeave:O,handleDragLeaveGroup:j,handleDragEnd:T,handleCategoryDrop:Z,handleDropOnGroup:U,handleGroupDragStart:z,handleGroupDrop:q,setDragOverId:K,setDragOverGroupId:ee,isMobile:X,categories:P}){const W=h==="group"&&m===t.id,Y=h==="group"&&g===t.id,Q=h==="category"&&_===t.id,fe=m&&h==="category"?P[m]:null,ce=fe&&(fe.category_group_id||"ungrouped")!==t.id,me=h==="group"&&Y&&m!==t.id,ge=e>0,Ee=e<i.length-1;return d.jsxs("div",{children:[h==="group"&&!W&&d.jsxs("div",{onDragOver:re=>{re.preventDefault(),K(t.id)},onDragLeave:O,onDrop:re=>q(re,t.id),style:{position:"relative",height:me?"2.5rem":"0.5rem",marginBottom:me?"-0.5rem":"-0.25rem",transition:"height 0.15s"},children:[d.jsx("div",{style:{position:"absolute",top:"50%",left:0,right:0,height:"3px",background:de.primary,borderRadius:"2px",opacity:me?1:0,transition:"opacity 0.15s",boxShadow:me?"0 0 8px rgba(100, 108, 255, 0.6)":"none"}}),me&&d.jsx("span",{style:{position:"absolute",top:"50%",left:"50%",transform:"translate(-50%, -50%)",fontSize:"0.75rem",opacity:.7,background:"var(--background, #1a1a1a)",padding:"0 0.5rem",whiteSpace:"nowrap"},children:"Drop here"})]}),d.jsx("div",{onDragOver:re=>k(re,t.id),onDragLeave:j,onDrop:re=>U(re,t.id),style:{background:W?"color-mix(in srgb, currentColor 3%, transparent)":Q&&ce?`color-mix(in srgb, ${de.primary} 10%, transparent)`:"color-mix(in srgb, currentColor 5%, transparent)",borderRadius:"12px",padding:"1rem",opacity:W?.5:1,border:Q&&ce?`2px dashed ${de.primary}`:"2px solid transparent",transition:"all 0.15s"},children:R===t.id?d.jsx(pT,{initialData:{name:t.name},onSubmit:re=>te(t.id,re),onCancel:()=>N(null),submitLabel:"Save"}):d.jsxs(d.Fragment,{children:[d.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:X?"0.5rem":"0.75rem",paddingBottom:"0.5rem",borderBottom:"1px solid color-mix(in srgb, currentColor 15%, transparent)",gap:"0.5rem",flexWrap:X?"wrap":"nowrap"},children:[d.jsxs("h3",{style:{...Il,margin:0,display:"flex",alignItems:"center",gap:"0.5rem",flex:1,minWidth:0},children:[!X&&d.jsx("span",{draggable:!0,onDragStart:re=>z(re,t.id),onDragEnd:T,style:{cursor:"grab",opacity:.4,padding:"0.25rem",margin:"-0.25rem",borderRadius:"4px",userSelect:"none"},title:"Drag to reorder group",children:""}),d.jsx("span",{style:{overflow:"hidden",textOverflow:"ellipsis",whiteSpace:"nowrap"},children:t.name}),d.jsxs("span",{style:{opacity:.5,fontWeight:400,fontSize:"0.9rem",flexShrink:0},children:["(",n.length,")"]})]}),d.jsxs("div",{style:{display:"flex",gap:"0.5rem",flexShrink:0,alignItems:"center"},children:[!X&&d.jsx(Oe,{variant:"small",actionName:`Open Add Category Form (${t.name})`,onClick:()=>C(t.id),disabled:w!==null,children:"+ Category"}),d.jsx("button",{onClick:()=>{t.name,N(t.id)},style:{background:"transparent",border:"none",cursor:"pointer",opacity:.6,fontSize:"0.9rem",padding:"0.25rem"},title:"Edit group",children:""}),d.jsx("button",{onClick:()=>{t.name,he(t.id)},style:{background:"transparent",border:"none",cursor:"pointer",opacity:.6,fontSize:"0.9rem",padding:"0.25rem"},title:"Delete group",children:""}),d.jsxs("div",{style:My,children:[d.jsx("button",{onClick:()=>L(t.id,"up"),disabled:!ge,style:{...ul,opacity:ge?.6:.2,cursor:ge?"pointer":"default"},title:"Move group up","aria-label":"Move group up",children:""}),d.jsx("button",{onClick:()=>L(t.id,"down"),disabled:!Ee,style:{...ul,opacity:Ee?.6:.2,cursor:Ee?"pointer":"default"},title:"Move group down","aria-label":"Move group down",children:""})]})]})]}),X&&d.jsx("div",{style:{marginBottom:"0.5rem"},children:d.jsx(Oe,{variant:"small",actionName:`Open Add Category Form (${t.name})`,onClick:()=>C(t.id),disabled:w!==null,children:"+ Category"})}),d.jsxs("div",{style:dl,children:[n.map(([re,ke])=>v===re?d.jsx(qh,{initialData:{name:ke.name,description:ke.description,category_group_id:ke.category_group_id,default_monthly_amount:ke.default_monthly_amount,default_monthly_type:ke.default_monthly_type},onSubmit:Ve=>H(re,Ve),onCancel:()=>b(null),submitLabel:"Save",categoryGroups:a,showGroupSelector:!0},re):d.jsx(vf,{isDragging:h==="category"&&m===re,isDragOver:g===re,onDragStart:Ve=>{Ve.stopPropagation(),I(Ve,re)},onDragOver:Ve=>D(Ve,re,t.id),onDragLeave:O,onDragEnd:T,onDrop:Ve=>Z(Ve,re,t.id),onEdit:()=>{ke.name,b(re)},onDelete:()=>{ke.name,F(re)},onMoveUp:()=>ae(re,"up"),onMoveDown:()=>ae(re,"down"),canMoveUp:n.findIndex(([Ve])=>Ve===re)>0,canMoveDown:n.findIndex(([Ve])=>Ve===re)<n.length-1,children:d.jsx(yT,{category:ke,catId:re,categoryBalances:l,loadingBalances:u})},re)),n.length===0&&!w&&d.jsx("p",{style:{opacity:.5,fontSize:"0.9rem",margin:"0.5rem 0"},children:"No categories in this group"}),h==="category"&&n.length>0&&d.jsx(gT,{groupId:t.id,isActive:g===`__end__${t.id}`,onDragOver:re=>{re.preventDefault(),re.stopPropagation(),K(`__end__${t.id}`),ee(t.id)},onDragLeave:re=>{re.stopPropagation(),K(null)},onDrop:re=>{re.stopPropagation(),Z(re,"__group_end__",t.id)}}),w===t.id&&d.jsx(qh,{initialData:{name:"",category_group_id:t.id},onSubmit:re=>B(re,t.id),onCancel:()=>C(null),submitLabel:"Create",categoryGroups:a})]}),w!==t.id&&d.jsx("div",{style:{marginTop:"0.75rem",paddingTop:"0.5rem",borderTop:"1px solid color-mix(in srgb, currentColor 10%, transparent)"},children:d.jsx(Oe,{variant:"small",actionName:`Open Add Category Form (${t.name})`,onClick:()=>C(t.id),disabled:w!==null,children:"+ Add Category"})})]})})]})}function yT({category:t,catId:e,categoryBalances:n,loadingBalances:i}){const a=n[e]||{current:0,total:0};return d.jsxs("div",{children:[d.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"0.75rem",flexWrap:"wrap"},children:[d.jsx("span",{style:ky,children:t.name}),t.default_monthly_amount!==void 0&&t.default_monthly_amount>0&&d.jsxs("span",{style:{fontSize:"0.75rem",opacity:.8,background:"color-mix(in srgb, currentColor 10%, transparent)",padding:"0.15rem 0.4rem",borderRadius:"4px"},children:["Default: ",t.default_monthly_type==="percentage"?d.jsxs(d.Fragment,{children:[d.jsxs("span",{style:{color:de.success,fontWeight:500},children:[t.default_monthly_amount,"%"]})," of prev income"]}):d.jsxs(d.Fragment,{children:[d.jsx("span",{style:{color:de.success,fontWeight:500},children:Re(t.default_monthly_amount)}),"/mo"]})]})]}),t.description&&d.jsx("p",{style:{margin:"0.25rem 0 0 0",fontSize:"0.8rem",opacity:.6,lineHeight:1.3},children:t.description}),d.jsxs("div",{style:{marginTop:"0.25rem"},children:[d.jsxs("p",{style:{margin:0,fontSize:"1rem",fontWeight:600,color:Pt(a.current)},children:[i?"...":Re(a.current),d.jsx("span",{style:{fontSize:"0.75rem",fontWeight:400,opacity:.6,marginLeft:"0.35rem"},children:"available now"})]}),d.jsxs("p",{style:{margin:"0.15rem 0 0 0",fontSize:"0.85rem",fontWeight:500,color:Pt(a.total),opacity:.75},children:[i?"...":Re(a.total),d.jsx("span",{style:{fontSize:"0.7rem",fontWeight:400,opacity:.7,marginLeft:"0.35rem"},children:"total allocated"})]})]})]})}function e6({ungroupedCategories:t,categoryGroups:e,categoryBalances:n,loadingBalances:i,dragType:a,draggedId:l,dragOverId:u,dragOverGroupId:h,editingCategoryId:m,setEditingCategoryId:g,createForGroupId:_,setCreateForGroupId:v,handleCreateCategory:b,handleUpdateCategory:w,handleDeleteCategory:C,handleMoveCategory:R,handleCategoryDragStart:N,handleCategoryDragOver:B,handleDragOverGroup:H,handleDragLeaveGroup:F,handleDragLeave:ae,handleDragEnd:te,handleCategoryDrop:he,handleDropOnGroup:L,setDragOverId:I,setDragOverGroupId:D,categories:k,hasGroups:O}){const j=a==="category"&&h==="ungrouped",T=l&&a==="category"?k[l]:null,Z=T&&T.category_group_id!==null;return t.length===0&&!_&&O&&a!=="category"?null:d.jsxs("div",{onDragOver:U=>H(U,"ungrouped"),onDragLeave:F,onDrop:U=>L(U,"ungrouped"),style:{background:j&&Z?`color-mix(in srgb, ${de.primary} 10%, transparent)`:"color-mix(in srgb, currentColor 5%, transparent)",borderRadius:"12px",padding:"1rem",border:j&&Z?`2px dashed ${de.primary}`:"2px solid transparent",transition:"all 0.15s"},children:[d.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:"0.75rem",paddingBottom:"0.5rem",borderBottom:"1px solid color-mix(in srgb, currentColor 15%, transparent)"},children:[d.jsxs("h3",{style:{...Il,margin:0,opacity:.7},children:["Uncategorized",d.jsxs("span",{style:{marginLeft:"0.5rem",opacity:.5,fontWeight:400,fontSize:"0.9rem"},children:["(",t.length,")"]})]}),d.jsx(Oe,{variant:"small",actionName:"Open Add Category Form (Uncategorized)",onClick:()=>v("ungrouped"),disabled:_!==null,children:"+ Category"})]}),d.jsxs("div",{style:dl,children:[t.map(([U,z])=>m===U?d.jsx(qh,{initialData:{name:z.name,description:z.description,category_group_id:z.category_group_id,default_monthly_amount:z.default_monthly_amount,default_monthly_type:z.default_monthly_type},onSubmit:q=>w(U,q),onCancel:()=>g(null),submitLabel:"Save",categoryGroups:e,showGroupSelector:!0},U):d.jsx(vf,{isDragging:a==="category"&&l===U,isDragOver:u===U,onDragStart:q=>N(q,U),onDragOver:q=>B(q,U,"ungrouped"),onDragLeave:ae,onDragEnd:te,onDrop:q=>he(q,U,"ungrouped"),onEdit:()=>{z.name,g(U)},onDelete:()=>{z.name,C(U)},onMoveUp:()=>R(U,"up"),onMoveDown:()=>R(U,"down"),canMoveUp:t.findIndex(([q])=>q===U)>0,canMoveDown:t.findIndex(([q])=>q===U)<t.length-1,children:d.jsx(yT,{category:z,catId:U,categoryBalances:n,loadingBalances:i})},U)),t.length===0&&a==="category"&&d.jsx("p",{style:{opacity:.5,fontSize:"0.9rem",margin:"0.5rem 0",textAlign:"center"},children:"Drop here to uncategorize"}),a==="category"&&t.length>0&&d.jsx(gT,{groupId:"ungrouped",isActive:u==="__end__ungrouped",onDragOver:U=>{U.preventDefault(),U.stopPropagation(),I("__end__ungrouped"),D("ungrouped")},onDragLeave:U=>{U.stopPropagation(),I(null)},onDrop:U=>{U.stopPropagation(),he(U,"__group_end__","ungrouped")}}),_==="ungrouped"&&d.jsx(qh,{initialData:{name:"",category_group_id:null},onSubmit:U=>b(U,"ungrouped"),onCancel:()=>v(null),submitLabel:"Create",categoryGroups:e})]}),_!=="ungrouped"&&d.jsx("div",{style:{marginTop:"0.75rem",paddingTop:"0.5rem",borderTop:"1px solid color-mix(in srgb, currentColor 10%, transparent)"},children:d.jsx(Oe,{variant:"small",actionName:"Open Add Category Form (Uncategorized)",onClick:()=>v("ungrouped"),disabled:_!==null,children:"+ Add Category"})})]})}function t6(){const{currentBudget:t,categories:e,categoryGroups:n,categoriesByGroup:i,sortedGroups:a,categoryBalances:l,isLoading:u,loadingBalances:h,error:m,setError:g,getOnBudgetTotal:_,handleCreateCategory:v,handleUpdateCategory:b,handleDeleteCategory:w,handleMoveCategory:C,handleCreateGroup:R,handleUpdateGroup:N,handleDeleteGroup:B,handleMoveGroup:H,dragType:F,draggedId:ae,dragOverId:te,dragOverGroupId:he,setDragOverId:L,setDragOverGroupId:I,handleCategoryDragStart:D,handleCategoryDragOver:k,handleDragOverGroup:O,handleDragLeave:j,handleDragLeaveGroup:T,handleDragEnd:Z,handleCategoryDrop:U,handleDropOnGroup:z,handleGroupDragStart:q,handleGroupDrop:K}=gP(),ee=es(),[X,P]=A.useState(null),[W,Y]=A.useState(null),[Q,fe]=A.useState(null),[ce,me]=A.useState(!1);return t?u?d.jsxs("div",{children:[d.jsx("h2",{style:{marginTop:0},children:"Categories & Groups"}),d.jsx("p",{style:iu,children:"Organize your spending categories into groups."}),d.jsx("div",{style:{display:"flex",justifyContent:"center",alignItems:"center",minHeight:"200px",opacity:.7},children:d.jsx("p",{children:"Loading..."})})]}):d.jsxs("div",{children:[d.jsx("h2",{style:{marginTop:0},children:"Categories & Groups"}),d.jsxs("p",{style:iu,children:["Organize your spending categories into groups.",d.jsx("br",{}),d.jsx("span",{style:{fontSize:"0.9rem"},children:ee?"Use  buttons to reorder items, or drag to move between groups.":"Drag categories between groups, or use  buttons to reorder."})]}),m&&d.jsx(jl,{message:m,onDismiss:()=>g(null)}),d.jsx("div",{style:{display:"flex",justifyContent:"flex-end",marginBottom:"1rem"},children:d.jsx(zy,{})}),(()=>{const ge=Object.values(l).reduce((jt,Ot)=>jt+Ot.current,0),Ee=Object.values(l).reduce((jt,Ot)=>jt+Ot.total,0),re=_()-ge,ke=_()-Ee,Ve=Math.abs(Ee-ge)>.01;return d.jsxs("div",{style:{display:"flex",gap:"1rem",marginBottom:"1rem",flexWrap:"wrap"},children:[d.jsxs(Nc,{style:{flex:1,minWidth:"120px"},children:[d.jsx("p",{style:{margin:0,fontSize:"0.85rem",opacity:.7},children:"Categories"}),d.jsx("p",{style:{margin:"0.25rem 0 0 0",fontSize:"1.4rem",fontWeight:600},children:Object.keys(e).length})]}),d.jsxs(Nc,{style:{flex:1,minWidth:"120px"},children:[d.jsx("p",{style:{margin:0,fontSize:"0.85rem",opacity:.7},children:"Groups"}),d.jsx("p",{style:{margin:"0.25rem 0 0 0",fontSize:"1.4rem",fontWeight:600},children:n.length})]}),d.jsxs(Nc,{style:{flex:1,minWidth:"120px"},children:[d.jsx("p",{style:{margin:0,fontSize:"0.85rem",opacity:.7},children:"On-Budget"}),d.jsx("p",{style:{margin:"0.25rem 0 0 0",fontSize:"1.4rem",fontWeight:600,color:Pt(_())},children:Re(_())})]}),d.jsxs(Nc,{style:{flex:1,minWidth:"120px"},children:[d.jsx("p",{style:{margin:0,fontSize:"0.85rem",opacity:.7},children:"Allocated Now"}),d.jsx("p",{style:{margin:"0.25rem 0 0 0",fontSize:"1.4rem",fontWeight:600,color:de.primary},children:h?"...":Re(ge)}),Ve&&d.jsx("p",{style:{margin:"0.1rem 0 0 0",fontSize:"0.75rem",opacity:.6},children:h?"":`${Re(Ee)} total`})]}),d.jsxs(Nc,{style:{flex:1,minWidth:"120px"},children:[d.jsx("p",{style:{margin:0,fontSize:"0.85rem",opacity:.7},children:"Available Now"}),d.jsx("p",{style:{margin:"0.25rem 0 0 0",fontSize:"1.4rem",fontWeight:600,color:Pt(re)},children:h?"...":Re(re)}),Ve&&d.jsx("p",{style:{margin:"0.1rem 0 0 0",fontSize:"0.75rem",opacity:.6},children:h?"":`${Re(ke)} after future`})]})]})})(),d.jsxs("div",{style:{display:"flex",flexDirection:"column",gap:"1rem",marginBottom:"1.5rem"},children:[Object.keys(e).length===0&&n.length===0&&d.jsx("p",{style:{opacity:.7},children:"No categories yet. Create a group first, then add categories!"}),a.map((ge,Ee)=>{const re=(i[ge.id]||[]).sort((ke,Ve)=>ke[1].sort_order-Ve[1].sort_order);return d.jsx(ZP,{group:ge,groupIndex:Ee,groupCategories:re,sortedGroups:a,categoryGroups:n,categoryBalances:l,loadingBalances:h,dragType:F,draggedId:ae,dragOverId:te,dragOverGroupId:he,editingCategoryId:X,setEditingCategoryId:P,createForGroupId:W,setCreateForGroupId:Y,editingGroupId:Q,setEditingGroupId:fe,handleCreateCategory:v,handleUpdateCategory:b,handleDeleteCategory:w,handleMoveCategory:C,handleUpdateGroup:N,handleDeleteGroup:B,handleMoveGroup:H,handleCategoryDragStart:D,handleCategoryDragOver:k,handleDragOverGroup:O,handleDragLeave:j,handleDragLeaveGroup:T,handleDragEnd:Z,handleCategoryDrop:U,handleDropOnGroup:z,handleGroupDragStart:q,handleGroupDrop:K,setDragOverId:L,setDragOverGroupId:I,isMobile:ee,categories:e},ge.id)}),F==="group"&&a.length>0&&d.jsx(Py,{isActive:te==="__end__",onDragOver:ge=>{ge.preventDefault(),L("__end__")},onDragLeave:j,onDrop:ge=>K(ge,"__end__"),label:"Move group to end"}),d.jsx(e6,{ungroupedCategories:(i.ungrouped||[]).sort((ge,Ee)=>ge[1].sort_order-Ee[1].sort_order),categoryGroups:n,categoryBalances:l,loadingBalances:h,dragType:F,draggedId:ae,dragOverId:te,dragOverGroupId:he,editingCategoryId:X,setEditingCategoryId:P,createForGroupId:W,setCreateForGroupId:Y,handleCreateCategory:v,handleUpdateCategory:b,handleDeleteCategory:w,handleMoveCategory:C,handleCategoryDragStart:D,handleCategoryDragOver:k,handleDragOverGroup:O,handleDragLeaveGroup:T,handleDragLeave:j,handleDragEnd:Z,handleCategoryDrop:U,handleDropOnGroup:z,setDragOverId:L,setDragOverGroupId:I,categories:e,hasGroups:n.length>0})]}),ce?d.jsx(pT,{onSubmit:ge=>{R(ge),me(!1)},onCancel:()=>me(!1),submitLabel:"Create Group"}):d.jsx(Oe,{variant:"primary-large",actionName:"Open Add Category Group Form",onClick:()=>me(!0),children:"+ Add Category Group"})]}):d.jsx("p",{children:"No budget found. Please log in."})}const n6=["accounts","categories","users"];function r6(){const{selectedBudgetId:t,currentUserId:e,lastSettingsTab:n,setLastSettingsTab:i}=Tn(),{isOwner:a,isLoading:l}=Hn(t,e),u=kn(),h=u.pathname==="/budget/settings",m=A.useMemo(()=>{const w=u.pathname;return w.includes("/settings/accounts")?"accounts":w.includes("/settings/categories")?"categories":w.includes("/settings/users")?"users":"categories"},[u.pathname]),g=m==="users";A.useEffect(()=>{h||i(m)},[m,h,i]);function _(){return!n6.includes(n)||n==="users"&&!a?"categories":n}const v=A.useMemo(()=>[{id:"accounts",label:"Accounts",icon:""},{id:"categories",label:"Categories",icon:""},{id:"users",label:"Users",icon:"",hidden:!a}],[a]);return l?d.jsx("div",{style:Gn,children:d.jsx("p",{children:"Loading..."})}):!a&&g?d.jsxs("div",{style:Gn,children:[d.jsx(vi,{title:"Budget Settings"}),d.jsx("h1",{children:"Access Denied"}),d.jsx("p",{style:{opacity:.7},children:"Only the budget owner can access this section."}),d.jsx("p",{style:{marginTop:"1rem"},children:d.jsx(Dt,{to:"/budget/settings/categories",style:{color:"#646cff"},children:"Go to Categories "})})]}):d.jsxs("div",{style:Gn,children:[d.jsx(vi,{title:"Budget Settings"}),d.jsx(Ly,{mode:"link",linkPrefix:"/budget/settings",tabs:v,activeTab:h?_():m}),h?d.jsx(Hh,{to:`/budget/settings/${_()}`,replace:!0}):d.jsx(Qh,{})]})}function i6(){const{selectedBudgetId:t,currentUserId:e}=Tn(),{budget:n,budgetUserIds:i,acceptedUserIds:a,inviteUser:l,revokeUser:u}=Hn(t,e),[h,m]=A.useState(""),[g,_]=A.useState(!1),[v,b]=A.useState(null),[w,C]=A.useState(null);if(!n)return d.jsx("p",{children:"No budget found."});async function R(F){if(F.preventDefault(),!(!h.trim()||!n)){_(!0),b(null),C(null);try{await l(h.trim()),m(""),C("Invite sent! The user can now accept the invitation from their account.")}catch(ae){b(ae instanceof Error?ae.message:"Failed to invite user")}finally{_(!1)}}}async function N(F){if(!n)return;if(F===n.owner_id){b("Cannot revoke the budget owner");return}if(F===e){b("Cannot revoke yourself from the budget");return}const ae=a.includes(F);if(confirm(ae?"Are you sure you want to revoke this user's access? They will lose access to this budget.":"Are you sure you want to cancel this invitation?")){b(null),C(null);try{await u(F),C(ae?"User access revoked.":"Invitation cancelled.")}catch(he){b(he instanceof Error?he.message:"Failed to revoke user")}}}const B=i.filter(F=>a.includes(F)),H=i.filter(F=>!a.includes(F));return d.jsxs("div",{children:[d.jsx("h2",{style:{marginTop:0},children:"Budget Users"}),d.jsx("p",{style:{opacity:.7,marginBottom:"1.5rem"},children:"Invite users to access this budget. They must accept the invitation before they can access it."}),v&&d.jsxs("div",{style:{background:"rgba(220, 38, 38, 0.1)",border:"1px solid rgba(220, 38, 38, 0.3)",color:"#f87171",padding:"0.75rem 1rem",borderRadius:"8px",marginBottom:"1rem",display:"flex",justifyContent:"space-between",alignItems:"center"},children:[d.jsx("span",{children:v}),d.jsx("button",{onClick:()=>b(null),style:{background:"transparent",border:"none",color:"#f87171",cursor:"pointer",fontSize:"1.2rem",padding:"0 0.25rem",lineHeight:1},children:""})]}),w&&d.jsxs("div",{style:{background:"rgba(34, 197, 94, 0.1)",border:"1px solid rgba(34, 197, 94, 0.3)",color:"#4ade80",padding:"0.75rem 1rem",borderRadius:"8px",marginBottom:"1rem",display:"flex",justifyContent:"space-between",alignItems:"center"},children:[d.jsx("span",{children:w}),d.jsx("button",{onClick:()=>C(null),style:{background:"transparent",border:"none",color:"#4ade80",cursor:"pointer",fontSize:"1.2rem",padding:"0 0.25rem",lineHeight:1},children:""})]}),d.jsxs("div",{style:{background:"color-mix(in srgb, currentColor 5%, transparent)",padding:"1.25rem",borderRadius:"8px",marginBottom:"1.5rem"},children:[d.jsxs("h3",{style:{margin:"0 0 1rem 0",fontSize:"1rem"},children:["Active Users (",B.length,")"]}),B.length===0?d.jsx("p",{style:{opacity:.6,margin:0},children:"No users have accepted invitations yet."}):d.jsx("div",{style:{display:"flex",flexDirection:"column",gap:"0.5rem"},children:B.map(F=>{const ae=F===n.owner_id,te=F===e;return d.jsxs("div",{style:{background:"color-mix(in srgb, currentColor 8%, transparent)",padding:"0.75rem 1rem",borderRadius:"6px",display:"flex",justifyContent:"space-between",alignItems:"center",gap:"1rem"},children:[d.jsx("div",{style:{flex:1,minWidth:0},children:d.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"0.5rem",flexWrap:"wrap"},children:[d.jsx("code",{style:{fontSize:"0.85rem",background:"color-mix(in srgb, currentColor 10%, transparent)",padding:"0.2rem 0.5rem",borderRadius:"4px",wordBreak:"break-all"},children:F}),ae&&d.jsx("span",{style:{background:"color-mix(in srgb, #646cff 20%, transparent)",color:"#a5b4fc",padding:"0.15rem 0.5rem",borderRadius:"4px",fontSize:"0.7rem",textTransform:"uppercase",fontWeight:600},children:"Owner"}),te&&d.jsx("span",{style:{background:"color-mix(in srgb, #22c55e 20%, transparent)",color:"#4ade80",padding:"0.15rem 0.5rem",borderRadius:"4px",fontSize:"0.7rem",textTransform:"uppercase",fontWeight:600},children:"You"})]})}),!ae&&!te&&d.jsx("button",{onClick:()=>N(F),style:{background:"transparent",border:"1px solid rgba(220, 38, 38, 0.4)",color:"#f87171",padding:"0.4rem 0.75rem",borderRadius:"6px",cursor:"pointer",fontSize:"0.8rem",whiteSpace:"nowrap"},children:"Revoke Access"})]},F)})})]}),H.length>0&&d.jsxs("div",{style:{background:"color-mix(in srgb, currentColor 5%, transparent)",padding:"1.25rem",borderRadius:"8px",marginBottom:"1.5rem"},children:[d.jsxs("h3",{style:{margin:"0 0 1rem 0",fontSize:"1rem"},children:["Pending Invitations (",H.length,")"]}),d.jsx("div",{style:{display:"flex",flexDirection:"column",gap:"0.5rem"},children:H.map(F=>d.jsxs("div",{style:{background:"color-mix(in srgb, #f59e0b 10%, transparent)",border:"1px solid color-mix(in srgb, #f59e0b 30%, transparent)",padding:"0.75rem 1rem",borderRadius:"6px",display:"flex",justifyContent:"space-between",alignItems:"center",gap:"1rem"},children:[d.jsx("div",{style:{flex:1,minWidth:0},children:d.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"0.5rem",flexWrap:"wrap"},children:[d.jsx("code",{style:{fontSize:"0.85rem",background:"color-mix(in srgb, currentColor 10%, transparent)",padding:"0.2rem 0.5rem",borderRadius:"4px",wordBreak:"break-all"},children:F}),d.jsx("span",{style:{background:"color-mix(in srgb, #f59e0b 20%, transparent)",color:"#fbbf24",padding:"0.15rem 0.5rem",borderRadius:"4px",fontSize:"0.7rem",textTransform:"uppercase",fontWeight:600},children:"Pending"})]})}),d.jsx("button",{onClick:()=>N(F),style:{background:"transparent",border:"1px solid color-mix(in srgb, currentColor 30%, transparent)",color:"inherit",padding:"0.4rem 0.75rem",borderRadius:"6px",cursor:"pointer",fontSize:"0.8rem",whiteSpace:"nowrap",opacity:.8},children:"Cancel Invite"})]},F))})]}),d.jsxs("div",{style:{background:"color-mix(in srgb, currentColor 5%, transparent)",padding:"1.25rem",borderRadius:"8px"},children:[d.jsx("h3",{style:{margin:"0 0 1rem 0",fontSize:"1rem"},children:"Invite User"}),d.jsxs("form",{onSubmit:R,style:{display:"flex",gap:"0.75rem"},children:[d.jsx("input",{type:"text",value:h,onChange:F=>m(F.target.value),placeholder:"Enter Firebase User ID",style:{flex:1,padding:"0.6rem 0.8rem",borderRadius:"6px",border:"1px solid color-mix(in srgb, currentColor 20%, transparent)",background:"color-mix(in srgb, currentColor 5%, transparent)",fontSize:"0.95rem",color:"inherit"}}),d.jsx("button",{type:"submit",disabled:g||!h.trim(),style:{background:"#646cff",color:"white",border:"none",padding:"0.6rem 1.25rem",borderRadius:"6px",cursor:g||!h.trim()?"not-allowed":"pointer",fontWeight:500,opacity:g||!h.trim()?.7:1,whiteSpace:"nowrap"},children:g?"Inviting...":"Send Invite"})]}),d.jsx("p",{style:{margin:"1rem 0 0 0",fontSize:"0.85rem",opacity:.6},children:" The invited user will need to accept the invitation from their Account page using this budget's ID:"}),d.jsx("code",{style:{display:"block",marginTop:"0.5rem",padding:"0.5rem 0.75rem",background:"color-mix(in srgb, currentColor 10%, transparent)",borderRadius:"6px",fontSize:"0.85rem",wordBreak:"break-all"},children:n.id})]})]})}const s6=["budget","feedback","migration","tests"];function a6(){const{isAdmin:t,isTest:e,lastAdminTab:n,setLastAdminTab:i}=Tn(),a=kn(),l=a.pathname==="/budget/admin",u=A.useMemo(()=>{const _=a.pathname;return _.includes("/admin/budget")?"budget":_.includes("/admin/feedback")?"feedback":_.includes("/admin/migration")?"migration":_.includes("/admin/tests")?"tests":"budget"},[a.pathname]),h=u==="tests";A.useEffect(()=>{l||i(u)},[u,l,i]);function m(){return!s6.includes(n)||n==="tests"&&!e?"budget":n}const g=A.useMemo(()=>[{id:"budget",label:"Budget",icon:""},{id:"feedback",label:"Feedback",icon:""},{id:"migration",label:"Migration",icon:""},{id:"tests",label:"Tests",icon:"",hidden:!e}],[e]);return t?!e&&h?d.jsxs("div",{style:Gn,children:[d.jsx(vi,{title:"Budget Admin"}),d.jsx("h1",{children:"Access Denied"}),d.jsx("p",{style:{opacity:.7},children:"Only test users can access this section."}),d.jsx("p",{style:{marginTop:"1rem"},children:d.jsx(Dt,{to:"/budget/admin/budget",style:{color:"#646cff"},children:"Go to Admin "})})]}):d.jsxs("div",{style:Gn,children:[d.jsx(vi,{title:"Budget Admin"}),d.jsx(Ly,{mode:"link",linkPrefix:"/budget/admin",tabs:g,activeTab:u}),l?d.jsx(Hh,{to:`/budget/admin/${m()}`,replace:!0}):d.jsx(Qh,{})]}):d.jsxs("div",{style:Gn,children:[d.jsx(vi,{title:"Budget Admin"}),d.jsx("h1",{children:"Access Denied"}),d.jsx("p",{style:{opacity:.7},children:"Only administrators can access this section."}),d.jsx("p",{style:{marginTop:"1rem"},children:d.jsx(Dt,{to:"/budget",style:{color:"#646cff"},children:"Go to Budget "})})]})}function o6(){const{selectedBudgetId:t,currentUserId:e,isAdmin:n}=Tn(),{budget:i,accounts:a,accountGroups:l,categories:u,categoryGroups:h,isOwner:m,isLoading:g}=Hn(t,e);return g?d.jsx("p",{children:"Loading budget info..."}):i?d.jsxs("div",{children:[d.jsx("h2",{style:{marginTop:0},children:"Budget Summary"}),d.jsx("p",{style:{opacity:.7,marginBottom:"1.5rem"},children:"Information about the currently selected budget."}),d.jsx("div",{style:{background:"color-mix(in srgb, currentColor 5%, transparent)",padding:"1.25rem",borderRadius:"8px",marginBottom:"1.5rem"},children:d.jsxs("div",{style:{display:"flex",flexDirection:"column",gap:"0.75rem",fontSize:"0.95rem"},children:[d.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"0.5rem"},children:[d.jsx("span",{children:""}),d.jsx("span",{style:{opacity:.7,minWidth:"80px"},children:"Name:"}),d.jsx("strong",{children:i.name})]}),d.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"0.5rem"},children:[d.jsx("span",{children:""}),d.jsx("span",{style:{opacity:.7,minWidth:"80px"},children:"ID:"}),d.jsx("code",{style:{background:"color-mix(in srgb, currentColor 10%, transparent)",padding:"0.2rem 0.5rem",borderRadius:"4px",fontSize:"0.85rem"},children:i.id})]}),d.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"0.5rem"},children:[d.jsx("span",{children:""}),d.jsx("span",{style:{opacity:.7,minWidth:"80px"},children:"Owner:"}),d.jsx("strong",{children:i.owner_email||i.owner_id})]}),d.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"0.5rem"},children:[d.jsx("span",{children:""}),d.jsx("span",{style:{opacity:.7,minWidth:"80px"},children:"Users:"}),d.jsxs("span",{children:[i.user_ids.length," user",i.user_ids.length!==1?"s":"",d.jsxs("span",{style:{opacity:.7},children:["  ",m?"You are the owner":"Shared with you"]})]})]})]})}),n&&d.jsxs("div",{style:{background:"color-mix(in srgb, currentColor 5%, transparent)",padding:"1.25rem",borderRadius:"8px"},children:[d.jsx("h3",{style:{margin:"0 0 0.75rem 0",fontSize:"1rem"},children:"Admin Tools"}),d.jsx("button",{onClick:()=>{const _={...i,accounts:a,account_groups:l,categories:u,category_groups:h,_meta:{downloaded_at:new Date().toISOString()}},v=new Blob([JSON.stringify(_,null,2)],{type:"application/json"}),b=URL.createObjectURL(v),w=document.createElement("a");w.href=b,w.download=`budget_${i.id}.json`,document.body.appendChild(w),w.click(),document.body.removeChild(w),URL.revokeObjectURL(b)},style:{display:"inline-flex",alignItems:"center",gap:"0.5rem",background:"color-mix(in srgb, currentColor 10%, transparent)",border:"1px solid color-mix(in srgb, currentColor 20%, transparent)",borderRadius:"6px",padding:"0.5rem 0.75rem",cursor:"pointer",fontSize:"0.85rem",color:"inherit",transition:"background 0.15s"},title:"Download budget document as JSON (for debugging)",children:" Download Budget JSON"})]})]}):d.jsx("p",{style:{opacity:.7},children:"No budget selected."})}function FE({budget:t,isCurrent:e,isAccepting:n,isSwitching:i,isEditing:a,editName:l,isRenaming:u,onAccept:h,onSwitch:m,onStartEdit:g,onCancelEdit:_,onEditNameChange:v,onSaveEdit:b}){const w=e&&t.isOwner;return d.jsx("div",{style:{background:e?"color-mix(in srgb, #646cff 15%, transparent)":"color-mix(in srgb, currentColor 8%, transparent)",border:e?"2px solid color-mix(in srgb, #646cff 50%, transparent)":"1px solid transparent",padding:"1rem",borderRadius:"8px"},children:a?d.jsxs("form",{onSubmit:b,children:[d.jsx("div",{style:{display:"flex",gap:"0.5rem",marginBottom:"0.5rem"},children:d.jsx("input",{type:"text",value:l,onChange:C=>v(C.target.value),placeholder:"Budget name",autoFocus:!0,style:{flex:1,padding:"0.5rem 0.75rem",borderRadius:"6px",border:"1px solid color-mix(in srgb, currentColor 30%, transparent)",background:"color-mix(in srgb, currentColor 5%, transparent)",fontSize:"1rem",fontWeight:600,color:"inherit"}})}),d.jsxs("div",{style:{display:"flex",gap:"0.5rem"},children:[d.jsx("button",{type:"submit",disabled:u||!l.trim(),style:{background:"#22c55e",color:"white",border:"none",padding:"0.4rem 0.75rem",borderRadius:"6px",cursor:u||!l.trim()?"not-allowed":"pointer",fontWeight:500,opacity:u||!l.trim()?.7:1,fontSize:"0.8rem"},children:u?"Saving...":"Save"}),d.jsx("button",{type:"button",onClick:_,disabled:u,style:{background:"transparent",color:"inherit",border:"1px solid color-mix(in srgb, currentColor 30%, transparent)",padding:"0.4rem 0.75rem",borderRadius:"6px",cursor:u?"not-allowed":"pointer",fontWeight:500,opacity:u?.7:.8,fontSize:"0.8rem"},children:"Cancel"})]})]}):d.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",gap:"1rem",flexWrap:"wrap"},children:[d.jsxs("div",{style:{flex:1,minWidth:"200px"},children:[d.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"0.5rem",flexWrap:"wrap",marginBottom:"0.25rem"},children:[d.jsx("span",{style:{fontWeight:600},children:t.name}),t.isOwner&&d.jsx("span",{style:{background:"color-mix(in srgb, #646cff 20%, transparent)",color:"#a5b4fc",padding:"0.15rem 0.5rem",borderRadius:"4px",fontSize:"0.65rem",textTransform:"uppercase",fontWeight:600},children:"Owner"}),e&&d.jsx("span",{style:{background:"color-mix(in srgb, #22c55e 20%, transparent)",color:"#4ade80",padding:"0.15rem 0.5rem",borderRadius:"4px",fontSize:"0.65rem",textTransform:"uppercase",fontWeight:600},children:"Active"}),t.isPending&&d.jsx("span",{style:{background:"color-mix(in srgb, #f59e0b 20%, transparent)",color:"#fbbf24",padding:"0.15rem 0.5rem",borderRadius:"4px",fontSize:"0.65rem",textTransform:"uppercase",fontWeight:600},children:"Pending"}),w&&d.jsx("button",{onClick:g,style:{background:"transparent",border:"none",padding:"0.15rem",cursor:"pointer",opacity:.5,fontSize:"0.8rem",lineHeight:1},title:"Rename budget",children:""})]}),d.jsx("p",{style:{margin:0,fontSize:"0.8rem",opacity:.6},children:t.ownerEmail?`Owner: ${t.ownerEmail}`:`ID: ${t.id}`})]}),d.jsx("div",{style:{display:"flex",gap:"0.5rem"},children:t.isPending?d.jsx("button",{onClick:h,disabled:n,style:{background:"#22c55e",color:"white",border:"none",padding:"0.5rem 1rem",borderRadius:"6px",cursor:n?"not-allowed":"pointer",fontWeight:500,opacity:n?.7:1,fontSize:"0.85rem"},children:n?"Accepting...":"Accept"}):e?null:d.jsx("button",{onClick:m,disabled:i,style:{background:"#646cff",color:"white",border:"none",padding:"0.5rem 1rem",borderRadius:"6px",cursor:i?"not-allowed":"pointer",fontWeight:500,opacity:i?.7:1,fontSize:"0.85rem"},children:i?"Switching...":"Switch"})})]})})}const Tg={critical_bug:{label:"Critical Bug",color:"#ff4757",bgColor:"rgba(255, 71, 87, 0.15)"},bug:{label:"Bug",color:"#ffa502",bgColor:"rgba(255, 165, 2, 0.15)"},new_feature:{label:"New Feature",color:"#2ed573",bgColor:"rgba(46, 213, 115, 0.15)"},core_feature:{label:"Core Feature",color:"#1e90ff",bgColor:"rgba(30, 144, 255, 0.15)"},qol:{label:"QOL",color:"#a55eea",bgColor:"rgba(165, 94, 234, 0.15)"}};function _T({type:t,onClick:e}){const n=t==="feature"?"new_feature":t,i=n&&n in Tg?n:"bug",a=Tg[i];return d.jsx("button",{type:"button",onClick:e,style:{padding:"0.25rem 0.5rem",borderRadius:"0.25rem",background:a.bgColor,color:a.color,fontSize:"0.7rem",fontWeight:600,textTransform:"uppercase",letterSpacing:"0.025em",flexShrink:0,border:"none",cursor:"pointer",transition:"opacity 0.15s, transform 0.15s"},onMouseEnter:l=>{l.currentTarget.style.opacity="0.8",l.currentTarget.style.transform="scale(1.05)"},onMouseLeave:l=>{l.currentTarget.style.opacity="1",l.currentTarget.style.transform="scale(1)"},title:"Click to change type",children:a.label})}function l6({item:t,isDragging:e,isDragOver:n,onDragStart:i,onDragOver:a,onDragLeave:l,onDragEnd:u,onDrop:h,onToggleDone:m,onTypeClick:g}){return d.jsxs("div",{onDragOver:_=>{_.stopPropagation(),a(_)},onDragLeave:_=>{_.stopPropagation(),l()},onDrop:_=>{_.stopPropagation(),h(_)},style:{position:"relative"},children:[d.jsx("div",{style:{...sT,opacity:n?1:0,boxShadow:n?"0 0 8px rgba(100, 108, 255, 0.6)":"none"}}),d.jsxs("div",{draggable:!0,onDragStart:i,onDragEnd:u,style:{...wu,cursor:"grab",opacity:e?.5:1,flexDirection:"column",alignItems:"stretch",gap:"0.5rem"},children:[d.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"0.75rem"},children:[d.jsx("span",{style:{...iT},children:""}),d.jsx("input",{type:"checkbox",checked:t.is_done,onChange:m,style:{width:"1.25rem",height:"1.25rem",cursor:"pointer",accentColor:de.primary,flexShrink:0}}),d.jsx(_T,{type:t.feedback_type,onClick:g})]}),d.jsxs("div",{style:{marginLeft:"3.25rem"},children:[d.jsx("p",{style:{margin:0,lineHeight:1.5},children:t.text}),d.jsxs("p",{style:{margin:"0.5rem 0 0 0",fontSize:"0.8rem",opacity:.6},children:[t.user_email,"  ",wg(t.created_at)]})]})]})]})}function c6({item:t,onToggleDone:e,onTypeClick:n}){return d.jsxs("div",{style:{...wu,opacity:.6,flexDirection:"column",alignItems:"stretch",gap:"0.5rem"},children:[d.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"0.75rem"},children:[d.jsx("input",{type:"checkbox",checked:t.is_done,onChange:e,style:{width:"1.25rem",height:"1.25rem",cursor:"pointer",accentColor:de.primary,flexShrink:0}}),d.jsx(_T,{type:t.feedback_type,onClick:n})]}),d.jsxs("div",{style:{marginLeft:"2rem"},children:[d.jsx("p",{style:{margin:0,lineHeight:1.5,textDecoration:"line-through"},children:t.text}),d.jsxs("p",{style:{margin:"0.5rem 0 0 0",fontSize:"0.8rem",opacity:.8},children:[t.user_email,"  Created: ",wg(t.created_at)]}),t.completed_at&&d.jsxs("p",{style:{margin:"0.25rem 0 0 0",fontSize:"0.8rem",color:de.success},children:[" Completed: ",wg(t.completed_at)]})]})]})}function Uy({noMargin:t}={}){return d.jsx("span",{style:{display:"inline-block",width:"14px",height:"14px",border:"2px solid rgba(255, 255, 255, 0.3)",borderTopColor:"white",borderRadius:"50%",animation:"spin 0.8s linear infinite",marginRight:t?0:"0.5rem",verticalAlign:"middle"}})}function By({title:t,description:e,status:n,statusText:i,onRefresh:a,isRefreshing:l,isBusy:u=!1,children:h,cardName:m}){const _=(()=>{switch(n){case"unknown":return{color:"#9ca3af",text:i??"Unknown"};case"clean":case"complete":return{color:"#22c55e",text:i??" Clean"};case"needs-action":return{color:"#f59e0b",text:i??"Action Needed"}}})(),v=l||u;return d.jsxs("div",{style:{background:"color-mix(in srgb, currentColor 5%, transparent)",borderRadius:"12px",padding:"1.5rem",marginBottom:"1rem"},children:[d.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"flex-start",marginBottom:"0.75rem"},children:[d.jsxs("div",{style:{flex:1},children:[d.jsx("h3",{style:{margin:"0 0 0.5rem 0"},children:t}),d.jsx("p",{style:{margin:0,opacity:.7,fontSize:"0.9rem"},children:e})]}),d.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"0.75rem",flexShrink:0},children:[n!=="unknown"&&d.jsx("span",{style:{color:_.color,fontWeight:600,fontSize:"0.9rem"},children:_.text}),d.jsxs("button",{onClick:()=>{a()},disabled:v,style:{background:"color-mix(in srgb, currentColor 10%, transparent)",color:"inherit",border:"1px solid color-mix(in srgb, currentColor 20%, transparent)",padding:"0.35rem 0.65rem",borderRadius:"6px",cursor:v?"not-allowed":"pointer",fontWeight:500,fontSize:"0.85rem",opacity:v?.6:1,display:"flex",alignItems:"center",gap:"0.3rem"},title:"Refresh status",children:[l?d.jsx(Uy,{noMargin:!0}):""," Refresh"]})]})]}),h]})}const u6={unknown:{bg:"rgba(100, 100, 100, 0.1)",border:"rgba(100, 100, 100, 0.3)",color:"#9ca3af"},clean:{bg:"rgba(34, 197, 94, 0.1)",border:"rgba(34, 197, 94, 0.3)",color:"#4ade80"},warning:{bg:"rgba(245, 158, 11, 0.1)",border:"rgba(245, 158, 11, 0.3)",color:"#fbbf24"},running:{bg:"rgba(100, 108, 255, 0.1)",border:"rgba(100, 108, 255, 0.3)",color:"#a5b4fc"},success:{bg:"rgba(34, 197, 94, 0.1)",border:"rgba(34, 197, 94, 0.3)",color:"#4ade80"}};function Mn({type:t,children:e}){const n=u6[t];return d.jsx("div",{style:{background:n.bg,border:`1px solid ${n.border}`,color:n.color,padding:"0.75rem 1rem",borderRadius:"8px",display:"flex",alignItems:"center"},children:e})}function Fy({onClick:t,disabled:e,isBusy:n,busyText:i,children:a,actionName:l}){const u=e||n;return d.jsx("button",{onClick:()=>{t()},disabled:u,style:{marginTop:"1rem",background:"#646cff",color:"white",border:"none",padding:"0.75rem 1.5rem",borderRadius:"8px",cursor:u?"not-allowed":"pointer",fontWeight:500,opacity:u?.7:1,display:"flex",alignItems:"center",gap:"0.4rem"},children:n?d.jsxs(d.Fragment,{children:[d.jsx(Uy,{noMargin:!0})," ",i??"Running..."]}):a})}function d6({hasData:t,status:e,hasIssues:n,totalIssues:i,isRunning:a,result:l,onRunCleanup:u,onRefresh:h,isRefreshing:m,disabled:g}){const _=()=>t?l&&l.errors.length===0&&(l.accountsFixed>0||l.categoriesFixed>0||l.groupsFixed>0||l.monthMapsAdded>0||l.futureMonthsDeleted>0||l.monthsFixed>0||l.oldRecalcFieldsRemoved>0)?"complete":n?"needs-action":"clean":"unknown",v=l?l.accountsFixed+l.categoriesFixed+l.groupsFixed+l.monthMapsAdded+l.futureMonthsDeleted+l.monthsFixed+l.oldRecalcFieldsRemoved:0;return d.jsx(By,{title:" Database Cleanup",description:"Validates and fixes all budget and month documents to match the expected schema. Converts legacy formats, adds missing default values, and removes invalid future months.",status:_(),onRefresh:h,isRefreshing:m,isBusy:a,children:a?d.jsx(Mn,{type:"running",children:"Running database cleanup..."}):l?d.jsx(Mn,{type:l.errors.length>0?"warning":"success",children:d.jsxs("div",{children:[l.errors.length>0?"":""," Cleanup complete",d.jsxs("ul",{style:{margin:"0.5rem 0 0 0",paddingLeft:"1.5rem",fontSize:"0.9rem"},children:[l.budgetsProcessed>0&&d.jsxs("li",{children:[l.budgetsProcessed," budget",l.budgetsProcessed!==1?"s":""," updated"]}),l.arraysConverted>0&&d.jsxs("li",{children:[l.arraysConverted," array",l.arraysConverted!==1?"s":""," converted to maps"]}),l.accountsFixed>0&&d.jsxs("li",{children:[l.accountsFixed," account",l.accountsFixed!==1?"s":""," fixed"]}),l.categoriesFixed>0&&d.jsxs("li",{children:[l.categoriesFixed," categor",l.categoriesFixed!==1?"ies":"y"," fixed"]}),l.groupsFixed>0&&d.jsxs("li",{children:[l.groupsFixed," group",l.groupsFixed!==1?"s":""," fixed"]}),l.monthMapsAdded>0&&d.jsxs("li",{children:[l.monthMapsAdded," budget",l.monthMapsAdded!==1?"s":""," got month_map added"]}),l.futureMonthsDeleted>0&&d.jsxs("li",{children:[l.futureMonthsDeleted," future month",l.futureMonthsDeleted!==1?"s":""," deleted"]}),l.monthsFixed>0&&d.jsxs("li",{children:[l.monthsFixed," month",l.monthsFixed!==1?"s":""," schema fixed"]}),l.oldRecalcFieldsRemoved>0&&d.jsxs("li",{children:[l.oldRecalcFieldsRemoved," month",l.oldRecalcFieldsRemoved!==1?"s":""," had old recalc field removed"]}),v===0&&d.jsx("li",{children:"No changes needed"})]}),l.errors.length>0&&d.jsxs(d.Fragment,{children:[d.jsx("p",{style:{margin:"0.75rem 0 0.25rem 0",fontWeight:500,color:"#ef4444"},children:"Errors:"}),d.jsxs("ul",{style:{margin:0,paddingLeft:"1.5rem",fontSize:"0.85rem",color:"#ef4444"},children:[l.errors.slice(0,5).map((b,w)=>d.jsx("li",{children:b},w)),l.errors.length>5&&d.jsxs("li",{style:{opacity:.7},children:["...and ",l.errors.length-5," more errors"]})]})]})]})}):t?n?d.jsxs(d.Fragment,{children:[d.jsx(Mn,{type:"warning",children:d.jsxs("div",{children:[d.jsxs("div",{style:{marginBottom:"0.5rem"},children:[" Found ",i," issue",i!==1?"s":""," to fix:"]}),d.jsxs("ul",{style:{margin:0,paddingLeft:"1.25rem",fontSize:"0.9rem"},children:[e.budgetsWithArrays>0&&d.jsxs("li",{children:[e.budgetsWithArrays," budget",e.budgetsWithArrays!==1?"s":""," using legacy array format"]}),e.accountsNeedingDefaults>0&&d.jsxs("li",{children:[e.accountsNeedingDefaults," account",e.accountsNeedingDefaults!==1?"s":""," missing default values"]}),e.categoriesNeedingDefaults>0&&d.jsxs("li",{children:[e.categoriesNeedingDefaults," categor",e.categoriesNeedingDefaults!==1?"ies":"y"," missing default values"]}),e.groupsNeedingDefaults>0&&d.jsxs("li",{children:[e.groupsNeedingDefaults," account group",e.groupsNeedingDefaults!==1?"s":""," missing default values"]}),e.budgetsNeedingMonthMap>0&&d.jsxs("li",{children:[e.budgetsNeedingMonthMap," budget",e.budgetsNeedingMonthMap!==1?"s":""," missing month_map"]}),e.futureMonthsToDelete.length>0&&d.jsxs("li",{children:[e.futureMonthsToDelete.length," future month",e.futureMonthsToDelete.length!==1?"s":""," to delete",d.jsxs("ul",{style:{margin:"0.25rem 0 0 0",paddingLeft:"1rem",fontSize:"0.85rem",opacity:.8},children:[e.futureMonthsToDelete.slice(0,3).map(b=>d.jsxs("li",{children:[Zo[b.month-1]," ",b.year]},b.docId)),e.futureMonthsToDelete.length>3&&d.jsxs("li",{style:{opacity:.7},children:["...and ",e.futureMonthsToDelete.length-3," more"]})]})]}),e.monthsWithSchemaIssues>0&&d.jsxs("li",{children:[e.monthsWithSchemaIssues," month",e.monthsWithSchemaIssues!==1?"s":""," with schema issues"]}),e.monthsWithOldRecalcField>0&&d.jsxs("li",{children:[e.monthsWithOldRecalcField," month",e.monthsWithOldRecalcField!==1?"s":""," with deprecated is_needs_recalculation field"]})]}),d.jsxs("p",{style:{margin:"0.75rem 0 0 0",fontSize:"0.85rem",opacity:.7},children:["Scanned ",e.totalBudgets," budgets and ",e.totalMonths," months."]})]})}),d.jsxs(Fy,{onClick:u,disabled:g,isBusy:a,busyText:"Running...",actionName:"Run Database Cleanup",children:[" Fix ",i," Issue",i!==1?"s":""]})]}):d.jsx(Mn,{type:"clean",children:d.jsxs("div",{children:[" Database is clean",d.jsxs("p",{style:{margin:"0.25rem 0 0 0",fontSize:"0.85rem",opacity:.7},children:["All ",e.totalBudgets," budgets and ",e.totalMonths," months match expected schema."]})]})}):d.jsx(Mn,{type:"unknown",children:" Status unknown  click Refresh to scan the database"})})}function h6({hasData:t,status:e,isMigrating:n,onMigrate:i,onRefresh:a,isRefreshing:l,disabled:u,migrationResult:h}){const m=e&&(e.sanitizedDocuments.length>0||e.corruptedDocuments.length>0),g=h&&(h.deletedDocuments>0||h.fixedDocuments>0),_=()=>t?g?"complete":m?"needs-action":"clean":"unknown";return d.jsx(By,{title:" Consolidate Feedback Documents",description:"Fixes corrupted feedback data and merges documents with sanitized IDs into proper email format.",status:_(),onRefresh:a,isRefreshing:l,isBusy:n,children:n?d.jsx(Mn,{type:"running",children:"Migrating feedback documents..."}):t?g?d.jsx(Mn,{type:"success",children:d.jsxs("div",{children:[" Migration complete:",d.jsxs("ul",{style:{margin:"0.5rem 0 0 0",paddingLeft:"1.25rem",fontSize:"0.9rem"},children:[h.fixedDocuments>0&&d.jsxs("li",{children:["Fixed ",h.fixedDocuments," corrupted document(s)"]}),h.deletedDocuments>0&&d.jsxs("li",{children:["Merged & deleted ",h.deletedDocuments," sanitized document(s)"]}),h.mergedItems>0&&d.jsxs("li",{children:["Merged ",h.mergedItems," feedback item(s)"]})]}),h.errors.length>0&&d.jsxs(d.Fragment,{children:[d.jsx("div",{style:{marginTop:"0.5rem"},children:" Errors:"}),d.jsx("ul",{style:{margin:"0.25rem 0 0 0",paddingLeft:"1.25rem",fontSize:"0.9rem"},children:h.errors.map((v,b)=>d.jsx("li",{children:v},b))})]})]})}):m?d.jsxs(d.Fragment,{children:[d.jsx(Mn,{type:"warning",children:d.jsxs("div",{children:[e?.corruptedDocuments&&e.corruptedDocuments.length>0&&d.jsxs(d.Fragment,{children:[d.jsxs("div",{style:{marginBottom:"0.5rem"},children:[" Found ",e.corruptedDocuments.length," corrupted document(s):"]}),d.jsx("ul",{style:{margin:"0 0 0.75rem 0",paddingLeft:"1.25rem",fontSize:"0.9rem"},children:e.corruptedDocuments.map(v=>d.jsxs("li",{children:[v," ",d.jsx("span",{style:{opacity:.6},children:"(broken arrayUnion)"})]},v))})]}),e?.sanitizedDocuments&&e.sanitizedDocuments.length>0&&d.jsxs(d.Fragment,{children:[d.jsxs("div",{style:{marginBottom:"0.5rem"},children:[" Found ",e.sanitizedDocuments.length," sanitized document(s) to merge:"]}),d.jsx("ul",{style:{margin:0,paddingLeft:"1.25rem",fontSize:"0.9rem"},children:e.sanitizedDocuments.map(v=>d.jsx("li",{children:v},v))})]})]})}),d.jsx(Fy,{onClick:i,disabled:u,isBusy:n,busyText:"Migrating...",actionName:"Run Feedback Migration",children:"Run Migration"})]}):d.jsxs(Mn,{type:"clean",children:[" No issues found. All feedback documents are healthy.",d.jsxs("span",{style:{display:"block",fontSize:"0.85rem",opacity:.7,marginTop:"0.25rem"},children:["Found ",e?.documentsFound??0," document(s) total."]})]}):d.jsx(Mn,{type:"unknown",children:" Status unknown  click Refresh to scan for issues"})})}function f6({hasData:t,monthsCount:e,budgetCount:n,monthsToDelete:i,isDeleting:a,onDelete:l,onRefresh:u,isRefreshing:h,disabled:m,deleteResult:g}){const _=()=>t?g&&g.deleted>0&&g.errors.length===0?"complete":e===0?"clean":"needs-action":"unknown",v=i.reduce((b,w)=>{const C=w.budgetId;return b[C]||(b[C]=[]),b[C].push(w),b},{});return d.jsx(By,{title:" Delete ALL Months",description:"DESTRUCTIVE: Deletes ALL month documents from Firebase for ALL budgets. This will reset all income, expenses, and allocations. Use with extreme caution!",status:_(),onRefresh:u,isRefreshing:h,isBusy:a,children:a?d.jsx(Mn,{type:"running",children:"Deleting all months..."}):g?d.jsx(Mn,{type:g.errors.length>0?"warning":"success",children:d.jsxs("div",{children:[g.errors.length>0?"":""," Deleted ",g.deleted," month",g.deleted!==1?"s":"",g.errors.length>0&&d.jsx("ul",{style:{margin:"0.5rem 0 0 0",paddingLeft:"1.5rem",fontSize:"0.85rem"},children:g.errors.map((b,w)=>d.jsx("li",{children:b},w))})]})}):t?e>0?d.jsxs(d.Fragment,{children:[d.jsx(Mn,{type:"warning",children:d.jsxs("div",{children:[d.jsxs("div",{style:{marginBottom:"0.5rem"},children:[" Found ",d.jsx("strong",{children:e})," month",e!==1?"s":""," across ",d.jsx("strong",{children:n})," budget",n!==1?"s":"",":"]}),d.jsxs("div",{style:{maxHeight:"200px",overflowY:"auto"},children:[Object.entries(v).slice(0,5).map(([b,w])=>d.jsxs("div",{style:{marginBottom:"0.5rem"},children:[d.jsxs("div",{style:{fontWeight:500,fontSize:"0.85rem"},children:["Budget: ",b.slice(0,12),"..."]}),d.jsxs("ul",{style:{margin:"0.25rem 0 0 0",paddingLeft:"1.25rem",fontSize:"0.85rem"},children:[w.slice(0,3).map(C=>d.jsxs("li",{children:[Zo[C.month-1]," ",C.year]},C.docId)),w.length>3&&d.jsxs("li",{style:{opacity:.7},children:["...and ",w.length-3," more"]})]})]},b)),Object.keys(v).length>5&&d.jsxs("div",{style:{opacity:.7,fontSize:"0.85rem",marginTop:"0.5rem"},children:["...and ",Object.keys(v).length-5," more budgets"]})]})]})}),d.jsxs(Fy,{onClick:l,disabled:m,isBusy:a,busyText:"Deleting...",actionName:"Delete All Months",children:[" Delete ALL ",e," Month",e!==1?"s":""]}),d.jsx("p",{style:{fontSize:"0.8rem",color:"#ef4444",marginTop:"0.5rem",fontWeight:500},children:" This action cannot be undone!"})]}):d.jsx(Mn,{type:"clean",children:" No month documents found in Firebase."}):d.jsx(Mn,{type:"unknown",children:" Status unknown  click Refresh to scan for months"})})}function m6(){try{localStorage.removeItem("BUDGET_APP_QUERY_CACHE"),console.log("[Cache] Cleared React Query cache from localStorage")}catch(t){console.warn("Failed to clear localStorage cache:",t)}window.location.reload()}function p6(){const e=Ka().get_current_firebase_user(),[n,i]=A.useState(!1),a=bP({currentUser:e}),l=EP({currentUser:e}),u=SP({currentUser:e,onComplete:()=>i(!0)}),h=a.isScanning||l.isScanning||u.isScanning,m=a.isRunning||l.isMigratingFeedback||u.isDeleting,g=async()=>{await Promise.all([a.scanStatus(),l.scanStatus(),u.scanStatus()])};return d.jsxs("div",{children:[d.jsx("style",{children:"@keyframes spin { to { transform: rotate(360deg); } }"}),d.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:"0.5rem"},children:[d.jsx("h2",{style:{margin:0},children:"Data Migrations"}),d.jsxs("button",{onClick:g,disabled:h||m,style:{background:"#646cff",color:"white",border:"none",padding:"0.5rem 1rem",borderRadius:"6px",cursor:h||m?"not-allowed":"pointer",fontWeight:500,opacity:h||m?.7:1,display:"flex",alignItems:"center",gap:"0.4rem",minWidth:"130px",minHeight:"36px"},children:[d.jsx("span",{style:{width:"18px",height:"18px",display:"inline-flex",justifyContent:"center",alignItems:"center",flexShrink:0},children:h?d.jsx(Uy,{noMargin:!0}):""}),"Refresh All"]})]}),d.jsx("p",{style:{opacity:.7,marginBottom:"1.5rem"},children:'Run migrations to validate and fix your database. Click "Refresh All" to scan Firestore directly.'}),d.jsx(d6,{hasData:!!a.status,status:a.status,hasIssues:a.hasIssues,totalIssues:a.totalIssues,isRunning:a.isRunning,result:a.result,onRunCleanup:a.runCleanup,onRefresh:a.scanStatus,isRefreshing:a.isScanning,disabled:!e}),d.jsx(h6,{hasData:!!l.status,status:l.status,isMigrating:l.isMigratingFeedback,onMigrate:l.migrateFeedbackDocuments,onRefresh:l.scanStatus,isRefreshing:l.isScanning,disabled:!e,migrationResult:l.feedbackMigrationResult}),d.jsx(f6,{hasData:!!u.status,monthsCount:u.status?.monthsCount??0,budgetCount:u.status?.budgetCount??0,monthsToDelete:u.status?.monthsToDelete??[],isDeleting:u.isDeleting,onDelete:u.deleteAllMonths,onRefresh:u.scanStatus,isRefreshing:u.isScanning,disabled:!e,deleteResult:u.deleteResult}),d.jsx("div",{style:{background:"color-mix(in srgb, currentColor 3%, transparent)",padding:"1rem",borderRadius:"8px",fontSize:"0.85rem"},children:d.jsxs("p",{style:{margin:0,opacity:.7},children:[d.jsx("strong",{children:"Note:"})," These migrations will process ",d.jsx("strong",{children:"all budgets and months"})," in the system, not just the ones you own or are invited to."]})}),d.jsxs("div",{style:{marginTop:"1.5rem",padding:"1rem",background:"color-mix(in srgb, #ff6b6b 10%, transparent)",borderRadius:"8px",border:"1px solid color-mix(in srgb, #ff6b6b 30%, transparent)"},children:[d.jsxs("p",{style:{margin:"0 0 0.75rem 0",fontSize:"0.9rem"},children:[d.jsx("strong",{children:" Clear All Caches"}),d.jsx("span",{style:{opacity:.7,display:"block",marginTop:"0.25rem"},children:"If you're seeing stale data after running migrations, clear all cached data and reload to fetch fresh data from Firestore."})]}),d.jsx(Oe,{variant:"danger",actionName:"Open Clear Caches Modal",onClick:()=>i(!0),style:{display:"flex",alignItems:"center",gap:"0.4rem"},children:" Clear All Caches & Reload"})]}),d.jsxs(hl,{isOpen:n,onClose:()=>i(!1),title:"Clear Caches & Reload?",children:[d.jsx("p",{style:{margin:"0 0 1rem 0",opacity:.8},children:"This will clear all cached data from localStorage and reload the page. The app will fetch fresh data from Firestore for everything."}),d.jsxs("div",{style:{display:"flex",gap:"0.75rem",justifyContent:"flex-end"},children:[d.jsx(Oe,{variant:"secondary",actionName:"Cancel Clear Caches",onClick:()=>i(!1),children:"Cancel"}),d.jsx(Oe,{variant:"danger",actionName:"Confirm Clear Caches & Reload",onClick:m6,children:"Clear & Reload"})]})]})]})}function g6(){const[t,e]=A.useState(null),[n,i]=A.useState(null),[a,l]=A.useState(null),[u,h]=A.useState(!1),[m,g]=A.useState(""),[_,v]=A.useState("bug"),[b,w]=A.useState(null),[C,R]=A.useState(null),N=A.useContext(cu),H=Ka().get_current_firebase_user(),F=JM(),{submitFeedback:ae}=aT(),{toggleFeedback:te}=G4(),{updateSortOrder:he}=H4(),L=F.data?.items||[];function I(X){X.preventDefault(),!(!m.trim()||!N.username||!H)&&(ae.mutate({userId:H.uid,userEmail:N.username,text:m.trim(),feedbackType:_,currentPath:"/settings/feedback"}),g(""),v("bug"),h(!1))}function D(X){X.is_done?k(X):w(X)}async function k(X){try{await te.mutateAsync({item:X})}catch(P){e(P instanceof Error?P.message:"Failed to update feedback")}}function O(){b&&(k(b),w(null))}async function j(X){if(C){try{const W=L.filter(Y=>Y.doc_id===C.doc_id).map(Y=>Y.id===C.id?{id:Y.id,text:Y.text,created_at:Y.created_at,is_done:Y.is_done,completed_at:Y.completed_at,sort_order:Y.sort_order,feedback_type:X}:{id:Y.id,text:Y.text,created_at:Y.created_at,is_done:Y.is_done,completed_at:Y.completed_at,sort_order:Y.sort_order,feedback_type:Y.feedback_type});await he.mutateAsync({docId:C.doc_id,items:W})}catch(P){e(P instanceof Error?P.message:"Failed to update feedback type")}R(null)}}const T=L.filter(X=>!X.is_done).sort((X,P)=>X.sort_order-P.sort_order),Z=L.filter(X=>X.is_done).sort((X,P)=>{const W=X.completed_at?new Date(X.completed_at).getTime():0;return(P.completed_at?new Date(P.completed_at).getTime():0)-W});function U(X,P){i(P),X.dataTransfer.effectAllowed="move"}function z(X,P){X.preventDefault(),P!==n&&l(P)}function q(){l(null)}function K(){i(null),l(null)}async function ee(X,P){if(X.preventDefault(),!n||n===P){K();return}const W=T.findIndex(me=>me.id===n),Y=[...T],[Q]=Y.splice(W,1);if(P==="__end__")Y.push(Q);else{const me=Y.findIndex(ge=>ge.id===P);Y.splice(me,0,Q)}const fe=Y.map((me,ge)=>({...me,sort_order:ge}));K();const ce=new Map;for(const me of fe)ce.has(me.doc_id)||ce.set(me.doc_id,[]),ce.get(me.doc_id).push({id:me.id,text:me.text,created_at:me.created_at,is_done:me.is_done,completed_at:me.completed_at,sort_order:me.sort_order,feedback_type:me.feedback_type});for(const me of Z)ce.has(me.doc_id)||ce.set(me.doc_id,[]),ce.get(me.doc_id).push({id:me.id,text:me.text,created_at:me.created_at,is_done:me.is_done,completed_at:me.completed_at,sort_order:me.sort_order,feedback_type:me.feedback_type});try{for(const[me,ge]of ce)await he.mutateAsync({docId:me,items:ge})}catch(me){e(me instanceof Error?me.message:"Failed to save order")}}return F.isLoading?d.jsx("p",{children:"Loading feedback..."}):d.jsxs("div",{children:[d.jsx("h2",{style:{marginTop:0},children:"Feedback"}),d.jsx("p",{style:{...iu,fontSize:"0.9rem"},children:"View and manage user feedback. Drag to reorder pending items."}),t&&d.jsx(jl,{message:t,onDismiss:()=>e(null)}),d.jsxs("div",{style:dl,children:[T.length===0&&!u&&d.jsx("p",{style:{opacity:.7},children:"No pending feedback."}),T.map(X=>d.jsx(l6,{item:X,isDragging:n===X.id,isDragOver:a===X.id,onDragStart:P=>U(P,X.id),onDragOver:P=>z(P,X.id),onDragLeave:q,onDragEnd:K,onDrop:P=>ee(P,X.id),onToggleDone:()=>D(X),onTypeClick:()=>R(X)},X.id)),n&&T.length>0&&d.jsx(Py,{isActive:a==="__end__",onDragOver:X=>z(X,"__end__"),onDragLeave:q,onDrop:X=>ee(X,"__end__")})]}),u?d.jsxs(qa,{actionName:"Add Feedback",onSubmit:I,children:[d.jsx(qE,{selectedType:_,onSelect:v}),d.jsx(Ny,{value:m,onChange:X=>g(X.target.value),placeholder:"Enter your feedback, bug report, or feature request...",autoFocus:!0,required:!0}),d.jsxs(Ya,{children:[d.jsx(Oe,{type:"submit",actionName:"Add Feedback",disabled:!m.trim(),children:"Add Feedback"}),d.jsx(Oe,{type:"button",variant:"secondary",actionName:"Cancel Add Feedback",onClick:()=>{h(!1),g(""),v("bug")},children:"Cancel"})]})]}):d.jsx(Oe,{variant:"primary-large",actionName:"Open Add Feedback Form",onClick:()=>h(!0),children:"+ Add Feedback"}),Z.length>0&&d.jsx(W4,{title:"Completed",count:Z.length,children:d.jsx("div",{style:{...dl,marginTop:"0.5rem"},children:Z.map(X=>d.jsx(c6,{item:X,onToggleDone:()=>D(X),onTypeClick:()=>R(X)},X.id))})}),d.jsxs(hl,{isOpen:b!==null,onClose:()=>w(null),title:"Mark as Complete",children:[d.jsx("p",{style:{margin:"0 0 1.5rem 0"},children:"Are you sure you want to mark this feedback item as complete?"}),b&&d.jsxs("p",{style:{margin:"0 0 1.5rem 0",padding:"0.75rem",background:"rgba(255,255,255,0.05)",borderRadius:"0.5rem",fontSize:"0.9rem"},children:['"',b.text,'"']}),d.jsxs("div",{style:{display:"flex",gap:"0.75rem",justifyContent:"flex-end"},children:[d.jsx(Oe,{variant:"secondary",actionName:"Cancel Mark Complete",onClick:()=>w(null),children:"Cancel"}),d.jsx(Oe,{variant:"primary",actionName:"Confirm Mark Complete",onClick:O,children:"Mark Complete"})]})]}),d.jsxs(hl,{isOpen:C!==null,onClose:()=>R(null),title:"Change Feedback Type",children:[d.jsx("p",{style:{margin:"0 0 1rem 0",fontSize:"0.9rem",opacity:.8},children:"Select a new type for this feedback:"}),d.jsx(qE,{selectedType:C?.feedback_type||"bug",onSelect:j}),d.jsx(Oe,{variant:"secondary",actionName:"Cancel Change Feedback Type",onClick:()=>R(null),style:{width:"100%"},children:"Cancel"})]})]})}function qE({selectedType:t,onSelect:e}){return d.jsx("div",{style:{display:"flex",gap:"0.5rem",marginBottom:"0.75rem",paddingBottom:"1rem",flexWrap:"wrap"},children:["critical_bug","bug","new_feature","core_feature","qol"].map(n=>{const i=Tg[n],a=t==="feature"?"new_feature":t,l=a===n||!a&&n==="bug";return d.jsxs("button",{type:"button",onClick:()=>{i.label,e(n)},style:{flex:1,padding:"0.6rem 0.75rem",border:`2px solid ${i.color}`,borderRadius:"0.5rem",background:l?i.bgColor:"transparent",color:l?i.color:"rgba(255,255,255,0.5)",cursor:"pointer",fontWeight:l?600:400,fontSize:"0.85rem",transition:"all 0.15s ease",opacity:l?1:.5,boxShadow:l?`0 0 12px ${i.bgColor}`:"none",position:"relative"},children:[i.label,l&&d.jsx("span",{style:{position:"absolute",bottom:"-14px",left:"10%",right:"10%",height:"3px",background:"white",borderRadius:"2px"}})]},n)})})}function y6(){const{currentUserId:t}=Tn(),[e,n]=A.useState([]),[i,a]=A.useState(!1);function l(b,w){n(C=>C.map(R=>R.name===b?{...R,...w}:R))}async function u(){a(!0),n([]),n([{name:"Read unauthorized budget",status:"pending",message:"",expectedToFail:!0},{name:"Read another user's document",status:"pending",message:"",expectedToFail:!0},{name:"Read unauthorized budget month",status:"pending",message:"",expectedToFail:!0},{name:"Toggle is_admin in own permission_flags",status:"pending",message:"",expectedToFail:!0},{name:"Toggle is_test in own permission_flags",status:"pending",message:"",expectedToFail:!0},{name:"Read own user document",status:"pending",message:"",expectedToFail:!1}]),await h("Read unauthorized budget",async()=>(await ze("budgets","unauthorized_budget_test_12345","security test: attempting unauthorized budget read"),"Was able to read budget (unexpected)"),!0),await h("Read another user's document",async()=>(await ze("users","another_user_test_12345","security test: attempting unauthorized user read"),"Was able to read user document (unexpected)"),!0),await h("Read unauthorized budget month",async()=>(await ze("months","unauthorized_budget_test_12345_2024_01","security test: attempting unauthorized month read"),"Was able to read month document for unauthorized budget (unexpected)"),!0),await h("Toggle is_admin in own permission_flags",async()=>{if(!t)throw new Error("Not authenticated");const{data:w}=await ze("users",t,"security test: reading own user to get current is_admin value"),C=w?.permission_flags?.is_admin??!1;return await Na("users",t,{"permission_flags.is_admin":!C},"security test: attempting to toggle is_admin (should fail)"),`Was able to change is_admin from ${C} to ${!C} (SECURITY ISSUE!)`},!0),await h("Toggle is_test in own permission_flags",async()=>{if(!t)throw new Error("Not authenticated");const{data:w}=await ze("users",t,"security test: reading own user to get current is_test value"),C=w?.permission_flags?.is_test??!1;return await Na("users",t,{"permission_flags.is_test":!C},"security test: attempting to toggle is_test (should fail)"),`Was able to change is_test from ${C} to ${!C} (SECURITY ISSUE!)`},!0),await h("Read own user document",async()=>{if(!t)throw new Error("Not authenticated");const{exists:w}=await ze("users",t,"security test: reading own user document (should succeed)");if(w)return"Successfully read own document";throw new Error("Document does not exist")},!1),a(!1)}async function h(b,w,C){l(b,{status:"running",message:"Running..."});try{const R=await w();C?l(b,{status:"failed",message:` ${R}`}):l(b,{status:"passed",message:` ${R}`})}catch(R){const N=R instanceof Error?R.message:"Unknown error";C?l(b,{status:"passed",message:` Blocked as expected: ${N}`}):l(b,{status:"failed",message:` ${N}`})}}async function m(b){switch(e.find(C=>C.name===b)||n(C=>[...C,{name:b,status:"pending",message:"",expectedToFail:!0}]),a(!0),b){case"Read unauthorized budget":await h(b,async()=>(await ze("budgets","unauthorized_budget_test_12345","security test: attempting unauthorized budget read"),"Was able to read budget (unexpected)"),!0);break;case"Read another user's document":await h(b,async()=>(await ze("users","another_user_test_12345","security test: attempting unauthorized user read"),"Was able to read user document (unexpected)"),!0);break;case"Read unauthorized budget month":await h(b,async()=>(await ze("months","unauthorized_budget_test_12345_2024_01","security test: attempting unauthorized month read"),"Was able to read month document for unauthorized budget (unexpected)"),!0);break;case"Toggle is_admin in own permission_flags":await h(b,async()=>{if(!t)throw new Error("Not authenticated");const{data:C}=await ze("users",t,"security test: reading own user to get current is_admin value"),R=C?.permission_flags?.is_admin??!1;return await Na("users",t,{"permission_flags.is_admin":!R},"security test: attempting to toggle is_admin (should fail)"),`Was able to change is_admin from ${R} to ${!R} (SECURITY ISSUE!)`},!0);break;case"Toggle is_test in own permission_flags":await h(b,async()=>{if(!t)throw new Error("Not authenticated");const{data:C}=await ze("users",t,"security test: reading own user to get current is_test value"),R=C?.permission_flags?.is_test??!1;return await Na("users",t,{"permission_flags.is_test":!R},"security test: attempting to toggle is_test (should fail)"),`Was able to change is_test from ${R} to ${!R} (SECURITY ISSUE!)`},!0);break;case"Read own user document":await h(b,async()=>{if(!t)throw new Error("Not authenticated");const{exists:C}=await ze("users",t,"security test: reading own user document (should succeed)");if(C)return"Successfully read own document";throw new Error("Document does not exist")},!1);break}a(!1)}const g=e.filter(b=>b.status==="passed").length,_=e.filter(b=>b.status==="failed").length,v=e.length;return d.jsxs("div",{children:[d.jsx("p",{style:iu,children:'Run security tests to verify Firestore rules are working correctly. Tests that are expected to fail (blocked by security rules) should show as "passed".'}),d.jsx("div",{style:{marginBottom:"1.5rem"},children:d.jsx(Oe,{onClick:u,disabled:i,variant:"primary",children:i?"Running Tests...":"Run All Tests"})}),e.length>0&&d.jsx("div",{style:{marginBottom:"1.5rem"},children:d.jsxs("div",{style:{display:"flex",gap:"1rem",padding:"0.75rem 1rem",borderRadius:"8px",background:"color-mix(in srgb, currentColor 5%, transparent)",marginBottom:"1rem"},children:[d.jsxs("span",{children:["Total: ",d.jsx("strong",{children:v})]}),d.jsxs("span",{style:{color:de.success},children:["Passed: ",d.jsx("strong",{children:g})]}),d.jsxs("span",{style:{color:de.danger},children:["Failed: ",d.jsx("strong",{children:_})]})]})}),d.jsxs("div",{style:{display:"flex",flexDirection:"column",gap:"0.75rem"},children:[d.jsx("h3",{style:{margin:"0.5rem 0"},children:"Individual Tests"}),d.jsx(Fo,{name:"Read unauthorized budget",description:"Try to read a budget the user doesn't have access to",expectedBehavior:"Should be blocked by Firestore rules",result:e.find(b=>b.name==="Read unauthorized budget"),onRun:()=>m("Read unauthorized budget"),disabled:i}),d.jsx(Fo,{name:"Read another user's document",description:"Try to read another user's profile document",expectedBehavior:"Should be blocked by Firestore rules",result:e.find(b=>b.name==="Read another user's document"),onRun:()=>m("Read another user's document"),disabled:i}),d.jsx(Fo,{name:"Read unauthorized budget month",description:"Try to read a month document for a budget you don't have access to",expectedBehavior:"Should be blocked - months inherit budget access",result:e.find(b=>b.name==="Read unauthorized budget month"),onRun:()=>m("Read unauthorized budget month"),disabled:i}),d.jsx(Fo,{name:"Toggle is_admin in own permission_flags",description:"Try to change your admin privileges (toggles current value)",expectedBehavior:"Should be blocked - permission_flags is protected",result:e.find(b=>b.name==="Toggle is_admin in own permission_flags"),onRun:()=>m("Toggle is_admin in own permission_flags"),disabled:i}),d.jsx(Fo,{name:"Toggle is_test in own permission_flags",description:"Try to change your test privileges (toggles current value)",expectedBehavior:"Should be blocked - permission_flags is protected",result:e.find(b=>b.name==="Toggle is_test in own permission_flags"),onRun:()=>m("Toggle is_test in own permission_flags"),disabled:i}),d.jsx(Fo,{name:"Read own user document",description:"Read your own user profile document",expectedBehavior:"Should succeed - users can read their own data",result:e.find(b=>b.name==="Read own user document"),onRun:()=>m("Read own user document"),disabled:i,expectedToSucceed:!0})]}),_>0&&d.jsxs(jl,{style:{marginTop:"1.5rem"},children:[" ",_," test(s) failed! This may indicate a security vulnerability in your Firestore rules."]})]})}function Fo({name:t,description:e,expectedBehavior:n,result:i,onRun:a,disabled:l,expectedToSucceed:u}){const h=i?.status==="passed"?de.success:i?.status==="failed"?de.danger:i?.status==="running"?de.warning:"inherit";return d.jsxs("div",{style:{...wu,display:"flex",flexDirection:"column",gap:"0.5rem"},children:[d.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"flex-start",gap:"1rem"},children:[d.jsxs("div",{style:{flex:1},children:[d.jsx("h4",{style:{margin:0,fontSize:"0.95rem"},children:t}),d.jsx("p",{style:{margin:"0.25rem 0 0",opacity:.7,fontSize:"0.85rem"},children:e}),d.jsxs("p",{style:{margin:"0.25rem 0 0",fontSize:"0.8rem",color:u?de.success:de.warning},children:["Expected: ",n]})]}),d.jsx(Oe,{onClick:a,disabled:l,variant:"secondary",style:{flexShrink:0},children:i?.status==="running"?"":"Run"})]}),i&&i.status!=="pending"&&d.jsx("div",{style:{padding:"0.5rem 0.75rem",borderRadius:"6px",background:`color-mix(in srgb, ${h} 15%, transparent)`,border:`1px solid color-mix(in srgb, ${h} 30%, transparent)`,fontSize:"0.85rem",color:h},children:i.message})]})}function _6(){const{selectedBudgetId:t,currentUserId:e,accessibleBudgets:n,loadAccessibleBudgets:i,switchToBudget:a,checkBudgetInvite:l,isInitialized:u}=Tn();A.useEffect(()=>{u&&i()},[u,i]);const{budget:h,renameBudget:m,acceptInvite:g,isLoading:_}=Hn(t,e),[v,b]=A.useState(null),[w,C]=A.useState(null),[R,N]=A.useState(null),[B,H]=A.useState(null),[F,ae]=A.useState(null),[te,he]=A.useState(""),[L,I]=A.useState(!1),[D,k]=A.useState(""),[O,j]=A.useState(!1),[T,Z]=A.useState(null);async function U(Q){if(Q!==h?.id){b(Q),N(null),H(null);try{await a(Q),H("Switched to budget successfully!"),await i()}catch(fe){N(fe instanceof Error?fe.message:"Failed to switch budget")}finally{b(null)}}}async function z(Q){C(Q),N(null),H(null);try{await g(Q),H("Invitation accepted! You now have access to this budget."),await i()}catch(fe){N(fe instanceof Error?fe.message:"Failed to accept invitation")}finally{C(null)}}async function q(Q){if(Q.preventDefault(),!!D.trim()){j(!0),N(null),Z(null);try{const fe=await l(D.trim());fe?Z(fe):N("No pending invitation found for this budget ID. Make sure you've been invited by the budget owner.")}catch(fe){N(fe instanceof Error?fe.message:"Failed to check invitation")}finally{j(!1)}}}async function K(){if(T){T.budgetName,C(T.budgetId),N(null);try{await g(T.budgetId),H(`Successfully joined "${T.budgetName}"!`),Z(null),k(""),await i()}catch(Q){N(Q instanceof Error?Q.message:"Failed to accept invitation")}finally{C(null)}}}function ee(Q,fe){he(fe),ae(Q)}function X(){ae(null),he("")}async function P(Q){if(Q.preventDefault(),!(!te.trim()||!F)){te.trim(),I(!0),N(null),H(null);try{await m(te.trim()),H("Budget renamed successfully!"),ae(null),await i()}catch(fe){N(fe instanceof Error?fe.message:"Failed to rename budget")}finally{I(!1)}}}const W=n.filter(Q=>!Q.isPending),Y=n.filter(Q=>Q.isPending);return _||!u?d.jsx(el,{children:d.jsx("p",{children:"Loading your budgets..."})}):d.jsxs(el,{children:[d.jsx(vi,{title:"My Budgets"}),d.jsx("h1",{children:"My Budgets"}),d.jsx("p",{style:{opacity:.7,marginBottom:"1.5rem"},children:"Switch between budgets, accept invitations, or join a budget by ID."}),R&&d.jsxs("div",{style:{background:"rgba(220, 38, 38, 0.1)",border:"1px solid rgba(220, 38, 38, 0.3)",color:"#f87171",padding:"0.75rem 1rem",borderRadius:"8px",marginBottom:"1rem",display:"flex",justifyContent:"space-between",alignItems:"center"},children:[d.jsx("span",{children:R}),d.jsx("button",{onClick:()=>N(null),style:{background:"transparent",border:"none",color:"#f87171",cursor:"pointer",fontSize:"1.2rem",padding:"0 0.25rem",lineHeight:1},children:""})]}),B&&d.jsxs("div",{style:{background:"rgba(34, 197, 94, 0.1)",border:"1px solid rgba(34, 197, 94, 0.3)",color:"#4ade80",padding:"0.75rem 1rem",borderRadius:"8px",marginBottom:"1rem",display:"flex",justifyContent:"space-between",alignItems:"center"},children:[d.jsx("span",{children:B}),d.jsx("button",{onClick:()=>H(null),style:{background:"transparent",border:"none",color:"#4ade80",cursor:"pointer",fontSize:"1.2rem",padding:"0 0.25rem",lineHeight:1},children:""})]}),Y.length>0&&d.jsxs("div",{style:{background:"color-mix(in srgb, #f59e0b 10%, transparent)",border:"1px solid color-mix(in srgb, #f59e0b 30%, transparent)",padding:"1.25rem",borderRadius:"8px",marginBottom:"1.5rem"},children:[d.jsxs("h3",{style:{margin:"0 0 1rem 0",fontSize:"1rem",display:"flex",alignItems:"center",gap:"0.5rem"},children:[d.jsx("span",{children:""})," Pending Invitations (",Y.length,")"]}),d.jsx("div",{style:{display:"flex",flexDirection:"column",gap:"0.75rem"},children:Y.map(Q=>d.jsx(FE,{budget:Q,isCurrent:!1,isAccepting:w===Q.id,isSwitching:!1,isEditing:!1,editName:"",isRenaming:!1,onAccept:()=>z(Q.id),onSwitch:()=>{},onStartEdit:()=>{},onCancelEdit:()=>{},onEditNameChange:()=>{},onSaveEdit:()=>{}},Q.id))})]}),d.jsxs("div",{style:{background:"color-mix(in srgb, currentColor 5%, transparent)",padding:"1.25rem",borderRadius:"8px",marginBottom:"1.5rem"},children:[d.jsxs("h3",{style:{margin:"0 0 1rem 0",fontSize:"1rem",display:"flex",alignItems:"center",gap:"0.5rem"},children:[d.jsx("span",{children:""})," Your Budgets (",W.length,")"]}),W.length===0?d.jsx("p",{style:{opacity:.6,margin:0},children:"You don't have access to any budgets yet."}):d.jsx("div",{style:{display:"flex",flexDirection:"column",gap:"0.75rem"},children:W.map(Q=>{const fe=Q.id===h?.id,ce=F===Q.id;return d.jsx(FE,{budget:Q,isCurrent:fe,isAccepting:!1,isSwitching:v===Q.id,isEditing:ce,editName:ce?te:"",isRenaming:L,onAccept:()=>{},onSwitch:()=>U(Q.id),onStartEdit:()=>ee(Q.id,Q.name),onCancelEdit:X,onEditNameChange:he,onSaveEdit:P},Q.id)})})]}),d.jsxs("div",{style:{background:"color-mix(in srgb, currentColor 5%, transparent)",padding:"1.25rem",borderRadius:"8px"},children:[d.jsxs("h3",{style:{margin:"0 0 0.75rem 0",fontSize:"1rem",display:"flex",alignItems:"center",gap:"0.5rem"},children:[d.jsx("span",{children:""})," Join Budget by ID"]}),d.jsx("p",{style:{margin:"0 0 1rem 0",fontSize:"0.9rem",opacity:.7},children:"If someone shared a budget ID with you, enter it below to accept the invitation:"}),T?d.jsxs("div",{style:{background:"color-mix(in srgb, #22c55e 10%, transparent)",border:"1px solid color-mix(in srgb, #22c55e 30%, transparent)",padding:"1rem",borderRadius:"8px"},children:[d.jsx("p",{style:{margin:"0 0 0.75rem 0",fontWeight:500},children:" You've been invited to join:"}),d.jsxs("div",{style:{background:"color-mix(in srgb, currentColor 8%, transparent)",padding:"0.75rem 1rem",borderRadius:"6px",marginBottom:"1rem"},children:[d.jsx("p",{style:{margin:"0 0 0.25rem 0",fontWeight:600,fontSize:"1.1rem"},children:T.budgetName}),T.ownerEmail&&d.jsxs("p",{style:{margin:0,fontSize:"0.9rem",opacity:.7},children:["Owner: ",T.ownerEmail]})]}),d.jsxs("div",{style:{display:"flex",gap:"0.75rem"},children:[d.jsx("button",{onClick:K,disabled:w===T.budgetId,style:{background:"#22c55e",color:"white",border:"none",padding:"0.6rem 1.25rem",borderRadius:"6px",cursor:w===T.budgetId?"not-allowed":"pointer",fontWeight:500,opacity:w===T.budgetId?.7:1},children:w===T.budgetId?"Accepting...":"Accept Invitation"}),d.jsx("button",{onClick:()=>{Z(null),k("")},disabled:w===T.budgetId,style:{background:"transparent",color:"inherit",border:"1px solid color-mix(in srgb, currentColor 30%, transparent)",padding:"0.6rem 1.25rem",borderRadius:"6px",cursor:w===T.budgetId?"not-allowed":"pointer",fontWeight:500,opacity:w===T.budgetId?.7:.8},children:"Cancel"})]})]}):d.jsxs("form",{onSubmit:q,style:{display:"flex",gap:"0.75rem"},children:[d.jsx("input",{type:"text",value:D,onChange:Q=>k(Q.target.value),placeholder:"Enter Budget ID",style:{flex:1,padding:"0.6rem 0.8rem",borderRadius:"6px",border:"1px solid color-mix(in srgb, currentColor 20%, transparent)",background:"color-mix(in srgb, currentColor 5%, transparent)",fontSize:"0.95rem",color:"inherit"}}),d.jsx("button",{type:"submit",disabled:O||!D.trim(),style:{background:"#646cff",color:"white",border:"none",padding:"0.6rem 1.25rem",borderRadius:"6px",cursor:O||!D.trim()?"not-allowed":"pointer",fontWeight:500,opacity:O||!D.trim()?.7:1,whiteSpace:"nowrap"},children:O?"Checking...":"Check Invite"})]})]}),e&&d.jsxs("div",{style:{marginTop:"1.5rem",padding:"1rem",background:"color-mix(in srgb, currentColor 3%, transparent)",borderRadius:"6px",fontSize:"0.85rem",opacity:.7},children:[d.jsx("p",{style:{margin:"0 0 0.5rem 0"},children:" Share your User ID with budget owners so they can invite you:"}),d.jsx("code",{style:{display:"block",padding:"0.5rem 0.75rem",background:"color-mix(in srgb, currentColor 8%, transparent)",borderRadius:"4px",fontSize:"0.8rem",wordBreak:"break-all"},children:e})]})]})}function v6({children:t}){const e=A.useContext(cu),n=kn();return e.is_auth_checked?e.is_logged_in?t?d.jsx(d.Fragment,{children:t}):d.jsx(Qh,{}):d.jsx(Hh,{to:"/account",state:{from:n.pathname},replace:!0}):d.jsx("div",{style:Gn,children:d.jsx("p",{children:"Loading..."})})}function b6(){const{selectedBudgetId:t,currentUserId:e,isInitialized:n}=Tn(),{isLoading:i,error:a}=Hn(t,e);return n?a?(console.error("[BudgetLayout] Error:",a),d.jsx("div",{style:Gn,children:d.jsxs("p",{style:{color:"#ef4444"},children:["Error: ",a.message]})})):d.jsx("div",{style:{paddingBottom:"5rem"},children:d.jsx(Qh,{})}):d.jsxs("div",{style:Gn,children:[d.jsx("p",{children:"Loading budget..."}),i&&d.jsx("p",{style:{opacity:.6},children:"Fetching data from server..."})]})}const x6={is_logged_in:!1,is_auth_checked:!1,username:"",set_user_context:()=>{}};function E6(){const[t,e]=A.useState(x6),n=Ka(),i=A.useRef(!1);return A.useEffect(function(){i.current||(i.current=!0,n.set_user_listener(a=>{e({is_logged_in:a!=null,is_auth_checked:!0,username:a?.email??"",set_user_context:e})}))},[n]),t.is_auth_checked?d.jsx(cu.Provider,{value:t,children:d.jsx(UD,{children:d.jsx(y4,{children:d.jsxs(DR,{children:[d.jsxs(iR,{children:[d.jsx(Jt,{path:"/",element:d.jsx(V4,{})}),d.jsx(Jt,{path:"/account",element:d.jsx(tP,{})}),d.jsx(Jt,{path:"/sql-test",element:d.jsx(eP,{})}),d.jsx(Jt,{path:"/budget",element:d.jsx(v6,{}),children:d.jsxs(Jt,{element:d.jsx(b6,{}),children:[d.jsx(Jt,{index:!0,element:d.jsx(UE,{})}),d.jsx(Jt,{path:":year/:month/:tab",element:d.jsx(UE,{})}),d.jsx(Jt,{path:"analytics",element:d.jsx(HP,{})}),d.jsx(Jt,{path:"my-budgets",element:d.jsx(_6,{})}),d.jsxs(Jt,{path:"settings",element:d.jsx(r6,{}),children:[d.jsx(Jt,{index:!0,element:d.jsx(Hh,{to:"categories",replace:!0})}),d.jsx(Jt,{path:"accounts",element:d.jsx(JP,{})}),d.jsx(Jt,{path:"categories",element:d.jsx(t6,{})}),d.jsx(Jt,{path:"users",element:d.jsx(i6,{})})]}),d.jsxs(Jt,{path:"admin",element:d.jsx(a6,{}),children:[d.jsx(Jt,{path:"budget",element:d.jsx(o6,{})}),d.jsx(Jt,{path:"feedback",element:d.jsx(g6,{})}),d.jsx(Jt,{path:"migration",element:d.jsx(p6,{})}),d.jsx(Jt,{path:"tests",element:d.jsx(y6,{})})]})]})})]}),d.jsx(K4,{})]})})})}):d.jsx("div",{style:Gn,children:d.jsx("p",{children:"Loading..."})})}iC.createRoot(document.getElementById("root")).render(d.jsx(A.StrictMode,{children:d.jsx(E6,{})}));
